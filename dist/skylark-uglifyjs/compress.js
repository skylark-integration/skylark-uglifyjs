/**
 * skylark-uglifyjs - A version of uglifyjs that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./utils","./ast","./output","./parse","./scope"],function(e,n,t,i,r){"use strict";const{AST_Accessor:o,AST_Array:s,AST_Arrow:a,AST_Assign:f,AST_AsyncArrow:c,AST_AsyncDefun:u,AST_AsyncFunction:l,AST_AsyncGeneratorDefun:p,AST_AsyncGeneratorFunction:d,AST_Atom:h,AST_Await:v,AST_BigInt:_,AST_Binary:g,AST_Block:m,AST_BlockScope:b,AST_BlockStatement:y,AST_Boolean:x,AST_Break:k,AST_Call:w,AST_Case:E,AST_Catch:T,AST_Chain:S,AST_Class:D,AST_ClassExpression:A,AST_ClassField:z,AST_ClassGetter:O,AST_ClassInit:q,AST_ClassInitBlock:F,AST_ClassMethod:M,AST_ClassProperty:C,AST_ClassSetter:j,AST_ClassStaticBlock:H,AST_ConciseMethod:P,AST_Conditional:N,AST_Const:Y,AST_Constant:I,AST_Continue:R,AST_Debugger:U,AST_Default:B,AST_DefaultAssign:L,AST_DefaultValue:G,AST_DefClass:V,AST_Definitions:W,AST_Defun:$,AST_Destructuring:J,AST_Destructured:K,AST_DestructuredArray:Q,AST_DestructuredKeyVal:X,AST_DestructuredObject:Z,AST_Directive:ee,AST_Do:ne,AST_Dot:te,AST_DWLoop:ie,AST_EmptyStatement:re,AST_Exit:oe,AST_Expansion:se,AST_Export:ae,AST_ExportDeclaration:fe,AST_ExportDefault:ce,AST_ExportReferences:ue,AST_False:le,AST_Finally:pe,AST_For:de,AST_ForEnumeration:he,AST_ForIn:ve,AST_Function:_e,AST_Hole:ge,AST_If:me,AST_Import:be,AST_Infinity:ye,AST_IterationStatement:xe,AST_Jump:ke,AST_LabeledStatement:we,AST_Lambda:Ee,AST_LambdaDefinition:Te,AST_LambdaExpression:Se,AST_Let:De,AST_LoopControl:Ae,AST_NaN:ze,AST_New:Oe,AST_NewTarget:qe,AST_Node:Fe,AST_Null:Me,AST_Number:Ce,AST_Object:je,AST_ObjectKeyVal:He,AST_ObjectGetter:Pe,AST_ObjectProperty:Ne,AST_ObjectIdentity:Ye,AST_ObjectMethod:Ie,AST_ObjectSetter:Re,AST_PrefixedTemplateString:Ue,AST_PropAccess:Be,AST_RegExp:Le,AST_Return:Ge,AST_Scope:Ve,AST_Sequence:We,AST_SimpleStatement:$e,AST_Spread:Je,AST_Statement:Ke,AST_String:Qe,AST_Sub:Xe,AST_Super:Ze,AST_Switch:en,AST_SwitchBranch:nn,AST_Symbol:tn,AST_SymbolCatch:rn,AST_SymbolClass:on,AST_SymbolClassProperty:sn,AST_SymbolConst:an,AST_SymbolDeclaration:fn,AST_SymbolDefun:cn,AST_SymbolExport:un,AST_SymbolFunarg:ln,AST_SymbolImport:pn,AST_SymbolLambda:dn,AST_SymbolLet:hn,AST_SymbolMethod:vn,AST_SymbolRef:_n,AST_SymbolVar:gn,AST_Template:mn,AST_TemplateString:bn,AST_This:yn,AST_Throw:xn,AST_Toplevel:kn,AST_True:wn,AST_Try:En,AST_Unary:Tn,AST_UnaryPostfix:Sn,AST_UnaryPrefix:Dn,AST_Undefined:An,AST_Var:zn,AST_VarDef:On,AST_While:qn,AST_With:Fn,AST_Yield:Mn,TreeTransformer:Cn,TreeWalker:jn,_INLINE:Hn,_NOINLINE:Pn,_PURE:Nn,first_in_statement:Yn,root_expr:In,is_arrow:Rn,is_generator:Un,is_statement:Bn,is_async:Ln,walk_body:Gn,walk_lambda:Vn}=n,{all:Wn,defaults:$n,Dictionary:Jn,find_if:Kn,has_annotation:Qn,HOP:Xn,List:Zn,make_node:et,makePredicate:nt,MAP:tt,member:it,noop:rt,push_uniq:ot,regexp_source_fix:st,regexp_is_safe:at,remove:ft,return_false:ct,return_null:ut,return_true:lt,return_this:pt}=e,{is_basic_identifier_string:dt,JS_Parse_Error:ht,parse:vt,PRECEDENCE:_t,decode_escape_sequence:gt,is_identifier_string:mt,UNARY_POSTFIX:bt}=i,{OutputStream:yt}=t,{base54:xt,is_lhs:kt,is_funarg:wt,unary_side_effects:Et}=r;function Tt(e,n){if(!(this instanceof Tt))return new Tt(e,n);Cn.call(this,this.before,this.after),this.options=$n(e,{annotations:!n,arguments:!n,arrows:!n,assignments:!n,awaits:!n,booleans:!n,collapse_vars:!n,comparisons:!n,conditionals:!n,dead_code:!n,default_values:!n,directives:!n,drop_console:!1,drop_debugger:!n,evaluate:!n,expression:!1,functions:!n,global_defs:!1,hoist_exports:!n,hoist_funs:!1,hoist_props:!n,hoist_vars:!1,ie:!1,if_return:!n,imports:!n,inline:!n,join_vars:!n,keep_fargs:n,keep_fnames:!1,keep_infinity:!1,loops:!n,merge_vars:!n,module:!1,negate_iife:!n,objects:!n,optional_chains:!n,passes:1,properties:!n,pure_funcs:null,pure_getters:!n&&"strict",reduce_funcs:!n,reduce_vars:!n,rests:!n,sequences:!n,side_effects:!n,spreads:!n,strings:!n,switches:!n,templates:!n,top_retain:null,toplevel:!(!e||!e.module&&!e.top_retain),typeofs:!n,unsafe:!1,unsafe_comps:!1,unsafe_Function:!1,unsafe_math:!1,unsafe_proto:!1,unsafe_regexp:!1,unsafe_undefined:!1,unused:!n,varify:!n,webkit:!1,yields:!n},!0);var t=this.options.evaluate;this.eval_threshold=/eager/.test(t)?1/0:+t;var i=this.options.global_defs;if("object"==typeof i)for(var r in i)/^@/.test(r)&&Xn(i,r)&&(i[r.slice(1)]=vt(i[r],{expression:!0}));!0===this.options.inline&&(this.options.inline=4),this.drop_fargs=this.options.keep_fargs?ct:function(e,n){if(e.length_read)return!1;var t=e.name;if(!t)return n&&"Call"==n.TYPE&&n.expression===e;if(t.fixed_value()!==e)return!1;var i=t.definition();if(i.direct_access)return!1;var r=i.escaped;return r&&1!=r.depth},this.options.module&&(this.directives["use strict"]=!0);var o=this.options.pure_funcs;"function"==typeof o?this.pure_funcs=o:"string"==typeof o?this.pure_funcs=function(e){var n;return e instanceof w?n=e.expression:e instanceof mn&&(n=e.tag),!(n&&o===n.print_to_string())}:Array.isArray(o)?this.pure_funcs=function(e){var n;return e instanceof w?n=e.expression:e instanceof mn&&(n=e.tag),!(n&&it(n.print_to_string(),o))}:this.pure_funcs=lt;var s=this.options.sequences;this.sequences_limit=1==s?800:0|s;var a=this.options.top_retain;a instanceof RegExp?this.top_retain=function(e){return a.test(e.name)}:"function"==typeof a?this.top_retain=a:a&&("string"==typeof a&&(a=a.split(/,/)),this.top_retain=function(e){return it(e.name,a)});var f=this.options.toplevel;this.toplevel="string"==typeof f?{funcs:/funcs/.test(f),vars:/vars/.test(f)}:{funcs:f,vars:f}}return Tt.prototype=new Cn(function(e,n,t){if(e._squeezed)return e;var i=e instanceof Ve;i&&(this.option("arrows")&&Rn(e)&&e.value&&(e.body=[e.first_statement()],e.value=null),e.hoist_properties(this),e.hoist_declarations(this),e.process_returns(this)),n(e,this),n(e,this);var r=e.optimize(this);return!i||r!==e||this.has_directive("use asm")||r.pinned()||(r.drop_unused(this),r.merge_variables(this)&&r.drop_unused(this),n(r,this)),r===e&&(r._squeezed=!0),r}),Tt.prototype.option=function(e){return this.options[e]},Tt.prototype.exposed=function(e){if(e.exported)return!0;if(e.undeclared)return!0;if(!(e.global||e.scope.resolve()instanceof kn))return!1;var n=this.toplevel;return!Wn(e.orig,function(e){return n[e instanceof cn?"funcs":"vars"]})},Tt.prototype.compress=function(e){(e=e.resolve_defines(this)).hoist_exports(this),this.option("expression")&&e.process_expression(!0);for(var n=this.options.merge_vars,t=+this.options.passes||1,i=1/0,r=!1,o={ie:this.option("ie")},s=0;s<t;s++)if(e.figure_out_scope(o),(s>0||this.option("reduce_vars"))&&e.reset_opt_flags(this),this.options.merge_vars=n&&(r||s==t-1),e=e.transform(this),t>1){var a=0;if(e.walk(new jn(function(){a++})),Fe.info("pass {pass}: last_count: {min_count}, count: {count}",{pass:s,min_count:i,count:a}),a<i)i=a,r=!1;else{if(r)break;r=!0}}return this.option("expression")&&e.process_expression(!1),e},function(e){function n(e,n){var t=n.get_property();if(!(t instanceof Fe)){var i;if(e instanceof s){var r=e.elements;if("length"==t)return xt(r.length,e);"number"==typeof t&&t in r&&(i=r[t])}else if(e instanceof Ee){if("length"==t)return e.length_read=!0,xt(e.argnames.length,e)}else if(e instanceof je){t=""+t;for(var o=e.properties,a=o.length;--a>=0;){if(!sr(o[a]))return;i||o[a].key!==t||(i=o[a].value)}}return i instanceof _n&&i.fixed_value()||i}}function t(e,i,r,o,a,c,u){var l=i.parent(a);if(!(e.option("unsafe")&&l instanceof te&&function(e,n){return e instanceof x?ri.Boolean[n]:e instanceof Ce?ri.Number[n]:e instanceof Qe?ri.String[n]:"valueOf"!=n&&(e instanceof s?ri.Array[n]:e instanceof Ee?ri.Function[n]:e instanceof je?ri.Object[n]:e instanceof Le?ri.RegExp[n]&&!e.value.global:void 0)}(o,l.property))){var p=kt(r,l);if(p)return p;if(0!=a||!o||!o.is_constant()){if(l instanceof s)return t(e,i,l,l,a+1);if(l instanceof f)switch(l.operator){case"=":return t(e,i,l,o,a+1,c,u);case"&&=":case"||=":case"??=":return t(e,i,l,l,a+1);default:return}if(l instanceof g){if(!Jt[l.operator])return;return t(e,i,l,l,a+1)}if(l instanceof w)return!c&&l.expression===r&&!l.is_expr_pure(e)&&(!(o instanceof Se)||!(l instanceof Oe)&&o.contains_this());if(l instanceof N){if(l.condition===r)return;return t(e,i,l,l,a+1)}if(l instanceof he)return l.init===r;if(l instanceof He){if(l.value!==r)return;var d=i.parent(a+1);return t(e,i,d,d,a+2)}if(l instanceof Be){if(l.expression!==r)return;var h=n(o,l);return(!c||u)&&t(e,i,l,h,a+1)}if(l instanceof We){if(l.tail_node()!==r)return;return t(e,i,l,o,a+1,c,u)}}}}function i(e){return e instanceof D||e instanceof Ee}function r(e){return e instanceof D||e instanceof $||e instanceof _e}function S(e){return"arguments"==e.name&&e.scope.uses_arguments}function H(e,n){do{if(e===n)return!1;if(n instanceof Ve)return!0}while(n=n.parent_scope)}function P(e,n,t){var i=e.redef||e.definition();return(!e.in_arg||!wt(i))&&Wn(i.orig,function(e){return e instanceof an||e instanceof hn?e instanceof pn||n&&Fi(n,e):!(t&&e instanceof dn)})}function L(e,n,t,i){return i instanceof f?"="==i.operator&&i.right===t:i instanceof w?i.expression!==t||i instanceof Oe:i instanceof z?i.value===t&&!i.static:i instanceof oe?i.value===t&&n.resolve()!==e.scope.resolve():i instanceof On?i.value===t:void 0}function J(e,n){var t=at(_n,e);return t.fixed=n||at(An,e),t}function se(e,n){return function(t){var i=e(t),r=(t=J(i,n),i.definition());return r.references.push(t),r.replaced++,t}}e(Fe,function(e,n){return e}),kn.DEFMETHOD("hoist_exports",function(e){if(e.option("hoist_exports")){for(var n=this.body,t=[],i=0;i<n.length;i++){var r=n[i];r instanceof fe?(n[i]=r=r.body,r instanceof W?r.definitions.forEach(function(e){e.name.match_symbol(o,!0)}):o(r.name)):r instanceof ue&&(n.splice(i--,1),[].push.apply(t,r.properties))}t.length&&n.push(at(ue,this,{properties:t}))}function o(e){if(e instanceof fn){var n=at(un,e);n.alias=at(Qe,n,{value:n.name}),t.push(n)}}}),Ve.DEFMETHOD("process_expression",function(e,n){var t=this,i=new Cn(function(r){if(e){if(r instanceof ee&&(r=at($e,r,{body:at(Qe,r)})),r instanceof $e)return n?n(r):at(Ge,r,{value:r.body})}else if(r instanceof Ge){if(n)return n(r);var o=r.value;return o instanceof Qe?at(ee,o):at($e,r,{body:o||at(Dn,r,{operator:"void",expression:at(Ce,r,{value:0})})})}if(r instanceof m){if(r instanceof Ee){if(r!==t)return r}else if("awaits"===e&&r instanceof En&&r.bfinally)return r;for(var s=r.body.length;--s>=0;){var a=r.body[s];if(!Bt(a,!0)){r.body[s]=a.transform(i);break}}}else r instanceof me?(r.body=r.body.transform(i),r.alternative&&(r.alternative=r.alternative.transform(i))):r instanceof Fn&&(r.body=r.body.transform(i));return r});t.transform(i)}),kn.DEFMETHOD("unwrap_expression",function(){switch(this.body.length){case 0:return at(Dn,this,{operator:"void",expression:at(Ce,this,{value:0})});case 1:var e=this.body[0];if(e instanceof ee)return at(Qe,e);if(e instanceof $e)return e.body;default:return at(w,this,{expression:at(_e,this,{argnames:[],body:this.body}).init_vars(this),args:[]})}}),Fe.DEFMETHOD("wrap_expression",function(){var e=this;return Bn(e)||(e=at($e,e,{body:e})),e instanceof kn||(e=at(kn,e,{body:[e]})),e});var ae=/^(0|[1-9][0-9]*)$/;function Ue(e){e._squeezed=!1,e._optimized=!1,e instanceof b&&(e._var_names=void 0),e instanceof _n&&(e.fixed=void 0)}function sn(e,n){return this.transform(new Cn(function(t,i){return t instanceof G?((t=t.clone()).name=t.name.transform(this),t):t instanceof K?(i(t=t.clone(),this),t):t instanceof X?((t=t.clone()).value=t.value.transform(this),t):t.convert_symbol(e,n)}))}function vn(e,n){var t=at(e,this);return n(t,this)||t}function bn(e){var n=e.definition();n.assignments++,n.references.push(e)}function Hn(e,n){var t=new jn(function(i){return i instanceof G?(i.value.walk(n),i.name.walk(t),!0):i instanceof X?(i.key instanceof Fe&&i.key.walk(n),i.value.walk(t),!0):e(i)});this.walk(t)}function Pn(e){return e(this)}function Nn(e,n){var t=!1,i=new jn(function(r){return!!t||(r instanceof G?n?(r.name.walk(i),!0):t=!0:r instanceof X?!n&&r.key instanceof Fe?t=!0:(r.value.walk(i),!0):e(r)?t=!0:void 0)});return this.walk(i),t}function $n(e){return e instanceof p||e instanceof d}function Qn(e){var n=0,t=e.self();do{if(t.variables)return t}while(t=e.parent(n++))}function et(e,n,t,i,r,o){for(var s;s=e.parent(n++);t=s){if(s===i)return!1;if(o&&s instanceof Ee){if(s.name||Ln(s)||Un(s))return!0}else if(s instanceof En){if(s.bfinally&&s.bfinally!==t)return!0;if(r&&s.bcatch&&s.bcatch!==t)return!0}}return!1}!function(e){function r(e,n,t){t.assignments=0,t.bool_return=0,t.drop_return=0,t.cross_loop=!1,t.direct_access=!1,t.escaped=[],t.fixed=!t.const_redefs&&!t.scope.pinned()&&!n.exposed(t)&&!(t.init instanceof Se&&t.init!==t.scope)&&t.init,t.reassigned=0,t.recursive_refs=0,t.references=[],t.single_use=void 0}function o(e,n,t){t.variables.each(function(e){r(0,n,e)})}function a(e,n,t){t.fn_defs=[],t.variables.each(function(i){r(0,n,i);var o=i.init;o instanceof Te&&(t.fn_defs.push(o),o.safe_ids=null),null===i.fixed?(i.safe_ids=e.safe_ids,_(e,i)):i.fixed&&(e.loop_ids[i.id]=e.in_loop,_(e,i))}),t.may_call_this=function(){t.may_call_this=t.contains_this()?lt:ct},t.uses_arguments&&t.each_argname(function(e){e.definition().last_ref=!1}),n.option("ie")&&t.variables.each(function(e){var n=e.orig[0].definition();n!==e&&(n.fixed=!1)})}function c(e,n){var t=n.safe_ids;return void 0===t||t===e.safe_ids}function u(e,n){var t=e.fn_scanning;e.fn_scanning=n,n.walk(e),e.fn_scanning=t}function l(e,n){n.enclosed.forEach(function(t){if(n.variables.get(t.name)!==t&&!y(e,t)){t.single_use=!1;var i=t.fixed;"function"==typeof i&&(i=i()),i instanceof Ee&&void 0!==i.safe_ids||(t.fixed=!1)}})}function p(e,n,t){var i=t.safe_ids;if(void 0!==i&&!1!==i)if(t.parent_scope.resolve().may_call_this===lt)it(t,e.fn_visited)&&l(e,t);else if(i){var r=it(t,e.fn_visited);i===e.safe_ids?r||u(e,t):r?l(e,t):t.safe_ids=!1}else e.fn_scanning&&e.fn_scanning!==n.scope.resolve()?t.safe_ids=!1:(t.safe_ids=e.safe_ids,u(e,t))}function d(e,n){var t=n.fn_defs,i=n.may_call_this===lt?t:t.filter(function(n){return!1===n.safe_ids||(n.safe_ids=e.safe_ids,u(e,n),!1)});v(e),i.forEach(function(n){n.safe_ids=e.safe_ids,u(e,n)}),t.forEach(function(e){e.safe_ids=void 0}),n.fn_defs=void 0,n.may_call_this=void 0}function h(e,n){var t=Object.create(e.safe_ids);n||(t.seq={}),e.safe_ids=t}function v(e){e.safe_ids=Object.getPrototypeOf(e.safe_ids)}function _(e,n){e.safe_ids[n.id]={}}function m(e,n){e.references.push(n),!1!==e.last_ref&&(e.last_ref=n)}function y(e,n){if("m"==n.single_use)return!1;var t=e.safe_ids[n.id];if(t){var i=Xn(e.safe_ids,n.id);if(!i){var r=e.safe_ids.seq;t.read?t.read!==r&&(t.read=!0):t.read=r}return null==n.fixed?!S(n)&&((!n.global||"arguments"!=n.name)&&(e.loop_ids[n.id]=null,n.fixed=at(An,n.orig[0]),i&&(n.safe_ids=void 0),!0)):!t.assign||t.assign===e.safe_ids}return n.fixed instanceof Te}function x(e,n,t){if(!t){if(wt(n)&&n.scope.uses_arguments&&!e.has_directive("use strict"))return!1;if(!Wn(n.orig,function(e){return!(e instanceof an)}))return!1}if(void 0===n.fixed)return t||Wn(n.orig,function(e){return!(e instanceof hn)});if(!1===n.fixed||0===n.fixed)return!1;var i=e.safe_ids[n.id];if(n.safe_ids)return n.safe_ids[n.id]=!1,n.safe_ids=void 0,null===n.fixed||Xn(e.safe_ids,n.id)&&!i.read;if(!Xn(e.safe_ids,n.id)){if(!i)return!1;if(i.read||e.in_loop){var r=e.find_parent(b);if(r instanceof D)return!1;if(n.scope.resolve()!==r.resolve())return!1}i.assign=!(!i.assign||i.assign===e.safe_ids)||e.safe_ids}if(null!=n.fixed&&i.read){if(i.read!==e.safe_ids.seq)return!1;if(e.loop_ids[n.id]!==e.in_loop)return!1}return y(e,n)&&Wn(n.orig,function(e){return!(e instanceof dn)})}function k(e){if(!e)return!1;if(e instanceof f){var n=e.operator;return"="==n?k(e.right):!Jt[n.slice(0,-1)]}return e instanceof We?k(e.tail_node()):e.is_constant()||i(e)||e instanceof Ye}function E(e,t,i,r,o,a,f){var c=e.parent(a);if(!o||!o.is_constant()){if(L(t,i,r,c))return t.escaped.push(c),!(f>1)||o&&o.is_constant_expression(i)||(f=1),(!t.escaped.depth||t.escaped.depth>f)&&(t.escaped.depth=f),t.scope.resolve()!==i.resolve()&&(t.escaped.cross_scope=!0),void(t.fixed&&(t.fixed.escaped=t.escaped));if(function(e,n){return n instanceof s||(n instanceof g?Jt[n.operator]:n instanceof N?n.condition!==e:n instanceof We?n.tail_node()===e:n instanceof Je||void 0)}(r,c))E(e,t,i,c,c,a+1,f);else if(c instanceof He&&c.value===r){var u=e.parent(a+1);E(e,t,i,u,u,a+2,f)}else if(c instanceof Be&&c.expression===r&&(E(e,t,i,c,o=n(o,c),a+1,f+1),o))return;a>0||c instanceof w&&c.expression===r||c instanceof We&&c.tail_node()!==r||c instanceof $e||c instanceof Tn&&!Et[c.operator]||(t.direct_access=!0,t.fixed&&(t.fixed.direct_access=!0))}}function T(e){if(e instanceof Xe){var n=e.expression;if(n instanceof _n){var t=n.definition();if(S(t)){var i=e.property;i.is_constant()&&(i=i.value),(i instanceof Fe||ae.test(i))&&(t.reassigned++,(i instanceof Fe?t.scope.argnames:[t.scope.argnames[i]]).forEach(function(e){e instanceof ln&&(e.definition().fixed=!1)}))}}}}function A(e,n){var t,i;return function(){var r=e();return t!==r&&(t=r,i=n(r)),i}}function z(e,n,t,i,r){var o=new jn(function(t){if(t instanceof G)return Ue(t),h(e,!0),t.value.walk(e),v(e),(f=i)&&(i=function(e,n,t){var i,r;return function(){if(r===n)return n;var o=t(),s=Si(e,o,!0);return s instanceof Fe?r=n:i!==o&&(i=o,r=void 0===s?dt(n,[o,n.value]):o),r}}(n,t,f)),t.name.walk(o),i=f,!0;if(t instanceof Q){Ue(t);var a,f=i;if(t.elements.forEach(function(e,n){if(e instanceof ge)return Ue(e);f&&(i=A(f,function(t){return at(Xe,e,{expression:t,property:at(Ce,e,{value:n})})})),e.walk(o)}),t.rest)f&&(i=n.option("rests")&&A(f,function(e){if(!(e instanceof s))return t;for(var n=0,i=t.elements.length;n<i;n++)if(e.elements[n]instanceof Je)return t;return a||(a=at(s,t,{})),a.elements=e.elements.slice(i),a})),t.rest.walk(o);return i=f,!0}if(t instanceof Z){Ue(t);f=i;return t.properties.forEach(function(n){Ue(n),n.key instanceof Fe&&(h(e),n.key.walk(e),v(e)),f&&(i=A(f,function(e){var t=n.key,i=Xe;return"string"==typeof t&&(mt(t)?i=te:t=xt(t,n)),at(i,n,{expression:e,property:t})})),n.value.walk(o)}),t.rest&&(i=!1,t.rest.walk(o)),i=f,!0}return r(t,i,function(){for(var n=e.stack.length,i=0,r=o.stack.length-1;i<r;i++)e.stack.push(o.stack[i]);t.walk(e),e.stack.length=n}),!0});t.walk(o)}function O(e,n,t){var i=this;i.inlined=!1;var r=e.parent(),o=!Ln(i)&&!Un(i),f=!o,c=!1;i.walk(new jn(function(e){return f?c=!0:e instanceof Ge?f=!0:e instanceof Ve&&e!==i||void 0})),c&&h(e,o),a(e,t,i);var u=!i.uses_arguments||e.has_directive("use strict");i.argnames.forEach(function(n,o){var s=r.args[o];z(e,t,n,function(){var e=i.argnames.indexOf(n),t=e<0?s:r.args[e];return t instanceof We&&t.expressions.length<2&&(t=t.expressions[0]),t||at(An,r)},g)});var l,p=i.rest;p&&z(e,t,p,t.option("rests")&&function(){return i.rest!==p?p:(l||(l=at(s,i,{})),l.elements=r.args.slice(i.argnames.length),l)},g),Vn(i,e);var v=e.safe_ids;return d(e,i),c||(e.safe_ids=v),!0;function g(n,t){var i=n.definition();t&&u&&void 0===i.fixed?(_(e,i),e.loop_ids[i.id]=e.in_loop,i.fixed=t,i.fixed.assigns=[n]):i.fixed=!1}}e(Fe,rt),e(f,function(e,n,i){var r=this,o=r.left,s=r.right,a=o instanceof _n&&o.definition(),f=a||o instanceof K;switch(r.operator){case"=":return o.equals(s)&&!o.has_side_effects(i)?(s.walk(e),function n(t){Ue(t);if(t instanceof te)n(t.expression);else if(t instanceof Xe)n(t.expression),t.property.walk(e);else if(t instanceof _n){var i=t.definition();m(i,t),i.fixed&&(t.fixed=i.fixed,t.fixed.assigns?t.fixed.assigns.push(r):t.fixed.assigns=[r])}else t.walk(e)}(o),r.redundant=!0,!0):a&&s instanceof Se?(d(),s.parent_scope.resolve().fn_defs.push(s),s.safe_ids=null,a.fixed&&r.write_only||p(e,a,s),!0):f?(s.walk(e),d(),!0):void T(o);case"&&=":case"||=":case"??=":var c=!0;default:if(!f)return T(o),b();a.assignments++;var u=a.fixed;if(t(i,e,r,r,0))return a.fixed=!1,b();var l=y(e,a);return c&&h(e,!0),s.walk(e),c&&v(e),l&&!o.in_arg&&x(e,a)?(m(a,o),_(e,a),a.single_use&&(a.single_use=!1),o.fixed=a.fixed=function(){return at(g,r,{operator:r.operator.slice(0,-1),left:J(o,u),right:r.right})},o.fixed.assigns=u&&u.assigns?u.assigns.slice():[a.orig[0]],o.fixed.assigns.push(r),o.fixed.to_binary=se(function(e){return e.left},u)):(o.walk(e),a.fixed=!1),!0}function d(){var n=a&&Qi(e,a),f=t(i,e,r,s,0,k(s),n);z(e,i,o,function(){return r.right},function(n,t,i){if(!(n instanceof _n))return T(n),void i();var a=n.definition();a.assignments++,t&&!n.in_arg&&x(e,a)?(m(a,n),_(e,a),(o instanceof K||1==a.orig.length&&a.orig[0]instanceof cn)&&(a.single_use=!1),e.loop_ids[a.id]=e.in_loop,a.fixed=f?0:t,n.fixed=t,n.fixed.assigns=[r],E(e,a,n.scope,r,s,0,1)):(i(),a.fixed=!1)})}function b(){if(c)return o.walk(e),h(e,!0),s.walk(e),v(e),!0}}),e(g,function(e){if(Jt[this.operator])return this.left.walk(e),h(e,!0),this.right.walk(e),v(e),!0}),e(b,function(e,n,t){o(0,t,this)}),e(w,function(e,n){var t=this.expression;if(t instanceof Se){var i=Pt(this);return this.args.forEach(function(n){n.walk(e),n instanceof Je&&(i=!1)}),i&&(t.reduce_vars=O),t.walk(e),i&&delete t.reduce_vars,!0}if("Call"==this.TYPE)switch(e.in_boolean_context()){case"d":var r=!0;case!0:!function e(n,t){if(n instanceof f){if("="!=n.operator)return;e(n.left,t),e(n.right,t)}else if(n instanceof g){if(!Jt[n.operator])return;e(n.left,t),e(n.right,t)}else if(n instanceof N)e(n.consequent,t),e(n.alternative,t);else if(n instanceof _n){var i=n.definition();i.bool_return++,t&&i.drop_return++}}(t,r)}t.walk(e);var o=this.optional;o&&h(e,!0),this.args.forEach(function(n){n.walk(e)}),o&&v(e);var s=t instanceof _n&&t.fixed_value();return s instanceof Ee?p(e,t.definition(),s):e.find_parent(Ve).may_call_this(),!0}),e(D,function(e,n,t){var i=this;o(0,t,i),i.extends&&i.extends.walk(e);var r=i.properties.filter(function(n){return Ue(n),n.key instanceof Fe&&(e.push(n),n.key.walk(e),e.pop()),n.value});if(i.name){var s=i.name.definition(),a=e.parent();(a instanceof fe||a instanceof ce)&&(s.single_use=!1),x(e,s,!0)?(_(e,s),e.loop_ids[s.id]=e.in_loop,s.fixed=function(){return i},s.fixed.assigns=[i],zi(s)||(s.single_use=!1)):s.fixed=!1}return r.forEach(function(n){e.push(n),!n.static||Rt(n)&&n.value.contains_this()?(h(e),n.value.walk(e),v(e)):n.value.walk(e),e.pop()}),!0}),e(F,function(e,n,t){return h(e,!0),a(e,t,this),n(),d(e,this),!0}),e(N,function(e){return this.condition.walk(e),h(e,!0),this.consequent.walk(e),v(e),h(e,!0),this.alternative.walk(e),v(e),!0}),e(G,function(e){return h(e,!0),this.value.walk(e),v(e),this.name.walk(e),!0}),e(ne,function(e){var n=e.in_loop;return e.in_loop=this,h(e),this.body.walk(e),Ei(this,e.parent())&&(v(e),h(e)),this.condition.walk(e),v(e),e.in_loop=n,!0}),e(de,function(e,n,t){o(0,t,this),this.init&&this.init.walk(e);var i=e.in_loop;return e.in_loop=this,h(e),this.condition&&this.condition.walk(e),this.body.walk(e),this.step&&(Ei(this,e.parent())&&(v(e),h(e)),this.step.walk(e)),v(e),e.in_loop=i,!0}),e(he,function(e,n,t){o(0,t,this),this.object.walk(e);var i=e.in_loop;e.in_loop=this,h(e);var r=this.init;return r instanceof W?r.definitions[0].name.mark_symbol(function(e){if(e instanceof fn){var n=e.definition();n.assignments++,n.fixed=!1}},e):r instanceof K||r instanceof _n?r.mark_symbol(function(e){if(e instanceof _n){var n=e.definition();m(n,e),n.assignments++,e.is_immutable()||(n.fixed=!1)}},e):r.walk(e),this.body.walk(e),v(e),e.in_loop=i,!0}),e(me,function(e){return this.condition.walk(e),h(e,!0),this.body.walk(e),v(e),this.alternative&&(h(e,!0),this.alternative.walk(e),v(e)),!0}),e(we,function(e){return h(e,!0),this.body.walk(e),v(e),!0}),e(Ee,function(e,n,t){var i=this;return!c(e,i)||(!ot(e.fn_visited,i)||(i.inlined=!1,h(e),a(e,t,i),n(),d(e,i),i.name&&E(e,i.name.definition(),i,i.name,i,0,1),!0))}),e(Te,function(e,n,t){var i=this,r=i.name.definition(),o=e.parent();return(o instanceof fe||o instanceof ce)&&(r.single_use=!1),!c(e,i)||(!ot(e.fn_visited,i)||(i.inlined=!1,h(e),a(e,t,i),n(),d(e,i),!0))}),e(Xe,function(e){if(this.optional)return this.expression.walk(e),h(e,!0),this.property.walk(e),v(e),!0}),e(en,function(e,n,t){o(0,t,this),this.expression.walk(e);var i=!0;return this.body.forEach(function(n){n instanceof B||(n.expression.walk(e),i&&(i=!1,h(e,!0)))}),i||v(e),Gn(this,e),!0}),e(nn,function(e){return h(e,!0),Gn(this,e),v(e),!0}),e(rn,function(){this.definition().fixed=!1}),e(pn,function(){this.definition().fixed=!1}),e(_n,function(e,n,r){var o=this,s=o.definition(),a=s.fixed||s.last_ref&&s.last_ref.fixed;m(s,o),1==s.references.length&&!s.fixed&&s.orig[0]instanceof cn&&(e.loop_ids[s.id]=e.in_loop);var f,c=Qi(e,s);switch(c&&c.enclosed.forEach(function(n){if(s!==n&&n.scope.resolve()!==c){var t=n.fixed&&n.fixed.assigns;if(t&&!(t[t.length-1]instanceof On)){var i=e.safe_ids[n.id];i&&(i.assign=!0)}}}),"m"==s.single_use&&s.fixed&&(s.fixed=0,s.single_use=!1),s.fixed){case 0:y(e,s)||(s.fixed=!1);case!1:var u=s.redefined();u&&H(s.scope,o.scope)&&(u.single_use=!1);break;case void 0:s.fixed=!1;break;default:if(!y(e,s)){s.fixed=!1;break}o.in_arg&&s.orig[0]instanceof dn&&(o.fixed=s.scope);var l=o.fixed_value();c?s.recursive_refs++:l&&function(e,n){return e.option("unused")&&!n.scope.pinned()&&!1!==n.single_use&&n.references.length-n.recursive_refs==1&&!(wt(n)&&n.scope.uses_arguments)}(r,s)?(s.in_loop=e.loop_ids[s.id]!==e.in_loop,s.single_use=i(l)&&!l.pinned()&&(!s.in_loop||e.parent()instanceof w)||!s.in_loop&&s.scope===o.scope.resolve()&&l.is_constant_expression()):s.single_use=!1,t(r,e,o,l,0,k(l),c)&&(s.single_use?s.single_use="m":s.fixed=0),s.fixed&&e.loop_ids[s.id]!==e.in_loop&&(s.cross_loop=!0),E(e,s,o.scope,o,l,0,1)}o.fixed||(o.fixed=0===s.fixed?a:s.fixed),l instanceof Ee&&!((f=e.parent())instanceof w&&f.expression===o)&&p(e,s,l)}),e(mn,function(e,n){var t=this.tag;if(t){if(t instanceof Se)return this.expressions.forEach(function(n){n.walk(e)}),t.walk(e),!0;t.walk(e),this.expressions.forEach(function(n){n.walk(e)});var i=t instanceof _n&&t.fixed_value();return i instanceof Ee?p(e,t.definition(),i):e.find_parent(Ve).may_call_this(),!0}}),e(kn,function(e,n,t){return this.globals.each(function(e){r(0,t,e)}),h(e,!0),a(e,t,this),n(),d(e,this),!0}),e(En,function(e,n,t){return o(0,t,this),h(e,!0),Gn(this,e),v(e),this.bcatch&&(h(e,!0),this.bcatch.walk(e),v(e)),this.bfinally&&this.bfinally.walk(e),!0}),e(Tn,function(e,n){var t=this;if(bt[t.operator]){var i=t.expression;if(i instanceof _n){var r=i.definition();r.assignments++;var o=r.fixed;return y(e,r)&&!i.in_arg&&x(e,r)?(m(r,i),_(e,r),r.single_use&&(r.single_use=!1),r.fixed=function(){return at(g,t,{operator:t.operator.slice(0,-1),left:at(Dn,t,{operator:"+",expression:J(i,o)}),right:at(Ce,t,{value:1})})},r.fixed.assigns=o&&o.assigns?o.assigns.slice():[],r.fixed.assigns.push(t),t instanceof Dn?i.fixed=r.fixed:(i.fixed=function(){return at(Dn,t,{operator:"+",expression:J(i,o)})},i.fixed.assigns=o&&o.assigns,i.fixed.to_prefix=se(function(e){return e.expression},r.fixed))):(i.walk(e),r.fixed=!1),!0}T(i)}}),e(On,function(e,n,t){var i=this,r=i.value;if(r instanceof Se&&i.name instanceof fn){s(),r.parent_scope.resolve().fn_defs.push(r),r.safe_ids=null;var o=i.name.definition();o.fixed||p(e,o,r)}else r?(r.walk(e),s()):e.parent()instanceof De&&s();return!0;function s(){z(e,t,i.name,function(){return i.value||at(An,i)},function(n,t){var r=n.definition();t&&x(e,r,!0)?(_(e,r),e.loop_ids[r.id]=e.in_loop,r.fixed=t,r.fixed.assigns=[i],(n instanceof an&&r.redefined()||!P(n)&&!zi(r))&&(r.single_use=!1)):r.fixed=!1})}}),e(qn,function(e,n){var t=e.in_loop;return e.in_loop=this,h(e),n(),v(e),e.in_loop=t,!0})}(function(e,n){e.DEFMETHOD("reduce_vars",n)}),kn.DEFMETHOD("reset_opt_flags",function(e){var n=new jn(e.option("reduce_vars")?function(t,i){return Ue(t),t.reduce_vars(n,i,e)}:Ue);n.fn_scanning=null,n.fn_visited=[],n.in_loop=null,n.loop_ids=Object.create(null),n.safe_ids=Object.create(null),n.safe_ids.seq={},this.walk(n)}),tn.DEFMETHOD("fixed_value",function(e){var n=this.definition(),t=n.fixed;if(t)return this.fixed&&(t=this.fixed),(t instanceof Fe?t:t()).tail_node();if(!(t=0===t&&this.fixed))return t;var i=(t instanceof Fe?t:t()).tail_node();return e&&1!=n.escaped.depth&&Gi(i,!0)?i:i.is_constant()?i:void 0}),_n.DEFMETHOD("is_immutable",function(){var e=this.redef||this.definition();return e.orig[0]instanceof dn&&(1==e.orig.length||!!this.in_arg&&!(e.orig[1]instanceof ln))}),Fe.DEFMETHOD("convert_symbol",rt),G.DEFMETHOD("convert_symbol",sn),K.DEFMETHOD("convert_symbol",sn),fn.DEFMETHOD("convert_symbol",vn),_n.DEFMETHOD("convert_symbol",vn),G.DEFMETHOD("mark_symbol",Hn),K.DEFMETHOD("mark_symbol",Hn),fn.DEFMETHOD("mark_symbol",Pn),_n.DEFMETHOD("mark_symbol",Pn),Fe.DEFMETHOD("match_symbol",function(e){return e(this)}),G.DEFMETHOD("match_symbol",Nn),K.DEFMETHOD("match_symbol",Nn);var tt=nt("Infinity NaN undefined");function st(e,n){if(e instanceof h)return!0;if(e instanceof Ye)return!0;if(e instanceof Be){if("__proto__"===e.property)return!0;if((e=e.expression)instanceof _n){if(e.is_immutable())return!1;e=e.fixed_value()}return!e||(!!e.tail_node().is_constant()||st(e,n))}if(e instanceof _n){if(e.is_immutable())return!0;var t=e.definition();return n.exposed(t)&&tt[t.name]}return!1}function at(e,n,t){return t?(t.start=n.start,t.end=n.end):t=n,new e(t)}function dt(e,n){return 1==n.length?n[0]:at(We,e,{expressions:n.reduce(zt,[])})}function xt(e,n){switch(typeof e){case"string":return at(Qe,n,{value:e});case"number":return isNaN(e)?at(ze,n):isFinite(e)?1/e<0?at(Dn,n,{operator:"-",expression:at(Ce,n,{value:-e})}):at(Ce,n,{value:e}):e<0?at(Dn,n,{operator:"-",expression:at(ye,n)}):at(ye,n);case"boolean":return at(e?wn:le,n);case"undefined":return at(An,n);default:if(null===e)return at(Me,n);if(e instanceof RegExp)return at(Le,n,{value:e});throw new Error(string_template("Can't handle constant of type: {type}",{type:typeof e}))}}function St(e){return e instanceof Be||Nt(e)&&"eval"==e.name}function Dt(e,n,t){var i=!1;return"Call"==e.TYPE?i=e.expression===n&&St(t):e instanceof mn?i=e.tag===n&&St(t):e instanceof Dn&&(i="delete"==e.operator||"typeof"==e.operator&&Nt(t)),i?dt(n,[at(Ce,n,{value:0}),t]):t}function At(e,n){var t=new Jn;return e.walk(new jn(function(e){if(e instanceof _n){var n=e.definition(),i=e.fixed;i&&t.has(n.id)?t.get(n.id)!==i&&t.set(n.id,!1):t.set(n.id,i)}})),t.size()>0&&n.walk(new jn(function(e){if(e instanceof _n){var n=e.definition(),i=e.fixed;i&&t.has(n.id)&&t.get(n.id)!==i&&(e.fixed=!1)}})),n}function zt(e,n){return n instanceof We?[].push.apply(e,n.expressions):e.push(n),e}function Ot(e){return e instanceof Y||e instanceof V||e instanceof De}function qt(e){if(e instanceof Te){var n=e.name.definition(),t=e.name.scope;return n.scope===t||Wn(n.references,function(e){var n=e.scope;do{if(n===t)return!0}while(n=n.parent_scope)})}return!Ot(e)}function Ft(e){if(null===e)return[];if(e instanceof y)return Wn(e.body,qt)?e.body:[e];if(e instanceof re)return[];if(Bn(e))return[e];throw new Error("Can't convert thing to statement array")}function Mt(e){return null===e||(e instanceof re||e instanceof y&&0==e.body.length)}function Ct(e){return Wn(e.body,function(e){return Mt(e)||e instanceof $||e instanceof zn&&Ut(e)})}function jt(e){return e instanceof xe&&e.body instanceof y?e.body:e}function Ht(e){if("Call"!=e.TYPE)return!1;do{e=e.expression}while(e instanceof Be);return e instanceof Se?!Rn(e):Ht(e)}function Pt(e){var n=e.expression;if(n.name)return!1;if(!(e instanceof Oe))return!0;var t=!1;return n.walk(new jn(function(e){return!!t||(e instanceof qe?t=!0:e instanceof Ve&&e!==n||void 0)})),!t}function Nt(e){return e instanceof _n&&e.definition().undeclared}var Yt,It=nt("Array Boolean clearInterval clearTimeout console Date decodeURI decodeURIComponent encodeURI encodeURIComponent Error escape eval EvalError Function isFinite isNaN JSON Map Math Number parseFloat parseInt RangeError ReferenceError RegExp Object Set setInterval setTimeout String SyntaxError TypeError unescape URIError WeakMap WeakSet");function Rt(e){return e.static&&e.value&&(e instanceof z||e instanceof q)}function Ut(e){return Wn(e.definitions,function(e){return!e.value})}function Bt(e,n){return e instanceof V?n&&!e.extends&&Wn(e.properties,function(e){return!(e.key instanceof Fe)&&!Rt(e)}):e instanceof W?(n||e instanceof zn)&&Ut(e):e instanceof fe?Bt(e.body,n):e instanceof ce?Bt(e.body,n):e instanceof Te}function Lt(e,n){var t=e.lastIndexOf(n);if(t<0)return!1;for(;++t<e.length;)if(!Bt(e[t],!0))return!1;return!0}function Gt(e,n){var t;if(e.init instanceof y&&(t=e.init,e.init=t.body.pop(),t.body.push(e)),e.init instanceof $?(t||(t=at(y,e,{body:[e]})),t.body.splice(-1,0,e.init),e.init=null):e.init instanceof $e?e.init=e.init.body:Mt(e.init)&&(e.init=null),t)return n?Zn.splice(t.body):t}function Vt(e,n){var i,a,c,u,l,p,d=A(n,function(e){return e instanceof Ee});!function(){var e=n.self(),t=0;do{if(!i&&e.variables&&(i=e),e instanceof T)n.parent(t).bfinally&&(l||(l={}),l.bfinally=!0),t++;else if(e instanceof pe)t++;else if(e instanceof xe)u=!0;else{if(e instanceof Ve){p=e;break}e instanceof En&&(l||(l={}),e.bcatch&&(l.bcatch=!0),e.bfinally&&(l.bfinally=!0))}}while(e=n.parent(t++))}();var h,_,x=10;do{if(_=h,h=0,F(e)&&(h=1),!h&&1==_)break;if(n.option("dead_code")&&(C(e,n)&&(h=2),!h&&2==_))break;if(n.option("if_return")&&(M(e,n)&&(h=3),!h&&3==_))break;if(n.option("awaits")&&n.option("side_effects")&&(j(e,n)&&(h=4),!h&&4==_))break;if(n.option("inline")>=4&&(H(e,n)&&(h=5),!h&&5==_))break;if(n.sequences_limit>0){if(I(e,n)&&(h=6),!h&&6==_)break;if(se(e,n)&&(h=7),!h&&7==_)break}if(n.option("join_vars")&&(ye(e)&&(h=8),!h&&8==_))break;n.option("collapse_vars")&&O(e,n)&&(h=9)}while(h&&x-- >0);return e;function A(e,n){var t,i=e.self(),r=0;do{if(i instanceof T)i=e.parent(r++);else if(i instanceof we)i=i.body;else if(i instanceof nn){var o=e.parent(r);(o.body[o.body.length-1]===i||s(i.body))&&(r++,i=o)}do{if(n(t=i))return t;i=e.parent(r++)}while(i instanceof me)}while(t&&(i instanceof y||i instanceof T||i instanceof Ve||i instanceof nn||i instanceof En)&&Lt(i.body,t));function s(e){for(var n=e.length;--n>=0;)if(e[n]instanceof k)return!0;return!1}}function O(e,n){if(!p.pinned()){for(var d,h,_=new Jn,x=[],k=!1,T=new Jn,A=e.length,O=new Cn(function(e,t){if(Me)return e;if(!qe)return e!==M[j]?e:++j<M.length?Qe(e,O):(qe=!0,(J=(V?function e(n,t){var i=O.parent(t);if(i instanceof s)return e(i,t+1);if(i instanceof f){return le(i)?n:i.left.match_symbol(function(e){return e instanceof _n&&(re.name==e.name||V.name==e.name)})?n:i.left!==n&&Jt[r=i.operator.slice(0,-1)]?un(i,r,t):e(i,t+1)}if(i instanceof v)return e(i,t+1);if(i instanceof g){var r;return i.left!==n&&Jt[r=i.operator]?un(i,r,t):e(i,t+1)}if(i instanceof w)return i;if(i instanceof E)return i.expression!==n?n:e(i,t+1);if(i instanceof N)return i.condition!==n?n:e(i,t+1);if(i instanceof W)return dn(i,t+1);if(i instanceof ne)return n;if(i instanceof oe)return dn(i,t+1);if(i instanceof de)return i.init!==n&&i.condition!==n?n:e(i,t+1);if(i instanceof he)return i.init!==n?n:e(i,t+1);if(i instanceof me)return i.condition!==n?n:e(i,t+1);if(i instanceof Ne){var o=O.parent(t+1);return Wn(o.properties,function(e){return e instanceof He})?e(o,t+2):o}if(i instanceof Be){var a=i.expression;return a===n?e(i,t+1):n}if(i instanceof We)return(i.tail_node()===n?e:dn)(i,t+1);if(i instanceof $e)return dn(i,t+1);if(i instanceof Je)return e(i,t+1);if(i instanceof en)return i.expression!==n?n:e(i,t+1);if(i instanceof Tn)return"delete"==i.operator?n:e(i,t+1);if(i instanceof On)return i.name.match_symbol(function(e){return e instanceof fn&&(re.name==e.name||V.name==e.name)})?n:e(i,t+1);if(i instanceof qn)return i.condition!==n?n:e(i,t+1);if(i instanceof Mn)return e(i,t+1);return null}:function e(n,t){var i=O.parent(t);if(i instanceof s)return n;if(i instanceof f)return n;if(i instanceof v)return n;if(i instanceof g)return n;if(i instanceof w)return n;if(i instanceof E)return n;if(i instanceof N)return n;if(i instanceof W)return dn(i,t+1);if(i instanceof oe)return n;if(i instanceof me)return n;if(i instanceof xe)return n;if(i instanceof Ne)return n;if(i instanceof Be)return n;if(i instanceof We)return(i.tail_node()===n?e:dn)(i,t+1);if(i instanceof $e)return dn(i,t+1);if(i instanceof Je)return n;if(i instanceof en)return n;if(i instanceof Tn)return n;if(i instanceof On)return n;if(i instanceof Mn)return n;return null})(e,0))===e&&(Me=!0),e);var i,r,a=O.parent();if(!ee&&nn(e,a)&&(ee=a),ce&&ae&&Ie&&!ee&&e instanceof f&&"="!=e.operator&&e.left.equals(re))return Pe++,k=!0,Fe.info("Cascading {this} [{start}]",e),Ie=!1,ye=Nn(re),e.right.transform(O),Hn(H),Me?i=H:(Me=!0,i=at(g,H,{operator:ce,left:re.fixed&&re.definition().fixed?re.fixed.to_binary(H):re,right:Te})),at(f,e,{operator:"=",left:e.left,right:at(g,e,{operator:e.operator.slice(0,-1),left:i,right:e.right})});if(function(e,t){if(e===Te)return!0;if(t instanceof de&&e!==t.init)return!0;if(e instanceof f)return"="!=e.operator&&re.equals(e.left);if(e instanceof w)return re instanceof Be&&(!!re.equals(e.expression)&&!(Te instanceof Se&&!Te.contains_this()));return e instanceof D?!n.has_directive("use strict"):e instanceof U||(e instanceof $?ue&&re.name===e.name.name:e instanceof X?e.key instanceof Fe:e instanceof ie||e instanceof Ae||e instanceof En||e instanceof Fn)}(e,a))return Me=!0,e;if(e.single_use)return e;if(!(e instanceof fn)&&(ae&&re.equals(e)||fe&&(r=fe(e,this)))){if(!Ie||ee&&(r||!ke||!Oe))return r||V||(Me=!0),e;if(kt(e,a))return V&&!r&&(I=!0),e;if(!r&&R&&e.fixed!==re.fixed)return Me=!0,e;if(V)return ee&&0==Y&&(Y=C-Pe),r||Pe++,e;if(Pe++,k=Me=!0,Fe.info("Collapsing {this} [{start}]",e),"Binary"==H.TYPE)return Pn(H,e),at(f,H,{operator:"=",left:H.right.left,right:"&&"==H.operator?at(N,H,{condition:H.left,consequent:H.right.right,alternative:e}):at(N,H,{condition:H.left,consequent:e,alternative:H.right.right})});if(H instanceof Sn)return at(Dn,H,{operator:H.operator,expression:re.fixed&&re.definition().fixed?re.fixed.to_prefix(H):re});if(H instanceof Dn)return Hn(H),H;if(Pn(Te,e),H instanceof On){var c=H.name.definition();return c.references.length-c.replaced!=1||n.exposed(c)?at(f,H,{operator:"=",left:e,right:Te}):(c.replaced++,Dt(a,e,Te))}Hn(Te);var u=H.clone();return u.right=Te,u}if(function(e,t){if(!(e instanceof _n))return!1;if(e.is_declared(n)){if(e.fixed_value())return!1;if(P(e))return!(t instanceof Be&&t.expression===e)&&S(e.definition())}else if(Ze(e,t))return!1;return!Oe||(fe=!1,!1)}(e,a))return Me=!0,e;if((rn(e,a)||le(e))&&(J=e,e instanceof Ve&&(Me=!0)),e instanceof o){var l=Ie;return Ie=!1,t(e,O),Ie=l,Ke(e)}if(e instanceof K){l=Ie;return Ie=!1,t(e,O),Ie=l,Ke(e)}if(e instanceof G){e.name=e.name.transform(O);l=Ie;return Ie=!1,e.value=e.value.transform(O),Ie=l,Ke(e)}if(!(!(e instanceof b)||e instanceof Ve||e.variables&&e.variables.all(function(e){return!ge.has(e.name)&&!ye.has(e.name)}))){l=Ie;return Ie=!1,Qe(e,O)||t(e,O),Ie=l,Ke(e)}return Qe(e,O)?Ke(e):void 0},Ke),F=new Cn(function(e){if(Me)return e;if(!qe){if(e!==M[j])return e;switch(j++,M.length-j){case 0:if(qe=!0,I)return e;if(e!==H)return e;if(e instanceof On)return e;Le.replaced++;var n=F.parent();return n instanceof We&&n.tail_node()!==e?(V.replaced++,Te===we?Zn.skip:dt(we,we.expressions.slice(0,-1))):Te;case 1:if(!I&&e.body===H)return qe=!0,Le.replaced++,V.replaced++,null;default:return Qe(e,F)}}if(e instanceof _n&&e.definition()===Le){if(kt(e,F.parent()))return e;--Pe||(Me=!0),Fe.info("Replacing {this} [{start}]",e);var t=Te.clone();return t.scope=e.scope,t.reference(),Pe==Y?(Me=!0,at(f,H,{operator:"=",left:e,right:t})):(Le.replaced++,t)}return e instanceof B||e instanceof Ve?e:void 0},function(e){return Gn(e,F)});--A>=0;){0==A&&n.option("unused")&&sn();var M=[];for(an(e[A]);x.length>0;){var C,j=0,H=(M=x.pop())[M.length-1],Y=-1,I=!1,R=!1,V=null,J=null,ee=null,re=bn(H),se=re&&re.has_side_effects(n),ae=re&&(!se||re instanceof _n)&&!st(re,n),fe=wn(H);if(ae||fe){var ce=H instanceof f&&H.operator.slice(0,-1),ue=H.name instanceof ln,le=ct;if(H.may_throw(n)){if(ue&&Ln(p))continue;le=l?function(e){return e.has_side_effects(n)}:tt}var pe=!1,ve=!1,ge=new Jn,be=!0,ye=Nn(H),ke=Vn(re),we=yn(H),Te=we;se||(!ce&&Te instanceof We&&(Te=Te.tail_node()),se=$n());var ze=l||!ke?function(e){return e instanceof K}:ct,Oe=Kn(H),qe=ue,Me=!1,Pe=0,Ie=!d||!qe;if(!Ie){for(var Re=H.arg_index+1;!Me&&Re<d.length;Re++)d[Re]&&d[Re].transform(O);Ie=!0}for(var Ue=A;!Me&&Ue<e.length;Ue++)e[Ue].transform(O);if(V){if(!Pe||C>Pe+I){x.push(M),h=!0;continue}Pe==Y&&(I=!0);var Le=re.definition();Me=!1,j=0,qe=ue;for(Ue=A;!Me&&Ue<e.length;Ue++)e[Ue].transform(F)||e.splice(Ue--,1);Pe=H instanceof On&&H===M[M.length-1]&&Le.references.length==Le.replaced&&!n.exposed(Le),V.last_ref=!1,V.single_use=!1,k=!0}Pe&&Yn(H)}}}return k}function Ke(e){return Me?e:(J===e&&(Me=!0),ee===e&&(ee=null),e)}function Qe(e,n){if(e instanceof b){if(e instanceof Ve)return e;if(e instanceof D){e.name&&(e.name=e.name.transform(n)),!Me&&e.extends&&(e.extends=e.extends.transform(n));for(var t=[],i=[],r=0;!Me&&r<e.properties.length;r++){(o=e.properties[r]).key instanceof Fe&&(o.key=o.key.transform(n)),o.static&&(o instanceof z?o.value&&t.push(o):o instanceof q&&[].push.apply(i,o.value.body))}for(r=0;!Me&&r<i.length;r++)i[r].transform(n);for(r=0;!Me&&r<t.length;r++){var o;(o=t[r]).value=o.value.transform(n)}return e}if(e instanceof he)return e.object=e.object.transform(n),Me=!0,e;if(e instanceof en){e.expression=e.expression.transform(n);for(r=0;!Me&&r<e.body.length;r++){var s=e.body[r];if(s instanceof E){if(!qe){if(s!==M[j])continue;j++}if(s.expression=s.expression.transform(n),!Oe)break;fe=!1}}return Me=!0,e}}}function Ze(e,n){return n instanceof f?"="==n.operator&&n.left===e:n instanceof G?n.name===e:n instanceof Q||(n instanceof X?n.value===e:void 0)}function nn(e,n){return n instanceof f?n.left!==e&&Jt[n.operator.slice(0,-1)]:n instanceof g?n.left!==e&&Jt[n.operator]:n instanceof w?n.optional&&n.expression!==e:n instanceof E?n.expression!==e:n instanceof N?n.condition!==e:n instanceof me?n.condition!==e:n instanceof Xe?n.optional&&n.expression!==e:void 0}function rn(e,t){if(e instanceof v)return!0;if("Binary"==e.TYPE)return!Vi(e.operator,e.right,n);if(e instanceof w){var i=e.expression;if(i instanceof _n&&(_=i.definition(),i=i.fixed_value()),!(i instanceof Ee))return!e.is_expr_pure(n);if(_&&Qi(n,_,i))return!0;if(i.collapse_scanning)return!1;i.collapse_scanning=!0;var o=Ie;Ie=!1;for(var a=J,f=ee,c=0;!Me&&c<i.argnames.length;c++)on(m,i.argnames[c],e.args[c])&&(Me=!0);if(!Me)if(i.rest&&on(m,i.rest,at(s,e,{elements:e.args.slice(c)})))Me=!0;else if(Rn(i)&&i.value)i.value.transform(O);else for(c=0;!Me&&c<i.body.length;c++){var u=i.body[c];if(u instanceof Ge){u.value&&u.value.transform(O);break}u.transform(O)}return ee=f,J=a,Ie=o,i.collapse_scanning=!1,Me?(Me=!1,!0):!1}if(e instanceof D){if(!l)return!1;var d=e.extends;return!!d&&(d instanceof _n&&(d=d.fixed_value()),!r(d))}if(e instanceof oe){if(l){if(l.bfinally)return!0;if(l.bcatch&&e instanceof xn)return!0}return se||re instanceof Be||nt(re)}if(e instanceof _e)return n.option("ie")&&e.name&&ye.has(e.name.name);if(e instanceof Ye)return Xn(e,t);if(e instanceof Be){if(se)return!0;var h=e.expression;if(h instanceof _n&&S(h.definition()))return!0;if(n.option("unsafe")){if(Nt(h)&&It[h.name])return!1;if(si(h))return!1}return!be||!V&&(!(!l&&ke)&&(!e.optional&&h.may_throw_on_access(n)))}if(e instanceof Je)return!0;if(e instanceof _n){if(Xn(e,t))return!Ze(e,t);if(se&&nt(e))return!0;var _=e.definition();return(l||_.scope.resolve()!==p)&&!P(e)}if(e instanceof mn)return!e.is_expr_pure(n);if(e instanceof On)return!!ze(e.name)||(e.value||t instanceof De)&&e.name.match_symbol(function(e){return e instanceof fn&&(ye.has(e.name)||se&&nt(e))},!0);if(e instanceof Mn)return!0;var g=kt(e.left,e);return!!g&&(g instanceof Be||(!!ze(g)||g.match_symbol(function(e){return e instanceof _n&&(ye.has(e.name)||pe&&n.exposed(e.definition()))},!0)));function m(e){return e.transform(O),Me}}function on(e,t,i){if(t instanceof G)return e(t.value)||on(e,t.name,t.value)||!$t(i)&&on(e,t.name,i);if(!i)return!(t instanceof tn);if(t instanceof K){if(t.rest&&on(e,t.rest))return!0;if(t instanceof Q)return i instanceof s?!Wn(t.elements,function(n,t){return!on(e,n,i[t])}):!i.is_string(n)||!Wn(t.elements,function(n){return!on(e,n)});if(t instanceof Z)return!!i.may_throw_on_access(n)||!Wn(t.properties,function(n){return!(n.key instanceof Fe&&e(n.key))&&!on(e,n.value)})}}function sn(){if(!1!==c){var e=n.parent(),t=n.self();if(void 0===c){if(!(t instanceof Se)||Un(t)||t.uses_arguments||t.pinned()||!(e instanceof w)||e.expression!==t||!Wn(e.args,function(e){return!(e instanceof Je)}))return void(c=!1);if(!Pt(e))return;c=!0}var i,r=t.in_strict_mode(n)&&!t.parent_scope.resolve(!0).in_strict_mode(n);Ln(t)?(i=function(e){return e instanceof tn&&"await"==e.name},a=!0):(i=function(e){return e instanceof v&&!s.find_parent(Ve)},void 0===a&&(a=et(n,1,e,null,!0,!0)));for(var o=null,s=new jn(function(e,n){if(!h)return!0;if(i(e)||e instanceof Mn)return h=null,!0;if(e instanceof Ye)return!r&&o||(h=null),!0;var s;if(e instanceof _n)return(e.in_arg&&!zi(e.definition())||(s=t.variables.get(e.name))&&s!==e.definition())&&(h=null),!0;if(e instanceof Ve&&!Rn(e)){var a=o;return o=e,n(),o=a,!0}}),f=(d=e.args.slice()).length,u=new Jn,l=t.argnames.length;--l>=0;){var p=t.argnames[l],h=d[l],_=null;if(p instanceof G&&(_=p.value,p=p.name,d[f+l]=_),p instanceof K){if(a&&on(function(e){return e.has_side_effects(n)},p,h)){x.length=0;break}d[f+l]=t.argnames[l]}else if(!u.has(p.name)&&(u.set(p.name,!0),_&&(h=$t(h)?_:null),h||_?h instanceof Ee&&h.pinned()?h=null:h&&h.walk(s):h=at(An,p).transform(n),h)){var g=at(On,p,{name:p,value:h});g.name_index=l,g.arg_index=_?f+l:l,x.unshift([g])}}t.rest&&d.push(t.rest)}}function an(e,n){if(M.push(e),e instanceof s)e.elements.forEach(function(e){an(e,n)});else if(e instanceof f){var t=e.left;t instanceof K||x.push(M.slice()),an(t),an(e.right),t instanceof _n&&"="==e.operator&&_.set(t.name,(_.get(t.name)||0)+1)}else if(e instanceof v)an(e.expression,n);else if(e instanceof g){var i=Jt[e.operator];n&&i&&"??"!=e.operator&&e.right instanceof f&&"="==e.right.operator&&!(e.right.left instanceof K)&&x.push(M.slice()),an(e.left,!i&&n),an(e.right,n)}else if(e instanceof w)an(e.expression),e.args.forEach(an);else if(e instanceof E)an(e.expression);else if(e instanceof N)an(e.condition),an(e.consequent,n),an(e.alternative,n);else if(e instanceof W)e.definitions.forEach(an);else if(e instanceof te)an(e.expression);else if(e instanceof ie)an(e.condition),e.body instanceof m||an(e.body);else if(e instanceof oe)e.value&&an(e.value);else if(e instanceof de)e.init&&an(e.init,!0),e.condition&&an(e.condition),e.step&&an(e.step,!0),e.body instanceof m||an(e.body);else if(e instanceof he)an(e.object),e.body instanceof m||an(e.body);else if(e instanceof me)an(e.condition),e.body instanceof m||an(e.body),!e.alternative||e.alternative instanceof m||an(e.alternative);else if(e instanceof je)e.properties.forEach(function(e){M.push(e),e.key instanceof Fe&&an(e.key),e instanceof He&&an(e.value,n),M.pop()});else if(e instanceof We){var r=e.expressions.length-(n?0:1);e.expressions.forEach(function(e,n){an(e,n<r)})}else if(e instanceof $e)an(e.body,!0);else if(e instanceof Je)an(e.expression);else if(e instanceof Xe)an(e.expression),an(e.property);else if(e instanceof en)an(e.expression),e.body.forEach(an);else if(e instanceof Tn)bt[e.operator]?x.push(M.slice()):an(e.expression);else if(e instanceof On){if(e.name instanceof gn)if(e.value){var o=e.name.definition();o.references.length>o.replaced&&x.push(M.slice())}else T.set(e.name.name,(T.get(e.name.name)||0)+1);e.value&&an(e.value)}else e instanceof Mn&&e.expression&&an(e.expression);M.pop()}function un(e,n,t){var i;do{i=e,e=O.parent(++t)}while(e instanceof f&&e.operator.slice(0,-1)==n||e instanceof g&&e.operator==n);return i}function pn(e,n,t,i,r){var o=Ie;Ie=!1;var s=J,a=ee,f=O.stack;return O.stack=[i],e.transform(O),O.stack=f,ee=a,J=s,Ie=o,Me?(Me=!1,t):n(i,r+1)}function dn(e,n){var t=O.parent(n);if(rn(e,t))return e;if(nn(e,t))return e;if(t instanceof s)return dn(t,n+1);if(t instanceof f)return o(t.left);if(t instanceof v)return e;if(t instanceof g)return dn(t,n+1);if(t instanceof w)return dn(t,n+1);if(t instanceof E)return dn(t,n+1);if(t instanceof N)return dn(t,n+1);if(t instanceof W)return dn(t,n+1);if(t instanceof oe)return dn(t,n+1);if(t instanceof me)return dn(t,n+1);if(t instanceof xe)return e;if(t instanceof Ne){var i=O.parent(n+1);return Wn(i.properties,function(e){return e instanceof He})?dn(i,n+2):i}if(t instanceof Be){var r=t.expression;return r===e?dn(t,n+1):pn(r,dn,e,t,n)}return t instanceof We?dn(t,n+1):t instanceof $e?dn(t,n+1):t instanceof Je?e:t instanceof en?dn(t,n+1):t instanceof Tn?dn(t,n+1):t instanceof On?o(t.name):t instanceof Mn?e:null;function o(i){return le(t)?e:i!==e&&i instanceof K?pn(i,dn,e,t,n):dn(t,n+1)}}function hn(e){if(h)h=!1;else if(!(C<1)){var t=(e=e.tail_node())instanceof f&&"="==e.operator?e.left:e;if(t instanceof _n){var i=t.definition();if(!i.undeclared&&!S(i)){if(t!==e){if(st(t,n))return;if(i.references.length-i.replaced<2)return;var r=H.clone();r[r instanceof f?"right":"value"]=t,H.name_index>=0&&(r.name_index=H.name_index,r.arg_index=H.arg_index),H=r}return V=i}}}}function vn(e){return e.references.length-e.replaced-(_.get(e.name)||0)}function bn(e){if(e instanceof f){if(!((r=e.left)instanceof _n))return r;var t=r.definition();if(p.uses_arguments&&wt(t))return r;if(n.exposed(t))return r;if(C=vn(t),t.fixed&&r.fixed){var i=t.references.filter(function(e){return e.fixed===r.fixed}).length-1;i<C&&(C=i,Y=0,R=!0)}return"="==e.operator&&hn(e.right),r}if(e instanceof g)return e.right.left;if(e instanceof Tn)return e.expression;if(e instanceof On){var r;if((t=(r=e.name).definition()).const_redefs)return;if(!it(r,t.orig))return;if(p.uses_arguments&&wt(t))return;var o=t.orig.length-t.eliminated-(T.get(t.name)||0);return C=vn(t),t.fixed&&(C=Math.min(C,t.references.filter(function(n){if(!n.fixed)return!0;if(!n.fixed.assigns)return!0;var t=n.fixed.assigns[0];return t===r||yn(t)===e.value}).length)),o>1&&!(r instanceof ln)?(hn(e.value),at(_n,r)):hn(e.value)||1==C&&!n.exposed(t)?at(_n,r):void 0}}function yn(e){if(e instanceof f)return e.right;if(e instanceof g){var n=e.clone();return n.right=e.right.right,n}return e instanceof On?e.value:void 0}function wn(e){if(!(e instanceof f&&e.right.single_use)){for(var t,i=Object.create(null),r=new jn(function(e){e instanceof _n&&(i[e.definition().id]=!0)});e instanceof f&&"="==e.operator;)e.left.walk(r),e=e.right;if(e instanceof Ye)return c;if(e instanceof _n){var o=e.evaluate(n);return o===e?c:zn(o,c)}if(e.is_truthy())return zn(!0,ct);if(e.is_constant()){var a=e.evaluate(n);if(!(a instanceof Fe))return zn(a,c)}return re instanceof _n&&(!!function e(t){return!(t instanceof s)&&(t instanceof g&&Jt[t.operator]?e(t.left)&&e(t.right):!(t instanceof w)&&(t instanceof N?e(t.consequent)&&e(t.alternative):!(t instanceof je||t.has_side_effects(n))))}(e)&&(e.walk(new jn(function(e){if(t)return!0;e instanceof _n&&i[e.definition().id]&&(t=!0)})),!t&&c))}function c(n){return e.equals(n)}}function zn(e,t){return function(i,r){if(r.in_boolean_context()){if(e&&i.is_truthy()&&!i.has_side_effects(n))return!0;if(i.is_constant()){var o=i.evaluate(n);if(!(o instanceof Fe))return!o==!e}}return t(i)}}function Hn(e){for(;e.write_only&&(e.write_only=!1,e instanceof f);)e=e.right}function Pn(e,n){var t=n.scope||Qn(O)||i;e.walk(new jn(function(e){if(e instanceof b)return!0;e instanceof tn&&(e.scope=t)}))}function Nn(e){var i=new Jn;e instanceof On&&(e.name.definition().fixed||(be=!1),i.add(e.name.name,re));var r=p.uses_arguments&&!n.has_directive("use strict"),o=p instanceof kn,s=new jn(function(a){var c;if(a instanceof _n){if(!(c=a.fixed_value())){c=a;var u=a.definition(),l=a.fixed&&a.fixed.escaped||u.escaped;u.undeclared||!u.assignments&&l&&!l.cross_scope||!L(u,a.scope,a,s.parent())&&Xi(u)||(be=!1)}}else a instanceof Ye&&(c=a);if(c)i.add(a.name,t(n,s,a,c,0));else{if(a instanceof Ee){for(var d,h=0,v=a;d=s.parent(h++);v=d){if(d instanceof f){if(d.left===v)break;if("="==d.operator)continue;if(Jt[d.operator.slice(0,-1)])continue;break}if(d instanceof g){if(Jt[d.operator])continue;break}if(d instanceof w)return;if(d instanceof Ve)return;if(d instanceof We){if(d.tail_node()===v)continue;break}if(d instanceof mn){if(d.tag)return;break}}return a.enclosed.forEach(function(e){e.scope!==a&&ge.set(e.name,!0)}),!0}r&&a instanceof Xe&&(p.each_argname(function(e){n.option("reduce_vars")&&!e.definition().assignments||(e.definition().fixed||(be=!1),i.add(e.name,!0))}),r=!1)}if(o)if("Call"==a.TYPE){if(ve)return;var _=a.expression;if(_ instanceof Be)return;if(_ instanceof Se&&!_.contains_this())return;ve=!0}else a instanceof Be&&function e(n){return n instanceof _n&&!(n=n.fixed_value())||(n instanceof f?"="==n.operator&&e(n.right):n instanceof Be||n instanceof Ye)}(a.expression)&&(a!==re||e instanceof Tn?pe=!0:ve=!0)});return e.walk(s),i}function Yn(t){var i=Te===we?null:dt(we,we.expressions.slice(0,-1)),r=t.name_index;if(r>=0){var o,s=p.argnames[r];s instanceof G?(p.argnames[r]=s=s.clone(),s.value=i||at(Ce,s,{value:0})):(o=n.parent().args)[r]&&(p.argnames[r]=s.clone(),o[r]=i||at(Ce,o[r],{value:0}))}else{var a=M.length-1,f=M[a];(f instanceof On||M[a-1].body===f)&&a--;var c=new Cn(function(e,n,t){if(qe)return e;if(e!==M[j])return e;if(++j<=a)return Qe(e,c);if(qe=!0,e instanceof W){T.set(f.name.name,(T.get(f.name.name)||0)+1),V&&V.replaced++;var r=e.definitions,o=r.indexOf(f),s=f.clone();if(s.value=null,!i)return e.definitions[o]=s,e;var u=[at($e,i,{body:i})];if(o>0){var l=e.clone();l.definitions=r.slice(0,o),u.unshift(l),(e=e.clone()).definitions=r.slice(o)}return u.push(e),e.definitions[0]=s,t?Zn.splice(u):at(y,e,{body:u})}return i?Bn(e)?at($e,i,{body:i}):i:t?Zn.skip:null},function(e,n){return e instanceof de?Gt(e,n):Gn(e,c)});Me=!1,qe=!1,j=0,(e[A]=e[A].transform(c))||e.splice(A,1)}}function Gn(e,n){if(e instanceof We)switch(e.expressions.length){case 0:return null;case 1:return Dt(n.parent(),e,e.expressions[0])}}function Vn(e){var n=In(e);if(!(n instanceof _n))return!1;if(n.definition().scope.resolve()!==p)return!1;if(!u)return!0;if(ce)return!1;if(H instanceof Tn)return!1;var t=ye.get(n.name);return!t||t[0]===e}function $n(){return!(H instanceof Tn)&&Te.has_side_effects(n)}function Kn(e){if(e instanceof Tn)return!1;if(se)return!1;if(V)return!0;if(!(re instanceof _n))return!1;var n;if(e instanceof On)n=1;else{if("="!=e.operator)return!1;n=2}var t=re.definition();if(t.references.length-t.replaced==n)return!0;if(!t.fixed)return!1;if(!re.fixed)return!1;var i=re.fixed.assigns,r=0;return!!Wn(t.references,function(e,n){var t=e.fixed;return!!t&&(!t.to_binary&&!t.to_prefix&&(t===re.fixed?(r++,!0):i&&t.assigns&&i[0]!==t.assigns[0]))})&&(r==n&&(R=!0,!0))}function Xn(e,n){var t=ye.get(e.name);if(t&&!Wn(t,function(e){return!e}))return t[0]!==re||void(fe=!1)}function nt(e){var t=e.definition();return!(1==t.orig.length&&t.orig[0]instanceof cn)&&(t.scope.resolve()!==p||(!(!ve||!n.exposed(t))||!Wn(t.references,function(e){return e.scope.resolve(!0)===p})))}function tt(e,n){if(e instanceof f)return tt(e.left,!0);if(e instanceof Tn)return tt(e.expression,!0);if(e instanceof On)return e.value&&tt(e.value);if(n){if(e instanceof te)return tt(e.expression,!0);if(e instanceof Xe)return tt(e.expression,!0);if(e instanceof _n)return e.definition().scope.resolve()!==p}return!1}}function F(e){for(var n=!1,t=[],i=0;i<e.length;){var r=e[i];if(r instanceof y&&Wn(r.body,qt))n=!0,F(r.body),[].splice.apply(e,[i,1].concat(r.body)),i+=r.body.length;else{if(r instanceof ee){if(it(r.value,t)){n=!0,e.splice(i,1);continue}t.push(r.value)}r instanceof re?(n=!0,e.splice(i,1)):i++}}return n}function M(e,n){for(var t,i,r,o=!1,s=n.parent(),a=n.self(),f=d&&s&&"Call"==s.TYPE&&s.expression===a,c=d&&n.option("conditionals")&&n.option("sequences"),u=!(l&&l.bfinally&&$n(p)),h=function(e){for(var n=0,t=e.length;--t>=0;){var i=e[t];if(i instanceof me&&i.body instanceof Ge&&++n>1)return!0}return!1}(e),v=e.length;--v>=0;){var _=e[v],g=G(v),b=e[g];if(d&&t&&!b&&_ instanceof Ge&&u&&!(a instanceof nn)){if(!(S=_.value)){o=!0,e.splice(v,1);continue}var x=S.tail_node();if($t(x)){o=!0,S instanceof Dn?S=S.expression:x instanceof Dn&&((S=S.clone()).expressions[S.expressions.length-1]=x.expression),e[v]=at($e,_,{body:S});continue}}if(_ instanceof me){var w=ci(_.body);if(P(w)){w.label&&ft(w.label.thedef.references,w),o=!0,(_=_.clone()).body=at(y,_,{body:B(_.body,w)}),_.alternative=at(y,_,{body:Ft(_.alternative).concat(I(r,i))}),L(w.value,r),e[v]=_,e[v]=_.transform(n);continue}if(w&&!_.alternative&&b instanceof ke){var E=_.condition,T=v+1==g&&_.body instanceof y;if((E=Kt(E,E.negate(n),T))!==_.condition){o=!0,(_=_.clone()).condition=E;var S=_.body;_.body=at(y,b,{body:I(!0,null,g+1)}),e.splice(v,1,_,S),(!d||a instanceof m&&a.body===e)&&(e[v]=_.transform(n));continue}}var D=ci(_.alternative);if(P(D)){D.label&&ft(D.label.thedef.references,D),o=!0,(_=_.clone()).body=at(y,_.body,{body:Ft(_.body).concat(I(r,i))}),_.alternative=at(y,_.alternative,{body:B(_.alternative,D)}),L(D.value,r),e[v]=_,e[v]=_.transform(n);continue}if(n.option("typeofs")){if(w&&!D){var z=at(y,a,{body:e.slice(v+1)});Ti(_.condition,null,z)}if(!w&&D){z=at(y,a,{body:e.slice(v+1)});Ti(_.condition,z)}}}if(_ instanceof me&&_.body instanceof Ge){var O,q,F=_.body.value,M=_.body.in_bool||b instanceof Ge&&b.in_bool;if(!_.alternative&&b instanceof Ge&&(u||!F==!b.value)){o=!0,(_=_.clone()).alternative=at(y,b,{body:I(!0,null,g+1)}),e[v]=_,e[v]=_.transform(n);continue}if(d&&t&&!b&&!_.alternative&&(M||F&&h||F instanceof N&&($t(F.consequent,n)||$t(F.alternative,n)))){o=!0,(_=_.clone()).alternative=at(Ge,_,{value:null}),e[v]=_,e[v]=_.transform(n);continue}if(c&&!_.alternative&&(!(q=e[O=W(v)])&&f||q instanceof me&&q.body instanceof Ge)&&(b?b instanceof $e&&G(g)==e.length:!t)){o=!0;var C=[];_=_.clone(),C.push(_.condition),_.condition=dt(_,C),_.alternative=at(y,a,{body:I().concat(at(Ge,a,{value:null}))}),e[v]=_.transform(n),v=O+1;continue}}_ instanceof k||_ instanceof oe?i=_:t&&i&&i===b&&$(_)}return o;function j(e){return A(n,function(n){return n===e})}function H(e,n){if(!i)return!1;if(i.TYPE!=e.TYPE)return!1;var t=e.value;if(!t)return!1;var r=i.equals(e);return!r&&t instanceof We&&(t=t.tail_node(),i.value&&i.value.equals(t)&&(r=2)),!r&&!n&&i.value instanceof We&&i.value.tail_node().equals(t)&&(r=3),r}function P(t){if(r=!1,!function(e){if(e instanceof oe){if(r=H(e))return!0;if(!d)return!1;if(!(e instanceof Ge))return!1;var t=e.value;return!(t&&!$t(t.tail_node())||a instanceof nn&&(!i||i instanceof oe&&i.value||(r=4,0)))}if(!(e instanceof Ae))return!1;if(a instanceof nn)if(i instanceof oe){if(!d)return!1;if(i.value)return!1;r=!0}else if(i){if(n.loopcontrol_target(i)!==s)return!1;r=!0}else if(!1===i)return!1;var o=n.loopcontrol_target(e);return e instanceof R?j(jt(o)):!(o instanceof xe)&&j(o)}(t))return!1;for(var o=e.length;--o>v;){var f=e[o];if(f instanceof V){if(f.name.definition().preinit)return!1}else if((f instanceof Y||f instanceof De)&&!Wn(f.definitions,function(e){return!e.name.match_symbol(function(e){return e instanceof fn&&e.definition().preinit})}))return!1}return!0}function I(n,t,r){var o=[],s=!1,a=v+1;n?t?r=e.lastIndexOf(t):(t=e[r])!==i&&(i=!1):(r=e.length,i=null);var f=e.splice(a,r-a).filter(function(e){return e instanceof Te?(o.push(e),!1):(Ot(e)&&(s=!0),!0)});return 3===n&&(f.push(at($e,t.value,{body:dt(t.value,t.value.expressions.slice(0,-1))})),t.value=t.value.tail_node()),[].push.apply(s?f:e,o),f}function U(e,n){if(e)switch(n){case 4:return e;case 3:if(!(e instanceof We))break;case 2:return dt(e,e.expressions.slice(0,-1))}}function B(e,n){for(var t,i=Ft(e),o=i;(t=o[o.length-1])!==n;)o=t.body;o.pop();var s=n.value;return r&&(s=U(s,r)),s&&o.push(at($e,s,{body:s})),i}function L(e,n){if(n&&e){switch(n){case 4:return;case 3:case 2:e=e.tail_node()}At(e,i.value)}}function G(n){t=!0;for(var i=n;++i<e.length;){var r=e[i];if(!Bt(r)){if(!(r instanceof zn))break;t=!1}}return i}function W(n){for(var t=n;--t>=0;){var i=e[t];if(!(i instanceof zn)&&!Bt(i))break}return t}function $(e,n,t){if(e instanceof oe){var r=!(n&&e instanceof xn)&&H(e,!0);if(r){o=!0;var s=U(e.value,r);return s?at($e,s,{body:s}):t?null:at(re,e)}}else if(e instanceof me)e.body=$(e.body,n),e.alternative&&(e.alternative=$(e.alternative,n));else if(e instanceof we)e.body=$(e.body,n);else if(e instanceof En){if(!e.bfinally||!i.value||i.value.is_constant())e.bcatch&&$(e.bcatch,n),(a=$(e.body.pop(),!0,!0))&&e.body.push(a)}else if(e instanceof m&&!(e instanceof Ve||e instanceof en)){var a;(a=$(e.body.pop(),n,!0))&&e.body.push(a)}return e}}function C(e,n){var t,i=n.self();i instanceof T?i=n.parent():i instanceof we&&(i=i.body);for(var r=0,o=0,s=e.length;r<s;r++){var a=e[r];if(a instanceof Ae){var f=n.loopcontrol_target(a);jt(f)!==i||a instanceof k&&f instanceof xe?e[o++]=a:a.label&&ft(a.label.thedef.references,a)}else e[o++]=a;if(ci(a)){t=e.slice(r+1);break}}return e.length=o,t&&t.forEach(function(t){Wt(n,t,e)}),e.length!=s}function j(e,n){if(!(!d||l&&l.bfinally)){for(var t=!1,i=e.length;--i>=0;){var r=e[i];if(!(r instanceof $e))break;var o=r.body;if(!(o instanceof v))break;var s=o.expression;if(!Wi(n,s))break;if(t=!0,s=s.drop_side_effect_free(n,!0)){r.body=s;break}}return e.length=i+1,t}}function H(e,n){var t=!1,r=e.length-1;if(d&&r>=0){var o=l&&l.bfinally&&$n(p);(a=e[r].try_inline(n,i,o))&&(e[r--]=a,t=!0)}for(var s=u&&l&&l.bfinally?"try":u;r>=0;r--){var a;(a=e[r].try_inline(n,i,!0,s))&&(e[r]=a,t=!0)}return t}function I(e,n){if(!(e.length<2)){for(var t=[],i=0,r=0,o=e.length;r<o;r++){var s=e[r];s instanceof $e?(t.length>=n.sequences_limit&&a(),zt(t,s.body)):Bt(s)?e[i++]=s:(a(),e[i++]=s)}return a(),e.length=i,i!=o}function a(){if(t.length){var n=dt(t[0],t);e[i++]=at($e,n,{body:n}),t=[]}}}function J(e,n){if(!(e instanceof y))return e;for(var t=null,i=0;i<e.body.length;i++){var r=e.body[i];if(r instanceof zn&&Ut(r))n.push(r);else{if(t||Ot(r))return!1;t=r}}return t}function se(e,n){for(var t,i=!1,r=0,o=0;o<e.length;o++){var s=e[o];if(t)if(s instanceof oe)!s.value&&$n(p)||(s.value=d(s.value||at(An,s)).optimize(n));else if(s instanceof de){if(!(s.init instanceof W)){var a=!1;t.body.walk(new jn(function(e){return!!(a||e instanceof Ve)||(e instanceof g&&"in"==e.operator?(a=!0,!0):void 0)})),a||(s.init?s.init=d(s.init):(s.init=t.body,r--,i=!0))}}else s instanceof ve?Ot(s.init)||(s.object=d(s.object)):s instanceof me?s.condition=d(s.condition):s instanceof en?s.expression=d(s.expression):s instanceof Fn&&(s.expression=d(s.expression));if(n.option("conditionals")&&s instanceof me){var f=[],c=J(s.body,f),u=J(s.alternative,f);if(!1!==c&&!1!==u&&f.length>0){var l=f.length;f.push(at(me,s,{condition:s.condition,body:c||at(re,s.body),alternative:u})),f.unshift(r,1),[].splice.apply(e,f),o+=l,r+=l+1,t=null,i=!0;continue}}e[r++]=s,t=s instanceof $e?s:null}return e.length=r,i;function d(e){r--,i=!0;var n=t.body;return dt(n,[n,e])}}function ae(e){return e instanceof f?[e]:e instanceof We?e.expressions.slice():void 0}function ce(e,n,t){var i=ae(n);if(i){t=t||0;for(var r=!1,o=i.length-t;--o>=0;){var s=i[o];if(l(s)){var a;if(s.left instanceof _n)a=i.slice(o+1);else{if(!(s.left instanceof Be&&l(s.left.expression)))continue;a=i.slice(o+1);var c=s.clone();s=s.left.expression,c.left=c.left.clone(),c.left.expression=s.left.clone(),a.unshift(c)}0!=a.length&&be(s.left,s.right,a)&&(r=!0,i=i.slice(0,o).concat(s,a))}}if(e instanceof W){for(o=e.definitions.length;--o>=0;){var u=e.definitions[o];if(u.value){be(u.name,u.value,i)&&(r=!0),le(u,i,t)&&(r=!0);break}}e instanceof zn&&ge(e.definitions,i,t)&&(r=!0)}return r&&i}function l(e){return e instanceof f&&"="==e.operator}}function ue(e,n){if(e instanceof $e&&!Ut(n)){var t=ae(e.body);if(t){var i=[];if(ge(i,t.reverse(),0))return n.definitions=i.reverse().concat(n.definitions),t.reverse()}}}function le(e,t,i){if(n.option("conditionals")&&!(e.name instanceof K)){for(var r=!1,o=e.name.definition();t.length>i;){var s=Ii(n,o,e.value,t[0]);if(!s)break;e.value=s,t.shift(),r=!0}return r}}function ge(e,n,t){for(var i=!1;n.length>t;){var r=n[0];if(!(r instanceof f))break;if("="!=r.operator)break;var o=r.left;if(!(o instanceof _n))break;if(Nt(o))break;if(o.scope.resolve()!==p)break;var s=o.definition();if(s.scope!==p)break;if(s.orig.length>s.eliminated+1)break;if("SymbolVar"!=s.orig[0].TYPE)break;var a=at(gn,o);e.push(at(On,r,{name:a,value:r.right})),s.orig.push(a),s.replaced++,n.shift(),i=!0}return i}function be(e,t,i){var r=new Jn;for(r.set(e.name,!0);t instanceof f&&"="==t.operator;)t.left instanceof _n&&r.set(t.left.name,!0),t=t.right;if(t instanceof je){var o=!1;do{if(!s(i[0]))break;i.shift(),o=!0}while(i.length);return o}function s(e){if(e instanceof f&&"="==e.operator&&e.left instanceof Be){var i=e.left.expression;if(i instanceof _n&&r.has(i.name)&&e.right.is_constant_expression(p)){var o=e.left.property;if(o instanceof Fe&&(s(o)&&(o=e.left.property=o.right.clone()),o=o.evaluate(n)),!(o instanceof Fe)){var a="__proto__"==(o=""+o)||n.has_directive("use strict")?function(e){var n=e.key;return"string"==typeof n&&n!=o&&"__proto__"!=n}:function(e){var n=e.key;return e instanceof Pe||e instanceof Re?"string"==typeof n&&n!=o:"__proto__"!==n};if(Wn(t.properties,a))return t.properties.push(at(He,e,{key:o,value:e.right})),!0}}}}}function ye(e){for(var n,t=!1,i=0,r=-1;i<e.length;i++){var o=e[i],s=e[r];if(o instanceof W)if(s&&s.TYPE==o.TYPE)s.definitions=s.definitions.concat(o.definitions),t=!0;else if(n&&n.TYPE==o.TYPE&&Ut(o))n.definitions=n.definitions.concat(o.definitions),t=!0;else if(o instanceof zn){(f=ue(s,o))?(f.length&&(s.body=dt(s,f),r++),t=!0):r++,e[r]=n=o}else e[++r]=o;else{if(o instanceof oe)o.value=u(o.value);else if(o instanceof de){if(f=ce(s,o.init))t=!0,o.init=f.length?dt(o.init,f):null;else{if(s instanceof zn&&(!o.init||o.init.TYPE==s.TYPE)){o.init&&(s.definitions=s.definitions.concat(o.init.definitions)),o=o.clone(),n=o.init=s,e[r]=l(o),t=!0;continue}if(n&&o.init&&n.TYPE==o.init.TYPE&&Ut(o.init))n.definitions=n.definitions.concat(o.init.definitions),o.init=null,t=!0;else if(o.init instanceof zn&&(n=o.init,f=ue(s,o.init))){if(t=!0,0==f.length){e[r]=l(o);continue}s.body=dt(s,f)}}}else if(o instanceof he){if(n&&n.TYPE==o.init.TYPE){var a=n.definitions.slice();o.init=o.init.definitions[0].name.convert_symbol(_n,function(e,n){a.push(at(On,n,{name:n,value:null})),n.definition().references.push(e)}),n.definitions=a,t=!0}o.object=u(o.object)}else if(o instanceof me)o.condition=u(o.condition);else if(o instanceof $e){var f,c;if(f=ce(s,o.body)){if(t=!0,!f.length)continue;o.body=dt(o.body,f)}else if(s instanceof W&&(c=e[i+1])&&s.TYPE==c.TYPE&&(c=c.definitions[0]).value){t=!0,c.value=dt(o,[o.body,c.value]);continue}}else o instanceof en?o.expression=u(o.expression):o instanceof Fn&&(o.expression=u(o.expression));e[++r]=n?l(o):o}}return e.length=r+1,t;function u(e){var n=ce(s,e,1);if(!n)return e;t=!0;var i=e.tail_node();return n[n.length-1]!==i&&n.push(i.left),dt(e,n)}function l(e){return e.transform(new Cn(function(e,i,r){if(e instanceof W){if(n===e)return e;if(n.TYPE!=e.TYPE)return e;var o=this.parent();return o instanceof he&&o.init===e?e:Ut(e)?(n.definitions=n.definitions.concat(e.definitions),t=!0,o instanceof de&&o.init===e?null:r?Zn.skip:at(re,e)):e}return e instanceof fe?e:e instanceof Ve?e:Bn(e)?void 0:e}))}}}function Wt(e,n,t){var i,r=!1;function o(e){i?(i.push(e),qt(e)||(i.required=!0)):t.push(e)}n.walk(new jn(function(s,a){if(s instanceof V)return s.extends=null,s.properties=[],o(s),!0;if(s instanceof W){var f=[];return s.remove_initializers(e,f)&&Fe.warn("Dropping initialization in unreachable code [{start}]",s),f.length>0&&(s.definitions=f,o(s)),!0}if(s instanceof Te)return o(s),!0;if(s instanceof Ve)return!0;if(s instanceof b){var c=i;return i=[],a(),i.required?t.push(at(y,n,{body:i})):i.length&&[].push.apply(t,i),i=c,!0}s instanceof Ae||(r=!0)})),r&&Fe.warn("Dropping unreachable code [{start}]",n)}function $t(e,n){return null==e||e.is_undefined||e instanceof An||e instanceof Dn&&"void"==e.operator&&!(n&&e.expression.has_side_effects(n))}_n.DEFMETHOD("is_declared",function(e){return this.defined||!this.definition().undeclared||e.option("unsafe")&&It[this.name]}),(Yt=function(e,n){e.DEFMETHOD("in_strict_mode",n)})(D,lt),Yt(Ve,function(e){for(var n=this.body,t=0;t<n.length;t++){var i=n[t];if(!(i instanceof ee))break;if("use strict"==i.value)return!0}var r=this.parent_scope;return r?r.resolve(!0).in_strict_mode(e):e.option("module")}),function(e){e(Fe,ct),e(s,lt),e(f,function(){return"="==this.operator&&this.right.is_truthy()}),e(Ee,lt),e(je,lt),e(Le,lt),e(We,function(){return this.tail_node().is_truthy()}),e(_n,function(){var e=this.fixed_value();if(!e)return!1;this.is_truthy=ct;var n=e.is_truthy();return delete this.is_truthy,n})}(function(e,n){e.DEFMETHOD("is_truthy",n)}),function(e){function n(e,n,t){switch(e){case"-":return n.is_negative_zero()&&(!(t instanceof I)||0==t.value);case"&&":case"||":return n.is_negative_zero()||t.is_negative_zero();case"*":case"/":case"%":case"**":return!0;default:return!1}}e(Fe,lt),e(s,ct),e(f,function(){var e=this.operator;return"="==e?this.right.is_negative_zero():n(e.slice(0,-1),this.left,this.right)}),e(g,function(){return n(this.operator,this.left,this.right)}),e(I,function(){return 0==this.value&&1/this.value<0}),e(Ee,ct),e(je,ct),e(Le,ct),e(We,function(){return this.tail_node().is_negative_zero()}),e(_n,function(){var e=this.fixed_value();if(!e)return!0;this.is_negative_zero=lt;var n=e.is_negative_zero();return delete this.is_negative_zero,n}),e(Dn,function(){return"+"==this.operator&&this.expression.is_negative_zero()||"-"==this.operator})}(function(e,n){e.DEFMETHOD("is_negative_zero",n)}),function(e){function n(e,n){return n||/strict/.test(e.option("pure_getters"))}Fe.DEFMETHOD("may_throw_on_access",function(e,n){return!e.option("pure_getters")||this._dot_throw(e,n)}),e(Fe,n),e(s,ct),e(f,function(e){var n=this.operator,t=this.left,i=this.right;return"="!=n?Jt[n.slice(0,-1)]&&(t._dot_throw(e)||i._dot_throw(e)):!!i._dot_throw(e)&&(!(t instanceof _n)||(!(i instanceof g&&"||"==i.operator&&t.name==i.left.name)||i.right._dot_throw(e)))}),e(g,function(e){return Jt[this.operator]&&(this.left._dot_throw(e)||this.right._dot_throw(e))}),e(D,function(e,t){return n(e,t)&&!Wn(this.properties,function(e){return!!e.private||(!e.static||!(e instanceof O||e instanceof j))})}),e(N,function(e){return this.consequent._dot_throw(e)||this.alternative._dot_throw(e)}),e(I,ct),e(te,function(e,t){if(!n(e,t))return!1;var r=this.expression;return r instanceof _n&&(r=r.fixed_value()),!("prototype"==this.property&&i(r))}),e(Ee,ct),e(Me,lt),e(je,function(e,t){return n(e,t)&&!Wn(this.properties,function(n){return!(n instanceof Pe||n instanceof Re)&&!("__proto__"===n.key&&n.value._dot_throw(e,t))})}),e(Ye,function(e,t){return n(e,t)&&!this.scope.resolve().new}),e(We,function(e){return this.tail_node()._dot_throw(e)}),e(_n,function(e,t){if(this.is_undefined)return!0;if(!n(e,t))return!1;if(Nt(this)&&this.is_declared(e))return!1;if(this.is_immutable())return!1;var i=this.definition();if(S(i)&&!i.scope.rest&&Wn(i.scope.argnames,function(e){return e instanceof ln}))return i.scope.uses_arguments>2;var r=this.fixed_value(!0);return!r||(this._dot_throw=lt,r._dot_throw(e)?(delete this._dot_throw,!0):(this._dot_throw=ct,!1))}),e(Dn,function(){return"void"==this.operator}),e(Sn,ct),e(An,lt)}(function(e,n){e.DEFMETHOD("_dot_throw",n)}),function(e){function n(e,n,t){switch(n){case"&&":return t.left.is_defined(e)&&t.right.is_defined(e);case"||":return t.left.is_truthy()||t.right.is_defined(e);case"??":return t.left.is_defined(e)||t.right.is_defined(e);default:return!0}}e(Fe,ct),e(s,lt),e(f,function(e){var t=this.operator;return"="==t?this.right.is_defined(e):n(e,t.slice(0,-1),this)}),e(g,function(e){return n(e,this.operator,this)}),e(N,function(e){return this.consequent.is_defined(e)&&this.alternative.is_defined(e)}),e(I,lt),e(ge,ct),e(Ee,lt),e(je,lt),e(We,function(e){return this.tail_node().is_defined(e)}),e(_n,function(e){if(this.is_undefined)return!1;if(Nt(this)&&this.is_declared(e))return!0;if(this.is_immutable())return!0;var n=this.fixed_value();if(!n)return!1;this.is_defined=ct;var t=n.is_defined(e);return delete this.is_defined,t}),e(Dn,function(){return"void"!=this.operator}),e(Sn,lt),e(An,ct)}(function(e,n){e.DEFMETHOD("is_defined",n)}),function(e){e(Fe,ct),e(f,function(e){return"="==this.operator&&this.right.is_boolean(e)});var n=nt("in instanceof == != === !== < <= >= >");e(g,function(e){return n[this.operator]||Jt[this.operator]&&this.left.is_boolean(e)&&this.right.is_boolean(e)}),e(x,lt);var t=nt("every hasOwnProperty isPrototypeOf propertyIsEnumerable some");e(w,function(e){if(!e.option("unsafe"))return!1;var n=this.expression;return n instanceof te&&(t[n.property]||"test"==n.property&&n.expression instanceof Le)}),e(N,function(e){return this.consequent.is_boolean(e)&&this.alternative.is_boolean(e)}),e(Oe,ct),e(We,function(e){return this.tail_node().is_boolean(e)}),e(_n,function(e){var n=this.fixed_value();if(!n)return!1;this.is_boolean=ct;var t=n.is_boolean(e);return delete this.is_boolean,t});var i=nt("! delete");e(Dn,function(){return i[this.operator]})}(function(e,n){e.DEFMETHOD("is_boolean",n)}),function(e){e(Fe,ct);var n=nt("- * / % ** & | ^ << >> >>>");e(f,function(e){return n[this.operator.slice(0,-1)]||"="==this.operator&&this.right.is_number(e)}),e(g,function(e){return!!n[this.operator]||"+"==this.operator&&((this.left.is_boolean(e)||this.left.is_number(e))&&(this.right.is_boolean(e)||this.right.is_number(e)))});var t=nt(["charCodeAt","getDate","getDay","getFullYear","getHours","getMilliseconds","getMinutes","getMonth","getSeconds","getTime","getTimezoneOffset","getUTCDate","getUTCDay","getUTCFullYear","getUTCHours","getUTCMilliseconds","getUTCMinutes","getUTCMonth","getUTCSeconds","getYear","indexOf","lastIndexOf","localeCompare","push","search","setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear"]);e(w,function(e){if(!e.option("unsafe"))return!1;var n=this.expression;return n instanceof te&&(t[n.property]||Nt(n.expression)&&"Math"==n.expression.name)}),e(N,function(e){return this.consequent.is_number(e)&&this.alternative.is_number(e)}),e(Oe,ct),e(Ce,lt),e(We,function(e){return this.tail_node().is_number(e)}),e(_n,function(e,n){var t=this.fixed_value();if(!t)return!1;if(n&&t instanceof Dn&&"+"==t.operator&&t.expression.equals(this))return!1;this.is_number=ct;var i=t.is_number(e);return delete this.is_number,i});var i=nt("+ - ~ ++ --");e(Tn,function(){return i[this.operator]})}(function(e,n){e.DEFMETHOD("is_number",n)}),function(e){e(Fe,ct),e(f,function(e){switch(this.operator){case"+=":if(this.left.is_string(e))return!0;case"=":return this.right.is_string(e)}}),e(g,function(e){return"+"==this.operator&&(this.left.is_string(e)||this.right.is_string(e))});var n=nt(["charAt","substr","substring","toExponential","toFixed","toLowerCase","toPrecision","toString","toUpperCase","trim"]);e(w,function(e){if(!e.option("unsafe"))return!1;var t=this.expression;return t instanceof te&&n[t.property]}),e(N,function(e){return this.consequent.is_string(e)&&this.alternative.is_string(e)}),e(We,function(e){return this.tail_node().is_string(e)}),e(Qe,lt),e(_n,function(e){var n=this.fixed_value();if(!n)return!1;this.is_string=ct;var t=n.is_string(e);return delete this.is_string,t}),e(mn,function(e){return!this.tag||Zi(e,this.tag)}),e(Dn,function(){return"typeof"==this.operator})}(function(e,n){e.DEFMETHOD("is_string",n)});var Jt=nt("&& || ??");function Kt(e,n,t){return n.print_to_string().length-e.print_to_string().length<(t||0)?n:e}function Qt(e,n,t){return Kt(at($e,e,{body:e}),at($e,n,{body:n}),t).body}function Xt(e,n,t,i){return(Yn(e)?Qt:Kt)(n,t,i)}function Zt(e){var n=Object.create(null);return Object.keys(e).forEach(function(t){n[t]=nt(e[t])}),n}function ei(e){for(var n=0;n<e.length;n++){var t=e[n];if(!(t instanceof ee))return t}}function ni(){return this.value?at(Ge,this.value,{value:this.value}):ei(this.body)}function ti(e,n){var t=n.evaluate(e);return t===n?n:Xt(e,n,t=xt(t,n).optimize(e),e.eval_threshold)}!function(e){function n(e){Fe.warn("global_defs {this} redefined [{start}]",e)}kn.DEFMETHOD("resolve_defines",function(e){return e.option("global_defs")?(this.figure_out_scope({ie:e.option("ie")}),this.transform(new Cn(function(t){var i=t._find_defs(e,"");if(i){for(var r,o=0,s=t;(r=this.parent(o++))&&r instanceof Be&&r.expression===s;)s=r;if(!kt(s,r))return i;n(t)}}))):this}),e(Fe,rt),e(te,function(e,n){return this.expression._find_defs(e,"."+this.property+n)}),e(fn,function(e){this.definition().global&&Xn(e.option("global_defs"),this.name)&&n(this)}),e(_n,function(e,n){if(this.definition().global){var t=e.option("global_defs"),i=this.name+n;return Xn(t,i)?function e(n,t){if(n instanceof Fe)return n.clone(!0);if(Array.isArray(n))return at(s,t,{elements:n.map(function(n){return e(n,t)})});if(n&&"object"==typeof n){var i=[];for(var r in n)Xn(n,r)&&i.push(at(He,t,{key:r,value:e(n[r],t)}));return at(je,t,{properties:i})}return xt(n,t)}(t[i],this):void 0}})}(function(e,n){e.DEFMETHOD("_find_defs",n)}),a.DEFMETHOD("first_statement",ni),c.DEFMETHOD("first_statement",ni),Ee.DEFMETHOD("first_statement",function(){return ei(this.body)}),Ee.DEFMETHOD("length",function(){for(var e=this.argnames,n=0;n<e.length&&!(e[n]instanceof G);n++);return n});var ii=["constructor","toString","valueOf"],ri=Zt({Array:["indexOf","join","lastIndexOf","slice"].concat(ii),Boolean:ii,Function:ii,Number:["toExponential","toFixed","toPrecision"].concat(ii),Object:ii,RegExp:["exec","test"].concat(ii),String:["charAt","charCodeAt","concat","indexOf","italics","lastIndexOf","match","replace","search","slice","split","substr","substring","toLowerCase","toUpperCase","trim"].concat(ii)}),oi=Zt({Array:["isArray"],Math:["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","atan2","pow","max","min"],Number:["isFinite","isNaN"],Object:["create","getOwnPropertyDescriptor","getOwnPropertyNames","getPrototypeOf","isExtensible","isFrozen","isSealed","keys"],String:["fromCharCode","raw"]});function si(e){if(!(e instanceof te))return!1;var n=e.expression;if(!Nt(n))return!1;var t=oi[n.name];return t&&(t[e.property]||"Math"==n.name&&"random"==e.property)}!function(e){e(Fe,ct),e(I,lt),e(Le,ct);var n=nt("! ~ - + void");e(Dn,function(){return n[this.operator]&&this.expression instanceof I})}(function(e,n){e.DEFMETHOD("is_constant",n)}),function(e){Fe.DEFMETHOD("evaluate",function(e,n){if(!e.option("evaluate"))return this;var t=[],i=this._eval(e,n,t,1);return t.forEach(function(e){delete e._eval}),n?i:!i||i instanceof RegExp?i:"function"==typeof i||"object"==typeof i?this:i});var n=new jn(function(e){e instanceof f&&t(e.left),e instanceof he&&t(e.init),e instanceof Tn&&bt[e.operator]&&t(e.expression)});function t(e){e instanceof Q?e.elements.forEach(t):e instanceof Z?e.properties.forEach(function(e){t(e.value)}):e instanceof Be?t(e.expression):e instanceof _n&&e.definition().references.forEach(function(e){delete e._eval})}e(Ke,function(){throw new Error(string_template("Cannot evaluate a statement [{start}]",this))}),e(o,pt),e(_,pt),e(D,pt),e(Fe,pt),e(I,function(){return this.value}),e(f,function(e,i,r,o){var s=this.left;if(!i){if(!(s instanceof _n))return this;if(!Xn(s,"_eval")){if(!s.fixed)return this;var a=s.definition();if(!a.fixed)return this;if(a.undeclared)return this;if(a.last_ref!==s)return this;if("m"==a.single_use)return this;if(this.right.has_side_effects(e))return this}}var f,c=this.operator;f=!Xn(s,"_eval")&&s instanceof _n&&s.fixed&&s.definition().fixed?s:"="==c?this.right:at(g,this,{operator:c.slice(0,-1),left:s,right:this.right}),s.walk(n);var u=f._eval(e,i,r,o);return"object"==typeof u?this:(t(s),u)}),e(We,function(e,t,i,r){if(!t)return this;for(var o=this.expressions,s=0,a=o.length-1;s<a;s++)o[s].walk(n);var f=o[a],c=f._eval(e,t,i,r);return c===f?this:c}),e(Ee,function(e){if(e.option("unsafe")){var n=function(){};return n.node=this,n.toString=function(){return"function(){}"},n}return this}),e(s,function(e,n,t,i){if(e.option("unsafe")){for(var r=[],o=0;o<this.elements.length;o++){var s=this.elements[o];if(s instanceof ge)return this;var a=s._eval(e,n,t,i);if(s===a)return this;r.push(a)}return r}return this}),e(je,function(e,n,t,i){if(e.option("unsafe")){for(var r={},o=0;o<this.properties.length;o++){var s=this.properties[o];if(!(s instanceof He))return this;var a=s.key;if(a instanceof Fe&&(a=a._eval(e,n,t,i))===s.key)return this;switch(a){case"__proto__":case"toString":case"valueOf":return this}if(r[a]=s.value._eval(e,n,t,i),r[a]===s.value)return this}return r}return this});var i=nt("! typeof void");e(Dn,function(e,r,o,s){var a=this.expression,f=this.operator;if(e.option("typeofs")&&"typeof"==f&&(a instanceof Ee||a instanceof _n&&a.fixed_value()instanceof Ee))return"function";var c=a instanceof _n&&a.definition();i[f]||c&&c.fixed||s++,a.walk(n);var u=a._eval(e,r,o,s);if(u===a){if(r&&"void"==f)return;return this}switch(f){case"!":return!u;case"typeof":return u instanceof RegExp?this:typeof u;case"void":return;case"~":return~u;case"-":return-u;case"+":return+u;case"++":case"--":if(!c)return this;if(!r){if(c.undeclared)return this;if(c.last_ref!==a)return this}return Xn(a,"_eval")&&(u=+(f[0]+1)+ +u),t(a),u}return this}),e(Sn,function(e,i,r,o){var s=this.expression;if(s instanceof _n){if(!Xn(s,"_eval")){if(!s.fixed)return this;if(!i){var a=s.definition();if(!a.fixed)return this;if(a.undeclared)return this;if(a.last_ref!==s)return this}}}else if(!i)return this;s instanceof _n&&s.definition().fixed||o++,s.walk(n);var f=s._eval(e,i,r,o);return f===s?this:(t(s),+f)});var r=nt("&& || === !==");e(g,function(e,n,t,i){r[this.operator]||i++;var o=this.left._eval(e,n,t,i);if(o===this.left)return this;if(this.operator==(o?"||":"&&"))return o;var s,a=n&&!(o&&"object"==typeof o),f=this.right._eval(e,a,t,i);if(f===this.right)return this;switch(this.operator){case"&&":s=o&&f;break;case"||":s=o||f;break;case"??":s=null==o?f:o;break;case"|":s=o|f;break;case"&":s=o&f;break;case"^":s=o^f;break;case"+":s=o+f;break;case"-":s=o-f;break;case"*":s=o*f;break;case"/":s=o/f;break;case"%":s=o%f;break;case"<<":s=o<<f;break;case">>":s=o>>f;break;case">>>":s=o>>>f;break;case"==":s=o==f;break;case"===":s=o===f;break;case"!=":s=o!=f;break;case"!==":s=o!==f;break;case"<":s=o<f;break;case"<=":s=o<=f;break;case">":s=o>f;break;case">=":s=o>=f;break;case"**":s=Math.pow(o,f);break;case"in":if(f&&"object"==typeof f&&Xn(f,o)){s=!0;break}default:return this}if(isNaN(s))return e.find_parent(Fn)?this:s;if(e.option("unsafe_math")&&!n&&s&&"number"==typeof s&&("+"==this.operator||"-"==this.operator)){var c=Math.max(0,u(o),u(f));if(c<16)return+s.toFixed(c)}return s;function u(e){var n=/(\.[0-9]*)?(e[^e]+)?$/.exec(+e);return(n[1]||".").length-1-(n[2]||"").slice(1)}}),e(N,function(e,n,t,i){var r=this.condition._eval(e,n,t,i);if(r===this.condition)return this;var o=r?this.consequent:this.alternative,s=o._eval(e,n,t,i);return s===o?this:s}),e(_n,function(e,n,t,i){var r,o=this.fixed_value();if(!o)return this;if(Xn(o,"_eval"))r=o._eval();else{if(this._eval=pt,r=o._eval(e,n,t,i),delete this._eval,r===o)return this;o._eval=function(){return r},t.push(o)}return r&&"object"==typeof r&&!function(e,n){var t=e.definition().escaped;switch(t.length){case 0:return!0;case 1:var i=!1;return t[0].walk(new jn(function(n){return!!i||(n===e?i=!0:n instanceof Ve||void 0)})),i;default:return n<=t.depth}}(this,i)?this:r});var c={Array:Array,Math:Math,Number:Number,Object:Object,String:String},u=Zt({Math:["E","LN10","LN2","LOG2E","LOG10E","PI","SQRT1_2","SQRT2"],Number:["MAX_VALUE","MIN_VALUE","NaN","NEGATIVE_INFINITY","POSITIVE_INFINITY"]}),l=nt("global ignoreCase multiline source");function p(e,n,t,i,r){for(var o=[],s=0;s<e.length;s++){var a=e[s],f=a._eval(n,t,i,r);if(a===f)return;o.push(f)}return o}e(Be,function(e,n,t,i){if(e.option("unsafe")){var r,o=this.expression;if(!Nt(o)&&(null==(r=o._eval(e,n,t,i+1))||r===o))return this;var s=this.property;if(s instanceof Fe&&(s=s._eval(e,n,t,i))===this.property)return this;if(void 0===r){var a=u[o.name];if(!a||!a[s])return this;r=c[o.name]}else if(r instanceof RegExp){if(!l[s])return this}else if("object"==typeof r){if(!Xn(r,s))return this}else if("function"==typeof r)switch(s){case"name":return r.node.name?r.node.name.name:"";case"length":return r.node.length();default:return this}return r[s]}return this}),e(w,function(e,t,i,r){var o=this.expression,s=o instanceof _n?o.fixed_value():o;if(s instanceof a||s instanceof $||s instanceof _e){if(s.evaluating)return this;if(s.name&&s.name.definition().recursive_refs>0)return this;if(this.is_expr_pure(e))return this;var f=p(this.args,e,t,i,r);if(!Wn(s.argnames,function(n,o){if(n instanceof G){if(!f)return!1;if(void 0===f[o]){var s=n.value._eval(e,t,i,r);if(s===n.value)return!1;f[o]=s}n=n.name}return!(n instanceof K)}))return this;if(s.rest instanceof K)return this;if(!f&&!t)return this;var u=s.first_statement();if(!(u instanceof Ge)){if(t){s.walk(n);var l=!1;if(s.evaluating=!0,Gn(s,new jn(function(n){return!!l||(n instanceof Ge?(n.value&&void 0!==n.value._eval(e,!0,i,r)&&(l=!0),!0):n instanceof Ve&&n!==s||void 0)})),s.evaluating=!1,!l)return}return this}if(!(h=u.value))return;var d=[];return(!f||Wn(s.argnames,function(e,n){return b(e,f[n])})&&(!s.rest||b(s.rest,f.slice(s.argnames.length)))||t)&&(t&&s.argnames.forEach(function(e){e instanceof G&&e.value.walk(n)}),s.evaluating=!0,h=h._eval(e,t,i,r),s.evaluating=!1),d.forEach(function(e){delete e._eval}),h===u.value?this:h}if(e.option("unsafe")&&o instanceof Be){var h,v=o.property;if(v instanceof Fe&&(v=v._eval(e,t,i,r))===o.property)return this;var _=o.expression;if(Nt(_)){var g=oi[_.name];if(!g||!g[v])return this;h=c[_.name]}else{if(null==(h=_._eval(e,t,i,r+1))||h===_)return this;var m=ri[h.constructor.name];if(!m||!m[v])return this;if(h instanceof RegExp&&h.global&&!(_ instanceof Le))return this}if(!(f=p(this.args,e,t,i,r)))return this;if("replace"==v&&"function"==typeof f[1])return this;try{return h[v].apply(h,f)}catch(e){Fe.warn("Error evaluating {this} [{start}]",this)}finally{h instanceof RegExp&&(h.lastIndex=0)}}return this;function b(e,n){e instanceof G&&(e=e.name);var t=e.definition();if(t.orig[t.orig.length-1]!==e)return!1;var i=n;return t.references.forEach(function(e){e._eval=function(){return i},d.push(e)}),!0}}),e(Oe,pt),e(mn,function(e,n,t,i){if(!e.option("templates"))return this;if(this.tag){if(!Zi(e,this.tag))return this;f=function(e){return e}}var r=p(this.expressions,e,n,t,i);if(!r)return this;for(var o=!1,s=f(this.strings[0]),a=0;a<r.length;a++)s+=r[a]+f(this.strings[a+1]);return o?(this._eval=pt,this):s;function f(e){return"string"!=typeof(e=er(e))&&(o=!0),e}})}(function(e,n){e.DEFMETHOD("_eval",n)}),function(e){function n(e){return at(Dn,e,{operator:"!",expression:e})}function t(e,t,i){var r=n(e);return i?Kt(r,at($e,t,{body:t}))===r?r:t:Kt(r,t)}e(Fe,function(){return n(this)}),e(Ke,function(){throw new Error("Cannot negate a statement")}),e(g,function(e,i){var r=this.clone(),o=this.operator;if(e.option("unsafe_comps"))switch(o){case"<=":return r.operator=">",r;case"<":return r.operator=">=",r;case">=":return r.operator="<",r;case">":return r.operator="<=",r}switch(o){case"==":return r.operator="!=",r;case"!=":return r.operator="==",r;case"===":return r.operator="!==",r;case"!==":return r.operator="===",r;case"&&":return r.operator="||",r.left=r.left.negate(e,i),r.right=r.right.negate(e),t(this,r,i);case"||":return r.operator="&&",r.left=r.left.negate(e,i),r.right=r.right.negate(e),t(this,r,i)}return n(this)}),e(A,function(){return n(this)}),e(N,function(e,n){var i=this.clone();return i.consequent=i.consequent.negate(e),i.alternative=i.alternative.negate(e),t(this,i,n)}),e(Se,function(){return n(this)}),e(We,function(e){var n=this.expressions.slice();return n.push(n.pop().negate(e)),dt(this,n)}),e(Dn,function(){return"!"==this.operator?this.expression:n(this)})}(function(e,n){e.DEFMETHOD("negate",function(e,t){return n.call(this,e,t)})});var ai=nt("Boolean decodeURI decodeURIComponent Date encodeURI encodeURIComponent Error escape EvalError isFinite isNaN Number Object parseFloat parseInt RangeError ReferenceError String SyntaxError TypeError unescape URIError"),fi=nt("Map Set WeakMap WeakSet");function ci(e){return e&&e.aborts()}w.DEFMETHOD("is_expr_pure",function(e){if(e.option("unsafe")){var n=this.expression;if(Nt(n)){if(ai[n.name])return!0;if(this instanceof Oe&&fi[n.name])return!0}if(si(n))return!0}return e.option("annotations")&&this.pure||!e.pure_funcs(this)}),mn.DEFMETHOD("is_expr_pure",function(e){var n=this.tag;if(!n)return!0;if(e.option("unsafe")){if(Nt(n)&&ai[n.name])return!0;if(n instanceof te&&Nt(n.expression)){var t=oi[n.expression.name];return t&&(t[n.property]||"Math"==n.expression.name&&"random"==n.property)}}return!e.pure_funcs(this)}),Fe.DEFMETHOD("is_call_pure",ct),w.DEFMETHOD("is_call_pure",function(e){if(!e.option("unsafe"))return!1;var n=this.expression;if(!(n instanceof te))return!1;var t,i=n.expression,r=n.property;if(i instanceof s)t=ri.Array;else if(i.is_boolean(e))t=ri.Boolean;else if(i.is_number(e))t=ri.Number;else if(i instanceof Le)t=ri.RegExp;else if(i.is_string(e)){if(t=ri.String,"replace"==r){var o=this.args[1];if(o&&!o.is_string(e))return!1}}else n.may_throw_on_access(e)||(t=ri.Object);return t&&t[r]}),function(e){e(Fe,ct),e(s,lt),e(f,function(){switch(this.operator){case"=":return this.right.safe_to_spread();case"&&=":case"||=":case"??=":return this.left.safe_to_spread()&&this.right.safe_to_spread()}return!0}),e(g,function(){return!Jt[this.operator]||this.left.safe_to_spread()&&this.right.safe_to_spread()}),e(I,lt),e(Ee,lt),e(je,function(){return Wn(this.properties,function(e){return!(e instanceof Pe||e instanceof Je)})}),e(We,function(){return this.tail_node().safe_to_spread()}),e(_n,function(){var e=this.fixed_value();return e&&e.safe_to_spread()}),e(Tn,lt)}(function(e,n){e.DEFMETHOD("safe_to_spread",n)}),function(e){function n(e,n,t){return!Wn(e,t?function(e){return e instanceof Je?!t(e,n):!e.has_side_effects(n)}:function(e){return!e.has_side_effects(n)})}function t(e,n){var t=e.expression;return!t.is_string(n)||t.has_side_effects(n)}e(Fe,lt),e(s,function(e){return n(this.elements,e,t)}),e(f,function(e){var n=this.left;if(!(n instanceof Be))return!0;var t=n.expression;return!(t instanceof Ye)||!t.scope.resolve().new||n instanceof Xe&&n.property.has_side_effects(e)||this.right.has_side_effects(e)}),e(g,function(e){return this.left.has_side_effects(e)||this.right.has_side_effects(e)||!Vi(this.operator,this.right,e)}),e(m,function(e){return n(this.body,e)}),e(w,function(e){return!(this.is_expr_pure(e)||this.is_call_pure(e)&&!this.expression.has_side_effects(e))||n(this.args,e,t)}),e(E,function(e){return this.expression.has_side_effects(e)||n(this.body,e)}),e(D,function(e){var t=this.extends;return!(!t||(t instanceof _n&&(t=t.fixed_value()),r(t)))||n(this.properties,e)}),e(C,function(e){return this.key instanceof Fe&&this.key.has_side_effects(e)||this.static&&this.value&&this.value.has_side_effects(e)}),e(N,function(e){return this.condition.has_side_effects(e)||this.consequent.has_side_effects(e)||this.alternative.has_side_effects(e)}),e(I,ct),e(W,function(e){return n(this.definitions,e)}),e(Q,function(e){return n(this.elements,e)}),e(X,function(e){return this.key instanceof Fe&&this.key.has_side_effects(e)||this.value.has_side_effects(e)}),e(Z,function(e){return n(this.properties,e)}),e(te,function(e){return this.expression.may_throw_on_access(e)||this.expression.has_side_effects(e)}),e(re,ct),e(me,function(e){return this.condition.has_side_effects(e)||this.body&&this.body.has_side_effects(e)||this.alternative&&this.alternative.has_side_effects(e)}),e(we,function(e){return this.body.has_side_effects(e)}),e(Ee,ct),e(je,function(e){return n(this.properties,e,function(e,n){var t=e.expression;return!t.safe_to_spread()||t.has_side_effects(n)})}),e(Ye,ct),e(Ne,function(e){return this.key instanceof Fe&&this.key.has_side_effects(e)||this.value.has_side_effects(e)}),e(We,function(e){return n(this.expressions,e)}),e($e,function(e){return this.body.has_side_effects(e)}),e(Xe,function(e){return this.expression.may_throw_on_access(e)||this.expression.has_side_effects(e)||this.property.has_side_effects(e)}),e(en,function(e){return this.expression.has_side_effects(e)||n(this.body,e)}),e(fn,ct),e(_n,function(e){return!this.is_declared(e)||!P(this,e)}),e(mn,function(e){return!this.is_expr_pure(e)||n(this.expressions,e)}),e(En,function(e){return n(this.body,e)||this.bcatch&&this.bcatch.has_side_effects(e)||this.bfinally&&this.bfinally.has_side_effects(e)}),e(Tn,function(e){return Et[this.operator]||this.expression.has_side_effects(e)}),e(On,function(){return this.value})}(function(e,n){e.DEFMETHOD("has_side_effects",n)}),function(e){function n(e,n){for(var t=e.length;--t>=0;)if(e[t].may_throw(n))return!0;return!1}function t(e,t){return!!e.may_throw(t)||(e instanceof _n&&(e=e.fixed_value()),!(e instanceof Ee)||(!!n(e.argnames,t)||(!!n(e.body,t)||Rn(e)&&e.value&&e.value.may_throw(t))))}e(Fe,lt),e(I,ct),e(re,ct),e(Ee,ct),e(Ye,ct),e(fn,ct),e(s,function(e){return n(this.elements,e)}),e(f,function(e){return!!this.right.may_throw(e)||!(!e.has_directive("use strict")&&"="==this.operator&&this.left instanceof _n)&&this.left.may_throw(e)}),e(v,function(e){return this.expression.may_throw(e)}),e(g,function(e){return this.left.may_throw(e)||this.right.may_throw(e)||!Vi(this.operator,this.right,e)}),e(m,function(e){return n(this.body,e)}),e(w,function(e){if(n(this.args,e))return!0;if(this.is_expr_pure(e))return!1;this.may_throw=lt;var i=t(this.expression,e);return delete this.may_throw,i}),e(E,function(e){return this.expression.may_throw(e)||n(this.body,e)}),e(N,function(e){return this.condition.may_throw(e)||this.consequent.may_throw(e)||this.alternative.may_throw(e)}),e(G,function(e){return this.name.may_throw(e)||this.value&&this.value.may_throw(e)}),e(W,function(e){return n(this.definitions,e)}),e(te,function(e){return!this.optional&&this.expression.may_throw_on_access(e)||this.expression.may_throw(e)}),e(he,function(e){if(this.init.may_throw(e))return!0;var n=this.object;return!!n.may_throw(e)||(!((n=n.tail_node())instanceof s||n.is_string(e))||this.body.may_throw(e))}),e(me,function(e){return this.condition.may_throw(e)||this.body&&this.body.may_throw(e)||this.alternative&&this.alternative.may_throw(e)}),e(we,function(e){return this.body.may_throw(e)}),e(je,function(e){return n(this.properties,e)}),e(Ne,function(e){return this.value.may_throw(e)||this.key instanceof Fe&&this.key.may_throw(e)}),e(Ge,function(e){return this.value&&this.value.may_throw(e)}),e(We,function(e){return n(this.expressions,e)}),e($e,function(e){return this.body.may_throw(e)}),e(Xe,function(e){return!this.optional&&this.expression.may_throw_on_access(e)||this.expression.may_throw(e)||this.property.may_throw(e)}),e(en,function(e){return this.expression.may_throw(e)||n(this.body,e)}),e(_n,function(e){return!this.is_declared(e)||!P(this,e)}),e(mn,function(e){if(n(this.expressions,e))return!0;if(this.is_expr_pure(e))return!1;if(!this.tag)return!1;this.may_throw=lt;var i=t(this.tag,e);return delete this.may_throw,i}),e(En,function(e){return(this.bcatch?this.bcatch.may_throw(e):n(this.body,e))||this.bfinally&&this.bfinally.may_throw(e)}),e(Tn,function(e){return this.expression.may_throw(e)&&!("typeof"==this.operator&&this.expression instanceof _n)}),e(On,function(e){return this.name.may_throw(e)||this.value&&this.value.may_throw(e)})}(function(e,n){e.DEFMETHOD("may_throw",n)}),function(e){function n(e,n){for(var t=e.length;--t>=0;)if(!e[t].is_constant_expression(n))return!1;return!0}e(Fe,ct),e(s,function(e){return n(this.elements,e)}),e(g,function(e){return this.left.is_constant_expression(e)&&this.right.is_constant_expression(e)&&Vi(this.operator,this.right)}),e(D,function(e){var t=this.extends;return!(t&&!r(t))&&n(this.properties,e)}),e(C,function(e){return"string"==typeof this.key&&(!this.value||this.value.is_constant_expression(e))}),e(I,lt),e(Ee,function(e){var n=this,t=!0,i=[];return n.walk(new jn(function(r,o){if(!t)return!0;if(r instanceof b){if(r===n)return;return i.push(r),o(),i.pop(),!0}if(r instanceof _n){if(n.inlined||r.redef||r.in_arg)return t=!1,!0;if(n.variables.has(r.name))return!0;var s=r.definition();if(it(s.scope,i))return!0;if(e&&!s.redefined()){var a=e.find_variable(r.name);if(a?a===s:s.undeclared)return t="f",!0}return t=!1,!0}return r instanceof Ye?(Rn(n)&&Wn(i,function(e){return!(e instanceof Ve)||Rn(e)})&&(t=!1),!0):void 0})),t}),e(je,function(e){return n(this.properties,e)}),e(Ne,function(e){return"string"==typeof this.key&&this.value.is_constant_expression(e)}),e(Tn,function(e){return this.expression.is_constant_expression(e)})}(function(e,n){e.DEFMETHOD("is_constant_expression",n)}),function(e){function n(){var e=this.body.length;return e>0&&ci(this.body[e-1])}e(Ke,ut),e(ke,pt),e(y,n),e(nn,n),e(me,function(){return this.alternative&&ci(this.body)&&ci(this.alternative)&&this})}(function(e,n){e.DEFMETHOD("aborts",n)});var ui=nt(["use asm","use strict"]);function li(e,n,t){switch(e.body.length){case 0:return t?Zn.skip:at(re,e);case 1:var i=e.body[0];return qt(i)?n instanceof xe&&i instanceof Te?e:i:e}return e}function pi(e,n){n.option("rests")&&(e.uses_arguments||e.rest instanceof Q&&n.drop_fargs(e,n.parent())&&(e.argnames=e.argnames.concat(e.rest.elements),e.rest=e.rest.rest))}function di(e,n){if(!n.option("arrows"))return e;pi(e,n),e.value&&(e.body=[e.first_statement()]);var t=Vt(e.body,n);switch(t.length){case 1:var i=t[0];if(i instanceof Ge){e.body.length=0,e.value=i.value;break}default:e.body=t,e.value=null}return e}e(ee,function(e,n){return!n.option("directives")||ui[e.value]&&n.has_directive(e.value)===e?e:at(re,e)}),e(U,function(e,n){return n.option("drop_debugger")?at(re,e):e}),e(we,function(e,n){if(e.body instanceof me||e.body instanceof k){var t=Vt([e.body],n);switch(t.length){case 0:e.body=at(re,e);break;case 1:e.body=t[0];break;default:e.body=at(y,e,{body:t})}}return n.option("unused")&&0==e.label.references.length?e.body:e}),e(Ae,function(e,n){if(!n.option("dead_code"))return e;var t=e.label;if(t){var i=n.loopcontrol_target(e);e.label=null,n.loopcontrol_target(e)===i?ft(t.thedef.references,e):e.label=t}return e}),e(m,function(e,n){return e.body=Vt(e.body,n),e}),e(y,function(e,n){return e.body=Vt(e.body,n),li(e,n.parent())}),e(Ee,function(e,n){return pi(e,n),e.body=Vt(e.body,n),e}),e(a,di),e(c,di),e(_e,function(e,n){pi(e,n),e.body=Vt(e.body,n);var t=n.parent();if(n.option("inline"))for(var i=0;i<e.body.length;i++){var r=e.body[i];if(!(r instanceof ee)){if(r instanceof Ge){if(i!=e.body.length-1)break;var o=r.value;if(!o||"Call"!=o.TYPE)break;if(o.is_expr_pure(n))break;var s,a=o.expression;if(a instanceof _n){if(e.name&&e.name.definition()===a.definition())break;s=a.fixed_value()}else s=a;if(!(s instanceof $||s instanceof _e))break;if(s.rest)break;if(s.uses_arguments)break;if(s===a){if(s.parent_scope!==e)break;if(!Wn(s.enclosed,function(n){return n.scope!==e}))break}if((s!==a||s.name)&&(t instanceof M||t instanceof Ie)&&t.value===n.self())break;if(s.contains_this())break;var f=s.argnames.length;if(f>0&&n.option("inline")<2)break;if(f>e.argnames.length)break;if(!Wn(e.argnames,function(e){return e instanceof ln}))break;if(!Wn(o.args,function(e){return!(e instanceof Je)}))break;for(var c=0;c<f;c++){var u=o.args[c];if(!(u instanceof _n))break;if(u.definition()!==e.argnames[c].definition())break}if(c<f)break;for(;c<o.args.length&&!o.args[c].has_side_effects(n);c++);if(c<o.args.length)break;if(f<e.argnames.length&&!n.drop_fargs(e,t)){if(!n.drop_fargs(s,o))break;do{s.argnames.push(s.make_var(ln,s,"argument_"+f))}while(++f<e.argnames.length)}return a}break}}return e});var hi=nt("arguments await yield");function vi(e,n){for(var t=n.length;--t>=0;)n[t]||(n[t]=at(ge,e))}function _i(e,n){var t=at(A,e);return t.name&&(t.name=n?null:at(on,t.name)),t}function gi(e,n){var t;switch(e.CTOR){case u:t=l;break;case p:t=d;break;case $:t=_e;break;case AST_GeneratorDefun:t=AST_GeneratorFunction}var i=at(t,e);return i.name=n?null:at(dn,e.name),i}function mi(e,n){e.walk(new jn(function(t){return t instanceof Ge?(n(t),!0):t instanceof Ve&&t!==e||void 0}))}function bi(e){var n=Object.create(null);return mi(e,function(e){var t=e.value;if(t&&(t=t.tail_node()),t instanceof _n){var i=t.definition().id;n[i]=(n[i]||0)+1}}),n}function yi(e,n,t){if(t.exposed(e))return!1;switch(e.references.length-e.replaced-(n[e.id]||0)){case e.drop_return:return"d";case e.bool_return:return!0}}function xi(e,n){mi(e,function(e){e.in_bool=!0;var t=e.value;if(t){var i=Si(n,t);i?i instanceof Fe||(t=t.drop_side_effect_free(n),e.value=t?dt(e.value,[t,at(Ce,e.value,{value:1})]):at(Ce,e.value,{value:1})):(t=t.drop_side_effect_free(n),e.value=t?dt(e.value,[t,at(Ce,e.value,{value:0})]):null)}})}function ki(e,n){if(!e.name||!n.option("ie"))return!0;var t=e.name.definition();return!n.exposed(t)&&Wn(t.references,function(e){return!(e instanceof _n)})}function wi(e,n,t){if(n instanceof Ee){var i=Rn(n),r=Ln(n),o=!1,s=!1;if(i&&e.option("arrows"))if(n.value){if(!r||Wi(e,n.value)){var f=n.value.drop_side_effect_free(e);f!==n.value&&(o=!0,n.value=f)}}else s=!0;else if(!Un(n))if(!t&&n.name){var u=n.name.definition();s=u.references.length==u.replaced}else s=!0;if(s&&(n.process_expression(!1,function(n){var t=n.value;if(t){if(r&&!Wi(e,t))return n;t=t.drop_side_effect_free(e,!0)}return o=!0,t?at($e,n,{body:t}):at(re,n)}),mi(n,function(n){var t=n.value;if(t){if(r&&!Wi(e,t))return;var i=t.drop_side_effect_free(e);i!==t&&(o=!0,i&&r&&!Wi(e,i)&&(i=i.negate(e)),n.value=i)}})),r&&e.option("awaits")){s&&n.process_expression("awaits",function(n){var t=n.body;if(t instanceof v){if(Wi(e,t.expression)){if(o=!0,!(t=t.expression.drop_side_effect_free(e,!0)))return at(re,n);n.body=t}}else if(t instanceof We){for(var i=t.expressions,r=i.length;--r>=0;){var s=i[r];if(!(s instanceof v))break;var a=s.expression;if(!Wi(e,a))break;if(o=!0,i[r]=a.drop_side_effect_free(e))break}switch(r){case-1:return at(re,n);case 0:n.body=i[0];break;default:i.length=r+1}}return n});var p=!s&&n.name||i&&n.value&&!Wi(e,n.value),h=new jn(function(t){return!!p||(h.parent()===n&&t.may_throw(e)?p=!0:t instanceof v?p=!0:t instanceof AST_ForAwaitOf?p=!0:t instanceof Ge?t.value&&!Wi(e,t.value)?p=!0:void 0:t instanceof Ve&&t!==n||void 0)});if(n.walk(h),!p){var _;switch(n.CTOR){case c:_=a;break;case l:_=_e;break;case d:_=AST_GeneratorFunction}return at(_,n)}}return o&&n.clone()}}function Ei(e,n,t){t||(t=Ae);var i=!1,r=new jn(function(n){return!!(i||n instanceof Ve)||(n instanceof t&&r.loopcontrol_target(n)===e?i=!0:void 0)});return n instanceof we&&r.push(n),r.push(e),e.body.walk(r),i}function Ti(e,n,t){if(e instanceof We&&(e=e.tail_node()),e instanceof g)if(e.left instanceof Qe){if(e.right instanceof Dn&&"typeof"==e.right.operator){var i=e.right.expression;if(Nt(i)){var r,o="undefined"==e.left.value;switch(e.operator){case"==":r=o?t:n;break;case"!=":r=o?n:t;break;default:return}if(r){var s,a=!1,c=i.definition(),u=[],l=[],p=new jn(function(e,n){if(a)return!0;if(e instanceof f){var t=e.left;if(!(t instanceof _n&&t.definition()===c))return;switch(e.right.walk(p),e.operator){case"=":case"&&=":a=!0}return!0}if(e instanceof w)return n(),(s=e.expression.tail_node())instanceof _n&&(s=s.fixed_value(),i=u.length),s instanceof Ee?ot(l,s)&&s.walk(p):a=!0,i>=0&&(u.length=i),!0;if(e instanceof ie){var i=u.length;return n(),a&&(u.length=i),!0}if(e instanceof de){e.init&&e.init.walk(p);i=u.length;return e.condition&&e.condition.walk(p),e.body.walk(p),e.step&&e.step.walk(p),a&&(u.length=i),!0}if(e instanceof he){e.object.walk(p);i=u.length;return e.init.walk(p),e.body.walk(p),a&&(u.length=i),!0}if(e instanceof Ve){if(e===s)return;return!0}return e instanceof _n?(e.definition()===c&&u.push(e),!0):void 0});r.walk(p),u.forEach(function(e){e.defined=!0})}}}}else switch(e.operator){case"&&":Ti(e.left,n),Ti(e.right,n);break;case"||":Ti(d(e.left),t),Ti(d(e.right),t)}function d(e){if(e instanceof g)switch(e.operator){case"==":return(e=e.clone()).operator="!=",e;case"!=":return(e=e.clone()).operator="==",e}}}function Si(e,n,t){return!!n.truthy||($t(n)?void 0:!(n.falsy&&!t)&&(!!n.is_truthy()||n.evaluate(e,!0)))}function Di(e,n){var t,i=0,r=!1,o=e.self();if(!Bn(o))for(;;){if(t=o,(o=e.parent(i++))instanceof g)switch(t){case o.left:if(Jt[o.operator])continue;break;case o.right:if(a(o.left))switch(o.operator){case"&&":n[r?"falsy":"truthy"]=!0;break;case"||":case"??":n[r?"truthy":"falsy"]=!0}}else if(o instanceof N){var s=o.condition;if(s===t)continue;if(a(s))switch(t){case o.consequent:n[r?"falsy":"truthy"]=!0;break;case o.alternative:n[r?"truthy":"falsy"]=!0}}else{if(o instanceof oe)break;if(o instanceof me)break;if(o instanceof We){if(o.expressions[0]===t)continue}else if(o instanceof $e)break}return}for(;;){if(t=o,(o=e.parent(i++))instanceof y){if(o.body[0]===t)continue}else if(o instanceof me&&a(o.condition))switch(t){case o.body:n[r?"falsy":"truthy"]=!0;break;case o.alternative:n[r?"truthy":"falsy"]=!0}return}function a(e){return!!n.equals(e)||e instanceof Dn&&("!"==e.operator&&(!!n.equals(e.expression)&&(r=!0,!0)))}}function Ai(e){return function(n,t){var i=!1;return this.definitions.forEach(function(r){r.value&&(i=!0),r.name.match_symbol(function(i){i instanceof fn&&t.push(at(On,i,{name:i,value:e(n,i)}))},!0)}),i}}function zi(e){return"arguments"!=e.name&&e.orig.length<(e.orig[0]instanceof dn?3:2)}function Oi(e,n){if(e.exposed(n))return!0;for(var t=n.scope.resolve(),i=n.scope;i!==t;)if((i=i.parent_scope).var_names().has(n.name))return!0}function qi(e,n){return at(zn,e,{definitions:e.definitions.map(function(e){return at(On,e,{name:e.name.convert_symbol(gn,function(e,t){var i=e.definition();i.orig[i.orig.indexOf(t)]=e,i.scope!==n&&(i.scope=n,n.variables.set(i.name,i),n.enclosed.push(i),n.var_names().set(i.name,!0))}),value:e.value})})})}function Fi(e,n){var t=n.definition();return(t.fixed||0===t.fixed)&&zi(t)&&Xi(t)&&!Oi(e,t)}function Mi(e,n){return n.option("varify")&&Wn(e.definitions,function(e){return!e.name.match_symbol(function(e){if(e instanceof fn)return!Fi(n,e)},!0)})?qi(e,n.find_parent(Ve)):e}function Ci(e,n){if(n.option("optional_chains")&&e.terminal)do{var t=e.expression;if(e.optional){var i=Si(n,t,!0);if(null==i)return at(Dn,e,{operator:"void",expression:t}).optimize(n);i instanceof Fe||(e.optional=!1)}e=t}while(("Call"==e.TYPE||e instanceof Be)&&!e.terminal)}function ji(e,n){var t=e.expression;if(!(t instanceof We))return e;var i=t.expressions.slice(),r=e.clone();return r.expression=i.pop(),i.push(r),dt(e,i)}function Hi(e,n,t){var i=e.expression,r=i instanceof _n?i.fixed_value():i;if(r instanceof Ee&&!r.uses_arguments&&!(r.pinned()||t&&t.indexOf(r)<0)){var o=e.args;if(Wn(o,function(e){return!(e instanceof Je)})){var a=r.argnames,f=r===i&&!r.name;if(r.rest){if(!f||!n.option("rests"))return;var c=a.length;for(o=o.slice(0,c);o.length<c;)o.push(at(An,e).optimize(n));o.push(at(s,e,{elements:e.args.slice(c)})),a=a.concat(r.rest),r.rest=null}else o=o.slice(),a=a.slice();for(var u=0,l=0,p=f&&n.option("default_values"),d=f&&n.drop_fargs(r,e)?function(e,t){return!e||(e instanceof Q?0==e.elements.length&&!e.rest&&t instanceof s:e instanceof Z?0==e.properties.length&&!e.rest&&t&&!t.may_throw_on_access(n):e.unused)}:ct,h=[],v=0;v<o.length;v++){var _=a[v];if(p&&_ instanceof G&&o[v].is_defined(n)&&(a[v]=_=_.name),_&&void 0===_.unused){if(d(_,o[v])){g=o[v].drop_side_effect_free(n);a.splice(v,1),o.splice(v,1),g&&h.push(g),v--;continue}h.push(o[v]),o[u++]=dt(e,h),h=[]}else{var g=o[v].drop_side_effect_free(n);if(d(_)){_&&a.splice(v,1),o.splice(v,1),g&&h.push(g),v--;continue}if(g)h.push(g),o[u++]=dt(e,h),h=[];else if(_){if(!h.length){o[u++]=at(Ce,o[v],{value:0});continue}o[u++]=dt(e,h),h=[]}}l=u}for(;v<a.length;v++)d(a[v])&&a.splice(v--,1);if(r.argnames=a,o.length=l,e.args=o,h.length){var m=dt(e,h);o.push(o.length<a.length?at(Dn,e,{operator:"void",expression:m}):m)}}}}function Pi(e,n){n||(n=e.find_parent(Ve));var t=[];return(Ln(n)||n instanceof kn&&e.option("module"))&&t.push("await"),Un(n)&&t.push("yield"),t.length&&nt(t)}function Ni(e,n){if(!n)return!0;var t=!0,i=new jn(function(r){if(!t)return!0;if(r instanceof Ve){if(r===e)return;if(Rn(r))for(var o=0;t&&o<r.argnames.length;o++)r.argnames[o].walk(i);else r instanceof Te&&n[r.name.name]&&(t=!1);return!0}r instanceof tn&&n[r.name]&&r!==e.name&&(t=!1)});return e.walk(i),t}function Yi(e,n){return e.in_strict_mode(n)||!n.has_directive("use strict")}function Ii(e,n,t,i){if(i instanceof g&&("&&"==i.operator||"||"==i.operator)&&i.right instanceof f&&"="==i.right.operator&&i.right.left instanceof _n&&i.right.left.definition()===n&&!t.has_side_effects(e)&&r(i.left)&&r(i.right.right))return n.replaced++,"&&"==i.operator?at(N,i,{condition:i.left,consequent:i.right.right,alternative:t}):at(N,i,{condition:i.left,consequent:t,alternative:i.right.right});function r(t){if(!t.has_side_effects(e)){var i=!1;return t.walk(new jn(function(e){return!!i||(e instanceof _n&&e.definition()===n?i=!0:void 0)})),!i}}}Ve.DEFMETHOD("merge_variables",function(e){if(e.option("merge_vars")){var n,t,i=[],r={},o=this,s=[],a=[],c=0,u=new Jn,l=Object.create(null),p=Object.create(null),d=new jn(function(s,a){if(s instanceof f){var c=s.left,p=s.right;return c instanceof K?(p.walk(d),z(_n,O,c),!0):Jt[s.operator.slice(0,-1)]?(c.walk(d),S(),p.walk(d),c instanceof _n&&O(c),A(),!0):c instanceof _n?("="!=s.operator&&O(c,!0),p.walk(d),O(c),!0):void 0}if(s instanceof g){if(!Jt[s.operator])return;return T(s),!0}var h;if(s instanceof k)return(h=d.loopcontrol_target(s))instanceof xe||q(h),!0;if(s instanceof w)return(m=s.expression)instanceof Se?(s.args.forEach(function(e){e.walk(d)}),m.walk(d)):(a(),E(m)),!0;if(s instanceof D)return s.name&&s.name.walk(d),s.extends&&s.extends.walk(d),s.properties.filter(function(e){return e.key instanceof Fe&&e.key.walk(d),e.value}).forEach(function(e){e.static?e.value.walk(d):(S(),r.block=s,e.value.walk(d),A())}),!0;if(s instanceof N)return T(s.condition,s.consequent,s.alternative),!0;if(s instanceof R)return(h=d.loopcontrol_target(s))instanceof ne&&q(h),!0;if(s instanceof ne){S(),r.block=s,r.loop=!0;var v=r;return s.body.walk(d),r.inserted===s&&(r=v),s.condition.walk(d),A(),!0}if(s instanceof de)return s.init&&s.init.walk(d),S(),r.block=s,r.loop=!0,s.condition&&s.condition.walk(d),s.body.walk(d),s.step&&s.step.walk(d),A(),!0;if(s instanceof he)return s.object.walk(d),S(),r.block=s,r.loop=!0,s.init.walk(d),s.body.walk(d),A(),!0;if(s instanceof me)return T(s.condition,s.body,s.alternative),!0;if(s instanceof we){S(),r.block=s;v=r;return s.body.walk(d),r.inserted===s&&(r=v),A(),!0}if(s instanceof Ve){if(S(),r.block=s,s===o&&(t=r),s instanceof Ee){s.name&&(l[s.name.definition().id]=!1);var _=s.uses_arguments&&!d.has_directive("use strict")?function(e){l[e.definition().id]=!1}:function(e){O(e)};i.push(s),s.argnames.forEach(function(e){z(ln,_,e)}),s.rest&&z(ln,_,s.rest),i.pop()}return Vn(s,d),A(),!0}if(s instanceof Xe){var m=s.expression;return s.optional?(m.walk(d),S(),s.property.walk(d),A()):a(),E(m),!0}if(s instanceof en){s.expression.walk(d);v=r;return s.body.forEach(function(e){e instanceof B||(e.expression.walk(d),v===r&&S())}),r=v,s.body.forEach(function(e){S(),r.block=s;var n=r;Gn(e,d),r.inserted===s&&(r=n),A()}),!0}if(s instanceof an||s instanceof hn)return l[s.definition().id]=!1,!0;if(s instanceof _n)return O(s,!0),!0;if(s instanceof En){var b=n;return n=s,Gn(s,d),s.bcatch&&(s.bcatch.argname&&s.bcatch.argname.mark_symbol(function(e){if(e instanceof rn){var n=e.definition();l[n.id]=!1,(n=n.redefined())&&(l[n.id]=!1)}},d),s.bfinally||(n=b)?Gn(s.bcatch,d):(S(),Gn(s.bcatch,d),A())),n=b,s.bfinally&&s.bfinally.walk(d),!0}if(s instanceof Tn){if(!bt[s.operator])return;var y=s.expression;if(!(y instanceof _n))return;return O(y,!0),!0}if(s instanceof On){var x=s.value;return x?x.walk(d):x=r.block instanceof he&&r.block.init===d.parent(),z(fn,x?function(e){e instanceof gn?O(e):e.walk(d)}:function(e){if(e instanceof gn){var n=e.definition().id,t=l[n];t?t.push(e):n in l||u.add(n,e)}else e.walk(d)},s.name),!0}if(s instanceof qn)return S(),r.block=s,r.loop=!0,a(),A(),!0;function E(n){if(e.option("ie")){var t=In(n);t instanceof _n&&t.walk(d)}}function T(e,n,t){var i=r,o=[i,i];if(e instanceof g)switch(e.operator){case"&&":o[0]=T(e.left,e.right)[0];break;case"||":case"??":o[1]=T(e.left,null,e.right)[1];break;default:e.walk(d)}else e instanceof N?T(e.condition,e.consequent,e.alternative):e.walk(d);return r=o[0],n&&(S(),n.walk(d)),o[0]=r,r=o[1],t&&(S(),t.walk(d)),o[1]=r,r=i,o}});d.directives=Object.create(e.directives),o.walk(d);for(var h=!1,v=Object.create(null);s.length&&a.length;){var _=a.shift();if(_){var m=_.definition,b=l[m.id];if(b){for(b={end:b.end};m.id in v;)m=v[m.id];b.start=l[m.id].start;var y=[];do{var x=s.shift();if(!(_.index>x.index)){var E=x.definition;if(E.id in p){var T=l[E.id];if(T){if(T.start.block===b.start.block&&M(T,b)&&(!T.start.loop&&Xi(m)||M(b,T))&&(!e.option("webkit")||wt(m)===wt(E))&&!E.const_redefs&&Wn(T.scopes,function(e){return e.find_variable(m.name)===m})){T.forEach(function(e){e.thedef=m,e.name=m.name,e instanceof _n?(m.references.push(e),E.replaced++):(m.orig.push(e),E.eliminated++)}),E.fixed||(m.fixed=!1),v[E.id]=m,h=!0;break}y.push(x)}}}}while(s.length);y.length&&(s=y.concat(s))}}}return h}function S(){r=Object.create(r)}function A(){r=Object.getPrototypeOf(r)}function z(e,n,t){var i=new jn(function(t){if(!(t instanceof K))return t instanceof G?(S(),t.value.walk(d),A(),t.name.walk(i)):t instanceof X?t.key instanceof Fe?t.value instanceof Be?(S(),r.block=t,t.key.walk(d),t.value.walk(i),A()):(t.key.walk(d),t.value.walk(i)):t.value.walk(i):t instanceof e?n(t):t.walk(d),!0});t.walk(i)}function O(f,h){var v,_=f.definition();if(h&&!Wn(i,function(e){return!(v=e.variables.get(f.name))||(!wt(v)||v!==_&&!_.undeclared&&e.parent_scope.find_variable(f.name)!==_)}))return l[_.id]=l[v.id]=!1;var g=r;if(n&&(S(),g=r,A()),_.id in l){if(!(m=l[_.id]))return;if(m.start.block!==g.block)return l[_.id]=!1;if(b(f),m.end=g,_.id in p)a[p[_.id]]=null;else if(!h)return}else{if((v=o.variables.get(_.name))!==_)return v&&t===g&&(l[v.id]=!1),l[_.id]=!1;if(e.exposed(_)||hi[f.name])return l[_.id]=!1;var m;if((m=u.get(_.id)||[]).scopes=[],b(f),l[_.id]=m,!h)return m.start=g,s.push({index:c++,definition:_});if(g.block!==o)return l[_.id]=!1;m.start=t}function b(e){m.push(e),ot(m.scopes,e.scope);var n=Qn(d);n!==e.scope&&ot(m.scopes,n)}p[_.id]=a.length,a.push({index:c++,definition:_})}function q(e){for(var n=[];;){if(Xn(r,"block")){var t=r.block;if(t instanceof we&&(t=t.body),t===e)break}n.push(r),A()}for(r.inserted=r.block,S();n.length;){var i=n.pop();S(),Xn(i,"block")&&(r.block=i.block),Xn(i,"loop")&&(r.loop=i.loop)}}function F(e,n){return e===n||e.isPrototypeOf(n)}function M(e,n){return F(e.start,e.end)||F(e.start,n.start)}}),Ve.DEFMETHOD("drop_unused",function(e){if(e.option("unused")){var n=this,t=!(n instanceof kn)||e.toplevel.funcs,i=!(n instanceof kn)||e.toplevel.vars,r=/keep_assign/.test(e.option("unused"))?ct:function(n,t){var i,r=!1;if(n instanceof f?(n.write_only||"="==n.operator)&&(i=s(n.left,t)):n instanceof Tn&&n.write_only&&(i=s(n.expression,t)),i instanceof _n){var o=i.definition();if(!c[o.id]&&!e.exposed(o)&&P(i,e,r))return i}function s(n,t){if(n instanceof Be){var i=n.expression;if(!i.may_throw_on_access(e,!0))return r=!0,t&&n instanceof Xe&&t.unshift(n.property),s(i,t)}else if(n instanceof f&&"="==n.operator){n.write_only="p";var o=s(n.right);return t?(t.assign=n,o instanceof _n?o:n.left):o}return n}},a=Object.create(null),c=Object.create(null),h=function(t){return(h=function n(t,i,r){var o=e.parent(i);if(!o)return r;var s=o instanceof Ee&&it(t,o.argnames);return n(o,i+1,s?function(e){var n=r(e);if(n)return n;if(n=o.variables.get(e)){var t=n.orig[0];if(t instanceof ln||t instanceof dn)return n}}:o.variables?function(e){return r(e)||o.variables.get(e)}:r)}(n,0,rt))(t)},v=Object.create(null),_=[],b=Object.create(null),x=Object.create(null),k=Object.create(null),E=Object.create(null),D=Object.create(null);n instanceof kn&&e.top_retain&&n.variables.each(function(n){!e.top_retain(n)||n.id in b||(Fe.info("Retaining variable {name}",n),b[n.id]=!0,_.push(n))});var z=new Jn,O=new Jn,q=this,F=new jn(function(r,o){if(r instanceof Ee&&r.uses_arguments&&!F.has_directive("use strict")&&r.each_argname(function(e){var n=e.definition();n.id in b||(b[n.id]=!0,_.push(n))}),r!==n){if(q===n){if(r instanceof V){var s=r.name.definition();(u=t&&!s.exported)||s.id in b||(b[s.id]=!0,_.push(s));var a=F.parent()instanceof ce;a?c[s.id]=!0:!u||s.id in x||(x[s.id]=1),r.extends&&r.extends.walk(F);var f=[];return r.properties.forEach(function(e){e.key instanceof Fe&&e.key.walk(F);var n=e.value;n&&(Rt(e)?(!a&&n.contains_this()&&(a=!0),l(n)):f.push(n))}),f.forEach(u&&a?l:function(e){O.add(s.id,e)}),!0}if(r instanceof Te){var u;s=r.name.definition();return(u=t&&!s.exported)||s.id in b||(b[s.id]=!0,_.push(s)),O.add(s.id,r),F.parent()instanceof ce?(c[s.id]=!0,ye(r,o,!0)):(!u||s.id in x||(x[s.id]=1),!0)}if(r instanceof W)return r.definitions.forEach(function(n){var t=n.value,o=t&&(n.name instanceof K||t.has_side_effects(e)),s=o&&"="==t.tail_node().operator;n.name.mark_symbol(function(e){if(e instanceof fn){var a=e.definition();if(D[a.id]=(D[a.id]||0)+1,r instanceof zn&&a.orig[0]instanceof rn){var f=a.redefined();f&&(D[f.id]=(D[f.id]||0)+1)}return a.id in b||i&&!a.exported&&(r instanceof Y?!a.redefined():!a.const_redefs)&&(r instanceof zn||zi(a))||(b[a.id]=!0,_.push(a)),t&&(o?s&&ae(a,e,E[a.id]):O.add(a.id,t),z.add(a.id,n)),se(a),!0}},F),o&&t.walk(F)}),!0;if(r instanceof ln){s=r.definition();return D[s.id]=(D[s.id]||0)+1,z.add(s.id,r),!0}if(r instanceof pn)return(s=r.definition()).id in b||i&&zi(s)||(b[s.id]=!0,_.push(s)),!0}return ye(r,o,!0)}function l(e){var n=q;q=r,e.walk(F),q=n}});F.directives=Object.create(e.directives),n.walk(F);var M=e.option("keep_fnames")?ct:e.option("ie")?function(n){return!e.exposed(n)&&n.references.length==n.replaced}:function(e){return!(e.id in b)||!(e.orig.length-e.eliminated<2)&&(e.orig[1]instanceof ln||Wn(e.references,function(e){return!e.in_arg}))};e.option("ie")&&O.each(function(e,n){n in b||e.forEach(function(e){e.walk(new jn(function(e){return e instanceof _e&&e.name&&!M(e.name.definition())?(e.walk(F),!0):e instanceof Ve||void 0}))})}),F=new jn(ye);for(var C=0;C<_.length;C++){var j=O.get(_[C].id);j&&j.forEach(function(e){e.walk(F)})}Object.keys(a).forEach(function(e){var n=a[e];if(n){n=n.reduce(function(e,n){return n.forEach(function(n){ot(e,n)}),e},[]);var t=(z.get(e)||[]).filter(function(e){return Kn(e instanceof Tn?function(n){return n===e}:function(n){return n===e||!(n instanceof Tn)&&X(n)===X(e)},n)});n.length==t.length?a[e]=t:delete a[e]}else delete a[e]});var I=[],R=[],U=new Cn(function(n){if(n instanceof G)return ke(U,n);if(n instanceof K&&n.rest&&(n.rest=n.rest.transform(U)),n instanceof Q){for(var t=!n.rest,i=n.elements.length;--i>=0;){var r=n.elements[i].transform(U);r?(n.elements[i]=r,t=!1):t?n.elements.pop():n.elements[i]=at(ge,n.elements[i])}return n}if(n instanceof Z){var o=[];return n.properties.forEach(function(t){var i=!1;if(t.key instanceof Fe&&(t.key=t.key.transform(B),i=t.key.has_side_effects(e)),(i||n.rest)&&function(e){return(e instanceof G?e.name:e)instanceof fn}(t.value))t.value=t.value.transform(B),o.push(t);else{var r=t.value.transform(U);!r&&n.rest&&(r=t.value instanceof Q?at(Q,t.value,{elements:[]}):at(Z,t.value,{properties:[]})),r&&(t.value=r,o.push(t))}}),n.properties=o,n}return n instanceof fn?xe(n):void 0}),B=new Cn(function(c,h,_){var x=B.parent();if(i){var k=[];if(se=r(c,k)){if(function(e,n){var t=e.definition(),i=b[t.id];return!i||n[n instanceof f?"left":"expression"]===e&&(i===e&&t.references.length-t.replaced==1||oe(t,n)<0)}(se,c)&&(c instanceof f&&(O=ue(c),!0===c.write_only&&(O=O.drop_side_effect_free(e))),O||(O=at(Ce,c,{value:0}))),O){if(k.assign){var E=k.assign.drop_side_effect_free(e);E&&(E.write_only=!0,k.unshift(E))}switch(x instanceof We&&x.tail_node()!==c&&!O.has_side_effects(e)||k.push(O),k.length){case 0:return Zn.skip;case 1:return Dt(x,c,k[0].transform(B));default:return dt(c,k.map(function(e){return e.transform(B)}))}}}else if(c instanceof Sn&&c.expression instanceof _n&&oe(c.expression.definition(),c)<0)return at(Dn,c,{operator:"+",expression:c.expression})}if(c instanceof g&&"instanceof"==c.operator){if(!((se=c.right)instanceof _n))return;if(se.definition().id in b)return;var z=c.left.drop_side_effect_free(e),O=at(le,c).optimize(e);return z?dt(c,[z,O]):O}if(c instanceof w)return I.push(c),c.args=c.args.map(function(e){return e.transform(B)}),c.expression=c.expression.transform(B),c;if(q===n){if(t&&c!==n&&c instanceof V)if(!((ae=c.name.definition()).id in b)){L(c.name,"Dropping unused class {name}"),ae.eliminated++,h(c,B);var F=_i(c,!0);return x instanceof ce?F:(F=F.drop_side_effect_free(e,!0))?at($e,c,{body:F}):_?Zn.skip:at(re,c)}if(c instanceof A&&c.name&&M(c.name.definition())&&(c.name=null),c instanceof Ee){if(t&&c!==n&&c instanceof Te)if(!((ae=c.name.definition()).id in b))return L(c.name,"Dropping unused function {name}"),ae.eliminated++,x instanceof ce?(je(),gi(c,!0)):_?Zn.skip:at(re,c);if(je(),c instanceof Se&&c.name&&M(c.name.definition())&&(c.name=null),!(c instanceof o)){var C,j,H=e.drop_fargs(c,x);if(H&&x instanceof w&&x.expression===c)for(C=x.args,j=0;j<C.length&&!(C[j]instanceof Je);j++);var N=c.argnames,G=c.rest,X=!1,Z=!1;if(G){if(Z=!0,!C||j<N.length||G instanceof ln)G=G.transform(U);else G=(F=Ae(G,at(s,x,{elements:C.slice(N.length)}),xe,!c.uses_arguments,G)).name,C.length=N.length,F.value.elements.length&&[].push.apply(C,F.value.elements);G instanceof K&&!G.rest&&(G instanceof Q?0==G.elements.length&&(G=null):0==G.properties.length&&(G=null)),c.rest=G,G&&(H=!1,X=!0)}for(var ee=H?-1:c.length(),te=C&&!c.uses_arguments&&x!==e.parent(),ie=N.length;--ie>=0;){var se;if((se=N[ie])instanceof ln){var ae;(ae=se.definition()).id in b?(H=!1,oe(ae,se)<0&&(se.unused=null)):H?(L(se,"Dropping unused function argument {name}"),N.pop(),ae.eliminated++,se.unused=!0):se.unused=!0}else{var pe;if(Z=!0,!C||j<ie)pe=se.transform(U);else pe=(F=Ae(se,C[ie],xe,te,se)).name,F.value&&(C[ie]=F.value);pe?(H=!1,N[ie]=pe,X||(X=!(pe instanceof ln))):H?(J(se,"Dropping unused default argument {name}"),N.pop()):ie>ee?(J(se,"Dropping unused default argument assignment {name}"),se.name instanceof ln?se.name.unused=!0:X=!0,N[ie]=se.name):(J(se,"Dropping unused default argument value {name}"),N[ie]=se=se.clone(),se.value=at(Ce,se,{value:0}),X=!0)}}Z&&!X&&c.uses_arguments&&!B.has_directive("use strict")&&(c.rest=at(Q,c,{elements:[]})),R.push(c)}return c}if(c instanceof T&&c.argname instanceof K&&c.argname.transform(U),c instanceof W&&!(x instanceof he&&x.init===c)){var ve=[],ge=[],be=[],ye=[],ke=0,ze=c instanceof zn;switch(c.definitions.forEach(function(n){n.value&&(n.value=n.value.transform(B));var t=n.value;if(n.name instanceof K){var r=Ae(n.name,t,function(e){return i?e.definition().id in b?e:w(e)?e:ze&&!P(e)?e:null:e},!0);r.name?(n=at(On,n,{name:r.name,value:t=r.value}),E()):r.value&&ye.push(r.value)}else{var o,s,f,h,v=n.name.definition(),_=ze?P(n.name):zi(v);if(!_||!i||v.id in b)if(t&&((o=oe(v,n))<0||(h=t.tail_node())instanceof _n&&h.definition()===v)&&(n=n.clone(),(t=t.drop_side_effect_free(e))&&Fe.warn("Side effects in definition of variable {name} [{start}]",n.name),c instanceof Y?n.value=t||at(Ce,n,{value:0}):(n.value=null,t&&ye.push(t)),t=null,o>=0&&(a[v.id][o]=n)),t||c instanceof De)if(e.option("functions")&&!e.option("ie")&&_&&t&&1==D[v.id]&&0==v.assignments&&(f=t.tail_node())instanceof Se&&!S(v)&&!Rn(f)&&function(e,t){return 0==t.length?e===n.name.fixed_value():Wn(t,function(n){return e===n.fixed_value()})}(f,v.references)&&function(n){if(!ze||e.has_directive("use strict")||!(n instanceof _e))return x instanceof Ve;return x instanceof m||x instanceof de&&x.init===c||x instanceof me}(f)&&!1!==(s=function(n,t){if(!n.name)return null;var i,r=n.name.definition();if(r.orig.length>1)return null;if(r.assignments>0)return!1;if(r.name==t)return r;if(e.option("keep_fnames"))return!1;switch(t){case"await":i=Ln;break;case"yield":i=Un}return Wn(r.references,function(e){var r=e.scope;if(r.find_variable(t)!==v)return!1;if(i)do{if(r=r.resolve(),i(r))return!1}while(r!==n&&(r=r.parent_scope));return!0})&&r}(f,n.name.name))){var g;switch(Fe.warn("Declaring {name} as function [{start}]",n.name),f.CTOR){case l:g=u;break;case d:g=p;break;case _e:g=$;break;case AST_GeneratorFunction:g=AST_GeneratorDefun}var y=at(g,f);y.name=at(cn,n.name);var k=n.name.scope.resolve().def_function(y.name);s&&s.forEach(function(e){e.name=k.name,e.thedef=k,e.reference()}),ve.push(y),t!==f&&[].push.apply(ye,t.expressions.slice(0,-1))}else _&&D[v.id]>1&&!(x instanceof fe)&&v.orig.indexOf(n.name)>v.eliminated&&(D[v.id]--,ke++),E();else x instanceof fe?E():_&&D[v.id]>1?(Fe.info("Dropping declaration of variable {name} [{start}]",n.name),D[v.id]--,v.eliminated++):ge.push(n);else w(n.name)?((t=t&&t.drop_side_effect_free(e))&&ye.push(t),D[v.id]>1?(Fe.warn("Dropping duplicated declaration of variable {name} [{start}]",n.name),D[v.id]--,v.eliminated++):(n.value=null,ge.push(n))):((t=t&&t.drop_side_effect_free(e))?(Fe.warn("Side effects in initialization of unused variable {name} [{start}]",n.name),ye.push(t)):L(n.name,"Dropping unused variable {name}"),v.eliminated++)}function w(e){var n=e.definition();return n.orig[0]instanceof rn&&n.scope.resolve()===e.scope.resolve()}function E(){ye.length>0&&(0==be.length?ve.push(at($e,c,{body:dt(c,ye)})):t?(ye.push(t),n.value=dt(t,ye)):n.value=at(Dn,n,{operator:"void",expression:dt(n,ye)}),ye=[]),be.push(n)}}),ge.length){case 0:if(0==be.length)break;if(be.length==ke){[].unshift.apply(ye,be.map(function(e){Fe.info("Dropping duplicated definition of variable {name} [{start}]",e.name);var n=e.name.definition(),t=at(_n,e.name);n.references.push(t);var i=at(f,e,{operator:"=",left:t,right:e.value}),r=oe(n,e);return r>=0&&(a[n.id][r]=i),n.assignments++,n.eliminated++,i}));break}case 1:if(0==be.length){var Oe=ge[0].name.definition().id;if(Oe in v){c.definitions=ge,v[Oe].init=c;break}}default:var qe;be.length>0&&(qe=be[0].value)instanceof We&&(be[0].value=qe.tail_node(),ve.push(at($e,c,{body:dt(qe,qe.expressions.slice(0,-1))}))),c.definitions=ge.concat(be),ve.push(c)}return ye.length>0&&ve.push(at($e,c,{body:dt(c,ye)})),ne(ve,c,_)}if(c instanceof f)return h(c,B),c.left instanceof K?(F=Ae(c.left,c.right,function(e){return e},!0===c.write_only)).name?at(f,c,{operator:c.operator,left:F.name,right:F.value}):F.value?F.value:x instanceof We&&x.tail_node()!==c?Zn.skip:at(Ce,c,{value:0}):c;if(c instanceof we&&c.body instanceof de){if(h(c,B),c.body instanceof y){var Me=c.body;return c.body=Me.body.pop(),Me.body.push(c),_?Zn.splice(Me.body):Me}return c}if(c instanceof Ve)return je(),c;if(c instanceof pn)return!e.option("imports")||c.definition().id in b?c:_?Zn.skip:null}function je(){var e=q;q=c,h(c,B),q=e}},function(n,t){if(n instanceof y)return li(n,B.parent(),t);if(n instanceof fe){var r=n.body;if(!(r instanceof y))return;return n.body=r.body.pop(),r.body.push(n),t?Zn.splice(r.body):r}if(n instanceof de)return Gt(n,t);if(n instanceof ve){if(!i||!e.option("loops"))return;if(!Mt(n.body))return;var o=pe(n);if(!o)return;var s=o.definition();if(s.id in b)return;L(o,"Dropping unused loop variable {name}"),v[s.id]===n&&delete v[s.id];var a=[],f=n.object.drop_side_effect_free(e);return f&&(Fe.warn("Side effects in object of for-in loop [{start}]",f),a.push(at($e,n,{body:f}))),n.init instanceof W&&s.orig[0]instanceof rn&&a.push(n.init),ne(a,n,t)}if(n instanceof be)return n.properties&&0==n.properties.length&&(n.properties=null),n;if(n instanceof We){if(n.expressions.length>1)return;return Dt(B.parent(),n,n.expressions[0])}});B.push(e.parent()),B.directives=Object.create(e.directives),n.transform(B),n instanceof Ee&&1==n.body.length&&n.body[0]instanceof ee&&"use strict"==n.body[0].value&&(n.body.length=0),I.forEach(function(n){Hi(n,e,R)})}function L(e,n){Fe[e.definition().references.length>0?"info":"warn"](n+" [{start}]",e)}function J(e,n){e.name instanceof ln?L(e.name,n):Fe.info(n+" [{start}]",e)}function X(e){return e[e instanceof f?"right":"value"]}function ne(e,n,t){switch(e.length){case 0:return t?Zn.skip:at(re,n);case 1:return e[0];default:return t?Zn.splice(e):at(y,n,{body:e})}}function te(e,t){return e.scope.resolve()===n&&(e.fixed&&t.fixed||(a[e.id]=!1),!1!==a[e.id])}function ie(e,n){a[e.id]||(a[e.id]=[]),n.fixed.assigns&&ot(a[e.id],n.fixed.assigns)}function oe(e,n){var t=a[e.id];return t&&t.indexOf(n)}function se(e){x[e.id]>1&&!(e.id in b)&&(b[e.id]=!0,_.push(e)),x[e.id]=0}function ae(e,n,t){e.id in b||(n&&t?(b[e.id]=n,_.push(e)):(k[e.id]=n,E[e.id]=t))}function ue(n){var t=n.right;if(!n.write_only)return t;if(!(t instanceof g&&Jt[t.operator]))return t;if(!(t.left instanceof _n))return t;if(!(n.left instanceof _n))return t;var i=n.left.definition();return t.left.definition()!==i?t:t.right.has_side_effects(e)?t:(te(i,t.left)&&ie(i,t.left),t.right)}function pe(e){var n=e.init;if(n instanceof W)return(n=n.definitions[0].name)instanceof fn&&n;for(;n instanceof Be;)n=n.expression.tail_node();return n instanceof _n?n:void 0}function ye(t,o,s){t instanceof f&&t.left instanceof _n&&((y=t.left.definition()).scope.resolve()===n&&z.add(y.id,t));(t instanceof _n&&t.in_arg&&(D[t.definition().id]=0),t instanceof Tn&&t.expression instanceof _n)&&((y=t.expression.definition()).scope.resolve()===n&&z.add(y.id,t));var a=[];if(m=r(t,a)){if((T=m.definition()).scope.resolve()!==n&&n.variables.get(m.name)!==T)return;if(S(T)&&!Wn(n.argnames,function(e){return!e.match_symbol(function(e){if(e instanceof ln){var n=e.definition();return n.references.length>n.replaced}},!0)}))return;if("p"===t.write_only&&t.right.may_throw_on_access(e,!0))return;var c=a.assign;if(c&&(c.write_only=!0,c.walk(F)),a.forEach(function(e){e.walk(F)}),t instanceof f){var u=ue(t),l=!1;if(s&&!0===t.write_only&&!u.has_side_effects(e)?O.add(T.id,u):(u.walk(F),l="="==u.tail_node().operator),t.left===m)t.write_only&&!l||ae(T,m,E[T.id]);else{var p=m.fixed_value();p&&p.is_constant()||ae(T,k[T.id],!0)}}return te(T,m)&&kt(m,t)!==m&&ie(T,m),se(T),!0}if(t instanceof g){if("instanceof"!=t.operator)return;if(!((m=t.right)instanceof _n))return;var d=m.definition().id;if(!x[d])return;return t.left.walk(F),x[d]++,!0}if(t instanceof ve){var m,y;if(t.init instanceof _n&&q===n)(d=t.init.definition().id)in v||(v[d]=t);if(!i||!e.option("loops"))return;if(!Mt(t.body))return;if(t.init.has_side_effects(e))return;if(!(m=pe(t)))return;if((y=m.definition()).scope.resolve()!==n){var w=h(m.name);if(w===y||w&&w.redefined()===y)return}return t.object.walk(F),!0}if(t instanceof _n){var T;if((T=t.definition()).id in b||(b[T.id]=!0,_.push(T)),H(T.scope,t.scope)){var A=T.redefined();!A||A.id in b||(b[A.id]=!0,_.push(A))}return te(T,t)&&ie(T,t),!0}if(t instanceof Ve){var M=q;return q=t,o(),q=M,!0}}function xe(e){return e.definition().id in b?e:(e instanceof ln&&(e.unused=!0),null)}function ke(n,t){if(t.value=t.value.transform(B),!t.name.transform(n)){if(t.name instanceof K)return null;var i=t.value.drop_side_effect_free(e);if(!i)return null;L(t.name,"Side effects in default value of unused variable {name}"),(t=t.clone()).name.unused=null,t.value=i}return t}function Ae(n,t,i,r,a){var c=new Cn(function(n){if(n instanceof G){if(!(e.option("default_values")&&t&&t.is_defined(e))){var f=r;r=!1;var p=ke(c,n);return r=f,!p&&r&&t&&(t=t.drop_side_effect_free(e)),p}n===a?a=n=n.name:n=n.name}if(n instanceof Q){f=r;var d,h=t;t instanceof _n&&(r=!1,t=t.fixed_value()),t instanceof s?(d=!0,k=t.elements):(d=t&&t.is_string(e),k=!1);var v=[],_=r&&[],g=0;if(n.elements.forEach(function(e,n){(t=k&&k[n])instanceof ge?t=null:t instanceof Je&&(r&&(_.length=g,vi(h,_),[].push.apply(_,k.slice(n)),h.elements=_),t=k=!1),(e=e.transform(c))&&(v[g]=e),r&&t&&(_[g]=t),!e&&!t&&r&&k||g++}),t=k&&at(s,h,{elements:k.slice(n.elements.length)}),n.rest){var m=r;r=!1,n.rest=n.rest.transform(e.option("rests")?c:B),r=m,n.rest&&(v.length=g)}if(r&&(t&&!n.rest&&(t=t.drop_side_effect_free(e)),t instanceof s?t=t.elements:t instanceof We?t=t.expressions:t&&(t=[t]),t&&t.length&&(_.length=g,[].push.apply(_,t))),t=h,r=f,k&&_&&(vi(t,_),(t=t.clone()).elements=_),d){if(!n.rest)switch(v.length){case 0:if(n===a)break;return r&&(t=t.drop_side_effect_free(e)),null;case 1:if(!r)break;if(n===a)break;var b=v[0];if(b.has_side_effects(e))break;if(t.has_side_effects(e)&&b.match_symbol(function(e){return e instanceof Be}))break;return t=at(Xe,n,{expression:t,property:at(Ce,n,{value:0})}),b}}else v.length=n.elements.length;return vi(n,v),n.elements=v,n}if(n instanceof Z){var y,x,k;f=r,h=t;t instanceof _n&&(r=!1,t=t.fixed_value()),t instanceof je&&(y=[],x=new Jn,k=t.properties.map(function(n,t){if((n=n.clone())instanceof Je)x=!1;else{var i=n.key;i instanceof Fe&&(i=i.evaluate(e,!0)),i instanceof Fe?x=!1:!x||n instanceof Re||x.set(i,n),y[t]=i}return n})),n.rest&&(t=!1,n.rest=n.rest.transform(e.option("rests")?c:B));var w=new Jn,E=r&&new Jn,T=[];if(n.properties.map(function(n){var t=n.key;return t instanceof Fe&&(n.key=t=t.transform(B),t=t.evaluate(e,!0)),t instanceof Fe?E=!1:w.set(t,!w.has(t)),t}).forEach(function(e,i){var s,a=n.properties[i];if(e instanceof Fe)r=!1,t=!1,s=a.value.transform(c)||l(a.value);else{r=E&&w.get(e);var f=x&&x.get(e);f?(t=f.value)instanceof o&&(t=!1):t=!1,(s=a.value.transform(c))?E&&E.set(e,!1):((n.rest||u(a))&&(s=l(a.value)),E&&!E.has(e)&&(f?(E.set(e,f),null===t&&x.set(e,u(f)&&at(He,f,{key:f.key,value:at(Ce,f,{value:0})}))):E.set(e,!0))),t&&(f.value=t)}s&&(a.value=s,T.push(a))}),t=h,r=f,E&&y&&((t=t.clone()).properties=Zn(k,function(t,i){if(t instanceof Je)return t;var r=y[i];if(r instanceof Fe)return t;if(E.has(r)){var o=E.get(r);if(!o)return t;if(o===t)return x.get(r)||Zn.skip}else if(n.rest)return t;var s=t.value.drop_side_effect_free(e);return s?(t.value=s,t):u(t)?at(He,t,{key:t.key,value:at(Ce,t,{value:0})}):Zn.skip})),t&&!n.rest)switch(T.length){case 0:if(n===a)break;if(t.may_throw_on_access(e,!0))break;return r&&(t=t.drop_side_effect_free(e)),null;case 1:if(!r)break;if(n===a)break;var S=T[0];if(S.key instanceof Fe)break;if(S.value.has_side_effects(e))break;if(t.has_side_effects(e)&&S.value.match_symbol(function(e){return e instanceof Be}))break;return t=at(Xe,n,{expression:t,property:xt(S.key,S)}),S.value}return n.properties=T,n}return!(n=n instanceof ge?null:i(n))&&r&&t&&(t=t.drop_side_effect_free(e)),n});return{name:n.transform(c),value:t};function u(n){return n.key instanceof Fe&&n.key.has_side_effects(e)}function l(n){return n instanceof G?l(n.name):n instanceof K?(null===t?t=at(Ce,n,{value:0}):t&&(t.may_throw_on_access(e,!0)?t=at(s,n,{elements:t instanceof We?t.expressions:[t]}):function e(n){if(n instanceof f)n.write_only=!1,e(n.right);else if(n instanceof g){if(!Jt[n.operator])return;e(n.left),e(n.right)}else n instanceof N?(e(n.consequent),e(n.alternative)):n instanceof We?e(n.tail_node()):n instanceof Tn&&(n.write_only=!1)}(t)),at(Z,n,{properties:[]})):(n.unused=null,n)}}}),Ve.DEFMETHOD("hoist_declarations",function(e){if(!e.has_directive("use asm")){var n=e.option("hoist_funs"),t=e.option("hoist_vars"),i=this;if(t){var r=0;i.walk(new jn(function(e){return r>1||(e instanceof fe||(e instanceof Ve&&e!==i||(e instanceof zn?(r++,!0):void 0)))})),r<=1&&(t=!1)}if(n||t){var o=new Jn,s=[],a=[],f=new Jn,c=new Cn(function(r,u,l){if(r!==i){if(r instanceof ee)return s.push(r),l?Zn.skip:at(re,r);if(r instanceof Te)return n?(p=c.parent())instanceof fe?r:p instanceof ce?r:p!==i&&e.has_directive("use strict")?r:(a.push(r),l?Zn.skip:at(re,r)):r;if(r instanceof zn){if(!t)return r;var p;if((p=c.parent())instanceof fe)return r;if(!Wn(r.definitions,function(e){var n=e.name;return n instanceof gn&&!o.has(n.name)&&i.find_variable(n.name)===n.definition()}))return r;r.definitions.forEach(function(e){f.set(e.name.name,e)});var d=r.to_assignments();if(p instanceof he&&p.init===r){if(d)return d;var h=r.definitions[0].name;return at(_n,h)}return p instanceof de&&p.init===r?d:d?at($e,r,{body:d}):l?Zn.skip:at(re,r)}return r instanceof Ve?r:r instanceof an?(o.set(r.name,!0),r):void 0}});if(i.transform(c),f.size()>0){var u=[];i instanceof Ee&&i.each_argname(function(e){Wn(e.definition().references,function(e){return!e.in_arg})&&f.del(e.name)}),f.each(function(e,n){(e=e.clone()).name=e.name.clone(),e.value=null,u.push(e),f.set(n,e),e.name.definition().orig.unshift(e.name)}),u.length>0&&a.push(at(zn,i,{definitions:u}))}i.body=s.concat(a,i.body)}}}),Ve.DEFMETHOD("process_returns",rt),$.DEFMETHOD("process_returns",function(e){if(e.option("booleans")&&!(e.parent()instanceof ce))switch(yi(this.name.definition(),bi(this),e)){case"d":wi(e,this,!0);break;case!0:xi(this,e)}}),_e.DEFMETHOD("process_returns",function(e){if(e.option("booleans")){var n=!0,t=bi(this);if(!this.name||l(this.name.definition())){var i=e.parent();if(i instanceof f){if("="!=i.operator)return;if(!((o=i.left)instanceof _n))return;if(!l(o.definition()))return}else if(i instanceof w&&i.expression!==this){var r=i.expression;if(r instanceof _n&&(r=r.fixed_value()),!(r instanceof Ee))return;if(r.uses_arguments||r.pinned())return;for(var o,s=i.args,a=0;a<s.length;a++){var c=s[a];if(c===this){if(!(o=r.argnames[a])&&r.rest)return;break}if(c instanceof Je)return}if(o instanceof G&&(o=o.name),o instanceof ln&&!l(o.definition()))return}else{if("Call"!=i.TYPE)return;e.pop();var u=e.in_boolean_context();switch(e.push(this),u){case!0:n=!1;case"d":break;default:return}}n?wi(e,this,!0):xi(this,e)}}function l(i){switch(yi(i,t,e)){case!0:n=!1;case"d":return!0}}}),b.DEFMETHOD("var_names",function(){var e=this._var_names;return e||(this._var_names=e=new Jn,this.enclosed.forEach(function(n){e.set(n.name,!0)}),this.variables.each(function(n,t){e.set(t,!0)})),e}),Ve.DEFMETHOD("make_var",function(e,n,t){var i=[this];n instanceof fn&&n.definition().references.forEach(function(e){var n=e.scope;do{if(!ot(i,n))return;n=n.parent_scope}while(n&&n!==this)});for(var r=t=t.replace(/^[^a-z_$]|[^a-z0-9_$]/gi,"_"),o=0;!Wn(i,function(e){return!e.var_names().has(r)});o++)r=t+"$"+o;var s=at(e,n,{name:r,scope:this}),a=this.def_variable(s);return i.forEach(function(e){e.enclosed.push(a),e.var_names().set(r,!0)}),s}),Ve.DEFMETHOD("hoist_properties",function(e){if(e.option("hoist_props")&&!e.has_directive("use asm")){var n=this;if(!Rn(n)||!n.value){var t=n instanceof kn&&e.top_retain||ct,i=Object.create(null),r=new Cn(function(e,t){if(e instanceof f){if("="!=e.operator)return;if(!e.write_only)return;if(!o(e.left,e.right,1))return;t(e,r);var s=new Jn,a=[],c=[];return e.right.properties.forEach(function(t){var i=d(gn,e.left,t.key);c.push(at(On,e,{name:i,value:null}));var r=at(_n,e,{name:i.name,scope:n,thedef:i.definition()});r.reference(),a.push(at(f,e,{operator:"=",left:r,right:t.value}))}),s.value=e.right,i[e.left.definition().id]=s,n.body.splice(n.body.indexOf(r.stack[1])+1,0,at(zn,e,{definitions:c})),dt(e,a)}if(e instanceof Ve){if(e===n)return;var u=r.parent();if("Call"==u.TYPE&&u.expression===e)return;return e}if(e instanceof On){if(!o(e.name,e.value,0))return;t(e,r);s=new Jn;var l=[],p=e.clone();return p.value=e.name instanceof an?at(Ce,e,{value:0}):null,l.push(p),e.value.properties.forEach(function(n){l.push(at(On,e,{name:d(e.name.CTOR,e.name,n.key),value:n.value}))}),s.value=e.value,i[e.name.definition().id]=s,Zn.splice(l)}function d(e,t,i){var r=n.make_var(e,t,t.name+"_"+i);return s.set(i,r.definition()),r}});n.transform(r),n.transform(new Cn(function(e,n){if(e instanceof Be){if(!(e.expression instanceof _n))return;if(!(o=i[e.expression.definition().id]))return;if(e.expression.fixed_value()!==o.value)return;var t=o.get(e.get_property()),r=at(_n,e,{name:t.name,scope:e.expression.scope,thedef:t});return r.reference(),r}if(e instanceof _n){var o;if(!(o=i[e.definition().id]))return;if(e.fixed_value()!==o.value)return;return at(je,e,{properties:[]})}}))}}function o(i,r,o){if(i instanceof tn){var s=i.definition();if(s.assignments==o&&s.references.length-s.replaced!=o&&!s.single_use&&n.find_variable(i.name)===s&&!t(s)&&i.fixed_value()===r){var a=i.fixed||s.fixed;if(!(a.direct_access||a.escaped&&1==a.escaped.depth))return r instanceof je&&r.properties.length>0&&P(i,e)&&Wn(r.properties,function(e){return sr(e)&&"__proto__"!==e.key})}}}}),function(e){function n(e,n,t,i){for(var r=e.length,o=[],s=!1,a=0;a<r;a++){var f,c=e[a];(f=i&&c instanceof Je?i(c,n,t):c.drop_side_effect_free(n,t))!==c&&(s=!0),f&&(o.push(f),t=!1)}return o.length?s?o:e:null}function t(e,n,t){var i=e.expression;return i.is_string(n)?i.drop_side_effect_free(n,t):e}function i(e){return e instanceof Je?at(s,e,{elements:[e]}):e}e(Fe,pt),e(o,ut),e(s,function(e,r){var o=n(this.elements,e,r,t);return o?o===this.elements&&Wn(o,function(e){return e instanceof Je})?this:dt(this,o.map(i)):null}),e(f,function(e){var n=this.left;if(n instanceof Be){var t=n.expression;if(t.may_throw_on_access(e,!0))return this;if(e.has_directive("use strict")&&t.is_constant())return this}return n.has_side_effects(e)?this:Jt[this.operator.slice(0,-1)]?this:(this.write_only=!0,In(n).is_constant_expression(e.find_parent(Ve))?this.right.drop_side_effect_free(e):this)}),e(v,function(e){if(!e.option("awaits"))return this;var n=this.expression;if(!Wi(e,n))return this;n instanceof Dn&&"!"==n.operator&&(n=n.expression);var t=n.drop_side_effect_free(e);if(t===n)return this;t?Wi(e,t)||(t=t.negate(e)):t=at(Ce,n,{value:0});var i=this.clone();return i.expression=t,i}),e(g,function(e,n){var t=this.left,i=this.right,r=this.operator;if(!Vi(r,i,e))return(o=t.drop_side_effect_free(e,n))===t?this:((a=this.clone()).left=o||at(Ce,t,{value:0}),a);var o,s=i.drop_side_effect_free(e,n);if(!s)return t.drop_side_effect_free(e,n);if(Jt[r]&&s.has_side_effects(e)){var a=this;if(s!==i&&((a=a.clone()).right=s.drop_side_effect_free(e)),"??"==r)return a;var f=a.clone();f.operator="&&"==r?"||":"&&",f.left=t.negate(e,n);var c=f.right.tail_node();c instanceof g&&f.operator==c.operator&&Ki(f);var u=n?Qt:Kt;return"&&"==r?u(a,f):u(f,a)}return(o=t.drop_side_effect_free(e,n))?(s=s.drop_side_effect_free(e))?dt(this,[o,s]):o:s}),e(w,function(e,r){var o=this;if(o.is_expr_pure(e)){o.pure&&Fe.warn("Dropping __PURE__ call [{start}]",o);var s=n(o.args,e,r,t);return s&&dt(o,s.map(i))}var a=o.expression;if(o.is_call_pure(e))return(p=o.args.slice()).unshift(a.expression),(p=n(p,e,r,t))&&dt(o,p.map(i));if(e.option("yields")&&Un(a)){var f=o.clone();f.expression=at(_e,a),f.expression.body=[];var c=f.transform(e);if(c!==f)return c.drop_side_effect_free(e,r)}var u=wi(e,a);if(u&&((o=o.clone()).expression=u,a._squeezed&&(o.expression._squeezed=!0)),o instanceof Oe){var l=a;if(l instanceof _n&&(l=l.fixed_value()),l instanceof Ee){var p;if(function(e,n){e.new=!0;var t=Wn(e.body,function(e){return!e.has_side_effects(n)})&&Wn(e.argnames,function(e){return!e.match_symbol(ct)})&&!(e.rest&&e.rest.match_symbol(ct));return e.new=!1,t}(l,e))return(p=o.args.slice()).unshift(a),(p=n(p,e,r,t))&&dt(o,p.map(i));l.contains_this()||((o=at(w,o)).expression=o.expression.clone(),o.args=o.args.slice())}}return o.call_only=!0,o}),e(A,function(e,t){for(var i=this,o=[],s=[],f=0,c=i.properties,u=0;u<c.length;u++){var l=c[u];if(l.key instanceof Fe&&o.push(l.key),Rt(l)){var p=l.value;if(p.has_side_effects(e)){if(p.contains_this())return i;l instanceof q?(f++,s.push(l)):s.push(p)}}}var d=i.extends;if(d&&(d instanceof _n&&(d=d.fixed_value()),(d=!r(d))||o.unshift(i.extends)),(o=n(o,e,t))&&(t=!1),s=n(s,e,t),!o){if(!d&&!s&&!i.name)return null;o=[]}if(d||i.name||!e.has_directive("use strict")){var h=_i(i);return d||(h.extends=null),h.properties=[],s?s.length==f?(o.length&&s.unshift(at(z,i,{key:dt(i,o),value:null})),h.properties=s):h.properties.push(at(z,i,{static:!0,key:o.length?dt(i,o):"c",value:v()})):o.length&&h.properties.push(at(M,i,{key:dt(i,o),value:at(_e,i,{argnames:[],body:[]}).init_vars(h)})),h}return s&&o.push(at(w,i,{expression:at(a,i,{argnames:[],body:[],value:v()}).init_vars(i.parent_scope),args:[]})),dt(i,o);function v(){return dt(i,s.map(function(e){if(!(e instanceof q))return e;var n=at(a,e.value);return n.argnames=[],at(w,e,{expression:n,args:[]})}))}}),e(N,function(e){var n,t,i=this.consequent.drop_side_effect_free(e),r=this.alternative.drop_side_effect_free(e);return i===this.consequent&&r===this.alternative?this:(e.option("ie")&&(n=[],i instanceof _e&&(n.push(i),i=null),r instanceof _e&&(n.push(r),r=null)),i?r?((t=this.clone()).consequent=i,t.alternative=r):t=at(g,this,{operator:"&&",left:this.condition,right:i}):t=r?at(g,this,{operator:"||",left:this.condition,right:r}):this.condition.drop_side_effect_free(e),n?(t&&n.push(t),0==n.length?null:dt(this,n)):t)}),e(I,ut),e(te,function(e,n){var t=this.expression;return t.may_throw_on_access(e)?this:t.drop_side_effect_free(e,n)}),e(_e,function(e){return ki(this,e)?null:this}),e(Se,ut),e(je,function(e,t){var i=[];this.properties.forEach(function(e){e instanceof Je?i.push(e):(e.key instanceof Fe&&i.push(e.key),i.push(e.value))});var r=n(i,e,t,function(e,n,t){var i=e.expression;return i.safe_to_spread()?i.drop_side_effect_free(n,t):e});return r?r!==i||Wn(r,function(e){return!(e instanceof Je)})?dt(this,r.map(function(e){return e instanceof Je?at(je,e,{properties:[e]}):e})):this:null}),e(Ye,ut),e(We,function(e,t){var i=n(this.expressions,e,t);if(!i)return null;var r,o,s,a=i.length-1,c=i[a];if(e.option("awaits")&&a>0&&c instanceof v&&c.expression.is_constant()){var u=(i=i.slice(0,-1))[--a];c.expression=Wi(e,u)?u:u.negate(e),i[a]=c}return e.option("conditionals")&&a>0&&(r=i[a-1])instanceof f&&"="==r.operator&&(s=r.left)instanceof _n&&(o=Ii(e,s.definition(),r.right,c))&&((r=r.clone()).right=o,(i=i.slice(0,-2)).push(r.drop_side_effect_free(e,t))),i===this.expressions?this:dt(this,i)}),e(Xe,function(e,n){var t=this.expression;if(t.may_throw_on_access(e))return this;var i=this.property;return(t=t.drop_side_effect_free(e,n))?(i=i.drop_side_effect_free(e))?dt(this,[t,i]):t:i.drop_side_effect_free(e,n)}),e(_n,function(e){return this.is_declared(e)&&P(this,e)?null:this}),e(mn,function(e,n){var t=this;if(t.is_expr_pure(e)){var i=t.expressions;return 0==i.length?null:dt(t,i).drop_side_effect_free(e,n)}var r=t.tag,o=wi(e,r);return o&&((t=t.clone()).tag=o,r._squeezed&&(t.tag._squeezed=!0)),t}),e(Tn,function(e,n){var t=this.expression;if(Et[this.operator])return this.write_only=!t.has_side_effects(e),this;if("typeof"==this.operator&&t instanceof _n&&P(t,e))return null;var i=t.drop_side_effect_free(e,n);return n&&i&&Ht(i)?i===t&&"!"==this.operator?this:i.negate(e,n):i})}(function(e,n){e.DEFMETHOD("drop_side_effect_free",n)}),e($e,function(e,n){if(n.option("side_effects")){var t=e.body,i=t.drop_side_effect_free(n,!0);if(!i)return Fe.warn("Dropping side-effect-free statement [{start}]",e),at(re,e);if(i!==t)return at($e,e,{body:i})}return e}),e(qn,function(e,n){return n.option("loops")?at(de,e).optimize(n):e}),e(ne,function(e,n){if(!n.option("loops"))return e;var t=Si(n,e.condition);if(!(t instanceof Fe)){if(t&&!Ei(e,n.parent(),R))return at(de,e,{body:at(y,e.body,{body:[e.body,at($e,e.condition,{body:e.condition})]})}).optimize(n);if(!Ei(e,n.parent()))return at(y,e.body,{body:[e.body,at($e,e.condition,{body:e.condition})]}).optimize(n)}if(e.body instanceof y&&!Ei(e,n.parent(),R)){for(var i=e.body.body,r=i.length;--r>=0;){var o=i[r];if(o instanceof me&&!o.alternative&&o.body instanceof k&&n.loopcontrol_target(o.body)===e){if(s(o.condition))break;e.condition=at(g,e,{operator:"&&",left:o.condition.negate(n),right:e.condition}),i.splice(r,1)}else if(o instanceof $e){if(s(o.body))break;e.condition=dt(e,[o.body,e.condition]),i.splice(r,1)}else if(!Bt(o,!0))break}e.body=li(e.body,n.parent())}return e.body instanceof re?at(de,e).optimize(n):e.body instanceof $e?at(de,e,{condition:dt(e.condition,[e.body.body,e.condition]),body:at(re,e)}).optimize(n):e;function s(n){var t=!1;return n.walk(new jn(function(n){return!!t||(n instanceof _n?(it(n.definition(),e.enclosed)||(t=!0),!0):void 0)})),t}}),e(de,function(e,n){if(!n.option("loops"))return e;if(n.option("side_effects")&&(e.init&&(e.init=e.init.drop_side_effect_free(n)),e.step&&(e.step=e.step.drop_side_effect_free(n))),e.condition){var t=Si(n,e.condition);if(t)t instanceof Fe||(e.body=at(y,e.body,{body:[at($e,e.condition,{body:e.condition}),e.body]}),e.condition=null);else if(n.option("dead_code")){var i=[];return Bn(e.init)?i.push(e.init):e.init&&i.push(at($e,e.init,{body:e.init})),i.push(at($e,e.condition,{body:e.condition})),Wt(n,e.body,i),at(y,e,{body:i}).optimize(n)}}return function e(n,t){var i=a(n.body);if(t.option("dead_code")&&(i instanceof k||i instanceof R&&f(i)||i instanceof oe)){var r=[];Bn(n.init)?r.push(n.init):n.init&&r.push(at($e,n.init,{body:n.init}));var o=f(i)||i instanceof oe;return n.condition&&o?r.push(at(me,n,{condition:n.condition,body:i,alternative:null})):n.condition?r.push(at($e,n.condition,{body:n.condition})):o&&r.push(i),Wt(t,n.body,r),at(y,n,{body:r})}if(i instanceof me){var s=a(i.body);if(s instanceof k&&!f(s))return n.condition?n.condition=at(g,n.condition,{left:n.condition,operator:"&&",right:i.condition.negate(t)}):n.condition=i.condition.negate(t),r=Ft(i.alternative),Wt(t,i.body,r),c(r);if((s=a(i.alternative))instanceof k&&!f(s))return n.condition?n.condition=at(g,n.condition,{left:n.condition,operator:"&&",right:i.condition}):n.condition=i.condition,r=Ft(i.body),Wt(t,i.alternative,r),c(r)}return n;function a(e){return e instanceof y?e.body[0]:e}function f(e){return t.loopcontrol_target(e)!==t.self()}function c(i){return n.body instanceof y?(n.body=n.body.clone(),n.body.body=i.concat(n.body.body.slice(1)),n.body=n.body.transform(t)):n.body=at(y,n.body,{body:i}).transform(t),e(n,t)}}(e,n)}),e(he,function(e,n){if(n.option("varify")&&Ot(e.init)){var t=e.init.definitions[0].name;(t instanceof K||t instanceof hn)&&!t.match_symbol(function(e){if(e instanceof fn){var t=e.definition();return!Xi(t)||Oi(n,t)}},!0)&&(e.init=qi(e.init,e.resolve()))}return e}),e(me,function(e,n){if(Mt(e.alternative)&&(e.alternative=null),!n.option("conditionals"))return e;if(n.option("booleans")&&!e.condition.has_side_effects(n)&&Di(n,e.condition),n.option("dead_code")){var t=Si(n,e.condition);if(!t){Fe.warn("Condition always false [{start}]",e.condition);var i=[at($e,e.condition,{body:e.condition}).transform(n)];return Wt(n,e.body,i),e.alternative&&i.push(e.alternative),at(y,e,{body:i}).optimize(n)}if(!(t instanceof Fe)){Fe.warn("Condition always true [{start}]",e.condition);i=[at($e,e.condition,{body:e.condition}).transform(n),e.body];return e.alternative&&Wt(n,e.alternative,i),at(y,e,{body:i}).optimize(n)}}var r=e.condition.negate(n),o=e.condition.print_to_string().length,s=r.print_to_string().length,a=s<o;if(e.alternative&&a){a=!1,e.condition=r;var c=e.body;e.body=e.alternative,e.alternative=Mt(c)?null:c}var u=[],l=[],p=[],d=Y(e.body,u,l,p),h=[],v=[],_=[],m=Y(e.alternative,h,v,_);if(d instanceof y||m instanceof y){i=[];var b=[];if(d&&([].push.apply(i,u),[].push.apply(b,l),d instanceof y?e.body=d:0==d.length?e.body=at(re,e.body):e.body=at($e,e.body,{body:dt(e.body,d)}),p.forEach(bn)),m&&([].push.apply(i,h),[].push.apply(b,v),m instanceof y?e.alternative=m:0==m.length?e.alternative=null:e.alternative=at($e,e.alternative,{body:dt(e.alternative,m)}),_.forEach(bn)),b.length>0&&i.push(at(zn,e,{definitions:b})),i.length>0)return i.push(e.transform(n)),at(y,e,{body:i}).optimize(n)}else if(d&&m){i=u.concat(h);return(l.length>0||v.length>0)&&i.push(at(zn,e,{definitions:l.concat(v)})),0==d.length?i.push(at($e,e.condition,{body:m.length>0?at(g,e,{operator:"||",left:e.condition,right:dt(e.alternative,m)}).transform(n):e.condition.clone()}).optimize(n)):0==m.length?(o===s&&!a&&e.condition instanceof g&&"||"==e.condition.operator&&(a=!0),i.push(at($e,e,{body:at(g,e,{operator:a?"||":"&&",left:a?r:e.condition,right:dt(e.body,d)}).transform(n)}).optimize(n))):i.push(at($e,e,{body:at(N,e,{condition:e.condition,consequent:dt(e.body,d),alternative:dt(e.alternative,m)})}).optimize(n)),p.forEach(bn),_.forEach(bn),at(y,e,{body:i}).optimize(n)}if(Mt(e.body)&&(e=at(me,e,{condition:r,body:e.alternative,alternative:null})),e.alternative instanceof oe&&e.body.TYPE==e.alternative.TYPE){var x=e.body.value,k=e.alternative.value;if(!x&&!k)return at(y,e,{body:[at($e,e,{body:e.condition}),e.body]}).optimize(n);if(x&&k||!function(){var e=!1,t=0,i=n.self();do{if(i instanceof T)n.parent(t).bfinally&&(e=!0),t++;else if(i instanceof pe)t++;else{if(i instanceof Ve)return e&&$n(i);i instanceof En&&i.bfinally&&(e=!0)}}while(i=n.parent(t++))}()){var w=at(e.body.CTOR,e,{value:at(N,e,{condition:e.condition,consequent:x||at(An,e.body).transform(n),alternative:k||at(An,e.alternative).transform(n)})});return w instanceof Ge&&(w.in_bool=e.body.in_bool||e.alternative.in_bool),w}}if(e.body instanceof me&&!e.body.alternative&&!e.alternative&&(e=at(me,e,{condition:at(g,e.condition,{operator:"&&",left:e.condition,right:e.body.condition}),body:e.body.body,alternative:null})),ci(e.body)&&e.alternative){var E=e.alternative;return e.alternative=null,at(y,e,{body:[e,E]}).optimize(n)}if(ci(e.alternative)){i=e.body;return e.body=e.alternative,e.condition=a?r:e.condition.negate(n),e.alternative=null,at(y,e,{body:[e,i]}).optimize(n)}if(e.alternative){for(var S=j(e.body),D=H(S),A=j(e.alternative),z=H(A),O=[];D>=0&&z>=0;){var q=S[D],F=A[z];if(q.equals(F))S.splice(D--,1),A.splice(z--,1),O.unshift(At(q,F));else{if(!(q instanceof $e))break;if(!(F instanceof $e))break;var M=q.body.tail_node(),C=F.body.tail_node();if(!M.equals(C))break;D=P(S,q.body,D),z=P(A,F.body,z),O.unshift(at($e,M,{body:At(M,C)}))}}if(O.length>0)return e.body=S.length>0?at(y,e,{body:S}):at(re,e),e.alternative=A.length>0?at(y,e,{body:A}):null,O.unshift(e),at(y,e,{body:O}).optimize(n)}return n.option("typeofs")&&Ti(e.condition,e.body,e.alternative),e;function j(e){return e instanceof y?e.body:[e]}function H(e){for(var n=e.length;--n>=0&&Bt(e[n],!0););return n}function P(e,n,t){return n instanceof We?e[t]=at($e,n,{body:dt(n,n.expressions.slice(0,-1))}):e.splice(t--,1),t}function Y(e,t,i,r){if(null==e)return[];if(e instanceof y){for(var o=[],s=0;s<e.body.length;s++){var a=e.body[s];if(!(a instanceof re)){if(a instanceof oe){if(0==s)return;o.length>0&&(a=a.clone(),o.push(a.value||at(An,a).transform(n)),a.value=dt(e,o));var c=e.clone();return c.body=c.body.slice(s+1),c.body.unshift(a),c}if(a instanceof Te)t.push(a);else if(a instanceof $e){if(!n.option("sequences")&&o.length>0)return;o.push(a.body)}else{if(!(a instanceof zn))return;if(!n.option("sequences")&&o.length>0)return;a.remove_initializers(n,i),a.definitions.forEach(u)}}}return o}if(e instanceof Te)return t.push(e),[];if(e instanceof re)return[];if(e instanceof $e)return[e.body];if(e instanceof zn){o=[];return e.remove_initializers(n,i),e.definitions.forEach(u),o}function u(e){e.value&&o.push(at(f,e,{operator:"=",left:e.name.convert_symbol(_n,function(e){r.push(e)}),right:e.value}))}}}),e(en,function(e,n){if(!n.option("switches"))return e;if(!n.option("dead_code"))return e;for(var t,i,r,o=[],s=[],a=[],f=0,c=e.body.length;f<c;f++){if((t=e.body[f])instanceof B){var u=o[o.length-1];if(i||T(t.body[0],n)&&(!u||ci(u))){D(t,u);continue}i=t}else{var l=t.expression,p=at(g,e,{operator:"===",left:e.expression,right:l}).evaluate(n,!0);if(!p){l.has_side_effects(n)&&a.push(l),D(t,o[o.length-1]);continue}if(!(p instanceof Fe)){if(i){var d=o.indexOf(i);o.splice(d,1),D(i,o[d-1]),i=null}for(l.has_side_effects(n)?r=t:i=t=at(B,t);++f<c;)D(e.body[f],t)}}if(f+1>=c||ci(t)){u=o[o.length-1];var h=t.body;if(ci(u))switch(u.body.length-h.length){case 1:if(!T(m=u.body[u.body.length-1],n))break;h=h.concat(m);case 0:var v=at(y,u),_=at(y,t,{body:h});v.equals(_)&&(u.body=[])}}a.length&&(t instanceof B?o.push(at(E,e,{expression:dt(e,a),body:[]})):(a.push(t.expression),t.expression=dt(e,a)),a=[]),o.push(t)}for(a.length&&!r&&o.push(at(E,e,{expression:dt(e,a),body:[]}));t=o[o.length-1];){var m;if(T(m=t.body[t.body.length-1],n)&&t.body.pop(),t===i){if(!Ct(t))break}else{if(t.expression.has_side_effects(n))break;if(i){if(!Ct(i))break;if(o[o.length-2]!==i)break;i.body=i.body.concat(t.body),t.body=[]}else if(!Ct(t))break}D(t),o.pop()===i&&(i=null)}if(!t)return s.push(at($e,e.expression,{body:e.expression})),a.length&&s.push(at($e,e,{body:dt(e,a)})),at(y,e,{body:s}).optimize(n);if(t===i)for(;(t=o[o.length-2])&&!(t instanceof B)&&Ct(t);){if((l=t.expression).has_side_effects(n)){if((u=o[o.length-3])&&!ci(u))break;i.body.unshift(at($e,e,{body:l}))}D(t),o.splice(-2,1)}if(o[0].body=s.concat(o[0].body),e.body=o,n.option("conditionals"))switch(o.length){case 1:if(!S(o[0]))break;l=o[0].expression,h=o[0].body.slice();return o[0]!==i&&o[0]!==r?at(me,e,{condition:at(g,e,{operator:"===",left:e.expression,right:l}),body:at(y,e,{body:h}),alternative:null}).optimize(n):(l&&h.unshift(at($e,l,{body:l})),h.unshift(at($e,e.expression,{body:e.expression})),at(y,e,{body:h}).optimize(n));case 2:if(!it(i,o)||!S(o[1]))break;var b=(h=o[0].body.slice()).length&&T(h[h.length-1],n);if(b&&h.pop(),!Wn(h,S))break;var x=o[1].body.length&&at(y,o[1]),w=at(me,e,{condition:at(g,e,o[0]===i?{operator:"!==",left:e.expression,right:o[1].expression}:{operator:"===",left:e.expression,right:o[0].expression}),body:at(y,o[0],{body:h}),alternative:b&&x||null});return!b&&x&&(w=at(y,e,{body:[w,x]})),w.optimize(n)}return e;function T(n,t){return n instanceof k&&t.loopcontrol_target(n)===e}function S(n){var t=!1,i=new jn(function(e){if(t||e instanceof Ee||e instanceof $e)return!0;T(e,i)&&(t=!0)});return i.push(e),n.walk(i),!t}function D(e,t){t&&!ci(t)?t.body=t.body.concat(e.body):Wt(n,e,s)}}),e(En,function(e,n){if(e.body=Vt(e.body,n),n.option("dead_code")){if(Ct(e)&&!(e.bcatch&&e.bcatch.argname&&e.bcatch.argname.match_symbol(function(e){return e instanceof rn&&!P(e)},!0))){var t=[];return e.bcatch&&(Wt(n,e.bcatch,t),t.forEach(function(e){e instanceof zn&&e.definitions.forEach(function(e){var n=e.name.definition().redefined();n&&(e.name=e.name.clone(),e.name.thedef=n)})})),t.unshift(at(y,e).optimize(n)),e.bfinally&&t.push(at(y,e.bfinally).optimize(n)),at(y,e,{body:t}).optimize(n)}if(e.bfinally&&Ct(e.bfinally)){t=at(y,e.bfinally).optimize(n);if(t=e.body.concat(t),!e.bcatch)return at(y,e,{body:t}).optimize(n);e.body=t,e.bfinally=null}}return e}),Y.DEFMETHOD("remove_initializers",Ai(function(e,n){return at(An,n).optimize(e)})),De.DEFMETHOD("remove_initializers",Ai(ut)),zn.DEFMETHOD("remove_initializers",Ai(ut)),W.DEFMETHOD("to_assignments",function(){var e=this.definitions.reduce(function(e,n){var t=n.name.definition(),i=n.value;if(i){i instanceof We&&(i=i.clone());var r=at(_n,n.name),o=at(f,n,{operator:"=",left:r,right:i});e.push(o);var s=function(){return o.right};s.assigns=[o],s.direct_access=t.direct_access,s.escaped=t.escaped,r.fixed=s,t.references.forEach(function(e){if(e.fixed){var i=e.fixed.assigns;i&&i[0]===n&&(i.length>1||e.fixed.to_binary||e.fixed.to_prefix?i[0]=o:(e.fixed=s,t.fixed===e.fixed&&(t.fixed=s)))}}),t.references.push(r)}return t.assignments++,t.eliminated++,t.single_use=!1,e},[]);return 0==e.length?null:dt(this,e)}),e(Y,Mi),e(De,Mi),e(w,function(e,n){var t=e.expression,i=Ci(e,n);if(i)return i;if(n.option("sequences"))if(t instanceof Be){if((r=ji(t))!==t)return(x=e.clone()).expression=r.expressions.pop(),r.expressions.push(x),r.optimize(n)}else if(!St(t.tail_node())){var r;if((r=ji(e))!==e)return r.optimize(n)}if(n.option("unused")&&Hi(e,n),n.option("unsafe"))if(Nt(t))switch(t.name){case"Array":if(1==e.args.length){if((h=e.args[0])instanceof Ce)try{var o=h.value;if(o>6)break;for(var a=Array(o),c=0;c<o;c++)a[c]=at(ge,e);return at(s,e,{elements:a})}catch(n){Fe.warn("Invalid array length: {length} [{start}]",{length:o,start:e.start});break}if(!h.is_boolean(n)&&!h.is_string(n))break}return at(s,e,{elements:e.args});case"Object":if(0==e.args.length)return at(je,e,{properties:[]});break;case"String":if(0==e.args.length)return at(Qe,e,{value:""});if(1==e.args.length)return at(g,e,{operator:"+",left:at(Qe,e,{value:""}),right:e.args[0]}).optimize(n);break;case"Number":if(0==e.args.length)return at(Ce,e,{value:0});if(1==e.args.length)return at(Dn,e,{operator:"+",expression:at(g,e,{operator:"+",left:at(Qe,e,{value:""}),right:e.args[0]})}).optimize(n);break;case"Boolean":if(0==e.args.length)return at(le,e).optimize(n);if(1==e.args.length)return at(Dn,e,{operator:"!",expression:at(Dn,e,{operator:"!",expression:e.args[0]})}).optimize(n);break;case"RegExp":var l=[];if(Wn(e.args,function(e){var t=e.evaluate(n);return l.unshift(t),e!==t}))try{return Xt(n,e,at(Le,e,{value:RegExp.apply(RegExp,l)}))}catch(n){Fe.warn("Error converting {this} [{start}]",e)}}else if(t instanceof te)switch(t.property){case"toString":var p=t.expression;if(0==e.args.length&&!(p.may_throw_on_access(n)||p instanceof Ze))return at(g,e,{operator:"+",left:at(Qe,e,{value:""}),right:p}).optimize(n);break;case"join":if(t.expression instanceof s&&e.args.length<2)e:{var d=e.args[0];if(0==t.expression.elements.length&&!(d instanceof Je))return d?dt(e,[d,at(Qe,e,{value:""})]).optimize(n):at(Qe,e,{value:""});if(!(d&&(d=d.evaluate(n))instanceof Fe)){a=[];var h,_=[];for(c=0;c<t.expression.elements.length;c++){var m=t.expression.elements[c];if((I=m.evaluate(n))!==m)_.push(I);else{if(m instanceof Je)break e;_.length>0&&(a.push(at(Qe,e,{value:_.join(d)})),_.length=0),a.push(m)}}return _.length>0&&a.push(at(Qe,e,{value:_.join(d)})),1==a.length?a[0].is_string(n)?a[0]:at(g,a[0],{operator:"+",left:at(Qe,e,{value:""}),right:a[0]}):""==d?(h=a[0].is_string(n)||a[1].is_string(n)?a.shift():at(Qe,e,{value:""}),a.reduce(function(e,n){return at(g,n,{operator:"+",left:e,right:n})},h).optimize(n)):((fe=e.clone()).expression=fe.expression.clone(),fe.expression.expression=fe.expression.expression.clone(),fe.expression.expression.elements=a,Xt(n,e,fe))}}break;case"charAt":if(e.args.length<2)return(fe=at(g,e,{operator:"||",left:at(Xe,e,{expression:t.expression,property:e.args.length?at(g,e.args[0],{operator:"|",left:at(Ce,e,{value:0}),right:e.args[0]}):at(Ce,e,{value:0})}).optimize(n),right:at(Qe,e,{value:""})})).is_string=lt,fe.optimize(n);break;case"apply":if(2==e.args.length&&e.args[1]instanceof s)return(ee=e.args[1].elements.slice()).unshift(e.args[0]),at(w,e,{expression:at(te,t,{expression:t.expression,property:"call"}),args:ee}).optimize(n);break;case"call":var b=t.expression;if(b instanceof _n&&(b=b.fixed_value()),b instanceof Ee&&!b.contains_this())return(e.args.length?dt(e,[e.args[0],at(w,e,{expression:t.expression,args:e.args.slice(1)})]):at(w,e,{expression:t.expression,args:[]})).optimize(n)}else if(n.option("side_effects")&&t instanceof w&&1==t.args.length&&Nt(t.expression)&&"Object"==t.expression.name){var x;return(x=e.clone()).expression=Dt(e,t,t.args[0]),x.optimize(n)}if(n.option("unsafe_Function")&&Nt(t)&&"Function"==t.name){if(0==e.args.length)return at(_e,e,{argnames:[],body:[]}).init_vars(t.scope);if(Wn(e.args,function(e){return e instanceof Qe}))try{var k="n(function("+e.args.slice(0,-1).map(function(e){return e.value}).join()+"){"+e.args[e.args.length-1].value+"})",E=vt(k),T={ie:n.option("ie")};E.figure_out_scope(T);var S,D=new Tt(n.options);(E=E.transform(D)).figure_out_scope(T),E.compute_char_frequency(T),E.mangle_names(T),E.walk(new jn(function(e){return!!S||(e instanceof Ee?(S=e,!0):void 0)}));k=yt();return y.prototype._codegen.call(S,k),e.args=[at(Qe,e,{value:S.argnames.map(function(e){return e.print_to_string()}).join()}),at(Qe,e.args[e.args.length-1],{value:k.get().replace(/^\{|\}$/g,"")})],e}catch(n){if(!(n instanceof ht))throw n;Fe.warn("Error parsing code passed to new Function [{start}]",e.args[e.args.length-1]),Fe.warn(n.toString())}}var A=t instanceof _n?t.fixed_value():t,O=n.parent(),q=n.self(),F=A instanceof Ee&&(!Ln(A)||n.option("awaits")&&O instanceof v)&&(!Un(A)||n.option("yields")&&q instanceof Mn&&q.nested),M=F&&A.first_statement(),C=0,j=!1,H=!Wn(e.args,function(e){return!(e instanceof Je)}),P=F&&Wn(A.argnames,function(n,t){if(1==C&&e.args[t]instanceof Je&&(C=2),n instanceof G){if(C||(C=1),$t(1==C&&e.args[t])||(C=2),fr(A,n.value))return!1;n=n.name}return!(n instanceof K&&(j=!0,fr(A,n)))})&&!(A.rest instanceof K&&fr(A,A.rest)),Y=P&&n.option("inline")&&!e.is_expr_pure(n)&&(t===A||Yi(A,n));if(Y&&M instanceof Ge){var I=M.value;if(t===A&&!A.name&&(!I||I.is_constant_expression())&&Ni(A,Pi(n)))return dt(e,pe(I)).optimize(n)}if(F&&!A.contains_this()){var R,U=!1;if(Y&&!A.uses_arguments&&!A.pinned()&&!(A.name&&A instanceof Se)&&(t===A||!Qi(n,R=t.definition(),A)&&A.is_constant_expression(Qn(n)))&&(I=function(e){var t=A.body.length;if(t<2&&(e=me(e)))return e;if(n.option("inline")<3)return!1;e=null;for(var i=0;i<t;i++){var r=A.body[i];if(r instanceof zn){if(U){if(!e)continue;if(!(e instanceof $e))return!1;Ut(r)||(e=null)}else if(!Ut(r)){if(e&&!(e instanceof $e))return!1;e=null,U=!0}}else{if(r instanceof u||r instanceof $||r instanceof re)continue;if(e)return!1;e=r}}return me(e)}(M))){var B,L,V,W,J=t===A||R.single_use&&R.references.length-R.replaced==1;if(function(){if(C||j||H||U||A.rest)return;if(n.option("inline")<2&&A.argnames.length)return;if(!A.variables.all(function(e){return e.references.length-e.replaced<2&&e.orig[0]instanceof ln}))return;var t,i=n.find_parent(Ve),r=!1,o=Pi(n,i),s=[],a=!1,c=new jn(function(e,i){if(r)return!0;if(e instanceof g&&Jt[e.operator]||e instanceof N)s=null;else{if(e instanceof Ve)return r=!0;if(o&&e instanceof tn&&o[e.name])return r=!0;if(e instanceof _n){var u=e.definition();if(A.variables.get(e.name)!==u)return void(s=null);if(u.init instanceof Te)return r=!0;if(kt(e,c.parent()))return r=!0;var l=be(u);if(t<l||(t=l),!s)return;a?s=null:s.push(A.argnames[l])}else if(!a)return e instanceof f&&e.left instanceof Be?(e.left.expression.walk(c),e.left instanceof Xe&&e.left.property.walk(c),e.right.walk(c),a=!0,!0):e.has_side_effects(n)?(i(),a=!0,!0):void 0}});if(I.walk(c),r)return;var u=e.args.length;if(s&&A.argnames.length>=u){for(u=A.argnames.length;u-- >t&&A.argnames[u]===s.pop(););u++}return u<=t||Wn(e.args.slice(t,u),a&&!s?function(e){return e.is_constant_expression(i)}:function(e){return!e.has_side_effects(n)})}()){var ee=e.args.slice(),ne=[],oe=I.clone(!0).transform(new Cn(function(n){if(n instanceof _n){var t=n.definition();if(A.variables.get(n.name)!==t)return ne.push(n),n;var i=be(t),r=ee[i];if(!r)return at(An,e);ee[i]=null;var o=this.parent();return o?Dt(o,n,r):r}})),se=A.inlined;t!==A&&(A.inlined=!0);var ae=[];ee.forEach(function(e){e&&((e=e.clone(!0)).walk(new jn(function(e){e instanceof _n&&ne.push(e)})),ae.push(e))},[]),ae.push(oe);var fe=dt(e,ae).optimize(n);if(A.inlined=se,fe=Dt(O,q,fe),J||Kt(fe,e)===fe)return ne.forEach(function(e){e.scope=t===A?A.parent_scope:t.scope,e.reference();var n=e.definition();J&&n.replaced++,n.single_use=!1}),fe;fe.has_side_effects(n)||(e.drop_side_effect_free=function(e,n){var t=this.args.slice();return t.unshift(this.expression),dt(this,t).drop_side_effect_free(e,n)})}if(J&&function(){var e,i=new Jn,r=0;W=q;do{if(W.variables&&W.variables.each(function(e){i.set(e.name,!0)}),e=W,(W=n.parent(r++))instanceof z){if(!W.static)return!1}else if(W instanceof ie)V=[];else if(W instanceof de){if(W.init===e)continue;V=[]}else if(W instanceof he){if(W.init===e)continue;if(W.object===e)continue;V=[]}}while(!(W instanceof Ve));if(!(L=W.body.indexOf(e)+1))return!1;if(!Ni(A,Pi(n,W)))return!1;var o=(t!==A||A.parent_scope.resolve()===W)&&!W.pinned();W instanceof kn&&(n.toplevel.vars?i.set("arguments",!0):o=!1);B=new Jn;var s=n.option("inline");return!(!function(e,n){var t=!1;return A.each_argname(function(i){if(!t&&!i.unused){if(!n||ye(e,i.name))return t=!0;B.set(i.name,!0),V&&V.push(i.definition())}}),!t}(i,s>=2&&o)||!function(e,n){for(var t=0;t<A.body.length;t++){var i=A.body[t];if(i instanceof Te){var r=i.name;if(!n)return!1;if(B.has(r.name))return!1;if(ye(e,r.name))return!1;if(!Wn(i.enclosed,function(n){return n.scope===W||n.scope===i||!e.has(n.name)}))return!1;V&&V.push(r.definition())}else if(i instanceof zn){if(!n)return!1;for(var o=i.definitions.length;--o>=0;){var r=i.definitions[o].name;if(ye(e,r.name))return!1;V&&V.push(r.definition())}}}return!0}(i,s>=3&&o)||V&&0!=V.length&&tr(A,V))}()){A._squeezed=!0,t!==A&&(A.parent_scope=t.scope);fe=dt(e,function(){var t=[],i=[];C>1||j||H||A.rest?function(n,t){function i(e,i){if(i.unused)return ue(i);var r=i.definition();r.assignments++,r.references.push(e);var o=at(gn,i);r.orig.push(o),r.eliminated++,xe(n,t,o)}t.push(at(f,e,{operator:"=",left:at(Q,e,{elements:A.argnames.map(function(e){return e.unused?at(ge,e):e.convert_symbol(_n,i)}),rest:A.rest&&A.rest.convert_symbol(_n,i)}),right:at(s,e,{elements:e.args.slice()})}))}(t,i):function(n,t){for(var i=A.argnames.length,r=e.args.length;--r>=i;)t.push(e.args[r]);var o=[];for(r=i;--r>=0;){var s,a=A.argnames[r];a instanceof G?(o.push(a),s=a.name):s=a;var c=e.args[r];if(s.unused||W.var_names().has(s.name))c&&t.push(c);else{var u=at(gn,s),l=s.definition();l.orig.push(u),l.eliminated++,void 0!==s.unused?(xe(n,t,u),c&&t.push(c)):(!c&&a===s&&(V||"arguments"==s.name&&!Rn(A)&&Rn(W))&&(c=at(An,e)),xe(n,t,u,c))}}for(n.reverse(),t.reverse(),r=o.length;--r>=0;){var p=o[r];if(void 0!==p.name.unused)t.push(p.value);else{var d=at(_n,p.name);p.name.definition().references.push(d),t.push(at(f,p,{operator:"=",left:d,right:p.value}))}}}(t,i);var r=function(e,t){var i=[L,0],r=[],o=[],s=[],a=[],f=[];return A.body.filter(V?function(n){if(!(n instanceof Te))return!0;var t=at(gn,ar(n.name)),i=t.definition();return i.fixed=!1,i.orig.push(t),i.eliminated++,xe(e,o,t,gi(n,!0)),!1}:function(e){if(!(e instanceof Te))return!0;var n=e.name.definition();return W.functions.set(n.name,n),W.variables.set(n.name,n),W.enclosed.push(n),W.var_names().set(n.name,!0),i.push(e),!1}).forEach(function(e){if(e instanceof zn)for(var t=0;t<e.definitions.length;t++){var i=e.definitions[t],o=ar(i.name),c=i.value;c&&f.length>0&&(f.push(c),c=dt(i,f),f=[]),xe(r,s,o,c),V&&(B.has(o.name)||1==o.definition().orig.length&&A.functions.has(o.name)||a.push(ur(n,o)))}else e instanceof $e&&f.push(e.body)}),[].push.apply(e,r),[].push.apply(t,a),[].push.apply(t,o),[].push.apply(t,s),i}(t,i);i.push(I),t.length&&r.push(at(zn,A,{definitions:t}));return[].splice.apply(W.body,r),A.enclosed.forEach(function(e){W.var_names().has(e.name)||(W.enclosed.push(e),W.var_names().set(e.name,!0))}),i}()).optimize(n);return Dt(O,q,fe)}}if(n.option("side_effects")&&P&&Wn(A.body,Mt)&&(A===t?ki(A,n):!C&&!j&&!A.rest)&&(!Rn(A)||!A.value)&&Ni(A,Pi(n)))return dt(e,pe()).optimize(n)}if(n.option("drop_console")&&t instanceof Be){for(var ce=t.expression;ce.expression;)ce=ce.expression;if(Nt(ce)&&"console"==ce.name)return at(An,e).optimize(n)}return n.option("negate_iife")&&O instanceof $e&&Ht(q)?e.negate(n,!0):ti(n,e);function ue(e){return at(Xe,e,{expression:at(s,e,{elements:[]}),property:at(Ce,e,{value:0})})}function pe(n){var t=e.args.slice(),i=C>1||j||A.rest;if((i||H)&&(t=[at(s,e,{elements:t})]),i){var r=new Cn(function(e,n){if(e instanceof G)return at(G,e,{name:e.name.transform(r)||ue(e),value:e.value});if(e instanceof Q){var t=[];return e.elements.forEach(function(e,n){(e=e.transform(r))&&(t[n]=e)}),vi(e,t),at(Q,e,{elements:t})}if(e instanceof Z){var i=[],o=[];return e.properties.forEach(function(n){var t=n.key,s=n.value.transform(r);s?(o.length&&(t instanceof Fe||(t=xt(t,n)),o.push(t),t=dt(e,o),o=[]),i.push(at(X,n,{key:t,value:s}))):t instanceof Fe&&o.push(t)}),o.length&&i.push(at(X,e,{key:dt(e,o),value:ue(e)})),at(Z,e,{properties:i})}return e instanceof ln?null:void 0}),o=[];A.argnames.forEach(function(e,n){(e=e.transform(r))&&(o[n]=e)});var a=A.rest&&A.rest.transform(r);a&&(o.length=A.argnames.length),vi(A,o),t[0]=at(f,e,{operator:"=",left:at(Q,A,{elements:o,rest:a}),right:t[0]})}else A.argnames.forEach(function(e){e instanceof G&&t.push(e.value)});return t.push(n||at(An,e)),t}function ve(){return e.call_only?at(Ce,e,{value:0}):at(An,e)}function me(n){return n?n instanceof Ge?n.value||ve():n instanceof $e?e.call_only?n.body:at(Dn,n,{operator:"void",expression:n.body}):void 0:ve()}function be(e){for(var n=A.argnames.length;--n>=0;)if(A.argnames[n].definition()===e)return n}function ye(e,n){return e.has(n)||tt[n]||W.var_names().has(n)}function xe(n,t,i,r){var o=i.definition();if(W.var_names().has(i.name)||(W.var_names().set(i.name,!0),n.push(at(On,i,{name:i,value:null}))),W.variables.set(i.name,o),W.enclosed.push(o),r){var s=at(_n,i);o.assignments++,o.references.push(s),t.push(at(f,e,{operator:"=",left:s,right:r}))}}}),e(Oe,function(e,n){if(n.option("unsafe")){var t=e.expression;if(Nt(t))switch(t.name){case"Array":case"Error":case"Function":case"Object":case"RegExp":return at(w,e).transform(n)}}if(n.option("sequences")){var i=ji(e);if(i!==e)return i.optimize(n)}return n.option("unused")&&Hi(e,n),e}),e(We,function(e,n){var t=function(){if(!n.option("side_effects"))return e.expressions;var t=[],i=Yn(n),r=e.expressions.length-1;return e.expressions.forEach(function(e,o){o<r&&(e=e.drop_side_effect_free(n,i)),e&&(zt(t,e),i=!1)}),t}(),i=t.length-1;return function(){for(var e=1;e<i;e++){var o=t[e-1],s=r(o);if(s){var a=t[e];if(n.option("conditionals")){var f=Ii(n,s,o.right,a);if(f){o.right=f,t.splice(e--,1),i--;continue}}n.option("dead_code")&&r(a)===s&&a.right.is_constant_expression(s.scope.resolve())&&(t[--e]=o.right)}}}(),function(){if(!n.option("side_effects"))return;for(;i>0&&$t(t[i],n);)i--;i<t.length-1&&(t[i]=at(Dn,e,{operator:"void",expression:t[i]}),t.length=i+1)}(),0==i?((e=Dt(n.parent(),n.self(),t[0]))instanceof We||(e=e.optimize(n)),e):(e.expressions=t,e);function r(e){return e instanceof f&&"="==e.operator&&e.left instanceof _n&&e.left.definition()}}),e(Sn,function(e,n){if(n.option("sequences")){var t=ji(e);if(t!==e)return t.optimize(n)}return ti(n,e)});var Ri=nt("+ -"),Ui=nt("* / %");e(Dn,function(e,n){var t=e.operator,i=e.expression;if(n.option("sequences")&&function(){switch(t){case"delete":return!f(i.tail_node());case"typeof":return!Nt(i.tail_node());default:return!0}}()){var r=ji(e);if(r!==e)return r.optimize(n)}switch(t){case"+":if(!n.option("evaluate"))break;if(!i.is_number(n,!0))break;var o=n.parent();if(o instanceof Dn&&"delete"==o.operator)break;return i;case"-":if(i instanceof ye&&(i=i.transform(n)),i instanceof Ce||i instanceof ye)return e;break;case"!":if(!n.option("booleans"))break;if(i.is_truthy())return dt(e,[i,at(le,e)]).optimize(n);if(n.in_boolean_context()){if(i instanceof Dn&&"!"==i.operator)return i.expression;if(i instanceof g){var s=Yn(n);e=(s?Qt:Kt)(e,i.negate(n,s))}}break;case"delete":if(!n.option("evaluate"))break;if(f(i))break;return dt(e,[i,at(wn,e)]).optimize(n);case"typeof":if(!n.option("booleans"))break;if(!n.in_boolean_context())break;Fe.warn("Boolean expression always true [{start}]",e);var a=[at(wn,e)];return i instanceof _n&&P(i,n)||a.unshift(i),dt(e,a).optimize(n);case"void":if(!n.option("side_effects"))break;return(i=i.drop_side_effect_free(n))?(e.expression=i,e):at(An,e).optimize(n)}return n.option("evaluate")&&i instanceof g&&Ri[t]&&Ui[i.operator]&&(i.left.is_constant()||!i.right.has_side_effects(n))?at(g,e,{operator:i.operator,left:at(Dn,i.left,{operator:t,expression:i.left}),right:i.right}):ti(n,e);function f(e){return e instanceof ye||e instanceof ze||e instanceof qe||e instanceof Be||e instanceof _n||e instanceof An}}),e(v,function(e,n){if(!n.option("awaits"))return e;if(n.option("sequences")){var t=ji(e);if(t!==e)return t.optimize(n)}if(n.option("side_effects")){var i=e.expression;if(i instanceof v)return i.optimize(n);if(i instanceof Dn&&i.expression instanceof v)return i.optimize(n);for(var r,o=0,s=e;r=n.parent(o++);s=r){if(Rn(r)){if(r.value===s)return i.optimize(n)}else if(r instanceof Ge){var a=!0;do{if(s=r,(r=n.parent(o++))instanceof En&&(r.bfinally||r.bcatch)!==s){a=!1;break}}while(r&&!(r instanceof Ve));if(a)return i.optimize(n)}else if(r instanceof We&&r.tail_node()===s)continue;break}}return e}),e(Mn,function(e,n){if(!n.option("yields"))return e;if(n.option("sequences")){var t=ji(e);if(t!==e)return t.optimize(n)}var i=e.expression;if(e.nested&&"Call"==i.TYPE){var r=i.clone().optimize(n);if("Call"!=r.TYPE)return r}return e}),g.DEFMETHOD("lift_sequences",function(e){if(this.left instanceof Be){if(!(this.left.expression instanceof We))return this;var n=this.left.expression.expressions.slice();return(t=this.clone()).left=t.left.clone(),t.left.expression=n.pop(),n.push(t),dt(this,n)}if(this.left instanceof We){n=this.left.expressions.slice();return(t=this.clone()).left=n.pop(),n.push(t),dt(this,n)}if(this.right instanceof We){if(this.left.has_side_effects(e))return this;for(var t,i="="==this.operator&&this.left instanceof _n,r=(n=this.right.expressions).length-1,o=0;o<r&&(i||!n[o].has_side_effects(e));o++);if(o==r)return n=n.slice(),(t=this.clone()).right=n.pop(),n.push(t),dt(this,n);if(o>0)return(t=this.clone()).right=dt(this.right,n.slice(o)),(n=n.slice(0,o)).push(t),dt(this,n)}return this});var Bi=nt("indexOf lastIndexOf"),Li=nt("== === != !== * & | ^");function Gi(e,n){return e instanceof f?!n&&"="==e.operator&&Gi(e.right):e instanceof Oe?!n:e instanceof We?Gi(e.tail_node(),n):e instanceof _n?!n&&Gi(e.fixed_value()):e instanceof s||e instanceof D||e instanceof Ee||e instanceof je}function Vi(e,n,t){switch(e){case"in":return Gi(n)||t&&t.option("unsafe_comps");case"instanceof":return n instanceof _n&&(n=n.fixed_value()),i(n)||t&&t.option("unsafe_comps");default:return!0}}function Wi(e,n){if(n.is_constant())return!0;if(n instanceof f)return"="!=n.operator||Wi(e,n.right);if(n instanceof g)return!Jt[n.operator]||Wi(e,n.left)&&Wi(e,n.right);if(n instanceof w)return Ln(n.expression);if(n instanceof N)return Wi(e,n.consequent)&&Wi(e,n.alternative);if(n instanceof We)return Wi(e,n.tail_node());if(n instanceof _n){var t=n.fixed_value();return t&&Wi(e,t)}return n instanceof mn?!n.tag||Zi(e,n.tag):n instanceof Tn||void 0}function $i(e,n){return e instanceof f?st(e.left,n)?e:e.left:e instanceof We?$i(e.tail_node(),n):e instanceof Dn&&bt[e.operator]?st(e.expression,n)?e:e.expression:e}function Ji(e,n){return n instanceof te?Ji(e,n.expression):n instanceof Xe?Ji(e,n.expression)&&Ji(e,n.property):n instanceof tn||!n.has_side_effects(e)}function Ki(e,n){var t=e.right.tail_node();if(t!==e.right){var i=e.right.expressions.slice(0,-1);i.push(t.left),(t=t.clone()).left=dt(e.right,i),e.right=t}e.left=at(g,e,{operator:e.operator,left:e.left,right:t.left,start:e.left.start,end:t.left.end}),e.right=t.right,n?e.left=e.left.transform(n):e.operator==t.left.operator&&Ki(e.left)}function Qi(e,n,t){var r=0,o=e.self();do{if(o===t)return o;if(i(o)&&o.name&&o.name.definition()===n)return o}while(o=e.parent(r++))}function Xi(e){var n=e.scope.resolve();return Wn(e.references,function(e){return n===e.scope.resolve()})}function Zi(e,n){return e.option("unsafe")&&n instanceof te&&"raw"==n.property&&Nt(n.expression)&&"String"==n.expression.name}function er(e){var n=!1;if(e=e.replace(/\\(u\{[^{}]*\}?|u[\s\S]{0,4}|x[\s\S]{0,2}|[0-9]+|[\s\S])/g,function(e,t){var i=gt(t);if("string"==typeof i)return i;n=!0}),!n)return e}function nr(e,n){return e instanceof _n||e.TYPE===n.TYPE}function tr(e,n){var t=!1,i=new jn(function(e){return!!t||(e instanceof _n&&it(e.definition(),n)?t=!0:void 0)}),r=new jn(function(n){if(t)return!0;if(n instanceof Ee&&n!==e){if(!(n.name||Ln(n)||Un(n))){var o=r.parent();if(o instanceof w&&o.expression===n)return}return n.walk(i),!0}});return e.walk(r),t}e(g,function(e,n){if(!Li[e.operator]||!e.right.is_constant()||e.left.is_constant()||e.left instanceof g&&_t[e.left.operator]>=_t[e.operator]||C(),n.option("sequences")){var t=e.lift_sequences(n);if(t!==e)return t.optimize(n)}if(n.option("assignments")&&Jt[e.operator]){var r=$i(e.left,n),o=e.right;if(r instanceof _n&&o instanceof f&&"="==o.operator&&r.equals(o.left)){r=r.clone();var s=at(f,e,{operator:"=",left:r,right:at(g,e,{operator:e.operator,left:e.left,right:o.right})});r.fixed&&(r.fixed=function(){return s.right},r.fixed.assigns=[s]);var a=r.definition();return a.references.push(r),a.replaced++,s.optimize(n)}}if(n.option("comparisons"))switch(e.operator){case"===":case"!==":if($t(e.left,n)&&e.right.is_defined(n))return Fe.warn("Expression always defined [{start}]",e),dt(e,[e.right,at("==="==e.operator?le:wn,e)]).optimize(n);var c=!0;(e.left.is_string(n)&&e.right.is_string(n)||e.left.is_number(n)&&e.right.is_number(n)||e.left.is_boolean(n)&&e.right.is_boolean(n)||Ji(n,e.left)&&e.left.equals(e.right))&&(e.operator=e.operator.slice(0,2));case"==":case"!=":if(!c&&$t(e.left,n))e.left=at(Me,e.left);else if(n.option("typeofs")&&e.left instanceof Qe&&"undefined"==e.left.value&&e.right instanceof Dn&&"typeof"==e.right.operator){((l=e.right.expression)instanceof _n?!l.is_declared(n):l instanceof Be&&n.option("ie"))||(e.right=l,e.left=at(An,e.left).optimize(n),2==e.operator.length&&(e.operator+="="))}else if(e.left instanceof _n&&e.right instanceof _n&&e.left.definition()===e.right.definition()&&Gi(e.left))return at("="==e.operator[0]?wn:le,e).optimize(n);break;case"&&":case"||":var u=e.left;if(!(u instanceof g))break;if(u.operator!=("&&"==e.operator?"!==":"==="))break;if(!(e.right instanceof g))break;if(u.operator!=e.right.operator)break;if($t(u.left,n)&&e.right.left instanceof Me||u.left instanceof Me&&$t(e.right.left,n)){var l;if((l=u.right)instanceof f&&"="==l.operator&&(l=l.left),l.has_side_effects(n))break;if(!l.equals(e.right.right))break;return u.operator=u.operator.slice(0,-1),u.left=at(Me,e),u}}var p=!1,d=n.parent();if(n.option("booleans")){r=$i(e.left,n);if(Jt[e.operator]&&!r.has_side_effects(n)){if(r.equals(e.right))return Dt(d,n.self(),e.left).optimize(n);Di(n,r)}p=n.in_boolean_context()}if(p)switch(e.operator){case"+":var h=e.left.evaluate(n,!0);if(h&&"string"==typeof h||(h=e.right.evaluate(n,!0))&&"string"==typeof h){Fe.warn("+ in boolean context always true [{start}]",e);var v=[];if(e.left.evaluate(n)instanceof Fe&&v.push(e.left),e.right.evaluate(n)instanceof Fe&&v.push(e.right),v.length<2)return v.push(at(wn,e)),dt(e,v).optimize(n);e.truthy=!0}break;case"==":if(e.left instanceof Qe&&""==e.left.value&&e.right.is_string(n))return at(Dn,e,{operator:"!",expression:e.right}).optimize(n);break;case"!=":if(e.left instanceof Qe&&""==e.left.value&&e.right.is_string(n))return e.right.optimize(n)}if(n.option("comparisons")&&e.is_boolean(n)){if("Binary"!=d.TYPE){var _=at(Dn,e,{operator:"!",expression:e.negate(n)});if(Xt(n,e,_)===_)return _}switch(e.operator){case">":C("<");break;case">=":C("<=")}}if(n.option("conditionals")&&Jt[e.operator]){if(e.left instanceof g&&e.operator==e.left.operator){var m=at(g,e,{operator:e.operator,left:e.left.right,right:e.right}),b=m.transform(n);m!==b&&(e.left=e.left.left,e.right=b)}(T=e.right.tail_node())instanceof g&&e.operator==T.operator&&Ki(e,n)}if(n.option("strings")&&"+"==e.operator){if(e.right instanceof Qe&&""==e.right.value&&e.left.is_string(n))return e.left.optimize(n);if(e.left instanceof Qe&&""==e.left.value&&e.right.is_string(n))return e.right.optimize(n);if(e.left instanceof g&&"+"==e.left.operator&&e.left.left instanceof Qe&&""==e.left.left.value&&e.right.is_string(n)&&(e.left.right.is_constant()||!e.right.has_side_effects(n)))return e.left=e.left.right,e.optimize(n);(T=e.right.tail_node())instanceof g&&e.operator==T.operator&&(e.left.is_string(n)&&T.is_string(n)||T.left.is_string(n)&&(e.left.is_constant()||!T.right.has_side_effects(n)))&&Ki(e,n)}if(n.option("evaluate")){var y=!0;switch(e.operator){case"&&":if(!(E=Si(n,e.left)))return Fe.warn("Condition left of && always false [{start}]",e),Dt(d,n.self(),e.left).optimize(n);if(!(E instanceof Fe))return Fe.warn("Condition left of && always true [{start}]",e),dt(e,[e.left,e.right]).optimize(n);if(e.right.evaluate(n,!0)){if((p||"&&"==d.operator&&d.left===n.self())&&!(e.right.evaluate(n)instanceof Fe))return Fe.warn("Dropping side-effect-free && [{start}]",e),e.left.optimize(n)}else{if(p&&!(e.right.evaluate(n)instanceof Fe))return Fe.warn("Boolean && always false [{start}]",e),dt(e,[e.left,at(le,e)]).optimize(n);e.falsy=!0}if("||"==e.left.operator)if(!(w=Si(n,e.left.right)))return at(N,e,{condition:e.left.left,consequent:e.right,alternative:e.left.right}).optimize(n);break;case"??":var x=!0;case"||":var k,w,E=Si(n,e.left,x);if(x?null==E:!E)return Fe.warn("Condition left of {operator} always {value} [{start}]",{operator:e.operator,value:x?"nullish":"false",start:e.start}),dt(e,[e.left,e.right]).optimize(n);if(!(E instanceof Fe))return Fe.warn("Condition left of {operator} always {value} [{start}]",{operator:e.operator,value:x?"defined":"true",start:e.start}),Dt(d,n.self(),e.left).optimize(n);if(x||!(k=e.right.evaluate(n,!0))||k instanceof Fe){if((p||"||"==d.operator&&d.left===n.self())&&!e.right.evaluate(n))return Fe.warn("Dropping side-effect-free {operator} [{start}]",e),e.left.optimize(n)}else{if(p&&!(e.right.evaluate(n)instanceof Fe))return Fe.warn("Boolean || always true [{start}]",e),dt(e,[e.left,at(wn,e)]).optimize(n);e.truthy=!0}if(!x&&"&&"==e.left.operator)if((w=Si(n,e.left.right))&&!(w instanceof Fe))return at(N,e,{condition:e.left.left,consequent:e.left.right,alternative:e.right}).optimize(n);break;case"+":if(e.left instanceof I&&e.right instanceof g&&"+"==e.right.operator&&e.right.left instanceof I&&e.right.is_string(n)&&(e=at(g,e,{operator:"+",left:at(Qe,e.left,{value:""+e.left.value+e.right.left.value,start:e.left.start,end:e.right.left.end}),right:e.right.right})),e.right instanceof I&&e.left instanceof g&&"+"==e.left.operator&&e.left.right instanceof I&&e.left.is_string(n)&&(e=at(g,e,{operator:"+",left:e.left.left,right:at(Qe,e.right,{value:""+e.left.right.value+e.right.value,start:e.left.right.start,end:e.right.end})})),e.right instanceof Dn&&"-"==e.right.operator&&e.left.is_number(n)){e=at(g,e,{operator:"-",left:e.left,right:e.right.expression});break}if(e.left instanceof Dn&&"-"==e.left.operator&&M()&&e.right.is_number(n)){e=at(g,e,{operator:"-",left:e.right,right:e.left.expression});break}if(n.option("unsafe_math")&&e.left instanceof g&&_t[e.left.operator]==_t[e.operator]&&e.right.is_constant()&&(e.right.is_boolean(n)||e.right.is_number(n))&&e.left.is_number(n)&&!e.left.right.is_constant()&&(e.left.left.is_boolean(n)||e.left.left.is_number(n))){e=at(g,e,{operator:e.left.operator,left:at(g,e,{operator:e.operator,left:e.right,right:e.left.left}),right:e.left.right});break}case"-":if(e.right instanceof Dn&&"-"==e.right.operator&&e.left.is_number(n)&&e.right.expression.is_number(n)){e=at(g,e,{operator:"+",left:e.left,right:e.right.expression});break}case"*":case"/":y=n.option("unsafe_math"),"+"!=e.operator&&["left","right"].forEach(function(t){var i=e[t];if(i instanceof Dn&&"+"==i.operator){var r=i.expression;(r.is_boolean(n)||r.is_number(n)||r.is_string(n))&&(e[t]=r)}});case"&":case"|":case"^":if("-"==e.operator||"/"==e.operator||!e.left.is_boolean(n)&&!e.left.is_number(n)||!e.right.is_boolean(n)&&!e.right.is_number(n)||!M()||e.left instanceof g&&e.left.operator!=e.operator&&_t[e.left.operator]>=_t[e.operator]||(e=Xt(n,e,at(g,e,{operator:e.operator,left:e.right,right:e.left}),e.right instanceof I&&!(e.left instanceof I))),!y||!e.is_number(n))break;if(!(e.right instanceof g&&"%"!=e.right.operator&&_t[e.right.operator]==_t[e.operator]&&e.right.is_number(n)&&("+"!=e.operator||e.right.left.is_boolean(n)||e.right.left.is_number(n)))||"-"==e.operator&&e.left.is_negative_zero()||!e.right.left.is_constant_expression()&&e.right.right.has_side_effects(n)||function(e){var n=!1;return e.walk(new jn(function(e){if(n)return!0;if(e instanceof f){if(e.left instanceof Be)return n=!0}else if(e instanceof Tn&&Et[e.operator]&&e.expression instanceof Be)return n=!0})),n}(e.right.right)||"+"!=(e=at(g,e,{operator:O(e.operator,e.right.operator),left:at(g,e.left,{operator:e.operator,left:e.left,right:e.right.left,start:e.left.start,end:e.right.left.end}),right:e.right.right})).operator||e.right.is_boolean(n)||e.right.is_number(n)||(e.right=at(Dn,e.right,{operator:"+",expression:e.right})),e.right instanceof I&&e.left instanceof g&&"%"!=e.left.operator&&_t[e.left.operator]==_t[e.operator]&&e.left.is_number(n))if(e.left.left instanceof I){r=q(e.operator,e.left.left,e.right,{start:e.left.left.start,end:e.right.end});e=q(e.left.operator,ti(n,r),e.left.right,e)}else if(e.left.right instanceof I){var T,S=O(e.left.operator,e.operator);!(T=ti(n,q(S,e.left.right,e.right,e.left))).is_constant()||"-"==e.left.operator&&0!=e.right.value&&0==+T.value&&e.left.left.is_negative_zero()||(e=q(e.left.operator,e.left.left,T,e))}break;case"instanceof":if(i(e.right))return dt(e,[e,at(le,e)]).optimize(n)}if(!(d instanceof Dn&&"delete"==d.operator)){if(e.left instanceof Ce&&!e.right.is_constant())switch(e.operator){case"+":if(0==e.left.value){if(e.right.is_boolean(n))return at(Dn,e,{operator:"+",expression:e.right}).optimize(n);if(e.right.is_number(n)&&!e.right.is_negative_zero())return e.right}break;case"*":if(1==e.left.value)return at(Dn,e,{operator:"+",expression:e.right}).optimize(n)}if(e.right instanceof Ce&&!e.left.is_constant())switch(e.operator){case"+":if(0==e.right.value){if(e.left.is_boolean(n))return at(Dn,e,{operator:"+",expression:e.left}).optimize(n);if(e.left.is_number(n)&&!e.left.is_negative_zero())return e.left}break;case"-":if(0==e.right.value)return at(Dn,e,{operator:"+",expression:e.left}).optimize(n);break;case"/":if(1==e.right.value)return at(Dn,e,{operator:"+",expression:e.left}).optimize(n)}}}if(n.option("typeofs"))switch(e.operator){case"&&":Ti(e.left,e.right,null);break;case"||":Ti(e.left,null,e.right)}if(n.option("unsafe")){var D=F(e.right);if(p&&D&&("=="==e.operator||"!="==e.operator)&&e.left instanceof Ce&&0==e.left.value)return("=="==e.operator?at(Dn,e,{operator:"!",expression:e.right}):e.right).optimize(n);var A=F(e.left);if(n.option("comparisons")&&function(){switch(e.operator){case"<=":return D&&e.left instanceof Ce&&0==e.left.value;case"<":if(A&&e.right instanceof Ce&&0==e.right.value)return!0;case"==":case"!=":return!!D&&(e.left instanceof Ce&&-1==e.left.value||e.left instanceof Dn&&"-"==e.left.operator&&e.left.expression instanceof Ce&&1==e.left.expression.value)}}()){var z=at(Dn,e,{operator:"!",expression:at(Dn,e,{operator:"~",expression:A?e.left:e.right})});switch(e.operator){case"<":if(A)break;case"<=":case"!=":z=at(Dn,e,{operator:"!",expression:z})}return z.optimize(n)}}return ti(n,e);function O(e,n){switch(e){case"-":return"+"==n?"-":"+";case"/":return"*"==n?"/":"*";default:return n}}function q(e,t,i,r){return"+"==e&&(t.is_boolean(n)||t.is_number(n)||(t=at(Dn,t,{operator:"+",expression:t})),i.is_boolean(n)||i.is_number(n)||(i=at(Dn,i,{operator:"+",expression:i}))),at(g,r,{operator:e,left:t,right:i})}function F(e){return"Call"==e.TYPE&&e.expression instanceof te&&Bi[e.expression.property]}function M(){return e.left.is_constant()||e.right.is_constant()||!e.left.has_side_effects(n)&&!e.right.has_side_effects(n)}function C(n){if(M()){n&&(e.operator=n);var t=e.left;e.left=e.right,e.right=t}}}),e(un,function(e){return e}),e(_n,function(e,n){if(!n.option("ie")&&Nt(e)&&(!e.scope.resolve().uses_with||!n.find_parent(Fn)))switch(e.name){case"undefined":return at(An,e).optimize(n);case"NaN":return at(ze,e).optimize(n);case"Infinity":return at(ye,e).optimize(n)}var t=n.parent();if(n.option("reduce_vars")&&kt(n.self(),t)!==n.self()){var r,o,s,a=e.definition(),f=e.fixed_value(),c=a.single_use&&!(t instanceof w&&t.is_expr_pure(n));if(c)if(i(f)){if(a.scope===e.scope.resolve(!0)&&!a.in_loop||n.option("reduce_funcs")&&1!=a.escaped.depth&&!f.inlined)if(a.redefined())c=!1;else if(Qi(n,a,f))c=!1;else if(f.name&&f.name.definition()!==a)c=!1;else if(f.parent_scope!==e.scope||wt(a))if(Yi(f,n)){if("f"==(c=f.is_constant_expression(e.scope))){var u=e.scope;do{(u instanceof Te||u instanceof Se)&&(u.inlined=!0)}while(u=u.parent_scope)}}else c=!1;else f.name&&("await"==f.name.name&&Ln(f)||"yield"==f.name.name&&Un(f))?c=!1:f.has_side_effects(n)?c=!1:n.option("ie")&&f instanceof D&&(c=!1);else c=!1;c&&(f.parent_scope=e.scope)}else(!f||a.recursive_refs>0||!f.is_constant_expression()||f.drop_side_effect_free(n))&&(c=!1);if(c){if(a.single_use=!1,f._squeezed=!0,f.single_use=!0,f instanceof V&&(f=_i(f)),f instanceof Te&&(f=gi(f)),i(f)){var l=[];u=e.scope;do{if(l.push(u),u===a.scope)break}while(u=u.parent_scope);f.enclosed.forEach(function(e){if(!f.variables.has(e.name))for(var n=0;n<l.length;n++){var t=l[n];if(!ot(t.enclosed,e))return;t.var_names().set(e.name,!0)}})}if(a.recursive_refs>0){var p,d,h=(y=f.clone(!0)).name.definition(),v=y.variables.get(y.name.name),_=v&&v.orig[0];y instanceof D?(p="def_function",d=on):(p="def_variable",d=dn),_ instanceof d||((_=at(d,y.name)).scope=y,y.name=_,(v=y[p](_)).recursive_refs=a.recursive_refs),y.walk(new jn(function(e){if(e instanceof fn)e!==_&&((n=e.definition()).orig.push(e),n.eliminated++);else if(e instanceof _n){var n;if((n=e.definition())===h)e.thedef=n=v;else{n.single_use=!1;var t=e.fixed_value();i(t)&&t.name&&t.name.definition()===n&&n.scope===t.name.scope&&f.variables.get(t.name.name)===n&&(t.name=t.name.clone(),e.thedef=n=y.variables.get(t.name.name)||y[p](t.name))}n.references.push(e)}}))}else f instanceof Ve?(n.push(f),y=f.optimize(n),n.pop()):y=f.optimize(n),y=y.transform(new Cn(function(e,n){return e instanceof Ve?e:(n(e=e.clone(),this),e)}));return a.replaced++,y}if(f&&!1!==(r=e.fixed||a.fixed).should_replace)if(f instanceof yn?wt(a)||!Xi(a)||function(n){var t=e.scope;for(;t!==n.scope;){if(t instanceof D)return!0;t=t.parent_scope}}(a)||(s=f):(o=f.evaluate(n,!0))!==f&&"function"!=typeof o&&(null===o||"object"!=typeof o||n.option("unsafe_regexp")&&o instanceof RegExp&&!a.cross_loop&&Xi(a))&&(s=xt(o,f)),s){if(void 0===r.should_replace){var g=s.optimize(n).print_to_string().length;x(f)||(g=Math.min(g,f.print_to_string().length));var m=a.name.length;if(n.option("unused")&&!n.exposed(a)){var b=a.references.length-a.replaced-a.assignments;b=Math.min(b,a.references.filter(function(e){return e.fixed===r}).length),m+=(m+2+g)/Math.max(1,b)}r.should_replace=g-Math.floor(m)<n.eval_threshold}var y;if(r.should_replace)return x(f)?(y=s.optimize(n))===s&&(y=y.clone(!0)):(y=Kt(s.optimize(n),f))!==s&&y!==f||(y=y.clone(!0)),a.replaced++,y}}return e;function x(e){var n;return e.walk(new jn(function(e){if(e instanceof _n&&(n=!0),n)return!0})),n}}),e(mn,function(e,n){if(!n.option("templates"))return e;var t=e.tag;if(!t||Zi(n,t)){for(var i,r=[],o=[],s=0;s<e.strings.length;s++){var a=e.strings[s];if(!t){var f=er(a);f&&(a=h(f))}if(s>0){var c=e.expressions[s-1],u=v(c);if(u){var l,p=o[o.length-1]+u+a;if(t||typeof(l=er(p))==i){o[o.length-1]=l?h(l):p;continue}}r.push(c)}o.push(a),t||(i=typeof f)}if(!t&&o.length>1){if(""==o[o.length-1])return at(g,e,{operator:"+",left:at(mn,e,{expressions:r.slice(0,-1),strings:o.slice(0,-1)}).transform(n),right:r[r.length-1]}).optimize(n);if(""==o[0]){var d=at(g,e,{operator:"+",left:at(Qe,e,{value:""}),right:r[0]});for(s=1;""==o[s]&&s<r.length;s++)d=at(g,e,{operator:"+",left:d,right:r[s]});return Xt(n,e,at(g,e,{operator:"+",left:d.transform(n),right:at(mn,e,{expressions:r.slice(s),strings:o.slice(s)}).transform(n)}).optimize(n))}}e.expressions=r,e.strings=o}return ti(n,e);function h(e){return e.replace(/\r|\\|`|\${/g,function(e){return"\\"+("\r"==e?"r":e)})}function v(e){var i=e.evaluate(n);if(i!==e&&!(t&&/\r|\\|`/.test(i)||(i=h(""+i)).length>e.print_to_string().length+"${}".length))return i}}),e(An,function(e,n){if(n.option("unsafe_undefined")){var t=Qn(n).find_variable("undefined");if(t){var i=at(_n,e,{name:"undefined",scope:t.scope,thedef:t});return i.is_undefined=!0,i}}var r=kt(n.self(),n.parent());return r&&nr(r,e)?e:at(Dn,e,{operator:"void",expression:at(Ce,e,{value:0})})}),e(ye,function(e,n){var t=kt(n.self(),n.parent());return t&&nr(t,e)?e:!n.option("keep_infinity")||t||Qn(n).find_variable("Infinity")?at(g,e,{operator:"/",left:at(Ce,e,{value:1}),right:at(Ce,e,{value:0})}):e}),e(ze,function(e,n){var t=kt(n.self(),n.parent());return t&&nr(t,e)?e:t||Qn(n).find_variable("NaN")?at(g,e,{operator:"/",left:at(Ce,e,{value:0}),right:at(Ce,e,{value:0})}):e});var ir=nt("+ - * / % >> << >>> | ^ &"),rr=nt("* | ^ &");function or(e,n){if(!e)return!1;var t=n.parent();return"Call"!=t.TYPE||(t.expression!==n.self()||!(e instanceof _n&&!(e=e.fixed_value()))&&(e instanceof Ee&&!e.contains_this()))}function sr(e){return e instanceof He&&"string"==typeof e.key&&!(e instanceof Ie&&e.value.contains_super())}function ar(e){var n=e.definition().redefined();return n&&((e=e.clone()).thedef=n),e}function fr(e,n){var t=!1;return n.walk(new jn(function(n){return!!t||(n instanceof _n&&e.variables.get(n.name)===n.definition()?t=!0:void 0)})),t}function cr(e,n){var t=[];e.references.forEach(function(e){var i=e.fixed;i&&ot(t,i)&&(i.assigns?i.assigns.unshift(n):i.assigns=[n])})}function ur(e,n){var t=at(_n,n),i=at(f,n,{operator:"=",left:t,right:at(An,n).transform(e)}),r=n.definition();return r.fixed&&(t.fixed=function(){return i.right},t.fixed.assigns=[i],cr(r,i)),r.assignments++,r.references.push(t),i}e(f,function(e,n){if(n.option("dead_code"))if(e.left instanceof Be){if("="==e.operator){if(e.redundant){var t=[e.left.expression];return e.left instanceof Xe&&t.push(e.left.property),t.push(e.right),dt(e,t).optimize(n)}if(e.left.equals(e.right)&&!e.left.has_side_effects(n))return e.right;var i=e.left.expression;if(i instanceof Ee||!n.has_directive("use strict")&&i instanceof I&&!i.may_throw_on_access(n))return e.left instanceof te?e.right:dt(e,[e.left.property,e.right]).optimize(n)}}else if(e.left instanceof _n&&P(e.left,n)){var r;if("="==e.operator&&e.left.equals(e.right)&&!((r=n.parent())instanceof Dn&&"delete"==r.operator))return e.right;if(e.left.is_immutable())return b();var o,s=e.left.definition(),a=s.scope.resolve(),c=a===n.find_parent(Ee),u=0;if(r=n.self(),!a.uses_arguments||!wt(s)||n.has_directive("use strict"))do{if(o=r,(r=n.parent(u++))instanceof f){if(r.left instanceof _n&&r.left.definition()===s){if(_(u,r,!c))break;return b(s)}if(r.left.match_symbol(function(e){if(e instanceof Be)return!0}))break}else{if(r instanceof oe){if(!c)break;if(_(u,r))break;if(tr(a,[s]))break;return b(s)}if(r instanceof $e){if(!c)break;if(tr(a,[s]))break;var l;do{if(l=r,(r=n.parent(u++))===a&&Lt(r.body,l))return b(s)}while(v(l,r));break}if(r instanceof On){if(!(r.name instanceof fn))continue;if(r.name.definition()!==s)continue;if(_(u,r))break;return b(s)}}}while(h(o,r))}if(n.option("sequences")){var p=e.lift_sequences(n);if(p!==e)return p.optimize(n)}if(n.option("assignments")){if("="==e.operator&&e.left instanceof _n&&e.right instanceof g){if(e.right.left instanceof _n&&e.right.left.name==e.left.name&&ir[e.right.operator])return m(e.right.right);if(e.right.right instanceof _n&&e.right.right.name==e.left.name&&rr[e.right.operator]&&!e.right.left.has_side_effects(n))return m(e.right.left)}if(("-="==e.operator||"+="==e.operator&&(e.left.is_boolean(n)||e.left.is_number(n)))&&e.right instanceof Ce&&1==e.right.value){var d=e.operator.slice(0,-1);return at(Dn,e,{operator:d+d,expression:e.left})}}return ti(n,e);function h(e,n){if(n instanceof g)switch(e){case n.left:return n.right.is_constant_expression(a);case n.right:return!0;default:return!1}if(n instanceof N)switch(e){case n.condition:return n.consequent.is_constant_expression(a)&&n.alternative.is_constant_expression(a);case n.consequent:case n.alternative:return!0;default:return!1}if(n instanceof We){var t=n.expressions,i=t.indexOf(e);if(i<0)return!1;for(var r=t.length;--r>i;)if(!t[r].is_constant_expression(a))return!1;return!0}return n instanceof Dn}function v(e,n){return n instanceof y?Lt(n.body,e):n instanceof T?Lt(n.body,e):n instanceof pe?Lt(n.body,e):n instanceof me?n.body===e||n.alternative===e:n instanceof En?n.bfinally?n.bfinally===e:n.bcatch===e:void 0}function _(t,i,r){var o=e.right;e.right=at(Me,o);var s=i.may_throw(n);return e.right=o,et(n,t,i,a,s,r)}function m(n){var t=e.left.fixed;return t&&(t.to_binary=se(function(e){return e.left},t)),at(f,e,{operator:e.right.operator+"=",left:e.left,right:n})}function b(t){return t&&(t.fixed=!1),("="!=e.operator?at(g,e,{operator:e.operator.slice(0,-1),left:e.left,right:e.right}):Dt(n.parent(),e,e.right)).optimize(n)}}),e(N,function(e,n){if(n.option("sequences")&&e.condition instanceof We){var t=e.condition.expressions.slice();return(v=e.clone()).condition=t.pop(),t.push(v),dt(e,t).optimize(n)}if(!n.option("conditionals"))return e;var i=e.condition;if(n.option("booleans")&&!i.has_side_effects(n)&&Di(n,i),!(i=Si(n,i)))return Fe.warn("Condition always false [{start}]",e),dt(e,[e.condition,e.alternative]).optimize(n);if(!(i instanceof Fe))return Fe.warn("Condition always true [{start}]",e),dt(e,[e.condition,e.consequent]).optimize(n);var r=Yn(n),o=i.negate(n,r);(r?Qt:Kt)(i,o)===o&&(e=at(N,e,{condition:o,consequent:e.alternative,alternative:e.consequent}),o=i,i=e.condition);var s=e.consequent,a=e.alternative,c=$i(i,n);if(Ji(n,c)){if(c.equals(s))return at(g,e,{operator:"||",left:i,right:a}).optimize(n);if(c.equals(a))return at(g,e,{operator:"&&",left:i,right:s}).optimize(n)}var u=s.tail_node();if(u instanceof f){var l="="==u.operator,p=l?a.tail_node():a;if((l||s===u)&&p instanceof f&&u.operator==p.operator&&u.left.equals(p.left)&&(l&&u.left instanceof _n||!i.has_side_effects(n)&&T(s)&&T(a)))return at(f,e,{operator:u.operator,left:u.left,right:at(N,e,{condition:i,consequent:S(s),alternative:S(a)})})}p=a.tail_node();if(u.equals(p))return dt(e,s.equals(a)?[i,s]:[at(N,e,{condition:i,consequent:D(s),alternative:D(a)}),p]).optimize(n);var d,h=function n(t,r,o){var s=t.tail_node();var a=r.tail_node();if(!function e(n,t){if(n.TYPE!=t.TYPE)return;if(n.optional!=t.optional)return;if(n instanceof w){if(-1!=k(n,t))return;return"Call"!=n.TYPE||!(n.expression instanceof Be||t.expression instanceof Be)||e(n.expression,t.expression)}if(!(n instanceof Be))return;var i=n.property;var r=t.property;return(i instanceof Fe?i.equals(r):i==r)&&!(n.expression instanceof Ze||t.expression instanceof Ze)}(s,a))return!o&&at(N,e,{condition:i,consequent:t,alternative:r});var f=s.clone();var c=E(t,s,"expression");var u=E(r,a,"expression");var l=n(c,u);s.expression instanceof We&&(l=Dt(s,s.expression,l));f.expression=l;return f}(s,a,!0);if(h)return h;if(s instanceof w&&a.TYPE==s.TYPE&&(d=k(s,a))>=0&&s.expression.equals(a.expression)&&!i.has_side_effects(n)&&!s.expression.has_side_effects(n)){var v=s.clone(),_=s.args[d];return v.args[d]=_ instanceof Je?at(Je,e,{expression:at(N,e,{condition:i,consequent:_.expression,alternative:a.args[d].expression})}):at(N,e,{condition:i,consequent:_,alternative:a.args[d]}),v}if(u instanceof N&&u.alternative.equals(a))return at(N,e,{condition:at(g,e,{left:i,operator:"&&",right:E(s,u,"condition")}),consequent:u.consequent,alternative:At(u.alternative,a)});if(u instanceof N&&u.consequent.equals(a))return at(N,e,{condition:at(g,e,{left:o,operator:"||",right:E(s,u,"condition")}),consequent:At(u.consequent,a),alternative:u.alternative});if(p instanceof N&&s.equals(p.consequent))return at(N,e,{condition:at(g,e,{left:i,operator:"||",right:E(a,p,"condition")}),consequent:At(s,p.consequent),alternative:p.alternative});if(p instanceof N&&s.equals(p.alternative))return at(N,e,{condition:at(g,e,{left:o,operator:"&&",right:E(a,p,"condition")}),consequent:p.consequent,alternative:At(s,p.alternative)});if(u instanceof g&&"&&"==u.operator&&u.right.equals(a))return at(g,e,{operator:"&&",left:at(g,e,{operator:"||",left:o,right:E(s,u,"left")}),right:At(u.right,a)}).optimize(n);if(u instanceof g&&"||"==u.operator&&u.right.equals(a))return at(g,e,{operator:"||",left:at(g,e,{operator:"&&",left:i,right:E(s,u,"left")}),right:At(u.right,a)}).optimize(n);if(p instanceof g&&"&&"==p.operator&&p.right.equals(s))return at(g,e,{operator:"&&",left:at(g,e,{operator:"||",left:i,right:E(a,p,"left")}),right:At(s,p.right)}).optimize(n);if(p instanceof g&&"||"==p.operator&&p.right.equals(s))return at(g,e,{operator:"||",left:at(g,e,{operator:"&&",left:o,right:E(a,p,"left")}),right:At(s,p.right)}).optimize(n);var m=n.option("booleans")&&n.in_boolean_context();return y(s)?x(a)?b(i):at(g,e,{operator:"||",left:b(i),right:a}).optimize(n):x(s)?y(a)?b(i.negate(n)):at(g,e,{operator:"&&",left:b(i.negate(n)),right:a}).optimize(n):y(a)?at(g,e,{operator:"||",left:b(i.negate(n)),right:s}).optimize(n):x(a)?at(g,e,{operator:"&&",left:b(i),right:s}).optimize(n):(n.option("typeofs")&&Ti(i,s,a),e);function b(e){return e.is_boolean(n)?e:at(Dn,e,{operator:"!",expression:e.negate(n)})}function y(e){return e instanceof wn||m&&e instanceof I&&e.value||e instanceof Dn&&"!"==e.operator&&e.expression instanceof I&&!e.expression.value}function x(e){return e instanceof le||m&&(e instanceof I&&!e.value||e instanceof Dn&&"void"==e.operator&&!e.expression.has_side_effects(n))||e instanceof Dn&&"!"==e.operator&&e.expression instanceof I&&e.expression.value}function k(e,n){var t=e.args,i=n.args,r=t.length;if(r!=i.length)return-2;for(var o=0;o<r;o++)if(!t[o].equals(i[o])){if(t[o]instanceof Je!=i[o]instanceof Je)return-3;for(var s=o+1;s<r;s++)if(!t[s].equals(i[s]))return-2;return o}return-1}function E(e,n,t){if(e===n)return n[t];var i=e.expressions.slice(0,-1);return i.push(n[t]),dt(e,i)}function T(e){return e===e.tail_node()||Wn(e.expressions.slice(0,-1),function(e){return!e.has_side_effects(n)})}function S(e){if(!(e instanceof We))return e.right;var n=e.expressions.slice();return n.push(n.pop().right),dt(e,n)}function D(e){return e instanceof We?dt(e,e.expressions.slice(0,-1)):at(Ce,e,{value:0})}}),e(x,function(e,n){if(!n.option("booleans"))return e;if(n.in_boolean_context())return at(Ce,e,{value:+e.value});var t=n.parent();return t instanceof g&&("=="==t.operator||"!="==t.operator)?(Fe.warn("Non-strict equality against boolean: {operator} {value} [{start}]",{operator:t.operator,value:e.value,start:t.start}),at(Ce,e,{value:+e.value})):at(Dn,e,{operator:"!",expression:at(Ce,e,{value:1-e.value})})}),e(Je,function(e,n){var t=e.expression;return n.option("spreads")&&t instanceof s&&!(n.parent()instanceof je)?Zn.splice(t.elements.map(function(e){return e instanceof ge?at(An,e).optimize(n):e})):e}),e(Xe,function(e,n){var t=e.expression,i=e.property,r=Ci(e,n);if(r)return r;if(n.option("properties")){var a=i.evaluate(n);if(a!==i){if("string"==typeof a)if("undefined"==a)a=void 0;else(A=parseFloat(a)).toString()==a&&(a=A);i=e.property=Kt(i,xt(a,i).transform(n));var f=""+a;if(mt(f)&&f.length<=i.print_to_string().length+1)return at(te,e,{optional:e.optional,expression:t,property:f,quoted:!0}).optimize(n)}}var c,u,l,p,d=n.parent(),h=kt(n.self(),d);if(n.option("arguments")&&t instanceof _n&&S(c=t.definition())&&!t.in_arg&&i instanceof Ce&&Math.floor(y=i.value)==y&&(u=c.scope)===function(){var e,t=0;for(;e=n.parent(t++);)if(e instanceof Ee){if(e instanceof o)return;if(Rn(e))continue;return l=n.parent(t),e}}()&&u.uses_arguments<(h?2:3)){d instanceof Dn&&"delete"==d.operator&&(c.deleted||(c.deleted=[]),c.deleted[y]=!0);var v=u.argnames[y];if(c.deleted&&c.deleted[y])v=null;else if(v){var _;v instanceof ln&&"await"!=v.name&&t.scope.find_variable(v.name)===(_=v.definition())?(n.has_directive("use strict")||u.name||u.rest||!(l instanceof w&&y<l.args.length&&Wn(l.args.slice(0,y+1),function(e){return!(e instanceof Je)}))||!Wn(u.argnames,function(e){return e instanceof ln}))&&(z()||_.assignments||_.orig.length>1)&&(v=null):v=null}else if((h||!z())&&y<u.argnames.length+5&&n.drop_fargs(u,l)&&!u.rest)for(;y>=u.argnames.length;)v=u.make_var(ln,u,"argument_"+u.argnames.length),u.argnames.push(v);if(v&&Kn(function(e){return e.name===v.name},u.argnames)===v){h&&c.reassigned--;var g=at(_n,v);return g.reference(),v.unused=void 0,g}}if(h)return e;if(n.option("sequences")&&"Call"!=d.TYPE&&!(d instanceof he&&d.init===e)){var m=ji(e);if(m!==e)return m.optimize(n)}if(a!==i){var b=e.flatten_object(f,n);b&&(t=e.expression=b.expression,i=e.property=b.property)}if(n.option("properties")&&n.option("side_effects")&&i instanceof Ce&&t instanceof s&&Wn(p=t.elements,function(e){return!(e instanceof Je)})){var y,x=p[y=i.value];if(or(x,n)){for(var k=x instanceof ge,E=!k,T=[],D=p.length;--D>y;){(A=p[D].drop_side_effect_free(n))&&(T.unshift(A),E&&A.has_side_effects(n)&&(E=!1))}for(E||T.unshift(x);--D>=0;){var A;(A=p[D].drop_side_effect_free(n))?T.unshift(A):k?T.unshift(at(ge,p[D])):y--}return E?(T.push(x),dt(e,T).optimize(n)):at(Xe,e,{expression:at(s,t,{elements:T}),property:at(Ce,i,{value:y})})}}return ti(n,e);function z(){return!n.option("reduce_vars")||c.reassigned}}),Se.DEFMETHOD("contains_super",function(){var e=!1,n=this;return n.walk(new jn(function(t){return!!e||(t instanceof Ze?e=!0:t!==n&&t instanceof Ve&&!Rn(t)||void 0)})),e}),function(e){e(a,ct),e(c,ct),e(Fe,function(){var e=!1,n=this;return n.walk(new jn(function(t){return!!e||(t instanceof yn?e=!0:t!==n&&t instanceof Ve&&!Rn(t)||void 0)})),e})}(function(e,n){e.DEFMETHOD("contains_this",n)}),Be.DEFMETHOD("flatten_object",function(e,n){if(n.option("properties")&&"__proto__"!==e){var t=this.expression;if(t instanceof je)for(var i=t.properties,r=i.length;--r>=0;){var o=i[r];if(o.key===e){if(!Wn(i,sr))return;if(!or(o.value,n))return;for(var f,u,l=[],p=0;p<i.length;p++){var d=i[p].value;if(i[p]instanceof Ie){var h,v=!(d.uses_arguments||Un(d)||d.contains_this());if(v){u||(u=n.find_parent(Ve));var _=Pi(n,u);d.each_argname(function(e){_[e.name]&&(v=!1)})}if(v)h=Ln(d)?c:a;else{if(!(r!=p||(f=n.parent())instanceof w&&f.expression===this))return;h=d.CTOR}d=at(h,d)}l.push(d)}return at(Xe,this,{expression:at(s,t,{elements:l}),property:at(Ce,this,{value:r})})}}}}),e(te,function(e,n){"arguments"!=e.property&&"caller"!=e.property||Fe.warn("Function.prototype.{property} not supported [{start}]",e);var t=n.parent();if(kt(n.self(),t))return e;var i=Ci(e,n);if(i)return i;if(n.option("sequences")&&"Call"!=t.TYPE&&!(t instanceof he&&t.init===e)){var r=ji(e);if(r!==e)return r.optimize(n)}if(n.option("unsafe_proto")&&e.expression instanceof te&&"prototype"==e.expression.property){var o=e.expression.expression;if(Nt(o))switch(o.name){case"Array":e.expression=at(s,e.expression,{elements:[]});break;case"Function":e.expression=at(_e,e.expression,{argnames:[],body:[]}).init_vars(o.scope);break;case"Number":e.expression=at(Ce,e.expression,{value:0});break;case"Object":e.expression=at(je,e.expression,{properties:[]});break;case"RegExp":e.expression=at(Le,e.expression,{value:/t/});break;case"String":e.expression=at(Qe,e.expression,{value:""})}}var a=e.flatten_object(e.property,n);return a?a.optimize(n):ti(n,e)}),e(Q,function(e,n){return n.option("rests")&&e.rest instanceof Q?at(Q,e,{elements:e.elements.concat(e.rest.elements),rest:e.rest.rest}):e}),e(X,function(e,n){if(n.option("objects")){var t=e.key;t instanceof Fe&&(t=t.evaluate(n))!==e.key&&(e.key=""+t)}return e}),e(je,function(e,n){if(!n.option("objects"))return e;var t=!1,i=!1,r=!1,o=n.has_directive("use strict"),s=[],a=new Jn,f=[];if(e.properties.forEach(function(e){if(!(e instanceof Je))return l(e);i=!0;var o=e.expression;n.option("spreads")&&o instanceof je&&Wn(o.properties,function(e){return!(e instanceof Pe)&&(!(e instanceof Je)&&("__proto__"!==e.key||(e instanceof Re||!e.value.has_side_effects(n))))})?(t=!0,o.properties.forEach(function(e){var t=e.key,i=e instanceof Re;if("__proto__"===t){if(!i)return;t=xt(t,e)}l(i?at(He,e,{key:t,value:at(An,e).optimize(n)}):e)})):(r=!0,u(),f.push(e))}),u(),!t)return e;if(i&&r&&1==f.length){var c=f[0];c instanceof Ne&&c.key instanceof Ce&&(c.key=""+c.key.value)}return at(je,e,{properties:f});function u(){s.forEach(function(n){var i=a.get(n);switch(i.length){case 0:return;case 1:return f.push(i[0])}t=!0;var s=o&&!r&&i.pop();f.push(1==i.length?i[0]:at(He,e,{key:i[0].key,value:dt(e,i.map(function(e){return e.value}))})),s&&f.push(s),i.length=0}),s=[],a=new Jn}function l(e){var t=e.key;t instanceof Fe&&(i=!0,(t=t.evaluate(n))===e.key||"__proto__"===t?r=!0:t=e.key=""+t),sr(e)?(e.value.has_side_effects(n)&&u(),s.push(t),a.add(t,e)):(u(),f.push(e)),i&&!r&&"string"==typeof t&&ae.test(t)&&(r=!0,a.has(t)&&(e=a.get(t)[0]),e.key=at(Ce,e,{value:+t}))}}),function(e){function n(e,n,t,i,r,o,s){for(var a=[],f=o.expressions,c=t,u=f.length-(s||0),l=u;--u>=0;c=!0,r=!1){var p=f[u].try_inline(e,n,c,i,r);p&&(d(),a.push(p))}if(0!=a.length)return d(),!t&&a[0]instanceof $e&&(a[0]=at(Ge,o,{value:a[0].body})),at(y,o,{body:a.reverse()});function d(){l>u+1&&a.push(at($e,o,{body:dt(o,f.slice(u+1,l))})),l=u}}e(Fe,rt),e(f,rt),e(v,function(e,n,t,i){if(e.option("awaits")){var r=this,o=r.expression.try_inline(e,n,t,i,!0);if(o)return t||mi(o,function(n){n.in_bool=!1;var t=n.value;t instanceof v||(n.value=at(v,r,{expression:t||at(An,n).transform(e)}))}),ci(o)?o:at(y,r,{body:[o,at($e,r,{body:at(v,r,{expression:at(Ce,r,{value:0})})})]})}}),e(g,function(e,n,t,i,r){if(void 0!==t){var o=this,s=o.operator;if(Jt[s]){var a=o.right.try_inline(e,n,t,i,r);if(a)return at(me,o,{condition:function(n){switch(s){case"&&":return n;case"||":return n.negate(e);case"??":return at(g,o,{operator:"==",left:at(Me,o),right:n})}}(o.left),body:a,alternative:t?null:at(Ge,o,{value:at(An,o).transform(e)})})}}}),e(y,function(e,n,t,i){if(!t&&this.variables){var r=this.body,o=r.length-1;if(!(o<0)){var s=r[o].try_inline(e,this,t,i);if(s)return r[o]=s,this}}}),e(w,function(e,n,t,i,r){if(!(e.option("inline")<4)){var o=this;if(!o.is_expr_pure(e)){var a=o.expression;if(a instanceof Se&&!(a.name||a.uses_arguments||a.pinned()||Un(a))){var f=Rn(a);if(!(f&&a.value||a.body[0]instanceof ee||a.contains_this())){n||(n=Qn(e));var c=new Jn;for(c.set("NaN",!0);!(n instanceof Ve);)n.variables.each(function(e){c.set(e.name,!0)}),n=n.parent_scope;if(it(n,e.stack)&&!(n.pinned()&&a.variables.size()>(f?0:1))){if(n instanceof kn){if(a.variables.size()>(f?0:1)){if(!e.toplevel.vars)return;if(a.functions.size()>0&&!e.toplevel.funcs)return}c.set("arguments",!0)}var u=!r&&Ln(a);if(u){if(!e.option("awaits"))return;if(!Ln(n))return;if(o.may_throw(e))return}var l=n.var_names();if(i&&(i=[]),a.variables.all(function(e,n){return i&&i.push(e),!c.has(n)&&!l.has(n)||!f&&"arguments"==n&&1==e.orig.length})&&!(i&&i.length>0&&tr(a,i))){var p=!0;if(Wn(a.argnames,function(e){var n=!1,t=new jn(function(e){return!!n||(e instanceof G?fr(a,e.value)?n=!0:(e.name.walk(t),!0):e instanceof X?e.key instanceof Fe&&fr(a,e.key)?n=!0:(e.value.walk(t),!0):e instanceof ln&&!Wn(e.definition().orig,function(e){return!(e instanceof cn)})?n=!0:void 0)});return e.walk(t),!n&&(e instanceof ln||(p=!1),!0)})){if(a.rest){if(fr(a,a.rest))return;p=!1}var d;if(t?d=function(e){var n=!1;return e.walk(new jn(function(e){return!!n||(u&&(e instanceof v||e instanceof AST_ForAwaitOf)||e instanceof Ge?n=!0:e instanceof Ve||void 0)})),!n}:(r||Ln(a)||$n(n))&&(d=function(e){var n=!1,t=new jn(function(e){return!!n||(e instanceof Ge?n=!0:e instanceof Ve||void 0)});return e.walk(new jn(function(e){return!!n||(e instanceof En?(e.bfinally&&Wn(e.body,function(e){return e.walk(t),!n})&&e.bcatch&&e.bcatch.walk(t),!0):e instanceof Ve||void 0)})),!n}),(!d||Wn(a.body,d))&&Ni(a,Pi(e,n))){a.functions.each(function(e,t){n.functions.set(t,e)});var h=[];a.variables.each(function(t,r){if((f||"arguments"!=r||1!=t.orig.length)&&(l.set(r,!0),n.enclosed.push(t),n.variables.set(r,t),t.single_use=!1,i&&t.references.length!=t.replaced&&t.orig.length!=t.eliminated&&(1!=t.orig.length||!a.functions.has(r))&&Wn(t.orig,function(e){return!(e instanceof an)&&(e instanceof ln?!e.unused&&t.scope.resolve()!==a:!(e instanceof hn))}))){var o=t.orig[0];o instanceof rn||h.push(at($e,o,{body:ur(e,ar(o))}))}});var _=Object.create(null),g=new Jn;if(p&&Wn(o.args,function(e){return!(e instanceof Je)})){var m=o.args.slice();a.argnames.forEach(function(n){var t=m.shift();if(n.unused)t&&h.push(at($e,o,{body:t}));else{var i=at(On,o,{name:n.convert_symbol(gn,x),value:t||at(An,o).transform(e)});n instanceof ln&&cr(n.definition(),i),h.push(at(zn,o,{definitions:[i]}))}}),m.length&&h.push(at($e,o,{body:dt(o,m)}))}else h.push(at(zn,o,{definitions:[at(On,o,{name:at(Q,o,{elements:a.argnames.map(function(e){return e.unused?at(ge,e):e.convert_symbol(gn,x)}),rest:a.rest&&a.rest.convert_symbol(gn,x)}),value:at(s,o,{elements:o.args.slice()})})]}));g.each(function(e,n){var t=_[n];[].unshift.apply(t.orig,e),t.eliminated+=e.length}),[].push.apply(h,i?a.body.filter(function(e){if(!(e instanceof Te))return!0;var n=at(gn,ar(e.name)),t=n.definition();return t.fixed=!1,t.orig.push(n),t.eliminated++,h.push(at(zn,e,{definitions:[at(On,e,{name:n,value:gi(e,!0)})]})),!1}):a.body);var b=at(y,o,{body:h});return t||(u&&mi(b,function(e){var n=e.value;$t(n)||(e.value=at(v,o,{expression:n}))}),h.push(at(Ge,o,{value:$n(n)?at(An,o).transform(e):null}))),b}}}}}}}}function x(e,n){var t=n.definition();_[t.id]=t,g.add(t.id,e)}}),e(N,function(e,n,t,i,r){var o=this.consequent.try_inline(e,n,t,i,r),s=this.alternative.try_inline(e,n,t,i,r);if(o||s)return at(me,this,{condition:this.condition,body:o||a(this.consequent),alternative:s||a(this.alternative)});function a(e){return t?at($e,e,{body:e}):at(Ge,e,{value:e})}}),e(de,function(e,n,t,i){var r=this.body.try_inline(e,n,!0,!0);r&&(this.body=r);var o=this.init;return o&&(o=o.try_inline(e,n,!0,i))?(this.init=null,o instanceof y?(o.body.push(this),o):at(y,o,{body:[o,this]})):r&&this}),e(he,function(e,t,i,r){var o=this.body.try_inline(e,t,!0,!0);o&&(this.body=o);var s=this.object;if(s instanceof We){var a=n(e,t,!0,r,!1,s,1);if(a)return this.object=s.tail_node(),a.body.push(this),a}return o&&this}),e(me,function(e,t,i,r){var o=this.body.try_inline(e,t,i,r);o&&(this.body=o);var s=this.alternative;s&&(s=s.try_inline(e,t,i,r))&&(this.alternative=s);var a=this.condition;if(a instanceof We){var f=n(e,t,!0,r,!1,a,1);if(f)return this.condition=a.tail_node(),f.body.push(this),f}return(o||s)&&this}),e(xe,function(e,n,t,i){var r=this.body.try_inline(e,n,!0,!0);if(r)return this.body=r,this}),e(we,function(e,n,t,i){var r=this.body.try_inline(e,n,t,i);if(r){if(this.body instanceof xe&&r instanceof y){var o=r.body.pop();return this.body=o,r.body.push(this),r}return this.body=r,this}}),e(Oe,rt),e(Ge,function(e,n,t,i){var r=this.value;return r&&r.try_inline(e,n,void 0,"try"===i)}),e(We,function(e,t,i,r,o){return n(e,t,i,r,o,this)}),e($e,function(e,n,t,i){for(var r=this.body;r instanceof Dn;){var o=r.operator;if(Et[o])break;if("void"==o)break;r=r.expression}return t||$t(r)||(r=at(Dn,this,{operator:"void",expression:r})),r.try_inline(e,n,t||!1,i)}),e(Dn,function(e,n,t,i,r){var o=this,s=o.operator;if(!Et[s]){t||"void"!=s||(t=!1);var a=o.expression.try_inline(e,n,t,i,r);if(a)return t||mi(a,function(n){n.in_bool=!1;var t=n.value;"void"==s&&$t(t)||(n.value=at(Dn,o,{operator:s,expression:t||at(An,n).transform(e)}))}),a}}),e(Fn,function(e,t,i,r){var o=this.body.try_inline(e,t,i,r);o&&(this.body=o);var s=this.expression;if(s instanceof We){var a=n(e,t,!0,r,!1,s,1);if(a)return this.expression=s.tail_node(),a.body.push(this),a}return o&&this}),e(Mn,function(e,n,t,i){if(e.option("yields")&&this.nested){var r=this.expression;if("Call"==r.TYPE){var o=r.expression;switch(o.CTOR){case d:o=at(l,o);break;case AST_GeneratorFunction:o=at(_e,o);break;default:return}return(r=r.clone()).expression=o,r.try_inline(e,n,t,i)}}})}(function(e,n){e.DEFMETHOD("try_inline",n)}),e(Ge,function(e,n){var t=e.value;return t&&n.option("side_effects")&&$t(t,n)&&!$n(n.find_parent(Ve))&&(e.value=null),e})}(function(e,n){e.DEFMETHOD("optimize",function(e){if(this._optimized)return this;if(e.has_directive("use asm"))return this;var t=n(this,e);return t._optimized=!0,t})}),{Compressor:Tt}});
//# sourceMappingURL=sourcemaps/compress.js.map
