/**
 * skylark-uglifyjs - A version of uglifyjs that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./utils","./ast","./output","./parse","./scope"],function(e,n,t,i,r){"use strict";const{AST_Accessor:o,AST_Array:s,AST_Arrow:a,AST_Assign:f,AST_AsyncArrow:c,AST_Await:u,AST_BigInt:l,AST_Binary:p,AST_Block:d,AST_BlockScope:h,AST_BlockStatement:v,AST_Boolean:_,AST_Break:g,AST_Call:m,AST_Case:b,AST_Catch:y,AST_Chain:x,AST_Class:w,AST_ClassExpression:k,AST_ClassField:E,AST_ClassInitBlock:T,AST_ClassProperty:S,AST_ClassStaticBlock:A,AST_ConciseMethod:D,AST_Conditional:z,AST_Const:O,AST_Constant:q,AST_Continue:F,AST_Debugger:M,AST_Default:C,AST_DefaultAssign:j,AST_DefaultValue:P,AST_DefClass:H,AST_Definitions:N,AST_Defun:Y,AST_Destructuring:I,AST_Destructured:R,AST_DestructuredArray:U,AST_DestructuredKeyVal:B,AST_DestructuredObject:G,AST_Directive:L,AST_Do:V,AST_Dot:W,AST_DWLoop:$,AST_EmptyStatement:X,AST_Exit:J,AST_Expansion:K,AST_Export:Q,AST_ExportDeclaration:Z,AST_ExportDefault:ee,AST_ExportReferences:ne,AST_False:te,AST_Finally:ie,AST_For:re,AST_ForEnumeration:oe,AST_ForIn:se,AST_Function:ae,AST_Hole:fe,AST_If:ce,AST_Import:ue,AST_Infinity:le,AST_IterationStatement:pe,AST_Jump:de,AST_LabeledStatement:he,AST_Lambda:ve,AST_LambdaDefinition:_e,AST_LambdaExpression:ge,AST_Let:me,AST_LoopControl:be,AST_NaN:ye,AST_New:xe,AST_Node:we,AST_Null:ke,AST_Number:Ee,AST_Object:Te,AST_ObjectKeyVal:Se,AST_ObjectProperty:Ae,AST_ObjectIdentity:De,AST_ObjectMethod:ze,AST_PrefixedTemplateString:Oe,AST_PropAccess:qe,AST_RegExp:Fe,AST_Return:Me,AST_Scope:Ce,AST_Sequence:je,AST_SimpleStatement:Pe,AST_Spread:He,AST_Statement:Ne,AST_String:Ye,AST_Sub:Ie,AST_Switch:Re,AST_SwitchBranch:Ue,AST_Symbol:Be,AST_SymbolCatch:Ge,AST_SymbolClassProperty:Le,AST_SymbolConst:Ve,AST_SymbolDeclaration:We,AST_SymbolDefun:$e,AST_SymbolExport:Xe,AST_SymbolFunarg:Je,AST_SymbolImport:Ke,AST_SymbolLambda:Qe,AST_SymbolLet:Ze,AST_SymbolMethod:en,AST_SymbolRef:nn,AST_SymbolVar:tn,AST_Template:rn,AST_TemplateString:on,AST_This:sn,AST_Toplevel:an,AST_True:fn,AST_Try:cn,AST_Unary:un,AST_UnaryPostfix:ln,AST_UnaryPrefix:pn,AST_Undefined:dn,AST_Var:hn,AST_VarDef:vn,AST_While:_n,AST_With:gn,AST_Yield:mn,TreeTransformer:bn,TreeWalker:yn,_INLINE:xn,_NOINLINE:wn,_PURE:kn,first_in_statement:En,is_arrow:Tn,is_generator:Sn,is_statement:An,walk_body:Dn,walk_lambda:zn}=n,{all:On,defaults:qn,Dictionary:Fn,has_annotation:Mn,HOP:Cn,List:jn,make_node:Pn,makePredicate:Hn,MAP:Nn,member:Yn,noop:In,push_uniq:Rn,regexp_source_fix:Un,regexp_is_safe:Bn,remove:Gn,return_false:Ln,return_null:Vn,return_true:Wn,return_this:$n}=e,{is_basic_identifier_string:Xn,JS_Parse_Error:Jn,parse:Kn,PRECEDENCE:Qn,is_identifier_string:Zn}=i,{OutputStream:et}=t,{base54:nt,is_lhs:tt,is_funarg:it}=r;function rt(e,n){if(!(this instanceof rt))return new rt(e,n);bn.call(this,this.before,this.after),this.options=qn(e,{annotations:!n,arguments:!n,arrows:!n,assignments:!n,awaits:!n,booleans:!n,collapse_vars:!n,comparisons:!n,conditionals:!n,dead_code:!n,default_values:!n,directives:!n,drop_console:!1,drop_debugger:!n,evaluate:!n,expression:!1,functions:!n,global_defs:!1,hoist_exports:!n,hoist_funs:!1,hoist_props:!n,hoist_vars:!1,ie:!1,if_return:!n,imports:!n,inline:!n,join_vars:!n,keep_fargs:n,keep_fnames:!1,keep_infinity:!1,loops:!n,merge_vars:!n,module:!1,negate_iife:!n,objects:!n,optional_chains:!n,passes:1,properties:!n,pure_funcs:null,pure_getters:!n&&"strict",reduce_funcs:!n,reduce_vars:!n,rests:!n,sequences:!n,side_effects:!n,spreads:!n,strings:!n,switches:!n,templates:!n,top_retain:null,toplevel:!(!e||!e.module&&!e.top_retain),typeofs:!n,unsafe:!1,unsafe_comps:!1,unsafe_Function:!1,unsafe_math:!1,unsafe_proto:!1,unsafe_regexp:!1,unsafe_undefined:!1,unused:!n,varify:!n,webkit:!1,yields:!n},!0);var t=this.options.evaluate;this.eval_threshold=/eager/.test(t)?1/0:+t;var i=this.options.global_defs;if("object"==typeof i)for(var r in i)/^@/.test(r)&&Cn(i,r)&&(i[r.slice(1)]=Kn(i[r],{expression:!0}));!0===this.options.inline&&(this.options.inline=4),this.drop_fargs=this.options.keep_fargs?Ln:function(e,n){if(e.length_read)return!1;var t=e.name;if(!t)return n&&"Call"==n.TYPE&&n.expression===e;if(t.fixed_value()!==e)return!1;var i=t.definition();if(i.direct_access)return!1;var r=i.escaped;return r&&1!=r.depth},this.options.module&&(this.directives["use strict"]=!0);var o=this.options.pure_funcs;"function"==typeof o?this.pure_funcs=o:"string"==typeof o?this.pure_funcs=function(e){var n;return e instanceof m?n=e.expression:e instanceof rn&&(n=e.tag),!(n&&o===n.print_to_string())}:Array.isArray(o)?this.pure_funcs=function(e){var n;return e instanceof m?n=e.expression:e instanceof rn&&(n=e.tag),!(n&&Yn(n.print_to_string(),o))}:this.pure_funcs=Wn;var s=this.options.sequences;this.sequences_limit=1==s?800:0|s;var a=this.options.top_retain;a instanceof RegExp?this.top_retain=function(e){return a.test(e.name)}:"function"==typeof a?this.top_retain=a:a&&("string"==typeof a&&(a=a.split(/,/)),this.top_retain=function(e){return Yn(e.name,a)});var f=this.options.toplevel;this.toplevel="string"==typeof f?{funcs:/funcs/.test(f),vars:/vars/.test(f)}:{funcs:f,vars:f}}return rt.prototype=new bn(function(e,n,t){if(e._squeezed)return e;var i=e instanceof Ce;i&&(this.option("arrows")&&Tn(e)&&e.value&&(e.body=[e.first_statement()],e.value=null),e.hoist_properties(this),e.hoist_declarations(this),e.process_returns(this)),n(e,this),n(e,this);var r=e.optimize(this);return!i||r!==e||this.has_directive("use asm")||r.pinned()||(r.drop_unused(this),r.merge_variables(this)&&r.drop_unused(this),n(r,this)),r===e&&(r._squeezed=!0),r}),rt.prototype.option=function(e){return this.options[e]},rt.prototype.exposed=function(e){if(e.exported)return!0;if(e.undeclared)return!0;if(!(e.global||e.scope.resolve()instanceof an))return!1;var n=this.toplevel;return!On(e.orig,function(e){return n[e instanceof $e?"funcs":"vars"]})},rt.prototype.compress=function(e){(e=e.resolve_defines(this)).hoist_exports(this),this.option("expression")&&e.process_expression(!0);for(var n=this.options.merge_vars,t=+this.options.passes||1,i=1/0,r=!1,o={ie:this.option("ie")},s=0;s<t;s++)if(e.figure_out_scope(o),(s>0||this.option("reduce_vars"))&&e.reset_opt_flags(this),this.options.merge_vars=n&&(r||s==t-1),e=e.transform(this),t>1){var a=0;if(e.walk(new yn(function(){a++})),we.info("pass {pass}: last_count: {min_count}, count: {count}",{pass:s,min_count:i,count:a}),a<i)i=a,r=!1;else{if(r)break;r=!0}}return this.option("expression")&&e.process_expression(!1),e},function(e){function n(e,n){var t=n.get_property();if(!(t instanceof we)){var i;if(e instanceof s){var r=e.elements;if("length"==t)return nt(r.length,e);"number"==typeof t&&t in r&&(i=r[t])}else if(e instanceof ve){if("length"==t)return e.length_read=!0,nt(e.argnames.length,e)}else if(e instanceof Te){t=""+t;for(var o=e.properties,a=o.length;--a>=0;){if(!Yi(o[a]))return;i||o[a].key!==t||(i=o[a].value)}}return i instanceof nn&&i.fixed_value()||i}}function t(e,i,r,o,a,c,u){var l=i.parent(a);if(!(e.option("unsafe")&&l instanceof W&&function(e,n){return e instanceof _?Ht.Boolean[n]:e instanceof Ee?Ht.Number[n]:e instanceof Ye?Ht.String[n]:"valueOf"!=n&&(e instanceof s?Ht.Array[n]:e instanceof ve?Ht.Function[n]:e instanceof Te?Ht.Object[n]:e instanceof Fe?Ht.RegExp[n]&&!e.value.global:void 0)}(o,l.property))){var d=tt(r,l);if(d)return d;if(0!=a||!o||!o.is_constant()){if(l instanceof s)return t(e,i,l,l,a+1);if(l instanceof f)switch(l.operator){case"=":return t(e,i,l,o,a+1,c,u);case"&&=":case"||=":case"??=":return t(e,i,l,l,a+1);default:return}if(l instanceof p){if(!Dt[l.operator])return;return t(e,i,l,l,a+1)}if(l instanceof m)return!c&&l.expression===r&&!l.is_expr_pure(e)&&(!(o instanceof ge)||!(l instanceof xe)&&o.contains_this());if(l instanceof z){if(l.condition===r)return;return t(e,i,l,l,a+1)}if(l instanceof oe)return l.init===r;if(l instanceof Se){if(l.value!==r)return;var h=i.parent(a+1);return t(e,i,h,h,a+2)}if(l instanceof qe){if(l.expression!==r)return;var v=n(o,l);return(!c||u)&&t(e,i,l,v,a+1)}if(l instanceof je){if(l.tail_node()!==r)return;return t(e,i,l,o,a+1,c,u)}}}}function i(e){return e instanceof w||e instanceof ve}function r(e){return e instanceof w||e instanceof Y||e instanceof ae}function x(e){return"arguments"==e.name&&e.scope.uses_arguments}function A(e,n){do{if(e===n)return!1;if(n instanceof Ce)return!0}while(n=n.parent_scope)}function D(e,n,t){var i=e.redef||e.definition();return(!e.in_arg||!it(i))&&On(i.orig,function(e){return e instanceof Ve||e instanceof Ze?e instanceof Ke||n&&li(n,e):!(t&&e instanceof Qe)})}function j(e,n,t,i){return i instanceof f?"="==i.operator&&i.right===t:i instanceof m?i.expression!==t||i instanceof xe:i instanceof E?i.value===t&&!i.static:i instanceof J?i.value===t&&n.resolve()!==e.scope.resolve():i instanceof vn?i.value===t:void 0}function I(e,n){var t=Bn(nn,e);return t.fixed=n||Bn(dn,e),t}function K(e,n){return function(t){var i=e(t),r=(t=I(i,n),i.definition());return r.references.push(t),r.replaced++,t}}e(we,function(e,n){return e}),an.DEFMETHOD("hoist_exports",function(e){if(e.option("hoist_exports")){for(var n=this.body,t=[],i=0;i<n.length;i++){var r=n[i];r instanceof Z?(n[i]=r=r.body,r instanceof N?r.definitions.forEach(function(e){e.name.match_symbol(o,!0)}):o(r.name)):r instanceof ne&&(n.splice(i--,1),[].push.apply(t,r.properties))}t.length&&n.push(Bn(ne,this,{properties:t}))}function o(e){if(e instanceof We){var n=Bn(Xe,e);n.alias=Bn(Ye,n,{value:n.name}),t.push(n)}}}),Ce.DEFMETHOD("process_expression",function(e,n){var t=this,i=new bn(function(r){if(e){if(r instanceof L&&(r=Bn(Pe,r,{body:Bn(Ye,r)})),r instanceof Pe)return n?n(r):Bn(Me,r,{value:r.body})}else if(r instanceof Me){if(n)return n(r);var o=r.value;return o instanceof Ye?Bn(L,o):Bn(Pe,r,{body:o||Bn(pn,r,{operator:"void",expression:Bn(Ee,r,{value:0})})})}if(r instanceof d){if(r instanceof ve){if(r!==t)return r}else if("awaits"===e&&r instanceof cn&&r.bfinally)return r;for(var s=r.body.length;--s>=0;){var a=r.body[s];if(!wt(a,!0)){r.body[s]=a.transform(i);break}}}else r instanceof ce?(r.body=r.body.transform(i),r.alternative&&(r.alternative=r.alternative.transform(i))):r instanceof gn&&(r.body=r.body.transform(i));return r});t.transform(i)}),an.DEFMETHOD("unwrap_expression",function(){switch(this.body.length){case 0:return Bn(pn,this,{operator:"void",expression:Bn(Ee,this,{value:0})});case 1:var e=this.body[0];if(e instanceof L)return Bn(Ye,e);if(e instanceof Pe)return e.body;default:return Bn(m,this,{expression:Bn(ae,this,{argnames:[],body:this.body}).init_vars(this),args:[]})}}),we.DEFMETHOD("wrap_expression",function(){var e=this;return An(e)||(e=Bn(Pe,e,{body:e})),e instanceof an||(e=Bn(an,e,{body:[e]})),e});var Q=/^(0|[1-9][0-9]*)$/;function Oe(e){e._squeezed=!1,e._optimized=!1,e instanceof h&&(e._var_names=void 0),e instanceof nn&&(e.fixed=void 0)}function Le(e,n){return this.transform(new bn(function(t,i){return t instanceof P?((t=t.clone()).name=t.name.transform(this),t):t instanceof R?(i(t=t.clone(),this),t):t instanceof B?((t=t.clone()).value=t.value.transform(this),t):t.convert_symbol(e,n)}))}function en(e,n){var t=Bn(e,this);return n(t,this)||t}function on(e){var n=e.definition();n.assignments++,n.references.push(e)}function xn(e,n){var t=new yn(function(i){return i instanceof P?(i.value.walk(n),i.name.walk(t),!0):i instanceof B?(i.key instanceof we&&i.key.walk(n),i.value.walk(t),!0):e(i)});this.walk(t)}function wn(e){return e(this)}function kn(e,n){var t=!1,i=new yn(function(r){return!!t||(r instanceof P?n?(r.name.walk(i),!0):t=!0:r instanceof B?!n&&r.key instanceof we?t=!0:(r.value.walk(i),!0):e(r)?t=!0:void 0)});return this.walk(i),t}function qn(e){return e instanceof AST_AsyncGeneratorDefun||e instanceof AST_AsyncGeneratorFunction}function Mn(e){var n=0,t=e.self();do{if(t.variables)return t}while(t=e.parent(n++))}function Pn(e,n,t,i,r,o){for(var s;s=e.parent(n++);t=s){if(s===i)return!1;if(o&&s instanceof ve){if(s.name||is_async(s)||Sn(s))return!0}else if(s instanceof cn){if(s.bfinally&&s.bfinally!==t)return!0;if(r&&s.bcatch&&s.bcatch!==t)return!0}}return!1}!function(e){function r(e,n,t){t.assignments=0,t.bool_return=0,t.drop_return=0,t.cross_loop=!1,t.direct_access=!1,t.escaped=[],t.fixed=!t.const_redefs&&!t.scope.pinned()&&!n.exposed(t)&&!(t.init instanceof ge&&t.init!==t.scope)&&t.init,t.reassigned=0,t.recursive_refs=0,t.references=[],t.single_use=void 0}function o(e,n,t){t.variables.each(function(e){r(0,n,e)})}function a(e,n,t){t.fn_defs=[],t.variables.each(function(i){r(0,n,i);var o=i.init;o instanceof _e&&(t.fn_defs.push(o),o.safe_ids=null),null===i.fixed?(i.safe_ids=e.safe_ids,b(e,i)):i.fixed&&(e.loop_ids[i.id]=e.in_loop,b(e,i))}),t.may_call_this=function(){t.may_call_this=t.contains_this()?Wn:Ln},t.uses_arguments&&t.each_argname(function(e){e.definition().last_ref=!1}),n.option("ie")&&t.variables.each(function(e){var n=e.orig[0].definition();n!==e&&(n.fixed=!1)})}function c(e,n){var t=n.safe_ids;return void 0===t||t===e.safe_ids}function u(e,n){var t=e.fn_scanning;e.fn_scanning=n,n.walk(e),e.fn_scanning=t}function l(e,n){n.enclosed.forEach(function(t){if(n.variables.get(t.name)!==t&&!k(e,t)){t.single_use=!1;var i=t.fixed;"function"==typeof i&&(i=i()),i instanceof ve&&void 0!==i.safe_ids||(t.fixed=!1)}})}function d(e,n,t){var i=t.safe_ids;if(void 0!==i&&!1!==i)if(t.parent_scope.resolve().may_call_this===Wn)Yn(t,e.fn_visited)&&l(e,t);else if(i){var r=Yn(t,e.fn_visited);i===e.safe_ids?r||u(e,t):r?l(e,t):t.safe_ids=!1}else e.fn_scanning&&e.fn_scanning!==n.scope.resolve()?t.safe_ids=!1:(t.safe_ids=e.safe_ids,u(e,t))}function v(e,n){var t=n.fn_defs,i=n.may_call_this===Wn?t:t.filter(function(n){return!1===n.safe_ids||(n.safe_ids=e.safe_ids,u(e,n),!1)});g(e),i.forEach(function(n){n.safe_ids=e.safe_ids,u(e,n)}),t.forEach(function(e){e.safe_ids=void 0}),n.fn_defs=void 0,n.may_call_this=void 0}function _(e,n){var t=Object.create(e.safe_ids);n||(t.seq={}),e.safe_ids=t}function g(e){e.safe_ids=Object.getPrototypeOf(e.safe_ids)}function b(e,n){e.safe_ids[n.id]={}}function y(e,n){e.references.push(n),!1!==e.last_ref&&(e.last_ref=n)}function k(e,n){if("m"==n.single_use)return!1;var t=e.safe_ids[n.id];if(t){var i=Cn(e.safe_ids,n.id);if(!i){var r=e.safe_ids.seq;t.read?t.read!==r&&(t.read=!0):t.read=r}return null==n.fixed?!x(n)&&((!n.global||"arguments"!=n.name)&&(e.loop_ids[n.id]=null,n.fixed=Bn(dn,n.orig[0]),i&&(n.safe_ids=void 0),!0)):!t.assign||t.assign===e.safe_ids}return n.fixed instanceof _e}function E(e,n,t){if(!t){if(it(n)&&n.scope.uses_arguments&&!e.has_directive("use strict"))return!1;if(!On(n.orig,function(e){return!(e instanceof Ve)}))return!1}if(void 0===n.fixed)return t||On(n.orig,function(e){return!(e instanceof Ze)});if(!1===n.fixed||0===n.fixed)return!1;var i=e.safe_ids[n.id];if(n.safe_ids)return n.safe_ids[n.id]=!1,n.safe_ids=void 0,null===n.fixed||Cn(e.safe_ids,n.id)&&!i.read;if(!Cn(e.safe_ids,n.id)){if(!i)return!1;if(i.read||e.in_loop){var r=e.find_parent(h);if(r instanceof w)return!1;if(n.scope.resolve()!==r.resolve())return!1}i.assign=!(!i.assign||i.assign===e.safe_ids)||e.safe_ids}if(null!=n.fixed&&i.read){if(i.read!==e.safe_ids.seq)return!1;if(e.loop_ids[n.id]!==e.in_loop)return!1}return k(e,n)&&On(n.orig,function(e){return!(e instanceof Qe)})}function S(e){if(!e)return!1;if(e instanceof f){var n=e.operator;return"="==n?S(e.right):!Dt[n.slice(0,-1)]}return e instanceof je?S(e.tail_node()):e.is_constant()||i(e)||e instanceof De}function O(e,t,i,r,o,a,f){var c=e.parent(a);if(!o||!o.is_constant()){if(j(t,i,r,c))return t.escaped.push(c),!(f>1)||o&&o.is_constant_expression(i)||(f=1),(!t.escaped.depth||t.escaped.depth>f)&&(t.escaped.depth=f),t.scope.resolve()!==i.resolve()&&(t.escaped.cross_scope=!0),void(t.fixed&&(t.fixed.escaped=t.escaped));if(function(e,n){return n instanceof s||(n instanceof p?Dt[n.operator]:n instanceof z?n.condition!==e:n instanceof je?n.tail_node()===e:n instanceof He||void 0)}(r,c))O(e,t,i,c,c,a+1,f);else if(c instanceof Se&&c.value===r){var u=e.parent(a+1);O(e,t,i,u,u,a+2,f)}else if(c instanceof qe&&c.expression===r&&(O(e,t,i,c,o=n(o,c),a+1,f+1),o))return;a>0||c instanceof m&&c.expression===r||c instanceof je&&c.tail_node()!==r||c instanceof Pe||c instanceof un&&!unary_side_effects[c.operator]||(t.direct_access=!0,t.fixed&&(t.fixed.direct_access=!0))}}function q(e){if(e instanceof Ie){var n=e.expression;if(n instanceof nn){var t=n.definition();if(x(t)){var i=e.property;i.is_constant()&&(i=i.value),(i instanceof we||Q.test(i))&&(t.reassigned++,(i instanceof we?t.scope.argnames:[t.scope.argnames[i]]).forEach(function(e){e instanceof Je&&(e.definition().fixed=!1)}))}}}}function F(e,n){var t,i;return function(){var r=e();return t!==r&&(t=r,i=n(r)),i}}function M(e,n,t,i,r){var o=new yn(function(t){if(t instanceof P)return Oe(t),_(e,!0),t.value.walk(e),g(e),(f=i)&&(i=function(e,n,t){var i,r;return function(){if(r===n)return n;var o=t(),s=oi(e,o,!0);return s instanceof we?r=n:i!==o&&(i=o,r=void 0===s?Xn(n,[o,n.value]):o),r}}(n,t,f)),t.name.walk(o),i=f,!0;if(t instanceof U){Oe(t);var a,f=i;if(t.elements.forEach(function(e,n){if(e instanceof fe)return Oe(e);f&&(i=F(f,function(t){return Bn(Ie,e,{expression:t,property:Bn(Ee,e,{value:n})})})),e.walk(o)}),t.rest)f&&(i=n.option("rests")&&F(f,function(e){if(!(e instanceof s))return t;for(var n=0,i=t.elements.length;n<i;n++)if(e.elements[n]instanceof He)return t;return a||(a=Bn(s,t,{})),a.elements=e.elements.slice(i),a})),t.rest.walk(o);return i=f,!0}if(t instanceof G){Oe(t);f=i;return t.properties.forEach(function(n){Oe(n),n.key instanceof we&&(_(e),n.key.walk(e),g(e)),f&&(i=F(f,function(e){var t=n.key,i=Ie;return"string"==typeof t&&(Zn(t)?i=W:t=nt(t,n)),Bn(i,n,{expression:e,property:t})})),n.value.walk(o)}),t.rest&&(i=!1,t.rest.walk(o)),i=f,!0}return r(t,i,function(){for(var n=e.stack.length,i=0,r=o.stack.length-1;i<r;i++)e.stack.push(o.stack[i]);t.walk(e),e.stack.length=n}),!0});t.walk(o)}function H(e,n,t){var i=this;i.inlined=!1;var r=e.parent(),o=!is_async(i)&&!Sn(i),f=!o,c=!1;i.walk(new yn(function(e){return f?c=!0:e instanceof Me?f=!0:e instanceof Ce&&e!==i||void 0})),c&&_(e,o),a(e,t,i);var u=!i.uses_arguments||e.has_directive("use strict");i.argnames.forEach(function(n,o){var s=r.args[o];M(e,t,n,function(){var e=i.argnames.indexOf(n),t=e<0?s:r.args[e];return t instanceof je&&t.expressions.length<2&&(t=t.expressions[0]),t||Bn(dn,r)},h)});var l,p=i.rest;p&&M(e,t,p,t.option("rests")&&function(){return i.rest!==p?p:(l||(l=Bn(s,i,{})),l.elements=r.args.slice(i.argnames.length),l)},h),zn(i,e);var d=e.safe_ids;return v(e,i),c||(e.safe_ids=d),!0;function h(n,t){var i=n.definition();t&&u&&void 0===i.fixed?(b(e,i),e.loop_ids[i.id]=e.in_loop,i.fixed=t,i.fixed.assigns=[n]):i.fixed=!1}}e(we,In),e(f,function(e,n,i){var r=this,o=r.left,s=r.right,a=o instanceof nn&&o.definition(),f=a||o instanceof R;switch(r.operator){case"=":return o.equals(s)&&!o.has_side_effects(i)?(s.walk(e),function n(t){Oe(t);if(t instanceof W)n(t.expression);else if(t instanceof Ie)n(t.expression),t.property.walk(e);else if(t instanceof nn){var i=t.definition();y(i,t),i.fixed&&(t.fixed=i.fixed,t.fixed.assigns?t.fixed.assigns.push(r):t.fixed.assigns=[r])}else t.walk(e)}(o),r.redundant=!0,!0):a&&s instanceof ge?(h(),s.parent_scope.resolve().fn_defs.push(s),s.safe_ids=null,a.fixed&&r.write_only||d(e,a,s),!0):f?(s.walk(e),h(),!0):void q(o);case"&&=":case"||=":case"??=":var c=!0;default:if(!f)return q(o),v();a.assignments++;var u=a.fixed;if(t(i,e,r,r,0))return a.fixed=!1,v();var l=k(e,a);return c&&_(e,!0),s.walk(e),c&&g(e),l&&!o.in_arg&&E(e,a)?(y(a,o),b(e,a),a.single_use&&(a.single_use=!1),o.fixed=a.fixed=function(){return Bn(p,r,{operator:r.operator.slice(0,-1),left:I(o,u),right:r.right})},o.fixed.assigns=u&&u.assigns?u.assigns.slice():[a.orig[0]],o.fixed.assigns.push(r),o.fixed.to_binary=K(function(e){return e.left},u)):(o.walk(e),a.fixed=!1),!0}function h(){var n=a&&Oi(e,a),f=t(i,e,r,s,0,S(s),n);M(e,i,o,function(){return r.right},function(n,t,i){if(!(n instanceof nn))return q(n),void i();var a=n.definition();a.assignments++,t&&!n.in_arg&&E(e,a)?(y(a,n),b(e,a),(o instanceof R||1==a.orig.length&&a.orig[0]instanceof $e)&&(a.single_use=!1),e.loop_ids[a.id]=e.in_loop,a.fixed=f?0:t,n.fixed=t,n.fixed.assigns=[r],O(e,a,n.scope,r,s,0,1)):(i(),a.fixed=!1)})}function v(){if(c)return o.walk(e),_(e,!0),s.walk(e),g(e),!0}}),e(p,function(e){if(Dt[this.operator])return this.left.walk(e),_(e,!0),this.right.walk(e),g(e),!0}),e(h,function(e,n,t){o(0,t,this)}),e(m,function(e,n){var t=this.expression;if(t instanceof ge){var i=_t(this);return this.args.forEach(function(n){n.walk(e),n instanceof He&&(i=!1)}),i&&(t.reduce_vars=H),t.walk(e),i&&delete t.reduce_vars,!0}if("Call"==this.TYPE)switch(e.in_boolean_context()){case"d":var r=!0;case!0:!function e(n,t){if(n instanceof f){if("="!=n.operator)return;e(n.left,t),e(n.right,t)}else if(n instanceof p){if(!Dt[n.operator])return;e(n.left,t),e(n.right,t)}else if(n instanceof z)e(n.consequent,t),e(n.alternative,t);else if(n instanceof nn){var i=n.definition();i.bool_return++,t&&i.drop_return++}}(t,r)}t.walk(e);var o=this.optional;o&&_(e,!0),this.args.forEach(function(n){n.walk(e)}),o&&g(e);var s=t instanceof nn&&t.fixed_value();return s instanceof ve?d(e,t.definition(),s):e.find_parent(Ce).may_call_this(),!0}),e(w,function(e,n,t){var i=this;o(0,t,i),i.extends&&i.extends.walk(e);var r=i.properties.filter(function(n){return Oe(n),n.key instanceof we&&(e.push(n),n.key.walk(e),e.pop()),n.value});if(i.name){var s=i.name.definition(),a=e.parent();(a instanceof Z||a instanceof ee)&&(s.single_use=!1),E(e,s,!0)?(b(e,s),e.loop_ids[s.id]=e.in_loop,s.fixed=function(){return i},s.fixed.assigns=[i],fi(s)||(s.single_use=!1)):s.fixed=!1}return r.forEach(function(n){e.push(n),!n.static||yt(n)&&n.value.contains_this()?(_(e),n.value.walk(e),g(e)):n.value.walk(e),e.pop()}),!0}),e(T,function(e,n,t){return _(e,!0),a(e,t,this),n(),v(e,this),!0}),e(z,function(e){return this.condition.walk(e),_(e,!0),this.consequent.walk(e),g(e),_(e,!0),this.alternative.walk(e),g(e),!0}),e(P,function(e){return _(e,!0),this.value.walk(e),g(e),this.name.walk(e),!0}),e(V,function(e){var n=e.in_loop;return e.in_loop=this,_(e),this.body.walk(e),ii(this,e.parent())&&(g(e),_(e)),this.condition.walk(e),g(e),e.in_loop=n,!0}),e(re,function(e,n,t){o(0,t,this),this.init&&this.init.walk(e);var i=e.in_loop;return e.in_loop=this,_(e),this.condition&&this.condition.walk(e),this.body.walk(e),this.step&&(ii(this,e.parent())&&(g(e),_(e)),this.step.walk(e)),g(e),e.in_loop=i,!0}),e(oe,function(e,n,t){o(0,t,this),this.object.walk(e);var i=e.in_loop;e.in_loop=this,_(e);var r=this.init;return r instanceof N?r.definitions[0].name.mark_symbol(function(e){if(e instanceof We){var n=e.definition();n.assignments++,n.fixed=!1}},e):r instanceof R||r instanceof nn?r.mark_symbol(function(e){if(e instanceof nn){var n=e.definition();y(n,e),n.assignments++,e.is_immutable()||(n.fixed=!1)}},e):r.walk(e),this.body.walk(e),g(e),e.in_loop=i,!0}),e(ce,function(e){return this.condition.walk(e),_(e,!0),this.body.walk(e),g(e),this.alternative&&(_(e,!0),this.alternative.walk(e),g(e)),!0}),e(he,function(e){return _(e,!0),this.body.walk(e),g(e),!0}),e(ve,function(e,n,t){var i=this;return!c(e,i)||(!Rn(e.fn_visited,i)||(i.inlined=!1,_(e),a(e,t,i),n(),v(e,i),i.name&&O(e,i.name.definition(),i,i.name,i,0,1),!0))}),e(_e,function(e,n,t){var i=this,r=i.name.definition(),o=e.parent();return(o instanceof Z||o instanceof ee)&&(r.single_use=!1),!c(e,i)||(!Rn(e.fn_visited,i)||(i.inlined=!1,_(e),a(e,t,i),n(),v(e,i),!0))}),e(Ie,function(e){if(this.optional)return this.expression.walk(e),_(e,!0),this.property.walk(e),g(e),!0}),e(Re,function(e,n,t){o(0,t,this),this.expression.walk(e);var i=!0;return this.body.forEach(function(n){n instanceof C||(n.expression.walk(e),i&&(i=!1,_(e,!0)))}),i||g(e),Dn(this,e),!0}),e(Ue,function(e){return _(e,!0),Dn(this,e),g(e),!0}),e(Ge,function(){this.definition().fixed=!1}),e(Ke,function(){this.definition().fixed=!1}),e(nn,function(e,n,r){var o=this,s=o.definition(),a=s.fixed||s.last_ref&&s.last_ref.fixed;y(s,o),1==s.references.length&&!s.fixed&&s.orig[0]instanceof $e&&(e.loop_ids[s.id]=e.in_loop);var f,c=Oi(e,s);switch(c&&c.enclosed.forEach(function(n){if(s!==n&&n.scope.resolve()!==c){var t=n.fixed&&n.fixed.assigns;if(t&&!(t[t.length-1]instanceof vn)){var i=e.safe_ids[n.id];i&&(i.assign=!0)}}}),"m"==s.single_use&&s.fixed&&(s.fixed=0,s.single_use=!1),s.fixed){case 0:k(e,s)||(s.fixed=!1);case!1:var u=s.redefined();u&&A(s.scope,o.scope)&&(u.single_use=!1);break;case void 0:s.fixed=!1;break;default:if(!k(e,s)){s.fixed=!1;break}o.in_arg&&s.orig[0]instanceof Qe&&(o.fixed=s.scope);var l=o.fixed_value();c?s.recursive_refs++:l&&function(e,n){return e.option("unused")&&!n.scope.pinned()&&!1!==n.single_use&&n.references.length-n.recursive_refs==1&&!(it(n)&&n.scope.uses_arguments)}(r,s)?(s.in_loop=e.loop_ids[s.id]!==e.in_loop,s.single_use=i(l)&&!l.pinned()&&(!s.in_loop||e.parent()instanceof m)||!s.in_loop&&s.scope===o.scope.resolve()&&l.is_constant_expression()):s.single_use=!1,t(r,e,o,l,0,S(l),c)&&(s.single_use?s.single_use="m":s.fixed=0),s.fixed&&e.loop_ids[s.id]!==e.in_loop&&(s.cross_loop=!0),O(e,s,o.scope,o,l,0,1)}o.fixed||(o.fixed=0===s.fixed?a:s.fixed),l instanceof ve&&!((f=e.parent())instanceof m&&f.expression===o)&&d(e,s,l)}),e(rn,function(e,n){var t=this.tag;if(t){if(t instanceof ge)return this.expressions.forEach(function(n){n.walk(e)}),t.walk(e),!0;t.walk(e),this.expressions.forEach(function(n){n.walk(e)});var i=t instanceof nn&&t.fixed_value();return i instanceof ve?d(e,t.definition(),i):e.find_parent(Ce).may_call_this(),!0}}),e(an,function(e,n,t){return this.globals.each(function(e){r(0,t,e)}),_(e,!0),a(e,t,this),n(),v(e,this),!0}),e(cn,function(e,n,t){return o(0,t,this),_(e,!0),Dn(this,e),g(e),this.bcatch&&(_(e,!0),this.bcatch.walk(e),g(e)),this.bfinally&&this.bfinally.walk(e),!0}),e(un,function(e,n){var t=this;if(UNARY_POSTFIX[t.operator]){var i=t.expression;if(i instanceof nn){var r=i.definition();r.assignments++;var o=r.fixed;return k(e,r)&&!i.in_arg&&E(e,r)?(y(r,i),b(e,r),r.single_use&&(r.single_use=!1),r.fixed=function(){return Bn(p,t,{operator:t.operator.slice(0,-1),left:Bn(pn,t,{operator:"+",expression:I(i,o)}),right:Bn(Ee,t,{value:1})})},r.fixed.assigns=o&&o.assigns?o.assigns.slice():[],r.fixed.assigns.push(t),t instanceof pn?i.fixed=r.fixed:(i.fixed=function(){return Bn(pn,t,{operator:"+",expression:I(i,o)})},i.fixed.assigns=o&&o.assigns,i.fixed.to_prefix=K(function(e){return e.expression},r.fixed))):(i.walk(e),r.fixed=!1),!0}q(i)}}),e(vn,function(e,n,t){var i=this,r=i.value;if(r instanceof ge&&i.name instanceof We){s(),r.parent_scope.resolve().fn_defs.push(r),r.safe_ids=null;var o=i.name.definition();o.fixed||d(e,o,r)}else r?(r.walk(e),s()):e.parent()instanceof me&&s();return!0;function s(){M(e,t,i.name,function(){return i.value||Bn(dn,i)},function(n,t){var r=n.definition();t&&E(e,r,!0)?(b(e,r),e.loop_ids[r.id]=e.in_loop,r.fixed=t,r.fixed.assigns=[i],(n instanceof Ve&&r.redefined()||!D(n)&&!fi(r))&&(r.single_use=!1)):r.fixed=!1})}}),e(_n,function(e,n){var t=e.in_loop;return e.in_loop=this,_(e),n(),g(e),e.in_loop=t,!0})}(function(e,n){e.DEFMETHOD("reduce_vars",n)}),an.DEFMETHOD("reset_opt_flags",function(e){var n=new yn(e.option("reduce_vars")?function(t,i){return Oe(t),t.reduce_vars(n,i,e)}:Oe);n.fn_scanning=null,n.fn_visited=[],n.in_loop=null,n.loop_ids=Object.create(null),n.safe_ids=Object.create(null),n.safe_ids.seq={},this.walk(n)}),Be.DEFMETHOD("fixed_value",function(e){var n=this.definition(),t=n.fixed;if(t)return this.fixed&&(t=this.fixed),(t instanceof we?t:t()).tail_node();if(!(t=0===t&&this.fixed))return t;var i=(t instanceof we?t:t()).tail_node();return e&&1!=n.escaped.depth&&Ei(i,!0)?i:i.is_constant()?i:void 0}),nn.DEFMETHOD("is_immutable",function(){var e=this.redef||this.definition();return e.orig[0]instanceof Qe&&(1==e.orig.length||!!this.in_arg&&!(e.orig[1]instanceof Je))}),we.DEFMETHOD("convert_symbol",In),P.DEFMETHOD("convert_symbol",Le),R.DEFMETHOD("convert_symbol",Le),We.DEFMETHOD("convert_symbol",en),nn.DEFMETHOD("convert_symbol",en),P.DEFMETHOD("mark_symbol",xn),R.DEFMETHOD("mark_symbol",xn),We.DEFMETHOD("mark_symbol",wn),nn.DEFMETHOD("mark_symbol",wn),we.DEFMETHOD("match_symbol",function(e){return e(this)}),P.DEFMETHOD("match_symbol",kn),R.DEFMETHOD("match_symbol",kn);var Nn=Hn("Infinity NaN undefined");function Un(e,n){if(e instanceof AST_Atom)return!0;if(e instanceof De)return!0;if(e instanceof qe){if("__proto__"===e.property)return!0;if((e=e.expression)instanceof nn){if(e.is_immutable())return!1;e=e.fixed_value()}return!e||(!!e.tail_node().is_constant()||Un(e,n))}if(e instanceof nn){if(e.is_immutable())return!0;var t=e.definition();return n.exposed(t)&&Nn[t.name]}return!1}function Bn(e,n,t){return t?(t.start=n.start,t.end=n.end):t=n,new e(t)}function Xn(e,n){return 1==n.length?n[0]:Bn(je,e,{expressions:n.reduce(ft,[])})}function nt(e,n){switch(typeof e){case"string":return Bn(Ye,n,{value:e});case"number":return isNaN(e)?Bn(ye,n):isFinite(e)?1/e<0?Bn(pn,n,{operator:"-",expression:Bn(Ee,n,{value:-e})}):Bn(Ee,n,{value:e}):e<0?Bn(pn,n,{operator:"-",expression:Bn(le,n)}):Bn(le,n);case"boolean":return Bn(e?fn:te,n);case"undefined":return Bn(dn,n);default:if(null===e)return Bn(ke,n);if(e instanceof RegExp)return Bn(Fe,n,{value:e});throw new Error(string_template("Can't handle constant of type: {type}",{type:typeof e}))}}function ot(e){return e instanceof qe||gt(e)&&"eval"==e.name}function st(e,n,t){var i=!1;return"Call"==e.TYPE?i=e.expression===n&&ot(t):e instanceof rn?i=e.tag===n&&ot(t):e instanceof pn&&(i="delete"==e.operator||"typeof"==e.operator&&gt(t)),i?Xn(n,[Bn(Ee,n,{value:0}),t]):t}function at(e,n){var t=new Fn;return e.walk(new yn(function(e){if(e instanceof nn){var n=e.definition(),i=e.fixed;i&&t.has(n.id)?t.get(n.id)!==i&&t.set(n.id,!1):t.set(n.id,i)}})),t.size()>0&&n.walk(new yn(function(e){if(e instanceof nn){var n=e.definition(),i=e.fixed;i&&t.has(n.id)&&t.get(n.id)!==i&&(e.fixed=!1)}})),n}function ft(e,n){return n instanceof je?[].push.apply(e,n.expressions):e.push(n),e}function ct(e){return e instanceof O||e instanceof H||e instanceof me}function ut(e){if(e instanceof _e){var n=e.name.definition(),t=e.name.scope;return n.scope===t||On(n.references,function(e){var n=e.scope;do{if(n===t)return!0}while(n=n.parent_scope)})}return!ct(e)}function lt(e){if(null===e)return[];if(e instanceof v)return On(e.body,ut)?e.body:[e];if(e instanceof X)return[];if(An(e))return[e];throw new Error("Can't convert thing to statement array")}function pt(e){return null===e||(e instanceof X||e instanceof v&&0==e.body.length)}function dt(e){return On(e.body,function(e){return pt(e)||e instanceof Y||e instanceof hn&&xt(e)})}function ht(e){return e instanceof pe&&e.body instanceof v?e.body:e}function vt(e){if("Call"!=e.TYPE)return!1;do{e=e.expression}while(e instanceof qe);return e instanceof ge?!Tn(e):vt(e)}function _t(e){var n=e.expression;if(n.name)return!1;if(!(e instanceof xe))return!0;var t=!1;return n.walk(new yn(function(e){return!!t||(e instanceof AST_NewTarget?t=!0:e instanceof Ce&&e!==n||void 0)})),!t}function gt(e){return e instanceof nn&&e.definition().undeclared}var mt,bt=Hn("Array Boolean clearInterval clearTimeout console Date decodeURI decodeURIComponent encodeURI encodeURIComponent Error escape eval EvalError Function isFinite isNaN JSON Map Math Number parseFloat parseInt RangeError ReferenceError RegExp Object Set setInterval setTimeout String SyntaxError TypeError unescape URIError WeakMap WeakSet");function yt(e){return e.static&&e.value&&(e instanceof E||e instanceof AST_ClassInit)}function xt(e){return On(e.definitions,function(e){return!e.value})}function wt(e,n){return e instanceof H?n&&!e.extends&&On(e.properties,function(e){return!(e.key instanceof we)&&!yt(e)}):e instanceof N?(n||e instanceof hn)&&xt(e):e instanceof Z?wt(e.body,n):e instanceof ee?wt(e.body,n):e instanceof _e}function kt(e,n){var t=e.lastIndexOf(n);if(t<0)return!1;for(;++t<e.length;)if(!wt(e[t],!0))return!1;return!0}function Et(e,n){var t;if(e.init instanceof v&&(t=e.init,e.init=t.body.pop(),t.body.push(e)),e.init instanceof Y?(t||(t=Bn(v,e,{body:[e]})),t.body.splice(-1,0,e.init),e.init=null):e.init instanceof Pe?e.init=e.init.body:pt(e.init)&&(e.init=null),t)return n?jn.splice(t.body):t}function Tt(e,n){var i,a,c,l,_,k,T=I(n,function(e){return e instanceof ve});!function(){var e=n.self(),t=0;do{if(!i&&e.variables&&(i=e),e instanceof y)n.parent(t).bfinally&&(_||(_={}),_.bfinally=!0),t++;else if(e instanceof ie)t++;else if(e instanceof pe)l=!0;else{if(e instanceof Ce){k=e;break}e instanceof cn&&(_||(_={}),e.bcatch&&(_.bcatch=!0),e.bfinally&&(_.bfinally=!0))}}while(e=n.parent(t++))}();var S,A,q=10;do{if(A=S,S=0,Q(e)&&(S=1),!S&&1==A)break;if(n.option("dead_code")&&(ne(e,n)&&(S=2),!S&&2==A))break;if(n.option("if_return")&&(ee(e,n)&&(S=3),!S&&3==A))break;if(n.option("awaits")&&n.option("side_effects")&&(te(e,n)&&(S=4),!S&&4==A))break;if(n.option("inline")>=4&&(fe(e,n)&&(S=5),!S&&5==A))break;if(n.sequences_limit>0){if(ue(e,n)&&(S=6),!S&&6==A)break;if(ye(e,n)&&(S=7),!S&&7==A)break}if(n.option("join_vars")&&(Ye(e)&&(S=8),!S&&8==A))break;n.option("collapse_vars")&&K(e,n)&&(S=9)}while(S&&q-- >0);return e;function I(e,n){var t,i=e.self(),r=0;do{if(i instanceof y)i=e.parent(r++);else if(i instanceof he)i=i.body;else if(i instanceof Ue){var o=e.parent(r);(o.body[o.body.length-1]===i||s(i.body))&&(r++,i=o)}do{if(n(t=i))return t;i=e.parent(r++)}while(i instanceof ce)}while(t&&(i instanceof v||i instanceof y||i instanceof Ce||i instanceof Ue||i instanceof cn)&&kt(i.body,t));function s(e){for(var n=e.length;--n>=0;)if(e[n]instanceof g)return!0;return!1}}function K(e,n){if(!k.pinned()){for(var g,y,T=new Fn,S=[],A=!1,O=new Fn,q=e.length,F=new bn(function(e,t){if(Ve)return e;if(!Le)return e!==I[X]?e:++X<I.length?sn(e,F):(Le=!0,(te=(ne?function e(n,t){var i=F.parent(t);if(i instanceof s)return e(i,t+1);if(i instanceof f){return _e(i)?n:i.left.match_symbol(function(e){return e instanceof nn&&(se.name==e.name||ne.name==e.name)})?n:i.left!==n&&Dt[r=i.operator.slice(0,-1)]?Dn(i,r,t):e(i,t+1)}if(i instanceof u)return e(i,t+1);if(i instanceof p){var r;return i.left!==n&&Dt[r=i.operator]?Dn(i,r,t):e(i,t+1)}if(i instanceof m)return i;if(i instanceof b)return i.expression!==n?n:e(i,t+1);if(i instanceof z)return i.condition!==n?n:e(i,t+1);if(i instanceof N)return qn(i,t+1);if(i instanceof V)return n;if(i instanceof J)return qn(i,t+1);if(i instanceof re)return i.init!==n&&i.condition!==n?n:e(i,t+1);if(i instanceof oe)return i.init!==n?n:e(i,t+1);if(i instanceof ce)return i.condition!==n?n:e(i,t+1);if(i instanceof Ae){var o=F.parent(t+1);return On(o.properties,function(e){return e instanceof Se})?e(o,t+2):o}if(i instanceof qe){var a=i.expression;return a===n?e(i,t+1):n}if(i instanceof je)return(i.tail_node()===n?e:qn)(i,t+1);if(i instanceof Pe)return qn(i,t+1);if(i instanceof He)return e(i,t+1);if(i instanceof Re)return i.expression!==n?n:e(i,t+1);if(i instanceof un)return"delete"==i.operator?n:e(i,t+1);if(i instanceof vn)return i.name.match_symbol(function(e){return e instanceof We&&(se.name==e.name||ne.name==e.name)})?n:e(i,t+1);if(i instanceof _n)return i.condition!==n?n:e(i,t+1);if(i instanceof mn)return e(i,t+1);return null}:function e(n,t){var i=F.parent(t);if(i instanceof s)return n;if(i instanceof f)return n;if(i instanceof u)return n;if(i instanceof p)return n;if(i instanceof m)return n;if(i instanceof b)return n;if(i instanceof z)return n;if(i instanceof N)return qn(i,t+1);if(i instanceof J)return n;if(i instanceof ce)return n;if(i instanceof pe)return n;if(i instanceof Ae)return n;if(i instanceof qe)return n;if(i instanceof je)return(i.tail_node()===n?e:qn)(i,t+1);if(i instanceof Pe)return qn(i,t+1);if(i instanceof He)return n;if(i instanceof Re)return n;if(i instanceof un)return n;if(i instanceof vn)return n;if(i instanceof mn)return n;return null})(e,0))===e&&(Ve=!0),e);var i,r,a=F.parent();if(!ie&&hn(e,a)&&(ie=a),de&&ue&&Ke&&!ie&&e instanceof f&&"="!=e.operator&&e.left.equals(se))return Xe++,A=!0,we.info("Cascading {this} [{start}]",e),Ke=!1,Oe=$n(se),e.right.transform(F),Vn(K),Ve?i=K:(Ve=!0,i=Bn(p,K,{operator:de,left:se.fixed&&se.definition().fixed?se.fixed.to_binary(K):se,right:Ye})),Bn(f,e,{operator:"=",left:e.left,right:Bn(p,e,{operator:e.operator.slice(0,-1),left:i,right:e.right})});if(function(e,t){if(e===Ye)return!0;if(t instanceof re&&e!==t.init)return!0;if(e instanceof f)return"="!=e.operator&&se.equals(e.left);if(e instanceof m)return se instanceof qe&&(!!se.equals(e.expression)&&!(Ye instanceof ge&&!Ye.contains_this()));return e instanceof w?!n.has_directive("use strict"):e instanceof M||(e instanceof Y?he&&se.name===e.name.name:e instanceof B?e.key instanceof we:e instanceof $||e instanceof be||e instanceof cn||e instanceof gn)}(e,a))return Ve=!0,e;if(e.single_use)return e;if(!(e instanceof We)&&(ue&&se.equals(e)||le&&(r=le(e,this)))){if(!Ke||ie&&(r||!Fe||!Ge))return r||ne||(Ve=!0),e;if(tt(e,a))return ne&&!r&&(Z=!0),e;if(!r&&ee&&e.fixed!==se.fixed)return Ve=!0,e;if(ne)return ie&&0==Q&&(Q=L-Xe),r||Xe++,e;if(Xe++,A=Ve=!0,we.info("Collapsing {this} [{start}]",e),"Binary"==K.TYPE)return Wn(K,e),Bn(f,K,{operator:"=",left:K.right.left,right:"&&"==K.operator?Bn(z,K,{condition:K.left,consequent:K.right.right,alternative:e}):Bn(z,K,{condition:K.left,consequent:e,alternative:K.right.right})});if(K instanceof ln)return Bn(pn,K,{operator:K.operator,expression:se.fixed&&se.definition().fixed?se.fixed.to_prefix(K):se});if(K instanceof pn)return Vn(K),K;if(Wn(Ye,e),K instanceof vn){var c=K.name.definition();return c.references.length-c.replaced!=1||n.exposed(c)?Bn(f,K,{operator:"=",left:e,right:Ye}):(c.replaced++,st(a,e,Ye))}Vn(Ye);var l=K.clone();return l.right=Ye,l}if(function(e,t){if(!(e instanceof nn))return!1;if(e.is_declared(n)){if(e.fixed_value())return!1;if(D(e))return!(t instanceof qe&&t.expression===e)&&x(e.definition())}else if(fn(e,t))return!1;return!Ge||(le=!1,!1)}(e,a))return Ve=!0,e;if((xn(e,a)||_e(e))&&(te=e,e instanceof Ce&&(Ve=!0)),e instanceof o){var d=Ke;return Ke=!1,t(e,F),Ke=d,on(e)}if(e instanceof R){d=Ke;return Ke=!1,t(e,F),Ke=d,on(e)}if(e instanceof P){e.name=e.name.transform(F);d=Ke;return Ke=!1,e.value=e.value.transform(F),Ke=d,on(e)}if(!(!(e instanceof h)||e instanceof Ce||e.variables&&e.variables.all(function(e){return!ke.has(e.name)&&!Oe.has(e.name)}))){d=Ke;return Ke=!1,sn(e,F)||t(e,F),Ke=d,on(e)}return sn(e,F)?on(e):void 0},on),H=new bn(function(e){if(Ve)return e;if(!Le){if(e!==I[X])return e;switch(X++,I.length-X){case 0:if(Le=!0,Z)return e;if(e!==K)return e;if(e instanceof vn)return e;en.replaced++;var n=H.parent();return n instanceof je&&n.tail_node()!==e?(ne.replaced++,Ye===Ne?jn.skip:Xn(Ne,Ne.expressions.slice(0,-1))):Ye;case 1:if(!Z&&e.body===K)return Le=!0,en.replaced++,ne.replaced++,null;default:return sn(e,H)}}if(e instanceof nn&&e.definition()===en){if(tt(e,H.parent()))return e;--Xe||(Ve=!0),we.info("Replacing {this} [{start}]",e);var t=Ye.clone();return t.scope=e.scope,t.reference(),Xe==Q?(Ve=!0,Bn(f,K,{operator:"=",left:e,right:t})):(en.replaced++,t)}return e instanceof C||e instanceof Ce?e:void 0},function(e){return Kn(e,H)});--q>=0;){0==q&&n.option("unused")&&kn();var I=[];for(En(e[q]);S.length>0;){var L,X=0,K=(I=S.pop())[I.length-1],Q=-1,Z=!1,ee=!1,ne=null,te=null,ie=null,se=Nn(K),fe=se&&se.has_side_effects(n),ue=se&&(!fe||se instanceof nn)&&!Un(se,n),le=Rn(K);if(ue||le){var de=K instanceof f&&K.operator.slice(0,-1),he=K.name instanceof Je,_e=Ln;if(K.may_throw(n)){if(he&&is_async(k))continue;_e=_?function(e){return e.has_side_effects(n)}:ot}var ye=!1,xe=!1,ke=new Fn,ze=!0,Oe=$n(K),Fe=Qn(se),Ne=In(K),Ye=Ne;fe||(!de&&Ye instanceof je&&(Ye=Ye.tail_node()),fe=Zn());var Ue=_||!Fe?function(e){return e instanceof R}:Ln,Ge=et(K),Le=he,Ve=!1,Xe=0,Ke=!g||!Le;if(!Ke){for(var Qe=K.arg_index+1;!Ve&&Qe<g.length;Qe++)g[Qe]&&g[Qe].transform(F);Ke=!0}for(var Ze=q;!Ve&&Ze<e.length;Ze++)e[Ze].transform(F);if(ne){if(!Xe||L>Xe+Z){S.push(I),y=!0;continue}Xe==Q&&(Z=!0);var en=se.definition();Ve=!1,X=0,Le=he;for(Ze=q;!Ve&&Ze<e.length;Ze++)e[Ze].transform(H)||e.splice(Ze--,1);Xe=K instanceof vn&&K===I[I.length-1]&&en.references.length==en.replaced&&!n.exposed(en),ne.last_ref=!1,ne.single_use=!1,A=!0}Xe&&Jn(K)}}}return A}function on(e){return Ve?e:(te===e&&(Ve=!0),ie===e&&(ie=null),e)}function sn(e,n){if(e instanceof h){if(e instanceof Ce)return e;if(e instanceof w){e.name&&(e.name=e.name.transform(n)),!Ve&&e.extends&&(e.extends=e.extends.transform(n));for(var t=[],i=[],r=0;!Ve&&r<e.properties.length;r++){(o=e.properties[r]).key instanceof we&&(o.key=o.key.transform(n)),o.static&&(o instanceof E?o.value&&t.push(o):o instanceof AST_ClassInit&&[].push.apply(i,o.value.body))}for(r=0;!Ve&&r<i.length;r++)i[r].transform(n);for(r=0;!Ve&&r<t.length;r++){var o;(o=t[r]).value=o.value.transform(n)}return e}if(e instanceof oe)return e.object=e.object.transform(n),Ve=!0,e;if(e instanceof Re){e.expression=e.expression.transform(n);for(r=0;!Ve&&r<e.body.length;r++){var s=e.body[r];if(s instanceof b){if(!Le){if(s!==I[X])continue;X++}if(s.expression=s.expression.transform(n),!Ge)break;le=!1}}return Ve=!0,e}}}function fn(e,n){return n instanceof f?"="==n.operator&&n.left===e:n instanceof P?n.name===e:n instanceof U||(n instanceof B?n.value===e:void 0)}function hn(e,n){return n instanceof f?n.left!==e&&Dt[n.operator.slice(0,-1)]:n instanceof p?n.left!==e&&Dt[n.operator]:n instanceof m?n.optional&&n.expression!==e:n instanceof b?n.expression!==e:n instanceof z?n.condition!==e:n instanceof ce?n.condition!==e:n instanceof Ie?n.optional&&n.expression!==e:void 0}function xn(e,t){if(e instanceof u)return!0;if("Binary"==e.TYPE)return!Ti(e.operator,e.right,n);if(e instanceof m){var i=e.expression;if(i instanceof nn&&(h=i.definition(),i=i.fixed_value()),!(i instanceof ve))return!e.is_expr_pure(n);if(h&&Oi(n,h,i))return!0;if(i.collapse_scanning)return!1;i.collapse_scanning=!0;var o=Ke;Ke=!1;for(var a=te,f=ie,c=0;!Ve&&c<i.argnames.length;c++)wn(g,i.argnames[c],e.args[c])&&(Ve=!0);if(!Ve)if(i.rest&&wn(g,i.rest,Bn(s,e,{elements:e.args.slice(c)})))Ve=!0;else if(Tn(i)&&i.value)i.value.transform(F);else for(c=0;!Ve&&c<i.body.length;c++){var l=i.body[c];if(l instanceof Me){l.value&&l.value.transform(F);break}l.transform(F)}return ie=f,te=a,Ke=o,i.collapse_scanning=!1,Ve?(Ve=!1,!0):!1}if(e instanceof w){if(!_)return!1;var p=e.extends;return!!p&&(p instanceof nn&&(p=p.fixed_value()),!r(p))}if(e instanceof J){if(_){if(_.bfinally)return!0;if(_.bcatch&&e instanceof AST_Throw)return!0}return fe||se instanceof qe||rt(se)}if(e instanceof ae)return n.option("ie")&&e.name&&Oe.has(e.name.name);if(e instanceof De)return nt(e,t);if(e instanceof qe){if(fe)return!0;var d=e.expression;if(d instanceof nn&&x(d.definition()))return!0;if(n.option("unsafe")){if(gt(d)&&bt[d.name])return!1;if(Yt(d))return!1}return!ze||!ne&&(!(!_&&Fe)&&(!e.optional&&d.may_throw_on_access(n)))}if(e instanceof He)return!0;if(e instanceof nn){if(nt(e,t))return!fn(e,t);if(fe&&rt(e))return!0;var h=e.definition();return(_||h.scope.resolve()!==k)&&!D(e)}if(e instanceof rn)return!e.is_expr_pure(n);if(e instanceof vn)return!!Ue(e.name)||(e.value||t instanceof me)&&e.name.match_symbol(function(e){return e instanceof We&&(Oe.has(e.name)||fe&&rt(e))},!0);if(e instanceof mn)return!0;var v=tt(e.left,e);return!!v&&(v instanceof qe||(!!Ue(v)||v.match_symbol(function(e){return e instanceof nn&&(Oe.has(e.name)||ye&&n.exposed(e.definition()))},!0)));function g(e){return e.transform(F),Ve}}function wn(e,t,i){if(t instanceof P)return e(t.value)||wn(e,t.name,t.value)||!At(i)&&wn(e,t.name,i);if(!i)return!(t instanceof Be);if(t instanceof R){if(t.rest&&wn(e,t.rest))return!0;if(t instanceof U)return i instanceof s?!On(t.elements,function(n,t){return!wn(e,n,i[t])}):!i.is_string(n)||!On(t.elements,function(n){return!wn(e,n)});if(t instanceof G)return!!i.may_throw_on_access(n)||!On(t.properties,function(n){return!(n.key instanceof we&&e(n.key))&&!wn(e,n.value)})}}function kn(){if(!1!==c){var e=n.parent(),t=n.self();if(void 0===c){if(!(t instanceof ge)||Sn(t)||t.uses_arguments||t.pinned()||!(e instanceof m)||e.expression!==t||!On(e.args,function(e){return!(e instanceof He)}))return void(c=!1);if(!_t(e))return;c=!0}var i,r=t.in_strict_mode(n)&&!t.parent_scope.resolve(!0).in_strict_mode(n);is_async(t)?(i=function(e){return e instanceof Be&&"await"==e.name},a=!0):(i=function(e){return e instanceof u&&!s.find_parent(Ce)},void 0===a&&(a=Pn(n,1,e,null,!0,!0)));for(var o=null,s=new yn(function(e,n){if(!h)return!0;if(i(e)||e instanceof mn)return h=null,!0;if(e instanceof De)return!r&&o||(h=null),!0;var s;if(e instanceof nn)return(e.in_arg&&!fi(e.definition())||(s=t.variables.get(e.name))&&s!==e.definition())&&(h=null),!0;if(e instanceof Ce&&!Tn(e)){var a=o;return o=e,n(),o=a,!0}}),f=(g=e.args.slice()).length,l=new Fn,p=t.argnames.length;--p>=0;){var d=t.argnames[p],h=g[p],v=null;if(d instanceof P&&(v=d.value,d=d.name,g[f+p]=v),d instanceof R){if(a&&wn(function(e){return e.has_side_effects(n)},d,h)){S.length=0;break}g[f+p]=t.argnames[p]}else if(!l.has(d.name)&&(l.set(d.name,!0),v&&(h=At(h)?v:null),h||v?h instanceof ve&&h.pinned()?h=null:h&&h.walk(s):h=Bn(dn,d).transform(n),h)){var _=Bn(vn,d,{name:d,value:h});_.name_index=p,_.arg_index=v?f+p:p,S.unshift([_])}}t.rest&&g.push(t.rest)}}function En(e,n){if(I.push(e),e instanceof s)e.elements.forEach(function(e){En(e,n)});else if(e instanceof f){var t=e.left;t instanceof R||S.push(I.slice()),En(t),En(e.right),t instanceof nn&&"="==e.operator&&T.set(t.name,(T.get(t.name)||0)+1)}else if(e instanceof u)En(e.expression,n);else if(e instanceof p){var i=Dt[e.operator];n&&i&&"??"!=e.operator&&e.right instanceof f&&"="==e.right.operator&&!(e.right.left instanceof R)&&S.push(I.slice()),En(e.left,!i&&n),En(e.right,n)}else if(e instanceof m)En(e.expression),e.args.forEach(En);else if(e instanceof b)En(e.expression);else if(e instanceof z)En(e.condition),En(e.consequent,n),En(e.alternative,n);else if(e instanceof N)e.definitions.forEach(En);else if(e instanceof W)En(e.expression);else if(e instanceof $)En(e.condition),e.body instanceof d||En(e.body);else if(e instanceof J)e.value&&En(e.value);else if(e instanceof re)e.init&&En(e.init,!0),e.condition&&En(e.condition),e.step&&En(e.step,!0),e.body instanceof d||En(e.body);else if(e instanceof oe)En(e.object),e.body instanceof d||En(e.body);else if(e instanceof ce)En(e.condition),e.body instanceof d||En(e.body),!e.alternative||e.alternative instanceof d||En(e.alternative);else if(e instanceof Te)e.properties.forEach(function(e){I.push(e),e.key instanceof we&&En(e.key),e instanceof Se&&En(e.value,n),I.pop()});else if(e instanceof je){var r=e.expressions.length-(n?0:1);e.expressions.forEach(function(e,n){En(e,n<r)})}else if(e instanceof Pe)En(e.body,!0);else if(e instanceof He)En(e.expression);else if(e instanceof Ie)En(e.expression),En(e.property);else if(e instanceof Re)En(e.expression),e.body.forEach(En);else if(e instanceof un)UNARY_POSTFIX[e.operator]?S.push(I.slice()):En(e.expression);else if(e instanceof vn){if(e.name instanceof tn)if(e.value){var o=e.name.definition();o.references.length>o.replaced&&S.push(I.slice())}else O.set(e.name.name,(O.get(e.name.name)||0)+1);e.value&&En(e.value)}else e instanceof mn&&e.expression&&En(e.expression);I.pop()}function Dn(e,n,t){var i;do{i=e,e=F.parent(++t)}while(e instanceof f&&e.operator.slice(0,-1)==n||e instanceof p&&e.operator==n);return i}function zn(e,n,t,i,r){var o=Ke;Ke=!1;var s=te,a=ie,f=F.stack;return F.stack=[i],e.transform(F),F.stack=f,ie=a,te=s,Ke=o,Ve?(Ve=!1,t):n(i,r+1)}function qn(e,n){var t=F.parent(n);if(xn(e,t))return e;if(hn(e,t))return e;if(t instanceof s)return qn(t,n+1);if(t instanceof f)return o(t.left);if(t instanceof u)return e;if(t instanceof p)return qn(t,n+1);if(t instanceof m)return qn(t,n+1);if(t instanceof b)return qn(t,n+1);if(t instanceof z)return qn(t,n+1);if(t instanceof N)return qn(t,n+1);if(t instanceof J)return qn(t,n+1);if(t instanceof ce)return qn(t,n+1);if(t instanceof pe)return e;if(t instanceof Ae){var i=F.parent(n+1);return On(i.properties,function(e){return e instanceof Se})?qn(i,n+2):i}if(t instanceof qe){var r=t.expression;return r===e?qn(t,n+1):zn(r,qn,e,t,n)}return t instanceof je?qn(t,n+1):t instanceof Pe?qn(t,n+1):t instanceof He?e:t instanceof Re?qn(t,n+1):t instanceof un?qn(t,n+1):t instanceof vn?o(t.name):t instanceof mn?e:null;function o(i){return _e(t)?e:i!==e&&i instanceof R?zn(i,qn,e,t,n):qn(t,n+1)}}function Cn(e){if(y)y=!1;else if(!(L<1)){var t=(e=e.tail_node())instanceof f&&"="==e.operator?e.left:e;if(t instanceof nn){var i=t.definition();if(!i.undeclared&&!x(i)){if(t!==e){if(Un(t,n))return;if(i.references.length-i.replaced<2)return;var r=K.clone();r[r instanceof f?"right":"value"]=t,K.name_index>=0&&(r.name_index=K.name_index,r.arg_index=K.arg_index),K=r}return ne=i}}}}function Hn(e){return e.references.length-e.replaced-(T.get(e.name)||0)}function Nn(e){if(e instanceof f){if(!((r=e.left)instanceof nn))return r;var t=r.definition();if(k.uses_arguments&&it(t))return r;if(n.exposed(t))return r;if(L=Hn(t),t.fixed&&r.fixed){var i=t.references.filter(function(e){return e.fixed===r.fixed}).length-1;i<L&&(L=i,Q=0,ee=!0)}return"="==e.operator&&Cn(e.right),r}if(e instanceof p)return e.right.left;if(e instanceof un)return e.expression;if(e instanceof vn){var r;if((t=(r=e.name).definition()).const_redefs)return;if(!Yn(r,t.orig))return;if(k.uses_arguments&&it(t))return;var o=t.orig.length-t.eliminated-(O.get(t.name)||0);return L=Hn(t),t.fixed&&(L=Math.min(L,t.references.filter(function(n){if(!n.fixed)return!0;if(!n.fixed.assigns)return!0;var t=n.fixed.assigns[0];return t===r||In(t)===e.value}).length)),o>1&&!(r instanceof Je)?(Cn(e.value),Bn(nn,r)):Cn(e.value)||1==L&&!n.exposed(t)?Bn(nn,r):void 0}}function In(e){if(e instanceof f)return e.right;if(e instanceof p){var n=e.clone();return n.right=e.right.right,n}return e instanceof vn?e.value:void 0}function Rn(e){if(!(e instanceof f&&e.right.single_use)){for(var t,i=Object.create(null),r=new yn(function(e){e instanceof nn&&(i[e.definition().id]=!0)});e instanceof f&&"="==e.operator;)e.left.walk(r),e=e.right;if(e instanceof De)return c;if(e instanceof nn){var o=e.evaluate(n);return o===e?c:Gn(o,c)}if(e.is_truthy())return Gn(!0,Ln);if(e.is_constant()){var a=e.evaluate(n);if(!(a instanceof we))return Gn(a,c)}return se instanceof nn&&(!!function e(t){return!(t instanceof s)&&(t instanceof p&&Dt[t.operator]?e(t.left)&&e(t.right):!(t instanceof m)&&(t instanceof z?e(t.consequent)&&e(t.alternative):!(t instanceof Te||t.has_side_effects(n))))}(e)&&(e.walk(new yn(function(e){if(t)return!0;e instanceof nn&&i[e.definition().id]&&(t=!0)})),!t&&c))}function c(n){return e.equals(n)}}function Gn(e,t){return function(i,r){if(r.in_boolean_context()){if(e&&i.is_truthy()&&!i.has_side_effects(n))return!0;if(i.is_constant()){var o=i.evaluate(n);if(!(o instanceof we))return!o==!e}}return t(i)}}function Vn(e){for(;e.write_only&&(e.write_only=!1,e instanceof f);)e=e.right}function Wn(e,n){var t=n.scope||Mn(F)||i;e.walk(new yn(function(e){if(e instanceof h)return!0;e instanceof Be&&(e.scope=t)}))}function $n(e){var i=new Fn;e instanceof vn&&(e.name.definition().fixed||(ze=!1),i.add(e.name.name,se));var r=k.uses_arguments&&!n.has_directive("use strict"),o=k instanceof an,s=new yn(function(a){var c;if(a instanceof nn){if(!(c=a.fixed_value())){c=a;var u=a.definition(),l=a.fixed&&a.fixed.escaped||u.escaped;u.undeclared||!u.assignments&&l&&!l.cross_scope||!j(u,a.scope,a,s.parent())&&qi(u)||(ze=!1)}}else a instanceof De&&(c=a);if(c)i.add(a.name,t(n,s,a,c,0));else{if(a instanceof ve){for(var d,h=0,v=a;d=s.parent(h++);v=d){if(d instanceof f){if(d.left===v)break;if("="==d.operator)continue;if(Dt[d.operator.slice(0,-1)])continue;break}if(d instanceof p){if(Dt[d.operator])continue;break}if(d instanceof m)return;if(d instanceof Ce)return;if(d instanceof je){if(d.tail_node()===v)continue;break}if(d instanceof rn){if(d.tag)return;break}}return a.enclosed.forEach(function(e){e.scope!==a&&ke.set(e.name,!0)}),!0}r&&a instanceof Ie&&(k.each_argname(function(e){n.option("reduce_vars")&&!e.definition().assignments||(e.definition().fixed||(ze=!1),i.add(e.name,!0))}),r=!1)}if(o)if("Call"==a.TYPE){if(xe)return;var _=a.expression;if(_ instanceof qe)return;if(_ instanceof ge&&!_.contains_this())return;xe=!0}else a instanceof qe&&function e(n){return n instanceof nn&&!(n=n.fixed_value())||(n instanceof f?"="==n.operator&&e(n.right):n instanceof qe||n instanceof De)}(a.expression)&&(a!==se||e instanceof un?ye=!0:xe=!0)});return e.walk(s),i}function Jn(t){var i=Ye===Ne?null:Xn(Ne,Ne.expressions.slice(0,-1)),r=t.name_index;if(r>=0){var o,s=k.argnames[r];s instanceof P?(k.argnames[r]=s=s.clone(),s.value=i||Bn(Ee,s,{value:0})):(o=n.parent().args)[r]&&(k.argnames[r]=s.clone(),o[r]=i||Bn(Ee,o[r],{value:0}))}else{var a=I.length-1,f=I[a];(f instanceof vn||I[a-1].body===f)&&a--;var c=new bn(function(e,n,t){if(Le)return e;if(e!==I[X])return e;if(++X<=a)return sn(e,c);if(Le=!0,e instanceof N){O.set(f.name.name,(O.get(f.name.name)||0)+1),ne&&ne.replaced++;var r=e.definitions,o=r.indexOf(f),s=f.clone();if(s.value=null,!i)return e.definitions[o]=s,e;var u=[Bn(Pe,i,{body:i})];if(o>0){var l=e.clone();l.definitions=r.slice(0,o),u.unshift(l),(e=e.clone()).definitions=r.slice(o)}return u.push(e),e.definitions[0]=s,t?jn.splice(u):Bn(v,e,{body:u})}return i?An(e)?Bn(Pe,i,{body:i}):i:t?jn.skip:null},function(e,n){return e instanceof re?Et(e,n):Kn(e,c)});Ve=!1,Le=!1,X=0,(e[q]=e[q].transform(c))||e.splice(q,1)}}function Kn(e,n){if(e instanceof je)switch(e.expressions.length){case 0:return null;case 1:return st(n.parent(),e,e.expressions[0])}}function Qn(e){var n=root_expr(e);if(!(n instanceof nn))return!1;if(n.definition().scope.resolve()!==k)return!1;if(!l)return!0;if(de)return!1;if(K instanceof un)return!1;var t=Oe.get(n.name);return!t||t[0]===e}function Zn(){return!(K instanceof un)&&Ye.has_side_effects(n)}function et(e){if(e instanceof un)return!1;if(fe)return!1;if(ne)return!0;if(!(se instanceof nn))return!1;var n;if(e instanceof vn)n=1;else{if("="!=e.operator)return!1;n=2}var t=se.definition();if(t.references.length-t.replaced==n)return!0;if(!t.fixed)return!1;if(!se.fixed)return!1;var i=se.fixed.assigns,r=0;return!!On(t.references,function(e,n){var t=e.fixed;return!!t&&(!t.to_binary&&!t.to_prefix&&(t===se.fixed?(r++,!0):i&&t.assigns&&i[0]!==t.assigns[0]))})&&(r==n&&(ee=!0,!0))}function nt(e,n){var t=Oe.get(e.name);if(t&&!On(t,function(e){return!e}))return t[0]!==se||void(le=!1)}function rt(e){var t=e.definition();return!(1==t.orig.length&&t.orig[0]instanceof $e)&&(t.scope.resolve()!==k||(!(!xe||!n.exposed(t))||!On(t.references,function(e){return e.scope.resolve(!0)===k})))}function ot(e,n){if(e instanceof f)return ot(e.left,!0);if(e instanceof un)return ot(e.expression,!0);if(e instanceof vn)return e.value&&ot(e.value);if(n){if(e instanceof W)return ot(e.expression,!0);if(e instanceof Ie)return ot(e.expression,!0);if(e instanceof nn)return e.definition().scope.resolve()!==k}return!1}}function Q(e){for(var n=!1,t=[],i=0;i<e.length;){var r=e[i];if(r instanceof v&&On(r.body,ut))n=!0,Q(r.body),[].splice.apply(e,[i,1].concat(r.body)),i+=r.body.length;else{if(r instanceof L){if(Yn(r.value,t)){n=!0,e.splice(i,1);continue}t.push(r.value)}r instanceof X?(n=!0,e.splice(i,1)):i++}}return n}function ee(e,n){for(var t,i,r,o=!1,s=n.parent(),a=n.self(),f=T&&s&&"Call"==s.TYPE&&s.expression===a,c=T&&n.option("conditionals")&&n.option("sequences"),u=!(_&&_.bfinally&&qn(k)),l=function(e){for(var n=0,t=e.length;--t>=0;){var i=e[t];if(i instanceof ce&&i.body instanceof Me&&++n>1)return!0}return!1}(e),p=e.length;--p>=0;){var h=e[p],m=V(p),b=e[m];if(T&&t&&!b&&h instanceof Me&&u&&!(a instanceof Ue)){if(!(S=h.value)){o=!0,e.splice(p,1);continue}var y=S.tail_node();if(At(y)){o=!0,S instanceof pn?S=S.expression:y instanceof pn&&((S=S.clone()).expressions[S.expressions.length-1]=y.expression),e[p]=Bn(Pe,h,{body:S});continue}}if(h instanceof ce){var x=Ut(h.body);if(R(x)){x.label&&Gn(x.label.thedef.references,x),o=!0,(h=h.clone()).body=Bn(v,h,{body:G(h.body,x)}),h.alternative=Bn(v,h,{body:lt(h.alternative).concat(U(r,i))}),L(x.value,r),e[p]=h,e[p]=h.transform(n);continue}if(x&&!h.alternative&&b instanceof de){var w=h.condition,E=p+1==m&&h.body instanceof v;if((w=zt(w,w.negate(n),E))!==h.condition){o=!0,(h=h.clone()).condition=w;var S=h.body;h.body=Bn(v,b,{body:U(!0,null,m+1)}),e.splice(p,1,h,S),(!T||a instanceof d&&a.body===e)&&(e[p]=h.transform(n));continue}}var A=Ut(h.alternative);if(R(A)){A.label&&Gn(A.label.thedef.references,A),o=!0,(h=h.clone()).body=Bn(v,h.body,{body:lt(h.body).concat(U(r,i))}),h.alternative=Bn(v,h.alternative,{body:G(h.alternative,A)}),L(A.value,r),e[p]=h,e[p]=h.transform(n);continue}if(n.option("typeofs")){if(x&&!A){var D=Bn(v,a,{body:e.slice(p+1)});ri(h.condition,null,D)}if(!x&&A){D=Bn(v,a,{body:e.slice(p+1)});ri(h.condition,D)}}}if(h instanceof ce&&h.body instanceof Me){var q,M,C=h.body.value,j=h.body.in_bool||b instanceof Me&&b.in_bool;if(!h.alternative&&b instanceof Me&&(u||!C==!b.value)){o=!0,(h=h.clone()).alternative=Bn(v,b,{body:U(!0,null,m+1)}),e[p]=h,e[p]=h.transform(n);continue}if(T&&t&&!b&&!h.alternative&&(j||C&&l||C instanceof z&&(At(C.consequent,n)||At(C.alternative,n)))){o=!0,(h=h.clone()).alternative=Bn(Me,h,{value:null}),e[p]=h,e[p]=h.transform(n);continue}if(c&&!h.alternative&&(!(M=e[q=W(p)])&&f||M instanceof ce&&M.body instanceof Me)&&(b?b instanceof Pe&&V(m)==e.length:!t)){o=!0;var P=[];h=h.clone(),P.push(h.condition),h.condition=Xn(h,P),h.alternative=Bn(v,a,{body:U().concat(Bn(Me,a,{value:null}))}),e[p]=h.transform(n),p=q+1;continue}}h instanceof g||h instanceof J?i=h:t&&i&&i===b&&$(h)}return o;function N(e){return I(n,function(n){return n===e})}function Y(e,n){if(!i)return!1;if(i.TYPE!=e.TYPE)return!1;var t=e.value;if(!t)return!1;var r=i.equals(e);return!r&&t instanceof je&&(t=t.tail_node(),i.value&&i.value.equals(t)&&(r=2)),!r&&!n&&i.value instanceof je&&i.value.tail_node().equals(t)&&(r=3),r}function R(t){if(r=!1,!function(e){if(e instanceof J){if(r=Y(e))return!0;if(!T)return!1;if(!(e instanceof Me))return!1;var t=e.value;return!(t&&!At(t.tail_node())||a instanceof Ue&&(!i||i instanceof J&&i.value||(r=4,0)))}if(!(e instanceof be))return!1;if(a instanceof Ue)if(i instanceof J){if(!T)return!1;if(i.value)return!1;r=!0}else if(i){if(n.loopcontrol_target(i)!==s)return!1;r=!0}else if(!1===i)return!1;var o=n.loopcontrol_target(e);return e instanceof F?N(ht(o)):!(o instanceof pe)&&N(o)}(t))return!1;for(var o=e.length;--o>p;){var f=e[o];if(f instanceof H){if(f.name.definition().preinit)return!1}else if((f instanceof O||f instanceof me)&&!On(f.definitions,function(e){return!e.name.match_symbol(function(e){return e instanceof We&&e.definition().preinit})}))return!1}return!0}function U(n,t,r){var o=[],s=!1,a=p+1;n?t?r=e.lastIndexOf(t):(t=e[r])!==i&&(i=!1):(r=e.length,i=null);var f=e.splice(a,r-a).filter(function(e){return e instanceof _e?(o.push(e),!1):(ct(e)&&(s=!0),!0)});return 3===n&&(f.push(Bn(Pe,t.value,{body:Xn(t.value,t.value.expressions.slice(0,-1))})),t.value=t.value.tail_node()),[].push.apply(s?f:e,o),f}function B(e,n){if(e)switch(n){case 4:return e;case 3:if(!(e instanceof je))break;case 2:return Xn(e,e.expressions.slice(0,-1))}}function G(e,n){for(var t,i=lt(e),o=i;(t=o[o.length-1])!==n;)o=t.body;o.pop();var s=n.value;return r&&(s=B(s,r)),s&&o.push(Bn(Pe,s,{body:s})),i}function L(e,n){if(n&&e){switch(n){case 4:return;case 3:case 2:e=e.tail_node()}at(e,i.value)}}function V(n){t=!0;for(var i=n;++i<e.length;){var r=e[i];if(!wt(r)){if(!(r instanceof hn))break;t=!1}}return i}function W(n){for(var t=n;--t>=0;){var i=e[t];if(!(i instanceof hn)&&!wt(i))break}return t}function $(e,n,t){if(e instanceof J){var r=!(n&&e instanceof AST_Throw)&&Y(e,!0);if(r){o=!0;var s=B(e.value,r);return s?Bn(Pe,s,{body:s}):t?null:Bn(X,e)}}else if(e instanceof ce)e.body=$(e.body,n),e.alternative&&(e.alternative=$(e.alternative,n));else if(e instanceof he)e.body=$(e.body,n);else if(e instanceof cn){if(!e.bfinally||!i.value||i.value.is_constant())e.bcatch&&$(e.bcatch,n),(a=$(e.body.pop(),!0,!0))&&e.body.push(a)}else if(e instanceof d&&!(e instanceof Ce||e instanceof Re)){var a;(a=$(e.body.pop(),n,!0))&&e.body.push(a)}return e}}function ne(e,n){var t,i=n.self();i instanceof y?i=n.parent():i instanceof he&&(i=i.body);for(var r=0,o=0,s=e.length;r<s;r++){var a=e[r];if(a instanceof be){var f=n.loopcontrol_target(a);ht(f)!==i||a instanceof g&&f instanceof pe?e[o++]=a:a.label&&Gn(a.label.thedef.references,a)}else e[o++]=a;if(Ut(a)){t=e.slice(r+1);break}}return e.length=o,t&&t.forEach(function(t){St(n,t,e)}),e.length!=s}function te(e,n){if(!(!T||_&&_.bfinally)){for(var t=!1,i=e.length;--i>=0;){var r=e[i];if(!(r instanceof Pe))break;var o=r.body;if(!(o instanceof u))break;var s=o.expression;if(!Si(n,s))break;if(t=!0,s=s.drop_side_effect_free(n,!0)){r.body=s;break}}return e.length=i+1,t}}function fe(e,n){var t=!1,r=e.length-1;if(T&&r>=0){var o=_&&_.bfinally&&qn(k);(a=e[r].try_inline(n,i,o))&&(e[r--]=a,t=!0)}for(var s=l&&_&&_.bfinally?"try":l;r>=0;r--){var a;(a=e[r].try_inline(n,i,!0,s))&&(e[r]=a,t=!0)}return t}function ue(e,n){if(!(e.length<2)){for(var t=[],i=0,r=0,o=e.length;r<o;r++){var s=e[r];s instanceof Pe?(t.length>=n.sequences_limit&&a(),ft(t,s.body)):wt(s)?e[i++]=s:(a(),e[i++]=s)}return a(),e.length=i,i!=o}function a(){if(t.length){var n=Xn(t[0],t);e[i++]=Bn(Pe,n,{body:n}),t=[]}}}function le(e,n){if(!(e instanceof v))return e;for(var t=null,i=0;i<e.body.length;i++){var r=e.body[i];if(r instanceof hn&&xt(r))n.push(r);else{if(t||ct(r))return!1;t=r}}return t}function ye(e,n){for(var t,i=!1,r=0,o=0;o<e.length;o++){var s=e[o];if(t)if(s instanceof J)!s.value&&qn(k)||(s.value=d(s.value||Bn(dn,s)).optimize(n));else if(s instanceof re){if(!(s.init instanceof N)){var a=!1;t.body.walk(new yn(function(e){return!!(a||e instanceof Ce)||(e instanceof p&&"in"==e.operator?(a=!0,!0):void 0)})),a||(s.init?s.init=d(s.init):(s.init=t.body,r--,i=!0))}}else s instanceof se?ct(s.init)||(s.object=d(s.object)):s instanceof ce?s.condition=d(s.condition):s instanceof Re?s.expression=d(s.expression):s instanceof gn&&(s.expression=d(s.expression));if(n.option("conditionals")&&s instanceof ce){var f=[],c=le(s.body,f),u=le(s.alternative,f);if(!1!==c&&!1!==u&&f.length>0){var l=f.length;f.push(Bn(ce,s,{condition:s.condition,body:c||Bn(X,s.body),alternative:u})),f.unshift(r,1),[].splice.apply(e,f),o+=l,r+=l+1,t=null,i=!0;continue}}e[r++]=s,t=s instanceof Pe?s:null}return e.length=r,i;function d(e){r--,i=!0;var n=t.body;return Xn(n,[n,e])}}function xe(e){return e instanceof f?[e]:e instanceof je?e.expressions.slice():void 0}function ke(e,n,t){var i=xe(n);if(i){t=t||0;for(var r=!1,o=i.length-t;--o>=0;){var s=i[o];if(l(s)){var a;if(s.left instanceof nn)a=i.slice(o+1);else{if(!(s.left instanceof qe&&l(s.left.expression)))continue;a=i.slice(o+1);var c=s.clone();s=s.left.expression,c.left=c.left.clone(),c.left.expression=s.left.clone(),a.unshift(c)}0!=a.length&&Ne(s.left,s.right,a)&&(r=!0,i=i.slice(0,o).concat(s,a))}}if(e instanceof N){for(o=e.definitions.length;--o>=0;){var u=e.definitions[o];if(u.value){Ne(u.name,u.value,i)&&(r=!0),Oe(u,i,t)&&(r=!0);break}}e instanceof hn&&Fe(e.definitions,i,t)&&(r=!0)}return r&&i}function l(e){return e instanceof f&&"="==e.operator}}function ze(e,n){if(e instanceof Pe&&!xt(n)){var t=xe(e.body);if(t){var i=[];if(Fe(i,t.reverse(),0))return n.definitions=i.reverse().concat(n.definitions),t.reverse()}}}function Oe(e,t,i){if(n.option("conditionals")&&!(e.name instanceof R)){for(var r=!1,o=e.name.definition();t.length>i;){var s=bi(n,o,e.value,t[0]);if(!s)break;e.value=s,t.shift(),r=!0}return r}}function Fe(e,n,t){for(var i=!1;n.length>t;){var r=n[0];if(!(r instanceof f))break;if("="!=r.operator)break;var o=r.left;if(!(o instanceof nn))break;if(gt(o))break;if(o.scope.resolve()!==k)break;var s=o.definition();if(s.scope!==k)break;if(s.orig.length>s.eliminated+1)break;if("SymbolVar"!=s.orig[0].TYPE)break;var a=Bn(tn,o);e.push(Bn(vn,r,{name:a,value:r.right})),s.orig.push(a),s.replaced++,n.shift(),i=!0}return i}function Ne(e,t,i){var r=new Fn;for(r.set(e.name,!0);t instanceof f&&"="==t.operator;)t.left instanceof nn&&r.set(t.left.name,!0),t=t.right;if(t instanceof Te){var o=!1;do{if(!s(i[0]))break;i.shift(),o=!0}while(i.length);return o}function s(e){if(e instanceof f&&"="==e.operator&&e.left instanceof qe){var i=e.left.expression;if(i instanceof nn&&r.has(i.name)&&e.right.is_constant_expression(k)){var o=e.left.property;if(o instanceof we&&(s(o)&&(o=e.left.property=o.right.clone()),o=o.evaluate(n)),!(o instanceof we)){var a="__proto__"==(o=""+o)||n.has_directive("use strict")?function(e){var n=e.key;return"string"==typeof n&&n!=o&&"__proto__"!=n}:function(e){var n=e.key;return e instanceof AST_ObjectGetter||e instanceof AST_ObjectSetter?"string"==typeof n&&n!=o:"__proto__"!==n};if(On(t.properties,a))return t.properties.push(Bn(Se,e,{key:o,value:e.right})),!0}}}}}function Ye(e){for(var n,t=!1,i=0,r=-1;i<e.length;i++){var o=e[i],s=e[r];if(o instanceof N)if(s&&s.TYPE==o.TYPE)s.definitions=s.definitions.concat(o.definitions),t=!0;else if(n&&n.TYPE==o.TYPE&&xt(o))n.definitions=n.definitions.concat(o.definitions),t=!0;else if(o instanceof hn){(f=ze(s,o))?(f.length&&(s.body=Xn(s,f),r++),t=!0):r++,e[r]=n=o}else e[++r]=o;else{if(o instanceof J)o.value=u(o.value);else if(o instanceof re){if(f=ke(s,o.init))t=!0,o.init=f.length?Xn(o.init,f):null;else{if(s instanceof hn&&(!o.init||o.init.TYPE==s.TYPE)){o.init&&(s.definitions=s.definitions.concat(o.init.definitions)),o=o.clone(),n=o.init=s,e[r]=l(o),t=!0;continue}if(n&&o.init&&n.TYPE==o.init.TYPE&&xt(o.init))n.definitions=n.definitions.concat(o.init.definitions),o.init=null,t=!0;else if(o.init instanceof hn&&(n=o.init,f=ze(s,o.init))){if(t=!0,0==f.length){e[r]=l(o);continue}s.body=Xn(s,f)}}}else if(o instanceof oe){if(n&&n.TYPE==o.init.TYPE){var a=n.definitions.slice();o.init=o.init.definitions[0].name.convert_symbol(nn,function(e,n){a.push(Bn(vn,n,{name:n,value:null})),n.definition().references.push(e)}),n.definitions=a,t=!0}o.object=u(o.object)}else if(o instanceof ce)o.condition=u(o.condition);else if(o instanceof Pe){var f,c;if(f=ke(s,o.body)){if(t=!0,!f.length)continue;o.body=Xn(o.body,f)}else if(s instanceof N&&(c=e[i+1])&&s.TYPE==c.TYPE&&(c=c.definitions[0]).value){t=!0,c.value=Xn(o,[o.body,c.value]);continue}}else o instanceof Re?o.expression=u(o.expression):o instanceof gn&&(o.expression=u(o.expression));e[++r]=n?l(o):o}}return e.length=r+1,t;function u(e){var n=ke(s,e,1);if(!n)return e;t=!0;var i=e.tail_node();return n[n.length-1]!==i&&n.push(i.left),Xn(e,n)}function l(e){return e.transform(new bn(function(e,i,r){if(e instanceof N){if(n===e)return e;if(n.TYPE!=e.TYPE)return e;var o=this.parent();return o instanceof oe&&o.init===e?e:xt(e)?(n.definitions=n.definitions.concat(e.definitions),t=!0,o instanceof re&&o.init===e?null:r?jn.skip:Bn(X,e)):e}return e instanceof Z?e:e instanceof Ce?e:An(e)?void 0:e}))}}}function St(e,n,t){var i,r=!1;function o(e){i?(i.push(e),ut(e)||(i.required=!0)):t.push(e)}n.walk(new yn(function(s,a){if(s instanceof H)return s.extends=null,s.properties=[],o(s),!0;if(s instanceof N){var f=[];return s.remove_initializers(e,f)&&we.warn("Dropping initialization in unreachable code [{start}]",s),f.length>0&&(s.definitions=f,o(s)),!0}if(s instanceof _e)return o(s),!0;if(s instanceof Ce)return!0;if(s instanceof h){var c=i;return i=[],a(),i.required?t.push(Bn(v,n,{body:i})):i.length&&[].push.apply(t,i),i=c,!0}s instanceof be||(r=!0)})),r&&we.warn("Dropping unreachable code [{start}]",n)}function At(e,n){return null==e||e.is_undefined||e instanceof dn||e instanceof pn&&"void"==e.operator&&!(n&&e.expression.has_side_effects(n))}nn.DEFMETHOD("is_declared",function(e){return this.defined||!this.definition().undeclared||e.option("unsafe")&&bt[this.name]}),(mt=function(e,n){e.DEFMETHOD("in_strict_mode",n)})(w,Wn),mt(Ce,function(e){for(var n=this.body,t=0;t<n.length;t++){var i=n[t];if(!(i instanceof L))break;if("use strict"==i.value)return!0}var r=this.parent_scope;return r?r.resolve(!0).in_strict_mode(e):e.option("module")}),function(e){e(we,Ln),e(s,Wn),e(f,function(){return"="==this.operator&&this.right.is_truthy()}),e(ve,Wn),e(Te,Wn),e(Fe,Wn),e(je,function(){return this.tail_node().is_truthy()}),e(nn,function(){var e=this.fixed_value();if(!e)return!1;this.is_truthy=Ln;var n=e.is_truthy();return delete this.is_truthy,n})}(function(e,n){e.DEFMETHOD("is_truthy",n)}),function(e){function n(e,n,t){switch(e){case"-":return n.is_negative_zero()&&(!(t instanceof q)||0==t.value);case"&&":case"||":return n.is_negative_zero()||t.is_negative_zero();case"*":case"/":case"%":case"**":return!0;default:return!1}}e(we,Wn),e(s,Ln),e(f,function(){var e=this.operator;return"="==e?this.right.is_negative_zero():n(e.slice(0,-1),this.left,this.right)}),e(p,function(){return n(this.operator,this.left,this.right)}),e(q,function(){return 0==this.value&&1/this.value<0}),e(ve,Ln),e(Te,Ln),e(Fe,Ln),e(je,function(){return this.tail_node().is_negative_zero()}),e(nn,function(){var e=this.fixed_value();if(!e)return!0;this.is_negative_zero=Wn;var n=e.is_negative_zero();return delete this.is_negative_zero,n}),e(pn,function(){return"+"==this.operator&&this.expression.is_negative_zero()||"-"==this.operator})}(function(e,n){e.DEFMETHOD("is_negative_zero",n)}),function(e){function n(e,n){return n||/strict/.test(e.option("pure_getters"))}we.DEFMETHOD("may_throw_on_access",function(e,n){return!e.option("pure_getters")||this._dot_throw(e,n)}),e(we,n),e(s,Ln),e(f,function(e){var n=this.operator,t=this.left,i=this.right;return"="!=n?Dt[n.slice(0,-1)]&&(t._dot_throw(e)||i._dot_throw(e)):!!i._dot_throw(e)&&(!(t instanceof nn)||(!(i instanceof p&&"||"==i.operator&&t.name==i.left.name)||i.right._dot_throw(e)))}),e(p,function(e){return Dt[this.operator]&&(this.left._dot_throw(e)||this.right._dot_throw(e))}),e(w,function(e,t){return n(e,t)&&!On(this.properties,function(e){return!!e.private||(!e.static||!(e instanceof AST_ClassGetter||e instanceof AST_ClassSetter))})}),e(z,function(e){return this.consequent._dot_throw(e)||this.alternative._dot_throw(e)}),e(q,Ln),e(W,function(e,t){if(!n(e,t))return!1;var r=this.expression;return r instanceof nn&&(r=r.fixed_value()),!("prototype"==this.property&&i(r))}),e(ve,Ln),e(ke,Wn),e(Te,function(e,t){return n(e,t)&&!On(this.properties,function(n){return!(n instanceof AST_ObjectGetter||n instanceof AST_ObjectSetter)&&!("__proto__"===n.key&&n.value._dot_throw(e,t))})}),e(De,function(e,t){return n(e,t)&&!this.scope.resolve().new}),e(je,function(e){return this.tail_node()._dot_throw(e)}),e(nn,function(e,t){if(this.is_undefined)return!0;if(!n(e,t))return!1;if(gt(this)&&this.is_declared(e))return!1;if(this.is_immutable())return!1;var i=this.definition();if(x(i)&&!i.scope.rest&&On(i.scope.argnames,function(e){return e instanceof Je}))return i.scope.uses_arguments>2;var r=this.fixed_value(!0);return!r||(this._dot_throw=Wn,r._dot_throw(e)?(delete this._dot_throw,!0):(this._dot_throw=Ln,!1))}),e(pn,function(){return"void"==this.operator}),e(ln,Ln),e(dn,Wn)}(function(e,n){e.DEFMETHOD("_dot_throw",n)}),function(e){function n(e,n,t){switch(n){case"&&":return t.left.is_defined(e)&&t.right.is_defined(e);case"||":return t.left.is_truthy()||t.right.is_defined(e);case"??":return t.left.is_defined(e)||t.right.is_defined(e);default:return!0}}e(we,Ln),e(s,Wn),e(f,function(e){var t=this.operator;return"="==t?this.right.is_defined(e):n(e,t.slice(0,-1),this)}),e(p,function(e){return n(e,this.operator,this)}),e(z,function(e){return this.consequent.is_defined(e)&&this.alternative.is_defined(e)}),e(q,Wn),e(fe,Ln),e(ve,Wn),e(Te,Wn),e(je,function(e){return this.tail_node().is_defined(e)}),e(nn,function(e){if(this.is_undefined)return!1;if(gt(this)&&this.is_declared(e))return!0;if(this.is_immutable())return!0;var n=this.fixed_value();if(!n)return!1;this.is_defined=Ln;var t=n.is_defined(e);return delete this.is_defined,t}),e(pn,function(){return"void"!=this.operator}),e(ln,Wn),e(dn,Ln)}(function(e,n){e.DEFMETHOD("is_defined",n)}),function(e){e(we,Ln),e(f,function(e){return"="==this.operator&&this.right.is_boolean(e)});var n=Hn("in instanceof == != === !== < <= >= >");e(p,function(e){return n[this.operator]||Dt[this.operator]&&this.left.is_boolean(e)&&this.right.is_boolean(e)}),e(_,Wn);var t=Hn("every hasOwnProperty isPrototypeOf propertyIsEnumerable some");e(m,function(e){if(!e.option("unsafe"))return!1;var n=this.expression;return n instanceof W&&(t[n.property]||"test"==n.property&&n.expression instanceof Fe)}),e(z,function(e){return this.consequent.is_boolean(e)&&this.alternative.is_boolean(e)}),e(xe,Ln),e(je,function(e){return this.tail_node().is_boolean(e)}),e(nn,function(e){var n=this.fixed_value();if(!n)return!1;this.is_boolean=Ln;var t=n.is_boolean(e);return delete this.is_boolean,t});var i=Hn("! delete");e(pn,function(){return i[this.operator]})}(function(e,n){e.DEFMETHOD("is_boolean",n)}),function(e){e(we,Ln);var n=Hn("- * / % ** & | ^ << >> >>>");e(f,function(e){return n[this.operator.slice(0,-1)]||"="==this.operator&&this.right.is_number(e)}),e(p,function(e){return!!n[this.operator]||"+"==this.operator&&((this.left.is_boolean(e)||this.left.is_number(e))&&(this.right.is_boolean(e)||this.right.is_number(e)))});var t=Hn(["charCodeAt","getDate","getDay","getFullYear","getHours","getMilliseconds","getMinutes","getMonth","getSeconds","getTime","getTimezoneOffset","getUTCDate","getUTCDay","getUTCFullYear","getUTCHours","getUTCMilliseconds","getUTCMinutes","getUTCMonth","getUTCSeconds","getYear","indexOf","lastIndexOf","localeCompare","push","search","setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear"]);e(m,function(e){if(!e.option("unsafe"))return!1;var n=this.expression;return n instanceof W&&(t[n.property]||gt(n.expression)&&"Math"==n.expression.name)}),e(z,function(e){return this.consequent.is_number(e)&&this.alternative.is_number(e)}),e(xe,Ln),e(Ee,Wn),e(je,function(e){return this.tail_node().is_number(e)}),e(nn,function(e,n){var t=this.fixed_value();if(!t)return!1;if(n&&t instanceof pn&&"+"==t.operator&&t.expression.equals(this))return!1;this.is_number=Ln;var i=t.is_number(e);return delete this.is_number,i});var i=Hn("+ - ~ ++ --");e(un,function(){return i[this.operator]})}(function(e,n){e.DEFMETHOD("is_number",n)}),function(e){e(we,Ln),e(f,function(e){switch(this.operator){case"+=":if(this.left.is_string(e))return!0;case"=":return this.right.is_string(e)}}),e(p,function(e){return"+"==this.operator&&(this.left.is_string(e)||this.right.is_string(e))});var n=Hn(["charAt","substr","substring","toExponential","toFixed","toLowerCase","toPrecision","toString","toUpperCase","trim"]);e(m,function(e){if(!e.option("unsafe"))return!1;var t=this.expression;return t instanceof W&&n[t.property]}),e(z,function(e){return this.consequent.is_string(e)&&this.alternative.is_string(e)}),e(je,function(e){return this.tail_node().is_string(e)}),e(Ye,Wn),e(nn,function(e){var n=this.fixed_value();if(!n)return!1;this.is_string=Ln;var t=n.is_string(e);return delete this.is_string,t}),e(rn,function(e){return!this.tag||Fi(e,this.tag)}),e(pn,function(){return"typeof"==this.operator})}(function(e,n){e.DEFMETHOD("is_string",n)});var Dt=Hn("&& || ??");function zt(e,n,t){return n.print_to_string().length-e.print_to_string().length<(t||0)?n:e}function Ot(e,n,t){return zt(Bn(Pe,e,{body:e}),Bn(Pe,n,{body:n}),t).body}function qt(e,n,t,i){return(En(e)?Ot:zt)(n,t,i)}function Ft(e){var n=Object.create(null);return Object.keys(e).forEach(function(t){n[t]=Hn(e[t])}),n}function Mt(e){for(var n=0;n<e.length;n++){var t=e[n];if(!(t instanceof L))return t}}function Ct(){return this.value?Bn(Me,this.value,{value:this.value}):Mt(this.body)}function jt(e,n){var t=n.evaluate(e);return t===n?n:qt(e,n,t=nt(t,n).optimize(e),e.eval_threshold)}!function(e){function n(e){we.warn("global_defs {this} redefined [{start}]",e)}an.DEFMETHOD("resolve_defines",function(e){return e.option("global_defs")?(this.figure_out_scope({ie:e.option("ie")}),this.transform(new bn(function(t){var i=t._find_defs(e,"");if(i){for(var r,o=0,s=t;(r=this.parent(o++))&&r instanceof qe&&r.expression===s;)s=r;if(!tt(s,r))return i;n(t)}}))):this}),e(we,In),e(W,function(e,n){return this.expression._find_defs(e,"."+this.property+n)}),e(We,function(e){this.definition().global&&Cn(e.option("global_defs"),this.name)&&n(this)}),e(nn,function(e,n){if(this.definition().global){var t=e.option("global_defs"),i=this.name+n;return Cn(t,i)?function e(n,t){if(n instanceof we)return n.clone(!0);if(Array.isArray(n))return Bn(s,t,{elements:n.map(function(n){return e(n,t)})});if(n&&"object"==typeof n){var i=[];for(var r in n)Cn(n,r)&&i.push(Bn(Se,t,{key:r,value:e(n[r],t)}));return Bn(Te,t,{properties:i})}return nt(n,t)}(t[i],this):void 0}})}(function(e,n){e.DEFMETHOD("_find_defs",n)}),a.DEFMETHOD("first_statement",Ct),c.DEFMETHOD("first_statement",Ct),ve.DEFMETHOD("first_statement",function(){return Mt(this.body)}),ve.DEFMETHOD("length",function(){for(var e=this.argnames,n=0;n<e.length&&!(e[n]instanceof P);n++);return n});var Pt=["constructor","toString","valueOf"],Ht=Ft({Array:["indexOf","join","lastIndexOf","slice"].concat(Pt),Boolean:Pt,Function:Pt,Number:["toExponential","toFixed","toPrecision"].concat(Pt),Object:Pt,RegExp:["exec","test"].concat(Pt),String:["charAt","charCodeAt","concat","indexOf","italics","lastIndexOf","match","replace","search","slice","split","substr","substring","toLowerCase","toUpperCase","trim"].concat(Pt)}),Nt=Ft({Array:["isArray"],Math:["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","atan2","pow","max","min"],Number:["isFinite","isNaN"],Object:["create","getOwnPropertyDescriptor","getOwnPropertyNames","getPrototypeOf","isExtensible","isFrozen","isSealed","keys"],String:["fromCharCode","raw"]});function Yt(e){if(!(e instanceof W))return!1;var n=e.expression;if(!gt(n))return!1;var t=Nt[n.name];return t&&(t[e.property]||"Math"==n.name&&"random"==e.property)}!function(e){e(we,Ln),e(q,Wn),e(Fe,Ln);var n=Hn("! ~ - + void");e(pn,function(){return n[this.operator]&&this.expression instanceof q})}(function(e,n){e.DEFMETHOD("is_constant",n)}),function(e){we.DEFMETHOD("evaluate",function(e,n){if(!e.option("evaluate"))return this;var t=[],i=this._eval(e,n,t,1);return t.forEach(function(e){delete e._eval}),n?i:!i||i instanceof RegExp?i:"function"==typeof i||"object"==typeof i?this:i});var n=new yn(function(e){e instanceof f&&t(e.left),e instanceof oe&&t(e.init),e instanceof un&&UNARY_POSTFIX[e.operator]&&t(e.expression)});function t(e){e instanceof U?e.elements.forEach(t):e instanceof G?e.properties.forEach(function(e){t(e.value)}):e instanceof qe?t(e.expression):e instanceof nn&&e.definition().references.forEach(function(e){delete e._eval})}e(Ne,function(){throw new Error(string_template("Cannot evaluate a statement [{start}]",this))}),e(o,$n),e(l,$n),e(w,$n),e(we,$n),e(q,function(){return this.value}),e(f,function(e,i,r,o){var s=this.left;if(!i){if(!(s instanceof nn))return this;if(!Cn(s,"_eval")){if(!s.fixed)return this;var a=s.definition();if(!a.fixed)return this;if(a.undeclared)return this;if(a.last_ref!==s)return this;if("m"==a.single_use)return this;if(this.right.has_side_effects(e))return this}}var f,c=this.operator;f=!Cn(s,"_eval")&&s instanceof nn&&s.fixed&&s.definition().fixed?s:"="==c?this.right:Bn(p,this,{operator:c.slice(0,-1),left:s,right:this.right}),s.walk(n);var u=f._eval(e,i,r,o);return"object"==typeof u?this:(t(s),u)}),e(je,function(e,t,i,r){if(!t)return this;for(var o=this.expressions,s=0,a=o.length-1;s<a;s++)o[s].walk(n);var f=o[a],c=f._eval(e,t,i,r);return c===f?this:c}),e(ve,function(e){if(e.option("unsafe")){var n=function(){};return n.node=this,n.toString=function(){return"function(){}"},n}return this}),e(s,function(e,n,t,i){if(e.option("unsafe")){for(var r=[],o=0;o<this.elements.length;o++){var s=this.elements[o];if(s instanceof fe)return this;var a=s._eval(e,n,t,i);if(s===a)return this;r.push(a)}return r}return this}),e(Te,function(e,n,t,i){if(e.option("unsafe")){for(var r={},o=0;o<this.properties.length;o++){var s=this.properties[o];if(!(s instanceof Se))return this;var a=s.key;if(a instanceof we&&(a=a._eval(e,n,t,i))===s.key)return this;switch(a){case"__proto__":case"toString":case"valueOf":return this}if(r[a]=s.value._eval(e,n,t,i),r[a]===s.value)return this}return r}return this});var i=Hn("! typeof void");e(pn,function(e,r,o,s){var a=this.expression,f=this.operator;if(e.option("typeofs")&&"typeof"==f&&(a instanceof ve||a instanceof nn&&a.fixed_value()instanceof ve))return"function";var c=a instanceof nn&&a.definition();i[f]||c&&c.fixed||s++,a.walk(n);var u=a._eval(e,r,o,s);if(u===a){if(r&&"void"==f)return;return this}switch(f){case"!":return!u;case"typeof":return u instanceof RegExp?this:typeof u;case"void":return;case"~":return~u;case"-":return-u;case"+":return+u;case"++":case"--":if(!c)return this;if(!r){if(c.undeclared)return this;if(c.last_ref!==a)return this}return Cn(a,"_eval")&&(u=+(f[0]+1)+ +u),t(a),u}return this}),e(ln,function(e,i,r,o){var s=this.expression;if(s instanceof nn){if(!Cn(s,"_eval")){if(!s.fixed)return this;if(!i){var a=s.definition();if(!a.fixed)return this;if(a.undeclared)return this;if(a.last_ref!==s)return this}}}else if(!i)return this;s instanceof nn&&s.definition().fixed||o++,s.walk(n);var f=s._eval(e,i,r,o);return f===s?this:(t(s),+f)});var r=Hn("&& || === !==");e(p,function(e,n,t,i){r[this.operator]||i++;var o=this.left._eval(e,n,t,i);if(o===this.left)return this;if(this.operator==(o?"||":"&&"))return o;var s,a=n&&!(o&&"object"==typeof o),f=this.right._eval(e,a,t,i);if(f===this.right)return this;switch(this.operator){case"&&":s=o&&f;break;case"||":s=o||f;break;case"??":s=null==o?f:o;break;case"|":s=o|f;break;case"&":s=o&f;break;case"^":s=o^f;break;case"+":s=o+f;break;case"-":s=o-f;break;case"*":s=o*f;break;case"/":s=o/f;break;case"%":s=o%f;break;case"<<":s=o<<f;break;case">>":s=o>>f;break;case">>>":s=o>>>f;break;case"==":s=o==f;break;case"===":s=o===f;break;case"!=":s=o!=f;break;case"!==":s=o!==f;break;case"<":s=o<f;break;case"<=":s=o<=f;break;case">":s=o>f;break;case">=":s=o>=f;break;case"**":s=Math.pow(o,f);break;case"in":if(f&&"object"==typeof f&&Cn(f,o)){s=!0;break}default:return this}if(isNaN(s))return e.find_parent(gn)?this:s;if(e.option("unsafe_math")&&!n&&s&&"number"==typeof s&&("+"==this.operator||"-"==this.operator)){var c=Math.max(0,u(o),u(f));if(c<16)return+s.toFixed(c)}return s;function u(e){var n=/(\.[0-9]*)?(e[^e]+)?$/.exec(+e);return(n[1]||".").length-1-(n[2]||"").slice(1)}}),e(z,function(e,n,t,i){var r=this.condition._eval(e,n,t,i);if(r===this.condition)return this;var o=r?this.consequent:this.alternative,s=o._eval(e,n,t,i);return s===o?this:s}),e(nn,function(e,n,t,i){var r,o=this.fixed_value();if(!o)return this;if(Cn(o,"_eval"))r=o._eval();else{if(this._eval=$n,r=o._eval(e,n,t,i),delete this._eval,r===o)return this;o._eval=function(){return r},t.push(o)}return r&&"object"==typeof r&&!function(e,n){var t=e.definition().escaped;switch(t.length){case 0:return!0;case 1:var i=!1;return t[0].walk(new yn(function(n){return!!i||(n===e?i=!0:n instanceof Ce||void 0)})),i;default:return n<=t.depth}}(this,i)?this:r});var c={Array:Array,Math:Math,Number:Number,Object:Object,String:String},u=Ft({Math:["E","LN10","LN2","LOG2E","LOG10E","PI","SQRT1_2","SQRT2"],Number:["MAX_VALUE","MIN_VALUE","NaN","NEGATIVE_INFINITY","POSITIVE_INFINITY"]}),d=Hn("global ignoreCase multiline source");function h(e,n,t,i,r){for(var o=[],s=0;s<e.length;s++){var a=e[s],f=a._eval(n,t,i,r);if(a===f)return;o.push(f)}return o}e(qe,function(e,n,t,i){if(e.option("unsafe")){var r,o=this.expression;if(!gt(o)&&(null==(r=o._eval(e,n,t,i+1))||r===o))return this;var s=this.property;if(s instanceof we&&(s=s._eval(e,n,t,i))===this.property)return this;if(void 0===r){var a=u[o.name];if(!a||!a[s])return this;r=c[o.name]}else if(r instanceof RegExp){if(!d[s])return this}else if("object"==typeof r){if(!Cn(r,s))return this}else if("function"==typeof r)switch(s){case"name":return r.node.name?r.node.name.name:"";case"length":return r.node.length();default:return this}return r[s]}return this}),e(m,function(e,t,i,r){var o=this.expression,s=o instanceof nn?o.fixed_value():o;if(s instanceof a||s instanceof Y||s instanceof ae){if(s.evaluating)return this;if(s.name&&s.name.definition().recursive_refs>0)return this;if(this.is_expr_pure(e))return this;var f=h(this.args,e,t,i,r);if(!On(s.argnames,function(n,o){if(n instanceof P){if(!f)return!1;if(void 0===f[o]){var s=n.value._eval(e,t,i,r);if(s===n.value)return!1;f[o]=s}n=n.name}return!(n instanceof R)}))return this;if(s.rest instanceof R)return this;if(!f&&!t)return this;var u=s.first_statement();if(!(u instanceof Me)){if(t){s.walk(n);var l=!1;if(s.evaluating=!0,Dn(s,new yn(function(n){return!!l||(n instanceof Me?(n.value&&void 0!==n.value._eval(e,!0,i,r)&&(l=!0),!0):n instanceof Ce&&n!==s||void 0)})),s.evaluating=!1,!l)return}return this}if(!(d=u.value))return;var p=[];return(!f||On(s.argnames,function(e,n){return b(e,f[n])})&&(!s.rest||b(s.rest,f.slice(s.argnames.length)))||t)&&(t&&s.argnames.forEach(function(e){e instanceof P&&e.value.walk(n)}),s.evaluating=!0,d=d._eval(e,t,i,r),s.evaluating=!1),p.forEach(function(e){delete e._eval}),d===u.value?this:d}if(e.option("unsafe")&&o instanceof qe){var d,v=o.property;if(v instanceof we&&(v=v._eval(e,t,i,r))===o.property)return this;var _=o.expression;if(gt(_)){var g=Nt[_.name];if(!g||!g[v])return this;d=c[_.name]}else{if(null==(d=_._eval(e,t,i,r+1))||d===_)return this;var m=Ht[d.constructor.name];if(!m||!m[v])return this;if(d instanceof RegExp&&d.global&&!(_ instanceof Fe))return this}if(!(f=h(this.args,e,t,i,r)))return this;if("replace"==v&&"function"==typeof f[1])return this;try{return d[v].apply(d,f)}catch(e){we.warn("Error evaluating {this} [{start}]",this)}finally{d instanceof RegExp&&(d.lastIndex=0)}}return this;function b(e,n){e instanceof P&&(e=e.name);var t=e.definition();if(t.orig[t.orig.length-1]!==e)return!1;var i=n;return t.references.forEach(function(e){e._eval=function(){return i},p.push(e)}),!0}}),e(xe,$n),e(rn,function(e,n,t,i){if(!e.option("templates"))return this;if(this.tag){if(!Fi(e,this.tag))return this;f=function(e){return e}}var r=h(this.expressions,e,n,t,i);if(!r)return this;for(var o=!1,s=f(this.strings[0]),a=0;a<r.length;a++)s+=r[a]+f(this.strings[a+1]);return o?(this._eval=$n,this):s;function f(e){return"string"!=typeof(e=Mi(e))&&(o=!0),e}})}(function(e,n){e.DEFMETHOD("_eval",n)}),function(e){function n(e){return Bn(pn,e,{operator:"!",expression:e})}function t(e,t,i){var r=n(e);return i?zt(r,Bn(Pe,t,{body:t}))===r?r:t:zt(r,t)}e(we,function(){return n(this)}),e(Ne,function(){throw new Error("Cannot negate a statement")}),e(p,function(e,i){var r=this.clone(),o=this.operator;if(e.option("unsafe_comps"))switch(o){case"<=":return r.operator=">",r;case"<":return r.operator=">=",r;case">=":return r.operator="<",r;case">":return r.operator="<=",r}switch(o){case"==":return r.operator="!=",r;case"!=":return r.operator="==",r;case"===":return r.operator="!==",r;case"!==":return r.operator="===",r;case"&&":return r.operator="||",r.left=r.left.negate(e,i),r.right=r.right.negate(e),t(this,r,i);case"||":return r.operator="&&",r.left=r.left.negate(e,i),r.right=r.right.negate(e),t(this,r,i)}return n(this)}),e(k,function(){return n(this)}),e(z,function(e,n){var i=this.clone();return i.consequent=i.consequent.negate(e),i.alternative=i.alternative.negate(e),t(this,i,n)}),e(ge,function(){return n(this)}),e(je,function(e){var n=this.expressions.slice();return n.push(n.pop().negate(e)),Xn(this,n)}),e(pn,function(){return"!"==this.operator?this.expression:n(this)})}(function(e,n){e.DEFMETHOD("negate",function(e,t){return n.call(this,e,t)})});var It=Hn("Boolean decodeURI decodeURIComponent Date encodeURI encodeURIComponent Error escape EvalError isFinite isNaN Number Object parseFloat parseInt RangeError ReferenceError String SyntaxError TypeError unescape URIError"),Rt=Hn("Map Set WeakMap WeakSet");function Ut(e){return e&&e.aborts()}m.DEFMETHOD("is_expr_pure",function(e){if(e.option("unsafe")){var n=this.expression;if(gt(n)){if(It[n.name])return!0;if(this instanceof xe&&Rt[n.name])return!0}if(Yt(n))return!0}return e.option("annotations")&&this.pure||!e.pure_funcs(this)}),rn.DEFMETHOD("is_expr_pure",function(e){var n=this.tag;if(!n)return!0;if(e.option("unsafe")){if(gt(n)&&It[n.name])return!0;if(n instanceof W&&gt(n.expression)){var t=Nt[n.expression.name];return t&&(t[n.property]||"Math"==n.expression.name&&"random"==n.property)}}return!e.pure_funcs(this)}),we.DEFMETHOD("is_call_pure",Ln),m.DEFMETHOD("is_call_pure",function(e){if(!e.option("unsafe"))return!1;var n=this.expression;if(!(n instanceof W))return!1;var t,i=n.expression,r=n.property;if(i instanceof s)t=Ht.Array;else if(i.is_boolean(e))t=Ht.Boolean;else if(i.is_number(e))t=Ht.Number;else if(i instanceof Fe)t=Ht.RegExp;else if(i.is_string(e)){if(t=Ht.String,"replace"==r){var o=this.args[1];if(o&&!o.is_string(e))return!1}}else n.may_throw_on_access(e)||(t=Ht.Object);return t&&t[r]}),function(e){e(we,Ln),e(s,Wn),e(f,function(){switch(this.operator){case"=":return this.right.safe_to_spread();case"&&=":case"||=":case"??=":return this.left.safe_to_spread()&&this.right.safe_to_spread()}return!0}),e(p,function(){return!Dt[this.operator]||this.left.safe_to_spread()&&this.right.safe_to_spread()}),e(q,Wn),e(ve,Wn),e(Te,function(){return On(this.properties,function(e){return!(e instanceof AST_ObjectGetter||e instanceof He)})}),e(je,function(){return this.tail_node().safe_to_spread()}),e(nn,function(){var e=this.fixed_value();return e&&e.safe_to_spread()}),e(un,Wn)}(function(e,n){e.DEFMETHOD("safe_to_spread",n)}),function(e){function n(e,n,t){return!On(e,t?function(e){return e instanceof He?!t(e,n):!e.has_side_effects(n)}:function(e){return!e.has_side_effects(n)})}function t(e,n){var t=e.expression;return!t.is_string(n)||t.has_side_effects(n)}e(we,Wn),e(s,function(e){return n(this.elements,e,t)}),e(f,function(e){var n=this.left;if(!(n instanceof qe))return!0;var t=n.expression;return!(t instanceof De)||!t.scope.resolve().new||n instanceof Ie&&n.property.has_side_effects(e)||this.right.has_side_effects(e)}),e(p,function(e){return this.left.has_side_effects(e)||this.right.has_side_effects(e)||!Ti(this.operator,this.right,e)}),e(d,function(e){return n(this.body,e)}),e(m,function(e){return!(this.is_expr_pure(e)||this.is_call_pure(e)&&!this.expression.has_side_effects(e))||n(this.args,e,t)}),e(b,function(e){return this.expression.has_side_effects(e)||n(this.body,e)}),e(w,function(e){var t=this.extends;return!(!t||(t instanceof nn&&(t=t.fixed_value()),r(t)))||n(this.properties,e)}),e(S,function(e){return this.key instanceof we&&this.key.has_side_effects(e)||this.static&&this.value&&this.value.has_side_effects(e)}),e(z,function(e){return this.condition.has_side_effects(e)||this.consequent.has_side_effects(e)||this.alternative.has_side_effects(e)}),e(q,Ln),e(N,function(e){return n(this.definitions,e)}),e(U,function(e){return n(this.elements,e)}),e(B,function(e){return this.key instanceof we&&this.key.has_side_effects(e)||this.value.has_side_effects(e)}),e(G,function(e){return n(this.properties,e)}),e(W,function(e){return this.expression.may_throw_on_access(e)||this.expression.has_side_effects(e)}),e(X,Ln),e(ce,function(e){return this.condition.has_side_effects(e)||this.body&&this.body.has_side_effects(e)||this.alternative&&this.alternative.has_side_effects(e)}),e(he,function(e){return this.body.has_side_effects(e)}),e(ve,Ln),e(Te,function(e){return n(this.properties,e,function(e,n){var t=e.expression;return!t.safe_to_spread()||t.has_side_effects(n)})}),e(De,Ln),e(Ae,function(e){return this.key instanceof we&&this.key.has_side_effects(e)||this.value.has_side_effects(e)}),e(je,function(e){return n(this.expressions,e)}),e(Pe,function(e){return this.body.has_side_effects(e)}),e(Ie,function(e){return this.expression.may_throw_on_access(e)||this.expression.has_side_effects(e)||this.property.has_side_effects(e)}),e(Re,function(e){return this.expression.has_side_effects(e)||n(this.body,e)}),e(We,Ln),e(nn,function(e){return!this.is_declared(e)||!D(this,e)}),e(rn,function(e){return!this.is_expr_pure(e)||n(this.expressions,e)}),e(cn,function(e){return n(this.body,e)||this.bcatch&&this.bcatch.has_side_effects(e)||this.bfinally&&this.bfinally.has_side_effects(e)}),e(un,function(e){return unary_side_effects[this.operator]||this.expression.has_side_effects(e)}),e(vn,function(){return this.value})}(function(e,n){e.DEFMETHOD("has_side_effects",n)}),function(e){function n(e,n){for(var t=e.length;--t>=0;)if(e[t].may_throw(n))return!0;return!1}function t(e,t){return!!e.may_throw(t)||(e instanceof nn&&(e=e.fixed_value()),!(e instanceof ve)||(!!n(e.argnames,t)||(!!n(e.body,t)||Tn(e)&&e.value&&e.value.may_throw(t))))}e(we,Wn),e(q,Ln),e(X,Ln),e(ve,Ln),e(De,Ln),e(We,Ln),e(s,function(e){return n(this.elements,e)}),e(f,function(e){return!!this.right.may_throw(e)||!(!e.has_directive("use strict")&&"="==this.operator&&this.left instanceof nn)&&this.left.may_throw(e)}),e(u,function(e){return this.expression.may_throw(e)}),e(p,function(e){return this.left.may_throw(e)||this.right.may_throw(e)||!Ti(this.operator,this.right,e)}),e(d,function(e){return n(this.body,e)}),e(m,function(e){if(n(this.args,e))return!0;if(this.is_expr_pure(e))return!1;this.may_throw=Wn;var i=t(this.expression,e);return delete this.may_throw,i}),e(b,function(e){return this.expression.may_throw(e)||n(this.body,e)}),e(z,function(e){return this.condition.may_throw(e)||this.consequent.may_throw(e)||this.alternative.may_throw(e)}),e(P,function(e){return this.name.may_throw(e)||this.value&&this.value.may_throw(e)}),e(N,function(e){return n(this.definitions,e)}),e(W,function(e){return!this.optional&&this.expression.may_throw_on_access(e)||this.expression.may_throw(e)}),e(oe,function(e){if(this.init.may_throw(e))return!0;var n=this.object;return!!n.may_throw(e)||(!((n=n.tail_node())instanceof s||n.is_string(e))||this.body.may_throw(e))}),e(ce,function(e){return this.condition.may_throw(e)||this.body&&this.body.may_throw(e)||this.alternative&&this.alternative.may_throw(e)}),e(he,function(e){return this.body.may_throw(e)}),e(Te,function(e){return n(this.properties,e)}),e(Ae,function(e){return this.value.may_throw(e)||this.key instanceof we&&this.key.may_throw(e)}),e(Me,function(e){return this.value&&this.value.may_throw(e)}),e(je,function(e){return n(this.expressions,e)}),e(Pe,function(e){return this.body.may_throw(e)}),e(Ie,function(e){return!this.optional&&this.expression.may_throw_on_access(e)||this.expression.may_throw(e)||this.property.may_throw(e)}),e(Re,function(e){return this.expression.may_throw(e)||n(this.body,e)}),e(nn,function(e){return!this.is_declared(e)||!D(this,e)}),e(rn,function(e){if(n(this.expressions,e))return!0;if(this.is_expr_pure(e))return!1;if(!this.tag)return!1;this.may_throw=Wn;var i=t(this.tag,e);return delete this.may_throw,i}),e(cn,function(e){return(this.bcatch?this.bcatch.may_throw(e):n(this.body,e))||this.bfinally&&this.bfinally.may_throw(e)}),e(un,function(e){return this.expression.may_throw(e)&&!("typeof"==this.operator&&this.expression instanceof nn)}),e(vn,function(e){return this.name.may_throw(e)||this.value&&this.value.may_throw(e)})}(function(e,n){e.DEFMETHOD("may_throw",n)}),function(e){function n(e,n){for(var t=e.length;--t>=0;)if(!e[t].is_constant_expression(n))return!1;return!0}e(we,Ln),e(s,function(e){return n(this.elements,e)}),e(p,function(e){return this.left.is_constant_expression(e)&&this.right.is_constant_expression(e)&&Ti(this.operator,this.right)}),e(w,function(e){var t=this.extends;return!(t&&!r(t))&&n(this.properties,e)}),e(S,function(e){return"string"==typeof this.key&&(!this.value||this.value.is_constant_expression(e))}),e(q,Wn),e(ve,function(e){var n=this,t=!0,i=[];return n.walk(new yn(function(r,o){if(!t)return!0;if(r instanceof h){if(r===n)return;return i.push(r),o(),i.pop(),!0}if(r instanceof nn){if(n.inlined||r.redef||r.in_arg)return t=!1,!0;if(n.variables.has(r.name))return!0;var s=r.definition();if(Yn(s.scope,i))return!0;if(e&&!s.redefined()){var a=e.find_variable(r.name);if(a?a===s:s.undeclared)return t="f",!0}return t=!1,!0}return r instanceof De?(Tn(n)&&On(i,function(e){return!(e instanceof Ce)||Tn(e)})&&(t=!1),!0):void 0})),t}),e(Te,function(e){return n(this.properties,e)}),e(Ae,function(e){return"string"==typeof this.key&&this.value.is_constant_expression(e)}),e(un,function(e){return this.expression.is_constant_expression(e)})}(function(e,n){e.DEFMETHOD("is_constant_expression",n)}),function(e){function n(){var e=this.body.length;return e>0&&Ut(this.body[e-1])}e(Ne,Vn),e(de,$n),e(v,n),e(Ue,n),e(ce,function(){return this.alternative&&Ut(this.body)&&Ut(this.alternative)&&this})}(function(e,n){e.DEFMETHOD("aborts",n)});var Bt=Hn(["use asm","use strict"]);function Gt(e,n,t){switch(e.body.length){case 0:return t?jn.skip:Bn(X,e);case 1:var i=e.body[0];return ut(i)?n instanceof pe&&i instanceof _e?e:i:e}return e}function Lt(e,n){n.option("rests")&&(e.uses_arguments||e.rest instanceof U&&n.drop_fargs(e,n.parent())&&(e.argnames=e.argnames.concat(e.rest.elements),e.rest=e.rest.rest))}function Vt(e,n){if(!n.option("arrows"))return e;Lt(e,n),e.value&&(e.body=[e.first_statement()]);var t=Tt(e.body,n);switch(t.length){case 1:var i=t[0];if(i instanceof Me){e.body.length=0,e.value=i.value;break}default:e.body=t,e.value=null}return e}e(L,function(e,n){return!n.option("directives")||Bt[e.value]&&n.has_directive(e.value)===e?e:Bn(X,e)}),e(M,function(e,n){return n.option("drop_debugger")?Bn(X,e):e}),e(he,function(e,n){if(e.body instanceof ce||e.body instanceof g){var t=Tt([e.body],n);switch(t.length){case 0:e.body=Bn(X,e);break;case 1:e.body=t[0];break;default:e.body=Bn(v,e,{body:t})}}return n.option("unused")&&0==e.label.references.length?e.body:e}),e(be,function(e,n){if(!n.option("dead_code"))return e;var t=e.label;if(t){var i=n.loopcontrol_target(e);e.label=null,n.loopcontrol_target(e)===i?Gn(t.thedef.references,e):e.label=t}return e}),e(d,function(e,n){return e.body=Tt(e.body,n),e}),e(v,function(e,n){return e.body=Tt(e.body,n),Gt(e,n.parent())}),e(ve,function(e,n){return Lt(e,n),e.body=Tt(e.body,n),e}),e(a,Vt),e(c,Vt),e(ae,function(e,n){Lt(e,n),e.body=Tt(e.body,n);var t=n.parent();if(n.option("inline"))for(var i=0;i<e.body.length;i++){var r=e.body[i];if(!(r instanceof L)){if(r instanceof Me){if(i!=e.body.length-1)break;var o=r.value;if(!o||"Call"!=o.TYPE)break;if(o.is_expr_pure(n))break;var s,a=o.expression;if(a instanceof nn){if(e.name&&e.name.definition()===a.definition())break;s=a.fixed_value()}else s=a;if(!(s instanceof Y||s instanceof ae))break;if(s.rest)break;if(s.uses_arguments)break;if(s===a){if(s.parent_scope!==e)break;if(!On(s.enclosed,function(n){return n.scope!==e}))break}if((s!==a||s.name)&&(t instanceof AST_ClassMethod||t instanceof ze)&&t.value===n.self())break;if(s.contains_this())break;var f=s.argnames.length;if(f>0&&n.option("inline")<2)break;if(f>e.argnames.length)break;if(!On(e.argnames,function(e){return e instanceof Je}))break;if(!On(o.args,function(e){return!(e instanceof He)}))break;for(var c=0;c<f;c++){var u=o.args[c];if(!(u instanceof nn))break;if(u.definition()!==e.argnames[c].definition())break}if(c<f)break;for(;c<o.args.length&&!o.args[c].has_side_effects(n);c++);if(c<o.args.length)break;if(f<e.argnames.length&&!n.drop_fargs(e,t)){if(!n.drop_fargs(s,o))break;do{s.argnames.push(s.make_var(Je,s,"argument_"+f))}while(++f<e.argnames.length)}return a}break}}return e});var Wt=Hn("arguments await yield");function $t(e,n){for(var t=n.length;--t>=0;)n[t]||(n[t]=Bn(fe,e))}function Xt(e,n){var t=Bn(k,e);return t.name&&(t.name=n?null:Bn(AST_SymbolClass,t.name)),t}function Jt(e,n){var t;switch(e.CTOR){case AST_AsyncDefun:t=AST_AsyncFunction;break;case AST_AsyncGeneratorDefun:t=AST_AsyncGeneratorFunction;break;case Y:t=ae;break;case AST_GeneratorDefun:t=AST_GeneratorFunction}var i=Bn(t,e);return i.name=n?null:Bn(Qe,e.name),i}function Kt(e,n){e.walk(new yn(function(t){return t instanceof Me?(n(t),!0):t instanceof Ce&&t!==e||void 0}))}function Qt(e){var n=Object.create(null);return Kt(e,function(e){var t=e.value;if(t&&(t=t.tail_node()),t instanceof nn){var i=t.definition().id;n[i]=(n[i]||0)+1}}),n}function Zt(e,n,t){if(t.exposed(e))return!1;switch(e.references.length-e.replaced-(n[e.id]||0)){case e.drop_return:return"d";case e.bool_return:return!0}}function ei(e,n){Kt(e,function(e){e.in_bool=!0;var t=e.value;if(t){var i=oi(n,t);i?i instanceof we||(t=t.drop_side_effect_free(n),e.value=t?Xn(e.value,[t,Bn(Ee,e.value,{value:1})]):Bn(Ee,e.value,{value:1})):(t=t.drop_side_effect_free(n),e.value=t?Xn(e.value,[t,Bn(Ee,e.value,{value:0})]):null)}})}function ni(e,n){if(!e.name||!n.option("ie"))return!0;var t=e.name.definition();return!n.exposed(t)&&On(t.references,function(e){return!(e instanceof nn)})}function ti(e,n,t){if(n instanceof ve){var i=Tn(n),r=is_async(n),o=!1,s=!1;if(i&&e.option("arrows"))if(n.value){if(!r||Si(e,n.value)){var f=n.value.drop_side_effect_free(e);f!==n.value&&(o=!0,n.value=f)}}else s=!0;else if(!Sn(n))if(!t&&n.name){var l=n.name.definition();s=l.references.length==l.replaced}else s=!0;if(s&&(n.process_expression(!1,function(n){var t=n.value;if(t){if(r&&!Si(e,t))return n;t=t.drop_side_effect_free(e,!0)}return o=!0,t?Bn(Pe,n,{body:t}):Bn(X,n)}),Kt(n,function(n){var t=n.value;if(t){if(r&&!Si(e,t))return;var i=t.drop_side_effect_free(e);i!==t&&(o=!0,i&&r&&!Si(e,i)&&(i=i.negate(e)),n.value=i)}})),r&&e.option("awaits")){s&&n.process_expression("awaits",function(n){var t=n.body;if(t instanceof u){if(Si(e,t.expression)){if(o=!0,!(t=t.expression.drop_side_effect_free(e,!0)))return Bn(X,n);n.body=t}}else if(t instanceof je){for(var i=t.expressions,r=i.length;--r>=0;){var s=i[r];if(!(s instanceof u))break;var a=s.expression;if(!Si(e,a))break;if(o=!0,i[r]=a.drop_side_effect_free(e))break}switch(r){case-1:return Bn(X,n);case 0:n.body=i[0];break;default:i.length=r+1}}return n});var p=!s&&n.name||i&&n.value&&!Si(e,n.value),d=new yn(function(t){return!!p||(d.parent()===n&&t.may_throw(e)?p=!0:t instanceof u?p=!0:t instanceof AST_ForAwaitOf?p=!0:t instanceof Me?t.value&&!Si(e,t.value)?p=!0:void 0:t instanceof Ce&&t!==n||void 0)});if(n.walk(d),!p){var h;switch(n.CTOR){case c:h=a;break;case AST_AsyncFunction:h=ae;break;case AST_AsyncGeneratorFunction:h=AST_GeneratorFunction}return Bn(h,n)}}return o&&n.clone()}}function ii(e,n,t){t||(t=be);var i=!1,r=new yn(function(n){return!!(i||n instanceof Ce)||(n instanceof t&&r.loopcontrol_target(n)===e?i=!0:void 0)});return n instanceof he&&r.push(n),r.push(e),e.body.walk(r),i}function ri(e,n,t){if(e instanceof je&&(e=e.tail_node()),e instanceof p)if(e.left instanceof Ye){if(e.right instanceof pn&&"typeof"==e.right.operator){var i=e.right.expression;if(gt(i)){var r,o="undefined"==e.left.value;switch(e.operator){case"==":r=o?t:n;break;case"!=":r=o?n:t;break;default:return}if(r){var s,a=!1,c=i.definition(),u=[],l=[],d=new yn(function(e,n){if(a)return!0;if(e instanceof f){var t=e.left;if(!(t instanceof nn&&t.definition()===c))return;switch(e.right.walk(d),e.operator){case"=":case"&&=":a=!0}return!0}if(e instanceof m)return n(),(s=e.expression.tail_node())instanceof nn&&(s=s.fixed_value(),i=u.length),s instanceof ve?Rn(l,s)&&s.walk(d):a=!0,i>=0&&(u.length=i),!0;if(e instanceof $){var i=u.length;return n(),a&&(u.length=i),!0}if(e instanceof re){e.init&&e.init.walk(d);i=u.length;return e.condition&&e.condition.walk(d),e.body.walk(d),e.step&&e.step.walk(d),a&&(u.length=i),!0}if(e instanceof oe){e.object.walk(d);i=u.length;return e.init.walk(d),e.body.walk(d),a&&(u.length=i),!0}if(e instanceof Ce){if(e===s)return;return!0}return e instanceof nn?(e.definition()===c&&u.push(e),!0):void 0});r.walk(d),u.forEach(function(e){e.defined=!0})}}}}else switch(e.operator){case"&&":ri(e.left,n),ri(e.right,n);break;case"||":ri(h(e.left),t),ri(h(e.right),t)}function h(e){if(e instanceof p)switch(e.operator){case"==":return(e=e.clone()).operator="!=",e;case"!=":return(e=e.clone()).operator="==",e}}}function oi(e,n,t){return!!n.truthy||(At(n)?void 0:!(n.falsy&&!t)&&(!!n.is_truthy()||n.evaluate(e,!0)))}function si(e,n){var t,i=0,r=!1,o=e.self();if(!An(o))for(;;){if(t=o,(o=e.parent(i++))instanceof p)switch(t){case o.left:if(Dt[o.operator])continue;break;case o.right:if(a(o.left))switch(o.operator){case"&&":n[r?"falsy":"truthy"]=!0;break;case"||":case"??":n[r?"truthy":"falsy"]=!0}}else if(o instanceof z){var s=o.condition;if(s===t)continue;if(a(s))switch(t){case o.consequent:n[r?"falsy":"truthy"]=!0;break;case o.alternative:n[r?"truthy":"falsy"]=!0}}else{if(o instanceof J)break;if(o instanceof ce)break;if(o instanceof je){if(o.expressions[0]===t)continue}else if(o instanceof Pe)break}return}for(;;){if(t=o,(o=e.parent(i++))instanceof v){if(o.body[0]===t)continue}else if(o instanceof ce&&a(o.condition))switch(t){case o.body:n[r?"falsy":"truthy"]=!0;break;case o.alternative:n[r?"truthy":"falsy"]=!0}return}function a(e){return!!n.equals(e)||e instanceof pn&&("!"==e.operator&&(!!n.equals(e.expression)&&(r=!0,!0)))}}function ai(e){return function(n,t){var i=!1;return this.definitions.forEach(function(r){r.value&&(i=!0),r.name.match_symbol(function(i){i instanceof We&&t.push(Bn(vn,i,{name:i,value:e(n,i)}))},!0)}),i}}function fi(e){return"arguments"!=e.name&&e.orig.length<(e.orig[0]instanceof Qe?3:2)}function ci(e,n){if(e.exposed(n))return!0;for(var t=n.scope.resolve(),i=n.scope;i!==t;)if((i=i.parent_scope).var_names().has(n.name))return!0}function ui(e,n){return Bn(hn,e,{definitions:e.definitions.map(function(e){return Bn(vn,e,{name:e.name.convert_symbol(tn,function(e,t){var i=e.definition();i.orig[i.orig.indexOf(t)]=e,i.scope!==n&&(i.scope=n,n.variables.set(i.name,i),n.enclosed.push(i),n.var_names().set(i.name,!0))}),value:e.value})})})}function li(e,n){var t=n.definition();return(t.fixed||0===t.fixed)&&fi(t)&&qi(t)&&!ci(e,t)}function pi(e,n){return n.option("varify")&&On(e.definitions,function(e){return!e.name.match_symbol(function(e){if(e instanceof We)return!li(n,e)},!0)})?ui(e,n.find_parent(Ce)):e}function di(e,n){if(n.option("optional_chains")&&e.terminal)do{var t=e.expression;if(e.optional){var i=oi(n,t,!0);if(null==i)return Bn(pn,e,{operator:"void",expression:t}).optimize(n);i instanceof we||(e.optional=!1)}e=t}while(("Call"==e.TYPE||e instanceof qe)&&!e.terminal)}function hi(e,n){var t=e.expression;if(!(t instanceof je))return e;var i=t.expressions.slice(),r=e.clone();return r.expression=i.pop(),i.push(r),Xn(e,i)}function vi(e,n,t){var i=e.expression,r=i instanceof nn?i.fixed_value():i;if(r instanceof ve&&!r.uses_arguments&&!(r.pinned()||t&&t.indexOf(r)<0)){var o=e.args;if(On(o,function(e){return!(e instanceof He)})){var a=r.argnames,f=r===i&&!r.name;if(r.rest){if(!f||!n.option("rests"))return;var c=a.length;for(o=o.slice(0,c);o.length<c;)o.push(Bn(dn,e).optimize(n));o.push(Bn(s,e,{elements:e.args.slice(c)})),a=a.concat(r.rest),r.rest=null}else o=o.slice(),a=a.slice();for(var u=0,l=0,p=f&&n.option("default_values"),d=f&&n.drop_fargs(r,e)?function(e,t){return!e||(e instanceof U?0==e.elements.length&&!e.rest&&t instanceof s:e instanceof G?0==e.properties.length&&!e.rest&&t&&!t.may_throw_on_access(n):e.unused)}:Ln,h=[],v=0;v<o.length;v++){var _=a[v];if(p&&_ instanceof P&&o[v].is_defined(n)&&(a[v]=_=_.name),_&&void 0===_.unused){if(d(_,o[v])){g=o[v].drop_side_effect_free(n);a.splice(v,1),o.splice(v,1),g&&h.push(g),v--;continue}h.push(o[v]),o[u++]=Xn(e,h),h=[]}else{var g=o[v].drop_side_effect_free(n);if(d(_)){_&&a.splice(v,1),o.splice(v,1),g&&h.push(g),v--;continue}if(g)h.push(g),o[u++]=Xn(e,h),h=[];else if(_){if(!h.length){o[u++]=Bn(Ee,o[v],{value:0});continue}o[u++]=Xn(e,h),h=[]}}l=u}for(;v<a.length;v++)d(a[v])&&a.splice(v--,1);if(r.argnames=a,o.length=l,e.args=o,h.length){var m=Xn(e,h);o.push(o.length<a.length?Bn(pn,e,{operator:"void",expression:m}):m)}}}}function _i(e,n){n||(n=e.find_parent(Ce));var t=[];return(is_async(n)||n instanceof an&&e.option("module"))&&t.push("await"),Sn(n)&&t.push("yield"),t.length&&Hn(t)}function gi(e,n){if(!n)return!0;var t=!0,i=new yn(function(r){if(!t)return!0;if(r instanceof Ce){if(r===e)return;if(Tn(r))for(var o=0;t&&o<r.argnames.length;o++)r.argnames[o].walk(i);else r instanceof _e&&n[r.name.name]&&(t=!1);return!0}r instanceof Be&&n[r.name]&&r!==e.name&&(t=!1)});return e.walk(i),t}function mi(e,n){return e.in_strict_mode(n)||!n.has_directive("use strict")}function bi(e,n,t,i){if(i instanceof p&&("&&"==i.operator||"||"==i.operator)&&i.right instanceof f&&"="==i.right.operator&&i.right.left instanceof nn&&i.right.left.definition()===n&&!t.has_side_effects(e)&&r(i.left)&&r(i.right.right))return n.replaced++,"&&"==i.operator?Bn(z,i,{condition:i.left,consequent:i.right.right,alternative:t}):Bn(z,i,{condition:i.left,consequent:t,alternative:i.right.right});function r(t){if(!t.has_side_effects(e)){var i=!1;return t.walk(new yn(function(e){return!!i||(e instanceof nn&&e.definition()===n?i=!0:void 0)})),!i}}}Ce.DEFMETHOD("merge_variables",function(e){if(e.option("merge_vars")){var n,t,i=[],r={},o=this,s=[],a=[],c=0,u=new Fn,l=Object.create(null),d=Object.create(null),h=new yn(function(s,a){if(s instanceof f){var c=s.left,d=s.right;return c instanceof R?(d.walk(h),O(nn,q,c),!0):Dt[s.operator.slice(0,-1)]?(c.walk(h),A(),d.walk(h),c instanceof nn&&q(c),D(),!0):c instanceof nn?("="!=s.operator&&q(c,!0),d.walk(h),q(c),!0):void 0}if(s instanceof p){if(!Dt[s.operator])return;return S(s),!0}var v;if(s instanceof g)return(v=h.loopcontrol_target(s))instanceof pe||M(v),!0;if(s instanceof m)return(y=s.expression)instanceof ge?(s.args.forEach(function(e){e.walk(h)}),y.walk(h)):(a(),T(y)),!0;if(s instanceof w)return s.name&&s.name.walk(h),s.extends&&s.extends.walk(h),s.properties.filter(function(e){return e.key instanceof we&&e.key.walk(h),e.value}).forEach(function(e){e.static?e.value.walk(h):(A(),r.block=s,e.value.walk(h),D())}),!0;if(s instanceof z)return S(s.condition,s.consequent,s.alternative),!0;if(s instanceof F)return(v=h.loopcontrol_target(s))instanceof V&&M(v),!0;if(s instanceof V){A(),r.block=s,r.loop=!0;var _=r;return s.body.walk(h),r.inserted===s&&(r=_),s.condition.walk(h),D(),!0}if(s instanceof re)return s.init&&s.init.walk(h),A(),r.block=s,r.loop=!0,s.condition&&s.condition.walk(h),s.body.walk(h),s.step&&s.step.walk(h),D(),!0;if(s instanceof oe)return s.object.walk(h),A(),r.block=s,r.loop=!0,s.init.walk(h),s.body.walk(h),D(),!0;if(s instanceof ce)return S(s.condition,s.body,s.alternative),!0;if(s instanceof he){A(),r.block=s;_=r;return s.body.walk(h),r.inserted===s&&(r=_),D(),!0}if(s instanceof Ce){if(A(),r.block=s,s===o&&(t=r),s instanceof ve){s.name&&(l[s.name.definition().id]=!1);var b=s.uses_arguments&&!h.has_directive("use strict")?function(e){l[e.definition().id]=!1}:function(e){q(e)};i.push(s),s.argnames.forEach(function(e){O(Je,b,e)}),s.rest&&O(Je,b,s.rest),i.pop()}return zn(s,h),D(),!0}if(s instanceof Ie){var y=s.expression;return s.optional?(y.walk(h),A(),s.property.walk(h),D()):a(),T(y),!0}if(s instanceof Re){s.expression.walk(h);_=r;return s.body.forEach(function(e){e instanceof C||(e.expression.walk(h),_===r&&A())}),r=_,s.body.forEach(function(e){A(),r.block=s;var n=r;Dn(e,h),r.inserted===s&&(r=n),D()}),!0}if(s instanceof Ve||s instanceof Ze)return l[s.definition().id]=!1,!0;if(s instanceof nn)return q(s,!0),!0;if(s instanceof cn){var x=n;return n=s,Dn(s,h),s.bcatch&&(s.bcatch.argname&&s.bcatch.argname.mark_symbol(function(e){if(e instanceof Ge){var n=e.definition();l[n.id]=!1,(n=n.redefined())&&(l[n.id]=!1)}},h),s.bfinally||(n=x)?Dn(s.bcatch,h):(A(),Dn(s.bcatch,h),D())),n=x,s.bfinally&&s.bfinally.walk(h),!0}if(s instanceof un){if(!UNARY_POSTFIX[s.operator])return;var k=s.expression;if(!(k instanceof nn))return;return q(k,!0),!0}if(s instanceof vn){var E=s.value;return E?E.walk(h):E=r.block instanceof oe&&r.block.init===h.parent(),O(We,E?function(e){e instanceof tn?q(e):e.walk(h)}:function(e){if(e instanceof tn){var n=e.definition().id,t=l[n];t?t.push(e):n in l||u.add(n,e)}else e.walk(h)},s.name),!0}if(s instanceof _n)return A(),r.block=s,r.loop=!0,a(),D(),!0;function T(n){if(e.option("ie")){var t=root_expr(n);t instanceof nn&&t.walk(h)}}function S(e,n,t){var i=r,o=[i,i];if(e instanceof p)switch(e.operator){case"&&":o[0]=S(e.left,e.right)[0];break;case"||":case"??":o[1]=S(e.left,null,e.right)[1];break;default:e.walk(h)}else e instanceof z?S(e.condition,e.consequent,e.alternative):e.walk(h);return r=o[0],n&&(A(),n.walk(h)),o[0]=r,r=o[1],t&&(A(),t.walk(h)),o[1]=r,r=i,o}});h.directives=Object.create(e.directives),o.walk(h);for(var v=!1,_=Object.create(null);s.length&&a.length;){var b=a.shift();if(b){var y=b.definition,x=l[y.id];if(x){for(x={end:x.end};y.id in _;)y=_[y.id];x.start=l[y.id].start;var k=[];do{var E=s.shift();if(!(b.index>E.index)){var T=E.definition;if(T.id in d){var S=l[T.id];if(S){if(S.start.block===x.start.block&&H(S,x)&&(!S.start.loop&&qi(y)||H(x,S))&&(!e.option("webkit")||it(y)===it(T))&&!T.const_redefs&&On(S.scopes,function(e){return e.find_variable(y.name)===y})){S.forEach(function(e){e.thedef=y,e.name=y.name,e instanceof nn?(y.references.push(e),T.replaced++):(y.orig.push(e),T.eliminated++)}),T.fixed||(y.fixed=!1),_[T.id]=y,v=!0;break}k.push(E)}}}}while(s.length);k.length&&(s=k.concat(s))}}}return v}function A(){r=Object.create(r)}function D(){r=Object.getPrototypeOf(r)}function O(e,n,t){var i=new yn(function(t){if(!(t instanceof R))return t instanceof P?(A(),t.value.walk(h),D(),t.name.walk(i)):t instanceof B?t.key instanceof we?t.value instanceof qe?(A(),r.block=t,t.key.walk(h),t.value.walk(i),D()):(t.key.walk(h),t.value.walk(i)):t.value.walk(i):t instanceof e?n(t):t.walk(h),!0});t.walk(i)}function q(f,p){var v,_=f.definition();if(p&&!On(i,function(e){return!(v=e.variables.get(f.name))||(!it(v)||v!==_&&!_.undeclared&&e.parent_scope.find_variable(f.name)!==_)}))return l[_.id]=l[v.id]=!1;var g=r;if(n&&(A(),g=r,D()),_.id in l){if(!(m=l[_.id]))return;if(m.start.block!==g.block)return l[_.id]=!1;if(b(f),m.end=g,_.id in d)a[d[_.id]]=null;else if(!p)return}else{if((v=o.variables.get(_.name))!==_)return v&&t===g&&(l[v.id]=!1),l[_.id]=!1;if(e.exposed(_)||Wt[f.name])return l[_.id]=!1;var m;if((m=u.get(_.id)||[]).scopes=[],b(f),l[_.id]=m,!p)return m.start=g,s.push({index:c++,definition:_});if(g.block!==o)return l[_.id]=!1;m.start=t}function b(e){m.push(e),Rn(m.scopes,e.scope);var n=Mn(h);n!==e.scope&&Rn(m.scopes,n)}d[_.id]=a.length,a.push({index:c++,definition:_})}function M(e){for(var n=[];;){if(Cn(r,"block")){var t=r.block;if(t instanceof he&&(t=t.body),t===e)break}n.push(r),D()}for(r.inserted=r.block,A();n.length;){var i=n.pop();A(),Cn(i,"block")&&(r.block=i.block),Cn(i,"loop")&&(r.loop=i.loop)}}function j(e,n){return e===n||e.isPrototypeOf(n)}function H(e,n){return j(e.start,e.end)||j(e.start,n.start)}}),Ce.DEFMETHOD("drop_unused",function(e){if(e.option("unused")){var n=this,t=!(n instanceof an)||e.toplevel.funcs,i=!(n instanceof an)||e.toplevel.vars,r=/keep_assign/.test(e.option("unused"))?Ln:function(n,t){var i,r=!1;if(n instanceof f?(n.write_only||"="==n.operator)&&(i=s(n.left,t)):n instanceof un&&n.write_only&&(i=s(n.expression,t)),i instanceof nn){var o=i.definition();if(!c[o.id]&&!e.exposed(o)&&D(i,e,r))return i}function s(n,t){if(n instanceof qe){var i=n.expression;if(!i.may_throw_on_access(e,!0))return r=!0,t&&n instanceof Ie&&t.unshift(n.property),s(i,t)}else if(n instanceof f&&"="==n.operator){n.write_only="p";var o=s(n.right);return t?(t.assign=n,o instanceof nn?o:n.left):o}return n}},a=Object.create(null),c=Object.create(null),u=function(t){return(u=function n(t,i,r){var o=e.parent(i);if(!o)return r;var s=o instanceof ve&&Yn(t,o.argnames);return n(o,i+1,s?function(e){var n=r(e);if(n)return n;if(n=o.variables.get(e)){var t=n.orig[0];if(t instanceof Je||t instanceof Qe)return n}}:o.variables?function(e){return r(e)||o.variables.get(e)}:r)}(n,0,In))(t)},l=Object.create(null),h=[],_=Object.create(null),g=Object.create(null),b=Object.create(null),w=Object.create(null),E=Object.create(null);n instanceof an&&e.top_retain&&n.variables.each(function(n){!e.top_retain(n)||n.id in _||(we.info("Retaining variable {name}",n),_[n.id]=!0,h.push(n))});var T=new Fn,S=new Fn,q=this,F=new yn(function(r,o){if(r instanceof ve&&r.uses_arguments&&!F.has_directive("use strict")&&r.each_argname(function(e){var n=e.definition();n.id in _||(_[n.id]=!0,h.push(n))}),r!==n){if(q===n){if(r instanceof H){var s=r.name.definition();(u=t&&!s.exported)||s.id in _||(_[s.id]=!0,h.push(s));var a=F.parent()instanceof ee;a?c[s.id]=!0:!u||s.id in g||(g[s.id]=1),r.extends&&r.extends.walk(F);var f=[];return r.properties.forEach(function(e){e.key instanceof we&&e.key.walk(F);var n=e.value;n&&(yt(e)?(!a&&n.contains_this()&&(a=!0),l(n)):f.push(n))}),f.forEach(u&&a?l:function(e){S.add(s.id,e)}),!0}if(r instanceof _e){var u;s=r.name.definition();return(u=t&&!s.exported)||s.id in _||(_[s.id]=!0,h.push(s)),S.add(s.id,r),F.parent()instanceof ee?(c[s.id]=!0,xe(r,o,!0)):(!u||s.id in g||(g[s.id]=1),!0)}if(r instanceof N)return r.definitions.forEach(function(n){var t=n.value,o=t&&(n.name instanceof R||t.has_side_effects(e)),s=o&&"="==t.tail_node().operator;n.name.mark_symbol(function(e){if(e instanceof We){var a=e.definition();if(E[a.id]=(E[a.id]||0)+1,r instanceof hn&&a.orig[0]instanceof Ge){var f=a.redefined();f&&(E[f.id]=(E[f.id]||0)+1)}return a.id in _||i&&!a.exported&&(r instanceof O?!a.redefined():!a.const_redefs)&&(r instanceof hn||fi(a))||(_[a.id]=!0,h.push(a)),t&&(o?s&&de(a,e,w[a.id]):S.add(a.id,t),T.add(a.id,n)),pe(a),!0}},F),o&&t.walk(F)}),!0;if(r instanceof Je){s=r.definition();return E[s.id]=(E[s.id]||0)+1,T.add(s.id,r),!0}if(r instanceof Ke)return(s=r.definition()).id in _||i&&fi(s)||(_[s.id]=!0,h.push(s)),!0}return xe(r,o,!0)}function l(e){var n=q;q=r,e.walk(F),q=n}});F.directives=Object.create(e.directives),n.walk(F);var M=e.option("keep_fnames")?Ln:e.option("ie")?function(n){return!e.exposed(n)&&n.references.length==n.replaced}:function(e){return!(e.id in _)||!(e.orig.length-e.eliminated<2)&&(e.orig[1]instanceof Je||On(e.references,function(e){return!e.in_arg}))};e.option("ie")&&S.each(function(e,n){n in _||e.forEach(function(e){e.walk(new yn(function(e){return e instanceof ae&&e.name&&!M(e.name.definition())?(e.walk(F),!0):e instanceof Ce||void 0}))})}),F=new yn(xe);for(var C=0;C<h.length;C++){var j=S.get(h[C].id);j&&j.forEach(function(e){e.walk(F)})}Object.keys(a).forEach(function(e){var n=a[e];if(n){n=n.reduce(function(e,n){return n.forEach(function(n){Rn(e,n)}),e},[]);var t=(T.get(e)||[]).filter(function(e){return find_if(e instanceof un?function(n){return n===e}:function(n){return n===e||!(n instanceof un)&&K(n)===K(e)},n)});n.length==t.length?a[e]=t:delete a[e]}else delete a[e]});var I=[],B=[],V=new bn(function(n){if(n instanceof P)return Ae(V,n);if(n instanceof R&&n.rest&&(n.rest=n.rest.transform(V)),n instanceof U){for(var t=!n.rest,i=n.elements.length;--i>=0;){var r=n.elements[i].transform(V);r?(n.elements[i]=r,t=!1):t?n.elements.pop():n.elements[i]=Bn(fe,n.elements[i])}return n}if(n instanceof G){var o=[];return n.properties.forEach(function(t){var i=!1;if(t.key instanceof we&&(t.key=t.key.transform(W),i=t.key.has_side_effects(e)),(i||n.rest)&&function(e){return(e instanceof P?e.name:e)instanceof We}(t.value))t.value=t.value.transform(W),o.push(t);else{var r=t.value.transform(V);!r&&n.rest&&(r=t.value instanceof U?Bn(U,t.value,{elements:[]}):Bn(G,t.value,{properties:[]})),r&&(t.value=r,o.push(t))}}),n.properties=o,n}return n instanceof We?ke(n):void 0}),W=new bn(function(c,u,h){var g=W.parent();if(i){var b=[];if(se=r(c,b)){if(function(e,n){var t=e.definition(),i=_[t.id];return!i||n[n instanceof f?"left":"expression"]===e&&(i===e&&t.references.length-t.replaced==1||le(t,n)<0)}(se,c)&&(c instanceof f&&(S=be(c),!0===c.write_only&&(S=S.drop_side_effect_free(e))),S||(S=Bn(Ee,c,{value:0}))),S){if(b.assign){var w=b.assign.drop_side_effect_free(e);w&&(w.write_only=!0,b.unshift(w))}switch(g instanceof je&&g.tail_node()!==c&&!S.has_side_effects(e)||b.push(S),b.length){case 0:return jn.skip;case 1:return st(g,c,b[0].transform(W));default:return Xn(c,b.map(function(e){return e.transform(W)}))}}}else if(c instanceof ln&&c.expression instanceof nn&&le(c.expression.definition(),c)<0)return Bn(pn,c,{operator:"+",expression:c.expression})}if(c instanceof p&&"instanceof"==c.operator){if(!((se=c.right)instanceof nn))return;if(se.definition().id in _)return;var T=c.left.drop_side_effect_free(e),S=Bn(te,c).optimize(e);return T?Xn(c,[T,S]):S}if(c instanceof m)return I.push(c),c.args=c.args.map(function(e){return e.transform(W)}),c.expression=c.expression.transform(W),c;if(q===n){if(t&&c!==n&&c instanceof H)if(!((fe=c.name.definition()).id in _)){$(c.name,"Dropping unused class {name}"),fe.eliminated++,u(c,W);var A=Xt(c,!0);return g instanceof ee?A:(A=A.drop_side_effect_free(e,!0))?Bn(Pe,c,{body:A}):h?jn.skip:Bn(X,c)}if(c instanceof k&&c.name&&M(c.name.definition())&&(c.name=null),c instanceof ve){if(t&&c!==n&&c instanceof _e)if(!((fe=c.name.definition()).id in _))return $(c.name,"Dropping unused function {name}"),fe.eliminated++,g instanceof ee?(qe(),Jt(c,!0)):h?jn.skip:Bn(X,c);if(qe(),c instanceof ge&&c.name&&M(c.name.definition())&&(c.name=null),!(c instanceof o)){var z,F,C=e.drop_fargs(c,g);if(C&&g instanceof m&&g.expression===c)for(z=g.args,F=0;F<z.length&&!(z[F]instanceof He);F++);var j=c.argnames,P=c.rest,G=!1,L=!1;if(P){if(L=!0,!z||F<j.length||P instanceof Je)P=P.transform(V);else P=(A=De(P,Bn(s,g,{elements:z.slice(j.length)}),ke,!c.uses_arguments,P)).name,z.length=j.length,A.value.elements.length&&[].push.apply(z,A.value.elements);P instanceof R&&!P.rest&&(P instanceof U?0==P.elements.length&&(P=null):0==P.properties.length&&(P=null)),c.rest=P,P&&(C=!1,G=!0)}for(var K=C?-1:c.length(),ne=z&&!c.uses_arguments&&g!==e.parent(),ie=j.length;--ie>=0;){var se;if((se=j[ie])instanceof Je){var fe;(fe=se.definition()).id in _?(C=!1,le(fe,se)<0&&(se.unused=null)):C?($(se,"Dropping unused function argument {name}"),j.pop(),fe.eliminated++,se.unused=!0):se.unused=!0}else{var ue;if(L=!0,!z||F<ie)ue=se.transform(V);else ue=(A=De(se,z[ie],ke,ne,se)).name,A.value&&(z[ie]=A.value);ue?(C=!1,j[ie]=ue,G||(G=!(ue instanceof Je))):C?(J(se,"Dropping unused default argument {name}"),j.pop()):ie>K?(J(se,"Dropping unused default argument assignment {name}"),se.name instanceof Je?se.name.unused=!0:G=!0,j[ie]=se.name):(J(se,"Dropping unused default argument value {name}"),j[ie]=se=se.clone(),se.value=Bn(Ee,se,{value:0}),G=!0)}}L&&!G&&c.uses_arguments&&!W.has_directive("use strict")&&(c.rest=Bn(U,c,{elements:[]})),B.push(c)}return c}if(c instanceof y&&c.argname instanceof R&&c.argname.transform(V),c instanceof N&&!(g instanceof oe&&g.init===c)){var pe=[],de=[],ye=[],xe=[],Te=0,Se=c instanceof hn;switch(c.definitions.forEach(function(n){n.value&&(n.value=n.value.transform(W));var t=n.value;if(n.name instanceof R){var r=De(n.name,t,function(e){return i?e.definition().id in _?e:b(e)?e:Se&&!D(e)?e:null:e},!0);r.name?(n=Bn(vn,n,{name:r.name,value:t=r.value}),y()):r.value&&xe.push(r.value)}else{var o,s,f,u,l=n.name.definition(),p=Se?D(n.name):fi(l);if(!p||!i||l.id in _)if(t&&((o=le(l,n))<0||(u=t.tail_node())instanceof nn&&u.definition()===l)&&(n=n.clone(),(t=t.drop_side_effect_free(e))&&we.warn("Side effects in definition of variable {name} [{start}]",n.name),c instanceof O?n.value=t||Bn(Ee,n,{value:0}):(n.value=null,t&&xe.push(t)),t=null,o>=0&&(a[l.id][o]=n)),t||c instanceof me)if(e.option("functions")&&!e.option("ie")&&p&&t&&1==E[l.id]&&0==l.assignments&&(f=t.tail_node())instanceof ge&&!x(l)&&!Tn(f)&&function(e,t){return 0==t.length?e===n.name.fixed_value():On(t,function(n){return e===n.fixed_value()})}(f,l.references)&&function(n){if(!Se||e.has_directive("use strict")||!(n instanceof ae))return g instanceof Ce;return g instanceof d||g instanceof re&&g.init===c||g instanceof ce}(f)&&!1!==(s=function(n,t){if(!n.name)return null;var i,r=n.name.definition();if(r.orig.length>1)return null;if(r.assignments>0)return!1;if(r.name==t)return r;if(e.option("keep_fnames"))return!1;switch(t){case"await":i=is_async;break;case"yield":i=Sn}return On(r.references,function(e){var r=e.scope;if(r.find_variable(t)!==l)return!1;if(i)do{if(r=r.resolve(),i(r))return!1}while(r!==n&&(r=r.parent_scope));return!0})&&r}(f,n.name.name))){var h;switch(we.warn("Declaring {name} as function [{start}]",n.name),f.CTOR){case AST_AsyncFunction:h=AST_AsyncDefun;break;case AST_AsyncGeneratorFunction:h=AST_AsyncGeneratorDefun;break;case ae:h=Y;break;case AST_GeneratorFunction:h=AST_GeneratorDefun}var v=Bn(h,f);v.name=Bn($e,n.name);var m=n.name.scope.resolve().def_function(v.name);s&&s.forEach(function(e){e.name=m.name,e.thedef=m,e.reference()}),pe.push(v),t!==f&&[].push.apply(xe,t.expressions.slice(0,-1))}else p&&E[l.id]>1&&!(g instanceof Z)&&l.orig.indexOf(n.name)>l.eliminated&&(E[l.id]--,Te++),y();else g instanceof Z?y():p&&E[l.id]>1?(we.info("Dropping declaration of variable {name} [{start}]",n.name),E[l.id]--,l.eliminated++):de.push(n);else b(n.name)?((t=t&&t.drop_side_effect_free(e))&&xe.push(t),E[l.id]>1?(we.warn("Dropping duplicated declaration of variable {name} [{start}]",n.name),E[l.id]--,l.eliminated++):(n.value=null,de.push(n))):((t=t&&t.drop_side_effect_free(e))?(we.warn("Side effects in initialization of unused variable {name} [{start}]",n.name),xe.push(t)):$(n.name,"Dropping unused variable {name}"),l.eliminated++)}function b(e){var n=e.definition();return n.orig[0]instanceof Ge&&n.scope.resolve()===e.scope.resolve()}function y(){xe.length>0&&(0==ye.length?pe.push(Bn(Pe,c,{body:Xn(c,xe)})):t?(xe.push(t),n.value=Xn(t,xe)):n.value=Bn(pn,n,{operator:"void",expression:Xn(n,xe)}),xe=[]),ye.push(n)}}),de.length){case 0:if(0==ye.length)break;if(ye.length==Te){[].unshift.apply(xe,ye.map(function(e){we.info("Dropping duplicated definition of variable {name} [{start}]",e.name);var n=e.name.definition(),t=Bn(nn,e.name);n.references.push(t);var i=Bn(f,e,{operator:"=",left:t,right:e.value}),r=le(n,e);return r>=0&&(a[n.id][r]=i),n.assignments++,n.eliminated++,i}));break}case 1:if(0==ye.length){var Ae=de[0].name.definition().id;if(Ae in l){c.definitions=de,l[Ae].init=c;break}}default:var ze;ye.length>0&&(ze=ye[0].value)instanceof je&&(ye[0].value=ze.tail_node(),pe.push(Bn(Pe,c,{body:Xn(ze,ze.expressions.slice(0,-1))}))),c.definitions=de.concat(ye),pe.push(c)}return xe.length>0&&pe.push(Bn(Pe,c,{body:Xn(c,xe)})),Q(pe,c,h)}if(c instanceof f)return u(c,W),c.left instanceof R?(A=De(c.left,c.right,function(e){return e},!0===c.write_only)).name?Bn(f,c,{operator:c.operator,left:A.name,right:A.value}):A.value?A.value:g instanceof je&&g.tail_node()!==c?jn.skip:Bn(Ee,c,{value:0}):c;if(c instanceof he&&c.body instanceof re){if(u(c,W),c.body instanceof v){var Oe=c.body;return c.body=Oe.body.pop(),Oe.body.push(c),h?jn.splice(Oe.body):Oe}return c}if(c instanceof Ce)return qe(),c;if(c instanceof Ke)return!e.option("imports")||c.definition().id in _?c:h?jn.skip:null}function qe(){var e=q;q=c,u(c,W),q=e}},function(n,t){if(n instanceof v)return Gt(n,W.parent(),t);if(n instanceof Z){var r=n.body;if(!(r instanceof v))return;return n.body=r.body.pop(),r.body.push(n),t?jn.splice(r.body):r}if(n instanceof re)return Et(n,t);if(n instanceof se){if(!i||!e.option("loops"))return;if(!pt(n.body))return;var o=ye(n);if(!o)return;var s=o.definition();if(s.id in _)return;$(o,"Dropping unused loop variable {name}"),l[s.id]===n&&delete l[s.id];var a=[],f=n.object.drop_side_effect_free(e);return f&&(we.warn("Side effects in object of for-in loop [{start}]",f),a.push(Bn(Pe,n,{body:f}))),n.init instanceof N&&s.orig[0]instanceof Ge&&a.push(n.init),Q(a,n,t)}if(n instanceof ue)return n.properties&&0==n.properties.length&&(n.properties=null),n;if(n instanceof je){if(n.expressions.length>1)return;return st(W.parent(),n,n.expressions[0])}});W.push(e.parent()),W.directives=Object.create(e.directives),n.transform(W),n instanceof ve&&1==n.body.length&&n.body[0]instanceof L&&"use strict"==n.body[0].value&&(n.body.length=0),I.forEach(function(n){vi(n,e,B)})}function $(e,n){we[e.definition().references.length>0?"info":"warn"](n+" [{start}]",e)}function J(e,n){e.name instanceof Je?$(e.name,n):we.info(n+" [{start}]",e)}function K(e){return e[e instanceof f?"right":"value"]}function Q(e,n,t){switch(e.length){case 0:return t?jn.skip:Bn(X,n);case 1:return e[0];default:return t?jn.splice(e):Bn(v,n,{body:e})}}function ne(e,t){return e.scope.resolve()===n&&(e.fixed&&t.fixed||(a[e.id]=!1),!1!==a[e.id])}function ie(e,n){a[e.id]||(a[e.id]=[]),n.fixed.assigns&&Rn(a[e.id],n.fixed.assigns)}function le(e,n){var t=a[e.id];return t&&t.indexOf(n)}function pe(e){g[e.id]>1&&!(e.id in _)&&(_[e.id]=!0,h.push(e)),g[e.id]=0}function de(e,n,t){e.id in _||(n&&t?(_[e.id]=n,h.push(e)):(b[e.id]=n,w[e.id]=t))}function be(n){var t=n.right;if(!n.write_only)return t;if(!(t instanceof p&&Dt[t.operator]))return t;if(!(t.left instanceof nn))return t;if(!(n.left instanceof nn))return t;var i=n.left.definition();return t.left.definition()!==i?t:t.right.has_side_effects(e)?t:(ne(i,t.left)&&ie(i,t.left),t.right)}function ye(e){var n=e.init;if(n instanceof N)return(n=n.definitions[0].name)instanceof We&&n;for(;n instanceof qe;)n=n.expression.tail_node();return n instanceof nn?n:void 0}function xe(t,o,s){t instanceof f&&t.left instanceof nn&&((D=t.left.definition()).scope.resolve()===n&&T.add(D.id,t));(t instanceof nn&&t.in_arg&&(E[t.definition().id]=0),t instanceof un&&t.expression instanceof nn)&&((D=t.expression.definition()).scope.resolve()===n&&T.add(D.id,t));var a=[];if(k=r(t,a)){if((O=k.definition()).scope.resolve()!==n&&n.variables.get(k.name)!==O)return;if(x(O)&&!On(n.argnames,function(e){return!e.match_symbol(function(e){if(e instanceof Je){var n=e.definition();return n.references.length>n.replaced}},!0)}))return;if("p"===t.write_only&&t.right.may_throw_on_access(e,!0))return;var c=a.assign;if(c&&(c.write_only=!0,c.walk(F)),a.forEach(function(e){e.walk(F)}),t instanceof f){var d=be(t),v=!1;if(s&&!0===t.write_only&&!d.has_side_effects(e)?S.add(O.id,d):(d.walk(F),v="="==d.tail_node().operator),t.left===k)t.write_only&&!v||de(O,k,w[O.id]);else{var m=k.fixed_value();m&&m.is_constant()||de(O,b[O.id],!0)}}return ne(O,k)&&tt(k,t)!==k&&ie(O,k),pe(O),!0}if(t instanceof p){if("instanceof"!=t.operator)return;if(!((k=t.right)instanceof nn))return;var y=k.definition().id;if(!g[y])return;return t.left.walk(F),g[y]++,!0}if(t instanceof se){var k,D;if(t.init instanceof nn&&q===n)(y=t.init.definition().id)in l||(l[y]=t);if(!i||!e.option("loops"))return;if(!pt(t.body))return;if(t.init.has_side_effects(e))return;if(!(k=ye(t)))return;if((D=k.definition()).scope.resolve()!==n){var z=u(k.name);if(z===D||z&&z.redefined()===D)return}return t.object.walk(F),!0}if(t instanceof nn){var O;if((O=t.definition()).id in _||(_[O.id]=!0,h.push(O)),A(O.scope,t.scope)){var M=O.redefined();!M||M.id in _||(_[M.id]=!0,h.push(M))}return ne(O,t)&&ie(O,t),!0}if(t instanceof Ce){var C=q;return q=t,o(),q=C,!0}}function ke(e){return e.definition().id in _?e:(e instanceof Je&&(e.unused=!0),null)}function Ae(n,t){if(t.value=t.value.transform(W),!t.name.transform(n)){if(t.name instanceof R)return null;var i=t.value.drop_side_effect_free(e);if(!i)return null;$(t.name,"Side effects in default value of unused variable {name}"),(t=t.clone()).name.unused=null,t.value=i}return t}function De(n,t,i,r,a){var c=new bn(function(n){if(n instanceof P){if(!(e.option("default_values")&&t&&t.is_defined(e))){var f=r;r=!1;var p=Ae(c,n);return r=f,!p&&r&&t&&(t=t.drop_side_effect_free(e)),p}n===a?a=n=n.name:n=n.name}if(n instanceof U){f=r;var d,h=t;t instanceof nn&&(r=!1,t=t.fixed_value()),t instanceof s?(d=!0,w=t.elements):(d=t&&t.is_string(e),w=!1);var v=[],_=r&&[],g=0;if(n.elements.forEach(function(e,n){(t=w&&w[n])instanceof fe?t=null:t instanceof He&&(r&&(_.length=g,$t(h,_),[].push.apply(_,w.slice(n)),h.elements=_),t=w=!1),(e=e.transform(c))&&(v[g]=e),r&&t&&(_[g]=t),!e&&!t&&r&&w||g++}),t=w&&Bn(s,h,{elements:w.slice(n.elements.length)}),n.rest){var m=r;r=!1,n.rest=n.rest.transform(e.option("rests")?c:W),r=m,n.rest&&(v.length=g)}if(r&&(t&&!n.rest&&(t=t.drop_side_effect_free(e)),t instanceof s?t=t.elements:t instanceof je?t=t.expressions:t&&(t=[t]),t&&t.length&&(_.length=g,[].push.apply(_,t))),t=h,r=f,w&&_&&($t(t,_),(t=t.clone()).elements=_),d){if(!n.rest)switch(v.length){case 0:if(n===a)break;return r&&(t=t.drop_side_effect_free(e)),null;case 1:if(!r)break;if(n===a)break;var b=v[0];if(b.has_side_effects(e))break;if(t.has_side_effects(e)&&b.match_symbol(function(e){return e instanceof qe}))break;return t=Bn(Ie,n,{expression:t,property:Bn(Ee,n,{value:0})}),b}}else v.length=n.elements.length;return $t(n,v),n.elements=v,n}if(n instanceof G){var y,x,w;f=r,h=t;t instanceof nn&&(r=!1,t=t.fixed_value()),t instanceof Te&&(y=[],x=new Fn,w=t.properties.map(function(n,t){if((n=n.clone())instanceof He)x=!1;else{var i=n.key;i instanceof we&&(i=i.evaluate(e,!0)),i instanceof we?x=!1:!x||n instanceof AST_ObjectSetter||x.set(i,n),y[t]=i}return n})),n.rest&&(t=!1,n.rest=n.rest.transform(e.option("rests")?c:W));var k=new Fn,E=r&&new Fn,T=[];if(n.properties.map(function(n){var t=n.key;return t instanceof we&&(n.key=t=t.transform(W),t=t.evaluate(e,!0)),t instanceof we?E=!1:k.set(t,!k.has(t)),t}).forEach(function(e,i){var s,a=n.properties[i];if(e instanceof we)r=!1,t=!1,s=a.value.transform(c)||l(a.value);else{r=E&&k.get(e);var f=x&&x.get(e);f?(t=f.value)instanceof o&&(t=!1):t=!1,(s=a.value.transform(c))?E&&E.set(e,!1):((n.rest||u(a))&&(s=l(a.value)),E&&!E.has(e)&&(f?(E.set(e,f),null===t&&x.set(e,u(f)&&Bn(Se,f,{key:f.key,value:Bn(Ee,f,{value:0})}))):E.set(e,!0))),t&&(f.value=t)}s&&(a.value=s,T.push(a))}),t=h,r=f,E&&y&&((t=t.clone()).properties=jn(w,function(t,i){if(t instanceof He)return t;var r=y[i];if(r instanceof we)return t;if(E.has(r)){var o=E.get(r);if(!o)return t;if(o===t)return x.get(r)||jn.skip}else if(n.rest)return t;var s=t.value.drop_side_effect_free(e);return s?(t.value=s,t):u(t)?Bn(Se,t,{key:t.key,value:Bn(Ee,t,{value:0})}):jn.skip})),t&&!n.rest)switch(T.length){case 0:if(n===a)break;if(t.may_throw_on_access(e,!0))break;return r&&(t=t.drop_side_effect_free(e)),null;case 1:if(!r)break;if(n===a)break;var S=T[0];if(S.key instanceof we)break;if(S.value.has_side_effects(e))break;if(t.has_side_effects(e)&&S.value.match_symbol(function(e){return e instanceof qe}))break;return t=Bn(Ie,n,{expression:t,property:nt(S.key,S)}),S.value}return n.properties=T,n}return!(n=n instanceof fe?null:i(n))&&r&&t&&(t=t.drop_side_effect_free(e)),n});return{name:n.transform(c),value:t};function u(n){return n.key instanceof we&&n.key.has_side_effects(e)}function l(n){return n instanceof P?l(n.name):n instanceof R?(null===t?t=Bn(Ee,n,{value:0}):t&&(t.may_throw_on_access(e,!0)?t=Bn(s,n,{elements:t instanceof je?t.expressions:[t]}):function e(n){if(n instanceof f)n.write_only=!1,e(n.right);else if(n instanceof p){if(!Dt[n.operator])return;e(n.left),e(n.right)}else n instanceof z?(e(n.consequent),e(n.alternative)):n instanceof je?e(n.tail_node()):n instanceof un&&(n.write_only=!1)}(t)),Bn(G,n,{properties:[]})):(n.unused=null,n)}}}),Ce.DEFMETHOD("hoist_declarations",function(e){if(!e.has_directive("use asm")){var n=e.option("hoist_funs"),t=e.option("hoist_vars"),i=this;if(t){var r=0;i.walk(new yn(function(e){return r>1||(e instanceof Z||(e instanceof Ce&&e!==i||(e instanceof hn?(r++,!0):void 0)))})),r<=1&&(t=!1)}if(n||t){var o=new Fn,s=[],a=[],f=new Fn,c=new bn(function(r,u,l){if(r!==i){if(r instanceof L)return s.push(r),l?jn.skip:Bn(X,r);if(r instanceof _e)return n?(p=c.parent())instanceof Z?r:p instanceof ee?r:p!==i&&e.has_directive("use strict")?r:(a.push(r),l?jn.skip:Bn(X,r)):r;if(r instanceof hn){if(!t)return r;var p;if((p=c.parent())instanceof Z)return r;if(!On(r.definitions,function(e){var n=e.name;return n instanceof tn&&!o.has(n.name)&&i.find_variable(n.name)===n.definition()}))return r;r.definitions.forEach(function(e){f.set(e.name.name,e)});var d=r.to_assignments();if(p instanceof oe&&p.init===r){if(d)return d;var h=r.definitions[0].name;return Bn(nn,h)}return p instanceof re&&p.init===r?d:d?Bn(Pe,r,{body:d}):l?jn.skip:Bn(X,r)}return r instanceof Ce?r:r instanceof Ve?(o.set(r.name,!0),r):void 0}});if(i.transform(c),f.size()>0){var u=[];i instanceof ve&&i.each_argname(function(e){On(e.definition().references,function(e){return!e.in_arg})&&f.del(e.name)}),f.each(function(e,n){(e=e.clone()).name=e.name.clone(),e.value=null,u.push(e),f.set(n,e),e.name.definition().orig.unshift(e.name)}),u.length>0&&a.push(Bn(hn,i,{definitions:u}))}i.body=s.concat(a,i.body)}}}),Ce.DEFMETHOD("process_returns",In),Y.DEFMETHOD("process_returns",function(e){if(e.option("booleans")&&!(e.parent()instanceof ee))switch(Zt(this.name.definition(),Qt(this),e)){case"d":ti(e,this,!0);break;case!0:ei(this,e)}}),ae.DEFMETHOD("process_returns",function(e){if(e.option("booleans")){var n=!0,t=Qt(this);if(!this.name||l(this.name.definition())){var i=e.parent();if(i instanceof f){if("="!=i.operator)return;if(!((o=i.left)instanceof nn))return;if(!l(o.definition()))return}else if(i instanceof m&&i.expression!==this){var r=i.expression;if(r instanceof nn&&(r=r.fixed_value()),!(r instanceof ve))return;if(r.uses_arguments||r.pinned())return;for(var o,s=i.args,a=0;a<s.length;a++){var c=s[a];if(c===this){if(!(o=r.argnames[a])&&r.rest)return;break}if(c instanceof He)return}if(o instanceof P&&(o=o.name),o instanceof Je&&!l(o.definition()))return}else{if("Call"!=i.TYPE)return;e.pop();var u=e.in_boolean_context();switch(e.push(this),u){case!0:n=!1;case"d":break;default:return}}n?ti(e,this,!0):ei(this,e)}}function l(i){switch(Zt(i,t,e)){case!0:n=!1;case"d":return!0}}}),h.DEFMETHOD("var_names",function(){var e=this._var_names;return e||(this._var_names=e=new Fn,this.enclosed.forEach(function(n){e.set(n.name,!0)}),this.variables.each(function(n,t){e.set(t,!0)})),e}),Ce.DEFMETHOD("make_var",function(e,n,t){var i=[this];n instanceof We&&n.definition().references.forEach(function(e){var n=e.scope;do{if(!Rn(i,n))return;n=n.parent_scope}while(n&&n!==this)});for(var r=t=t.replace(/^[^a-z_$]|[^a-z0-9_$]/gi,"_"),o=0;!On(i,function(e){return!e.var_names().has(r)});o++)r=t+"$"+o;var s=Bn(e,n,{name:r,scope:this}),a=this.def_variable(s);return i.forEach(function(e){e.enclosed.push(a),e.var_names().set(r,!0)}),s}),Ce.DEFMETHOD("hoist_properties",function(e){if(e.option("hoist_props")&&!e.has_directive("use asm")){var n=this;if(!Tn(n)||!n.value){var t=n instanceof an&&e.top_retain||Ln,i=Object.create(null),r=new bn(function(e,t){if(e instanceof f){if("="!=e.operator)return;if(!e.write_only)return;if(!o(e.left,e.right,1))return;t(e,r);var s=new Fn,a=[],c=[];return e.right.properties.forEach(function(t){var i=d(tn,e.left,t.key);c.push(Bn(vn,e,{name:i,value:null}));var r=Bn(nn,e,{name:i.name,scope:n,thedef:i.definition()});r.reference(),a.push(Bn(f,e,{operator:"=",left:r,right:t.value}))}),s.value=e.right,i[e.left.definition().id]=s,n.body.splice(n.body.indexOf(r.stack[1])+1,0,Bn(hn,e,{definitions:c})),Xn(e,a)}if(e instanceof Ce){if(e===n)return;var u=r.parent();if("Call"==u.TYPE&&u.expression===e)return;return e}if(e instanceof vn){if(!o(e.name,e.value,0))return;t(e,r);s=new Fn;var l=[],p=e.clone();return p.value=e.name instanceof Ve?Bn(Ee,e,{value:0}):null,l.push(p),e.value.properties.forEach(function(n){l.push(Bn(vn,e,{name:d(e.name.CTOR,e.name,n.key),value:n.value}))}),s.value=e.value,i[e.name.definition().id]=s,jn.splice(l)}function d(e,t,i){var r=n.make_var(e,t,t.name+"_"+i);return s.set(i,r.definition()),r}});n.transform(r),n.transform(new bn(function(e,n){if(e instanceof qe){if(!(e.expression instanceof nn))return;if(!(o=i[e.expression.definition().id]))return;if(e.expression.fixed_value()!==o.value)return;var t=o.get(e.get_property()),r=Bn(nn,e,{name:t.name,scope:e.expression.scope,thedef:t});return r.reference(),r}if(e instanceof nn){var o;if(!(o=i[e.definition().id]))return;if(e.fixed_value()!==o.value)return;return Bn(Te,e,{properties:[]})}}))}}function o(i,r,o){if(i instanceof Be){var s=i.definition();if(s.assignments==o&&s.references.length-s.replaced!=o&&!s.single_use&&n.find_variable(i.name)===s&&!t(s)&&i.fixed_value()===r){var a=i.fixed||s.fixed;if(!(a.direct_access||a.escaped&&1==a.escaped.depth))return r instanceof Te&&r.properties.length>0&&D(i,e)&&On(r.properties,function(e){return Yi(e)&&"__proto__"!==e.key})}}}}),function(e){function n(e,n,t,i){for(var r=e.length,o=[],s=!1,a=0;a<r;a++){var f,c=e[a];(f=i&&c instanceof He?i(c,n,t):c.drop_side_effect_free(n,t))!==c&&(s=!0),f&&(o.push(f),t=!1)}return o.length?s?o:e:null}function t(e,n,t){var i=e.expression;return i.is_string(n)?i.drop_side_effect_free(n,t):e}function i(e){return e instanceof He?Bn(s,e,{elements:[e]}):e}e(we,$n),e(o,Vn),e(s,function(e,r){var o=n(this.elements,e,r,t);return o?o===this.elements&&On(o,function(e){return e instanceof He})?this:Xn(this,o.map(i)):null}),e(f,function(e){var n=this.left;if(n instanceof qe){var t=n.expression;if(t.may_throw_on_access(e,!0))return this;if(e.has_directive("use strict")&&t.is_constant())return this}return n.has_side_effects(e)?this:Dt[this.operator.slice(0,-1)]?this:(this.write_only=!0,root_expr(n).is_constant_expression(e.find_parent(Ce))?this.right.drop_side_effect_free(e):this)}),e(u,function(e){if(!e.option("awaits"))return this;var n=this.expression;if(!Si(e,n))return this;n instanceof pn&&"!"==n.operator&&(n=n.expression);var t=n.drop_side_effect_free(e);if(t===n)return this;t?Si(e,t)||(t=t.negate(e)):t=Bn(Ee,n,{value:0});var i=this.clone();return i.expression=t,i}),e(p,function(e,n){var t=this.left,i=this.right,r=this.operator;if(!Ti(r,i,e))return(o=t.drop_side_effect_free(e,n))===t?this:((a=this.clone()).left=o||Bn(Ee,t,{value:0}),a);var o,s=i.drop_side_effect_free(e,n);if(!s)return t.drop_side_effect_free(e,n);if(Dt[r]&&s.has_side_effects(e)){var a=this;if(s!==i&&((a=a.clone()).right=s.drop_side_effect_free(e)),"??"==r)return a;var f=a.clone();f.operator="&&"==r?"||":"&&",f.left=t.negate(e,n);var c=f.right.tail_node();c instanceof p&&f.operator==c.operator&&zi(f);var u=n?Ot:zt;return"&&"==r?u(a,f):u(f,a)}return(o=t.drop_side_effect_free(e,n))?(s=s.drop_side_effect_free(e))?Xn(this,[o,s]):o:s}),e(m,function(e,r){var o=this;if(o.is_expr_pure(e)){o.pure&&we.warn("Dropping __PURE__ call [{start}]",o);var s=n(o.args,e,r,t);return s&&Xn(o,s.map(i))}var a=o.expression;if(o.is_call_pure(e))return(p=o.args.slice()).unshift(a.expression),(p=n(p,e,r,t))&&Xn(o,p.map(i));if(e.option("yields")&&Sn(a)){var f=o.clone();f.expression=Bn(ae,a),f.expression.body=[];var c=f.transform(e);if(c!==f)return c.drop_side_effect_free(e,r)}var u=ti(e,a);if(u&&((o=o.clone()).expression=u,a._squeezed&&(o.expression._squeezed=!0)),o instanceof xe){var l=a;if(l instanceof nn&&(l=l.fixed_value()),l instanceof ve){var p;if(function(e,n){e.new=!0;var t=On(e.body,function(e){return!e.has_side_effects(n)})&&On(e.argnames,function(e){return!e.match_symbol(Ln)})&&!(e.rest&&e.rest.match_symbol(Ln));return e.new=!1,t}(l,e))return(p=o.args.slice()).unshift(a),(p=n(p,e,r,t))&&Xn(o,p.map(i));l.contains_this()||((o=Bn(m,o)).expression=o.expression.clone(),o.args=o.args.slice())}}return o.call_only=!0,o}),e(k,function(e,t){for(var i=this,o=[],s=[],f=0,c=i.properties,u=0;u<c.length;u++){var l=c[u];if(l.key instanceof we&&o.push(l.key),yt(l)){var p=l.value;if(p.has_side_effects(e)){if(p.contains_this())return i;l instanceof AST_ClassInit?(f++,s.push(l)):s.push(p)}}}var d=i.extends;if(d&&(d instanceof nn&&(d=d.fixed_value()),(d=!r(d))||o.unshift(i.extends)),(o=n(o,e,t))&&(t=!1),s=n(s,e,t),!o){if(!d&&!s&&!i.name)return null;o=[]}if(d||i.name||!e.has_directive("use strict")){var h=Xt(i);return d||(h.extends=null),h.properties=[],s?s.length==f?(o.length&&s.unshift(Bn(E,i,{key:Xn(i,o),value:null})),h.properties=s):h.properties.push(Bn(E,i,{static:!0,key:o.length?Xn(i,o):"c",value:v()})):o.length&&h.properties.push(Bn(AST_ClassMethod,i,{key:Xn(i,o),value:Bn(ae,i,{argnames:[],body:[]}).init_vars(h)})),h}return s&&o.push(Bn(m,i,{expression:Bn(a,i,{argnames:[],body:[],value:v()}).init_vars(i.parent_scope),args:[]})),Xn(i,o);function v(){return Xn(i,s.map(function(e){if(!(e instanceof AST_ClassInit))return e;var n=Bn(a,e.value);return n.argnames=[],Bn(m,e,{expression:n,args:[]})}))}}),e(z,function(e){var n,t,i=this.consequent.drop_side_effect_free(e),r=this.alternative.drop_side_effect_free(e);return i===this.consequent&&r===this.alternative?this:(e.option("ie")&&(n=[],i instanceof ae&&(n.push(i),i=null),r instanceof ae&&(n.push(r),r=null)),i?r?((t=this.clone()).consequent=i,t.alternative=r):t=Bn(p,this,{operator:"&&",left:this.condition,right:i}):t=r?Bn(p,this,{operator:"||",left:this.condition,right:r}):this.condition.drop_side_effect_free(e),n?(t&&n.push(t),0==n.length?null:Xn(this,n)):t)}),e(q,Vn),e(W,function(e,n){var t=this.expression;return t.may_throw_on_access(e)?this:t.drop_side_effect_free(e,n)}),e(ae,function(e){return ni(this,e)?null:this}),e(ge,Vn),e(Te,function(e,t){var i=[];this.properties.forEach(function(e){e instanceof He?i.push(e):(e.key instanceof we&&i.push(e.key),i.push(e.value))});var r=n(i,e,t,function(e,n,t){var i=e.expression;return i.safe_to_spread()?i.drop_side_effect_free(n,t):e});return r?r!==i||On(r,function(e){return!(e instanceof He)})?Xn(this,r.map(function(e){return e instanceof He?Bn(Te,e,{properties:[e]}):e})):this:null}),e(De,Vn),e(je,function(e,t){var i=n(this.expressions,e,t);if(!i)return null;var r,o,s,a=i.length-1,c=i[a];if(e.option("awaits")&&a>0&&c instanceof u&&c.expression.is_constant()){var l=(i=i.slice(0,-1))[--a];c.expression=Si(e,l)?l:l.negate(e),i[a]=c}return e.option("conditionals")&&a>0&&(r=i[a-1])instanceof f&&"="==r.operator&&(s=r.left)instanceof nn&&(o=bi(e,s.definition(),r.right,c))&&((r=r.clone()).right=o,(i=i.slice(0,-2)).push(r.drop_side_effect_free(e,t))),i===this.expressions?this:Xn(this,i)}),e(Ie,function(e,n){var t=this.expression;if(t.may_throw_on_access(e))return this;var i=this.property;return(t=t.drop_side_effect_free(e,n))?(i=i.drop_side_effect_free(e))?Xn(this,[t,i]):t:i.drop_side_effect_free(e,n)}),e(nn,function(e){return this.is_declared(e)&&D(this,e)?null:this}),e(rn,function(e,n){var t=this;if(t.is_expr_pure(e)){var i=t.expressions;return 0==i.length?null:Xn(t,i).drop_side_effect_free(e,n)}var r=t.tag,o=ti(e,r);return o&&((t=t.clone()).tag=o,r._squeezed&&(t.tag._squeezed=!0)),t}),e(un,function(e,n){var t=this.expression;if(unary_side_effects[this.operator])return this.write_only=!t.has_side_effects(e),this;if("typeof"==this.operator&&t instanceof nn&&D(t,e))return null;var i=t.drop_side_effect_free(e,n);return n&&i&&vt(i)?i===t&&"!"==this.operator?this:i.negate(e,n):i})}(function(e,n){e.DEFMETHOD("drop_side_effect_free",n)}),e(Pe,function(e,n){if(n.option("side_effects")){var t=e.body,i=t.drop_side_effect_free(n,!0);if(!i)return we.warn("Dropping side-effect-free statement [{start}]",e),Bn(X,e);if(i!==t)return Bn(Pe,e,{body:i})}return e}),e(_n,function(e,n){return n.option("loops")?Bn(re,e).optimize(n):e}),e(V,function(e,n){if(!n.option("loops"))return e;var t=oi(n,e.condition);if(!(t instanceof we)){if(t&&!ii(e,n.parent(),F))return Bn(re,e,{body:Bn(v,e.body,{body:[e.body,Bn(Pe,e.condition,{body:e.condition})]})}).optimize(n);if(!ii(e,n.parent()))return Bn(v,e.body,{body:[e.body,Bn(Pe,e.condition,{body:e.condition})]}).optimize(n)}if(e.body instanceof v&&!ii(e,n.parent(),F)){for(var i=e.body.body,r=i.length;--r>=0;){var o=i[r];if(o instanceof ce&&!o.alternative&&o.body instanceof g&&n.loopcontrol_target(o.body)===e){if(s(o.condition))break;e.condition=Bn(p,e,{operator:"&&",left:o.condition.negate(n),right:e.condition}),i.splice(r,1)}else if(o instanceof Pe){if(s(o.body))break;e.condition=Xn(e,[o.body,e.condition]),i.splice(r,1)}else if(!wt(o,!0))break}e.body=Gt(e.body,n.parent())}return e.body instanceof X?Bn(re,e).optimize(n):e.body instanceof Pe?Bn(re,e,{condition:Xn(e.condition,[e.body.body,e.condition]),body:Bn(X,e)}).optimize(n):e;function s(n){var t=!1;return n.walk(new yn(function(n){return!!t||(n instanceof nn?(Yn(n.definition(),e.enclosed)||(t=!0),!0):void 0)})),t}}),e(re,function(e,n){if(!n.option("loops"))return e;if(n.option("side_effects")&&(e.init&&(e.init=e.init.drop_side_effect_free(n)),e.step&&(e.step=e.step.drop_side_effect_free(n))),e.condition){var t=oi(n,e.condition);if(t)t instanceof we||(e.body=Bn(v,e.body,{body:[Bn(Pe,e.condition,{body:e.condition}),e.body]}),e.condition=null);else if(n.option("dead_code")){var i=[];return An(e.init)?i.push(e.init):e.init&&i.push(Bn(Pe,e.init,{body:e.init})),i.push(Bn(Pe,e.condition,{body:e.condition})),St(n,e.body,i),Bn(v,e,{body:i}).optimize(n)}}return function e(n,t){var i=a(n.body);if(t.option("dead_code")&&(i instanceof g||i instanceof F&&f(i)||i instanceof J)){var r=[];An(n.init)?r.push(n.init):n.init&&r.push(Bn(Pe,n.init,{body:n.init}));var o=f(i)||i instanceof J;return n.condition&&o?r.push(Bn(ce,n,{condition:n.condition,body:i,alternative:null})):n.condition?r.push(Bn(Pe,n.condition,{body:n.condition})):o&&r.push(i),St(t,n.body,r),Bn(v,n,{body:r})}if(i instanceof ce){var s=a(i.body);if(s instanceof g&&!f(s))return n.condition?n.condition=Bn(p,n.condition,{left:n.condition,operator:"&&",right:i.condition.negate(t)}):n.condition=i.condition.negate(t),r=lt(i.alternative),St(t,i.body,r),c(r);if((s=a(i.alternative))instanceof g&&!f(s))return n.condition?n.condition=Bn(p,n.condition,{left:n.condition,operator:"&&",right:i.condition}):n.condition=i.condition,r=lt(i.body),St(t,i.alternative,r),c(r)}return n;function a(e){return e instanceof v?e.body[0]:e}function f(e){return t.loopcontrol_target(e)!==t.self()}function c(i){return n.body instanceof v?(n.body=n.body.clone(),n.body.body=i.concat(n.body.body.slice(1)),n.body=n.body.transform(t)):n.body=Bn(v,n.body,{body:i}).transform(t),e(n,t)}}(e,n)}),e(oe,function(e,n){if(n.option("varify")&&ct(e.init)){var t=e.init.definitions[0].name;(t instanceof R||t instanceof Ze)&&!t.match_symbol(function(e){if(e instanceof We){var t=e.definition();return!qi(t)||ci(n,t)}},!0)&&(e.init=ui(e.init,e.resolve()))}return e}),e(ce,function(e,n){if(pt(e.alternative)&&(e.alternative=null),!n.option("conditionals"))return e;if(n.option("booleans")&&!e.condition.has_side_effects(n)&&si(n,e.condition),n.option("dead_code")){var t=oi(n,e.condition);if(!t){we.warn("Condition always false [{start}]",e.condition);var i=[Bn(Pe,e.condition,{body:e.condition}).transform(n)];return St(n,e.body,i),e.alternative&&i.push(e.alternative),Bn(v,e,{body:i}).optimize(n)}if(!(t instanceof we)){we.warn("Condition always true [{start}]",e.condition);i=[Bn(Pe,e.condition,{body:e.condition}).transform(n),e.body];return e.alternative&&St(n,e.alternative,i),Bn(v,e,{body:i}).optimize(n)}}var r=e.condition.negate(n),o=e.condition.print_to_string().length,s=r.print_to_string().length,a=s<o;if(e.alternative&&a){a=!1,e.condition=r;var c=e.body;e.body=e.alternative,e.alternative=pt(c)?null:c}var u=[],l=[],d=[],h=Y(e.body,u,l,d),_=[],g=[],m=[],b=Y(e.alternative,_,g,m);if(h instanceof v||b instanceof v){i=[];var x=[];if(h&&([].push.apply(i,u),[].push.apply(x,l),h instanceof v?e.body=h:0==h.length?e.body=Bn(X,e.body):e.body=Bn(Pe,e.body,{body:Xn(e.body,h)}),d.forEach(on)),b&&([].push.apply(i,_),[].push.apply(x,g),b instanceof v?e.alternative=b:0==b.length?e.alternative=null:e.alternative=Bn(Pe,e.alternative,{body:Xn(e.alternative,b)}),m.forEach(on)),x.length>0&&i.push(Bn(hn,e,{definitions:x})),i.length>0)return i.push(e.transform(n)),Bn(v,e,{body:i}).optimize(n)}else if(h&&b){i=u.concat(_);return(l.length>0||g.length>0)&&i.push(Bn(hn,e,{definitions:l.concat(g)})),0==h.length?i.push(Bn(Pe,e.condition,{body:b.length>0?Bn(p,e,{operator:"||",left:e.condition,right:Xn(e.alternative,b)}).transform(n):e.condition.clone()}).optimize(n)):0==b.length?(o===s&&!a&&e.condition instanceof p&&"||"==e.condition.operator&&(a=!0),i.push(Bn(Pe,e,{body:Bn(p,e,{operator:a?"||":"&&",left:a?r:e.condition,right:Xn(e.body,h)}).transform(n)}).optimize(n))):i.push(Bn(Pe,e,{body:Bn(z,e,{condition:e.condition,consequent:Xn(e.body,h),alternative:Xn(e.alternative,b)})}).optimize(n)),d.forEach(on),m.forEach(on),Bn(v,e,{body:i}).optimize(n)}if(pt(e.body)&&(e=Bn(ce,e,{condition:r,body:e.alternative,alternative:null})),e.alternative instanceof J&&e.body.TYPE==e.alternative.TYPE){var w=e.body.value,k=e.alternative.value;if(!w&&!k)return Bn(v,e,{body:[Bn(Pe,e,{body:e.condition}),e.body]}).optimize(n);if(w&&k||!function(){var e=!1,t=0,i=n.self();do{if(i instanceof y)n.parent(t).bfinally&&(e=!0),t++;else if(i instanceof ie)t++;else{if(i instanceof Ce)return e&&qn(i);i instanceof cn&&i.bfinally&&(e=!0)}}while(i=n.parent(t++))}()){var E=Bn(e.body.CTOR,e,{value:Bn(z,e,{condition:e.condition,consequent:w||Bn(dn,e.body).transform(n),alternative:k||Bn(dn,e.alternative).transform(n)})});return E instanceof Me&&(E.in_bool=e.body.in_bool||e.alternative.in_bool),E}}if(e.body instanceof ce&&!e.body.alternative&&!e.alternative&&(e=Bn(ce,e,{condition:Bn(p,e.condition,{operator:"&&",left:e.condition,right:e.body.condition}),body:e.body.body,alternative:null})),Ut(e.body)&&e.alternative){var T=e.alternative;return e.alternative=null,Bn(v,e,{body:[e,T]}).optimize(n)}if(Ut(e.alternative)){i=e.body;return e.body=e.alternative,e.condition=a?r:e.condition.negate(n),e.alternative=null,Bn(v,e,{body:[e,i]}).optimize(n)}if(e.alternative){for(var S=P(e.body),A=H(S),D=P(e.alternative),O=H(D),q=[];A>=0&&O>=0;){var F=S[A],M=D[O];if(F.equals(M))S.splice(A--,1),D.splice(O--,1),q.unshift(at(F,M));else{if(!(F instanceof Pe))break;if(!(M instanceof Pe))break;var C=F.body.tail_node(),j=M.body.tail_node();if(!C.equals(j))break;A=N(S,F.body,A),O=N(D,M.body,O),q.unshift(Bn(Pe,C,{body:at(C,j)}))}}if(q.length>0)return e.body=S.length>0?Bn(v,e,{body:S}):Bn(X,e),e.alternative=D.length>0?Bn(v,e,{body:D}):null,q.unshift(e),Bn(v,e,{body:q}).optimize(n)}return n.option("typeofs")&&ri(e.condition,e.body,e.alternative),e;function P(e){return e instanceof v?e.body:[e]}function H(e){for(var n=e.length;--n>=0&&wt(e[n],!0););return n}function N(e,n,t){return n instanceof je?e[t]=Bn(Pe,n,{body:Xn(n,n.expressions.slice(0,-1))}):e.splice(t--,1),t}function Y(e,t,i,r){if(null==e)return[];if(e instanceof v){for(var o=[],s=0;s<e.body.length;s++){var a=e.body[s];if(!(a instanceof X)){if(a instanceof J){if(0==s)return;o.length>0&&(a=a.clone(),o.push(a.value||Bn(dn,a).transform(n)),a.value=Xn(e,o));var c=e.clone();return c.body=c.body.slice(s+1),c.body.unshift(a),c}if(a instanceof _e)t.push(a);else if(a instanceof Pe){if(!n.option("sequences")&&o.length>0)return;o.push(a.body)}else{if(!(a instanceof hn))return;if(!n.option("sequences")&&o.length>0)return;a.remove_initializers(n,i),a.definitions.forEach(u)}}}return o}if(e instanceof _e)return t.push(e),[];if(e instanceof X)return[];if(e instanceof Pe)return[e.body];if(e instanceof hn){o=[];return e.remove_initializers(n,i),e.definitions.forEach(u),o}function u(e){e.value&&o.push(Bn(f,e,{operator:"=",left:e.name.convert_symbol(nn,function(e){r.push(e)}),right:e.value}))}}}),e(Re,function(e,n){if(!n.option("switches"))return e;if(!n.option("dead_code"))return e;for(var t,i,r,o=[],s=[],a=[],f=0,c=e.body.length;f<c;f++){if((t=e.body[f])instanceof C){var u=o[o.length-1];if(i||T(t.body[0],n)&&(!u||Ut(u))){A(t,u);continue}i=t}else{var l=t.expression,d=Bn(p,e,{operator:"===",left:e.expression,right:l}).evaluate(n,!0);if(!d){l.has_side_effects(n)&&a.push(l),A(t,o[o.length-1]);continue}if(!(d instanceof we)){if(i){var h=o.indexOf(i);o.splice(h,1),A(i,o[h-1]),i=null}for(l.has_side_effects(n)?r=t:i=t=Bn(C,t);++f<c;)A(e.body[f],t)}}if(f+1>=c||Ut(t)){u=o[o.length-1];var _=t.body;if(Ut(u))switch(u.body.length-_.length){case 1:if(!T(x=u.body[u.body.length-1],n))break;_=_.concat(x);case 0:var m=Bn(v,u),y=Bn(v,t,{body:_});m.equals(y)&&(u.body=[])}}a.length&&(t instanceof C?o.push(Bn(b,e,{expression:Xn(e,a),body:[]})):(a.push(t.expression),t.expression=Xn(e,a)),a=[]),o.push(t)}for(a.length&&!r&&o.push(Bn(b,e,{expression:Xn(e,a),body:[]}));t=o[o.length-1];){var x;if(T(x=t.body[t.body.length-1],n)&&t.body.pop(),t===i){if(!dt(t))break}else{if(t.expression.has_side_effects(n))break;if(i){if(!dt(i))break;if(o[o.length-2]!==i)break;i.body=i.body.concat(t.body),t.body=[]}else if(!dt(t))break}A(t),o.pop()===i&&(i=null)}if(!t)return s.push(Bn(Pe,e.expression,{body:e.expression})),a.length&&s.push(Bn(Pe,e,{body:Xn(e,a)})),Bn(v,e,{body:s}).optimize(n);if(t===i)for(;(t=o[o.length-2])&&!(t instanceof C)&&dt(t);){if((l=t.expression).has_side_effects(n)){if((u=o[o.length-3])&&!Ut(u))break;i.body.unshift(Bn(Pe,e,{body:l}))}A(t),o.splice(-2,1)}if(o[0].body=s.concat(o[0].body),e.body=o,n.option("conditionals"))switch(o.length){case 1:if(!S(o[0]))break;l=o[0].expression,_=o[0].body.slice();return o[0]!==i&&o[0]!==r?Bn(ce,e,{condition:Bn(p,e,{operator:"===",left:e.expression,right:l}),body:Bn(v,e,{body:_}),alternative:null}).optimize(n):(l&&_.unshift(Bn(Pe,l,{body:l})),_.unshift(Bn(Pe,e.expression,{body:e.expression})),Bn(v,e,{body:_}).optimize(n));case 2:if(!Yn(i,o)||!S(o[1]))break;var w=(_=o[0].body.slice()).length&&T(_[_.length-1],n);if(w&&_.pop(),!On(_,S))break;var k=o[1].body.length&&Bn(v,o[1]),E=Bn(ce,e,{condition:Bn(p,e,o[0]===i?{operator:"!==",left:e.expression,right:o[1].expression}:{operator:"===",left:e.expression,right:o[0].expression}),body:Bn(v,o[0],{body:_}),alternative:w&&k||null});return!w&&k&&(E=Bn(v,e,{body:[E,k]})),E.optimize(n)}return e;function T(n,t){return n instanceof g&&t.loopcontrol_target(n)===e}function S(n){var t=!1,i=new yn(function(e){if(t||e instanceof ve||e instanceof Pe)return!0;T(e,i)&&(t=!0)});return i.push(e),n.walk(i),!t}function A(e,t){t&&!Ut(t)?t.body=t.body.concat(e.body):St(n,e,s)}}),e(cn,function(e,n){if(e.body=Tt(e.body,n),n.option("dead_code")){if(dt(e)&&!(e.bcatch&&e.bcatch.argname&&e.bcatch.argname.match_symbol(function(e){return e instanceof Ge&&!D(e)},!0))){var t=[];return e.bcatch&&(St(n,e.bcatch,t),t.forEach(function(e){e instanceof hn&&e.definitions.forEach(function(e){var n=e.name.definition().redefined();n&&(e.name=e.name.clone(),e.name.thedef=n)})})),t.unshift(Bn(v,e).optimize(n)),e.bfinally&&t.push(Bn(v,e.bfinally).optimize(n)),Bn(v,e,{body:t}).optimize(n)}if(e.bfinally&&dt(e.bfinally)){t=Bn(v,e.bfinally).optimize(n);if(t=e.body.concat(t),!e.bcatch)return Bn(v,e,{body:t}).optimize(n);e.body=t,e.bfinally=null}}return e}),O.DEFMETHOD("remove_initializers",ai(function(e,n){return Bn(dn,n).optimize(e)})),me.DEFMETHOD("remove_initializers",ai(Vn)),hn.DEFMETHOD("remove_initializers",ai(Vn)),N.DEFMETHOD("to_assignments",function(){var e=this.definitions.reduce(function(e,n){var t=n.name.definition(),i=n.value;if(i){i instanceof je&&(i=i.clone());var r=Bn(nn,n.name),o=Bn(f,n,{operator:"=",left:r,right:i});e.push(o);var s=function(){return o.right};s.assigns=[o],s.direct_access=t.direct_access,s.escaped=t.escaped,r.fixed=s,t.references.forEach(function(e){if(e.fixed){var i=e.fixed.assigns;i&&i[0]===n&&(i.length>1||e.fixed.to_binary||e.fixed.to_prefix?i[0]=o:(e.fixed=s,t.fixed===e.fixed&&(t.fixed=s)))}}),t.references.push(r)}return t.assignments++,t.eliminated++,t.single_use=!1,e},[]);return 0==e.length?null:Xn(this,e)}),e(O,pi),e(me,pi),e(m,function(e,n){var t=e.expression,i=di(e,n);if(i)return i;if(n.option("sequences"))if(t instanceof qe){if((r=hi(t))!==t)return(x=e.clone()).expression=r.expressions.pop(),r.expressions.push(x),r.optimize(n)}else if(!ot(t.tail_node())){var r;if((r=hi(e))!==e)return r.optimize(n)}if(n.option("unused")&&vi(e,n),n.option("unsafe"))if(gt(t))switch(t.name){case"Array":if(1==e.args.length){if((_=e.args[0])instanceof Ee)try{var o=_.value;if(o>6)break;for(var a=Array(o),c=0;c<o;c++)a[c]=Bn(fe,e);return Bn(s,e,{elements:a})}catch(n){we.warn("Invalid array length: {length} [{start}]",{length:o,start:e.start});break}if(!_.is_boolean(n)&&!_.is_string(n))break}return Bn(s,e,{elements:e.args});case"Object":if(0==e.args.length)return Bn(Te,e,{properties:[]});break;case"String":if(0==e.args.length)return Bn(Ye,e,{value:""});if(1==e.args.length)return Bn(p,e,{operator:"+",left:Bn(Ye,e,{value:""}),right:e.args[0]}).optimize(n);break;case"Number":if(0==e.args.length)return Bn(Ee,e,{value:0});if(1==e.args.length)return Bn(pn,e,{operator:"+",expression:Bn(p,e,{operator:"+",left:Bn(Ye,e,{value:""}),right:e.args[0]})}).optimize(n);break;case"Boolean":if(0==e.args.length)return Bn(te,e).optimize(n);if(1==e.args.length)return Bn(pn,e,{operator:"!",expression:Bn(pn,e,{operator:"!",expression:e.args[0]})}).optimize(n);break;case"RegExp":var l=[];if(On(e.args,function(e){var t=e.evaluate(n);return l.unshift(t),e!==t}))try{return qt(n,e,Bn(Fe,e,{value:RegExp.apply(RegExp,l)}))}catch(n){we.warn("Error converting {this} [{start}]",e)}}else if(t instanceof W)switch(t.property){case"toString":var d=t.expression;if(0==e.args.length&&!(d.may_throw_on_access(n)||d instanceof AST_Super))return Bn(p,e,{operator:"+",left:Bn(Ye,e,{value:""}),right:d}).optimize(n);break;case"join":if(t.expression instanceof s&&e.args.length<2)e:{var h=e.args[0];if(0==t.expression.elements.length&&!(h instanceof He))return h?Xn(e,[h,Bn(Ye,e,{value:""})]).optimize(n):Bn(Ye,e,{value:""});if(!(h&&(h=h.evaluate(n))instanceof we)){a=[];var _,g=[];for(c=0;c<t.expression.elements.length;c++){var b=t.expression.elements[c];if((L=b.evaluate(n))!==b)g.push(L);else{if(b instanceof He)break e;g.length>0&&(a.push(Bn(Ye,e,{value:g.join(h)})),g.length=0),a.push(b)}}return g.length>0&&a.push(Bn(Ye,e,{value:g.join(h)})),1==a.length?a[0].is_string(n)?a[0]:Bn(p,a[0],{operator:"+",left:Bn(Ye,e,{value:""}),right:a[0]}):""==h?(_=a[0].is_string(n)||a[1].is_string(n)?a.shift():Bn(Ye,e,{value:""}),a.reduce(function(e,n){return Bn(p,n,{operator:"+",left:e,right:n})},_).optimize(n)):((pe=e.clone()).expression=pe.expression.clone(),pe.expression.expression=pe.expression.expression.clone(),pe.expression.expression.elements=a,qt(n,e,pe))}}break;case"charAt":if(e.args.length<2)return(pe=Bn(p,e,{operator:"||",left:Bn(Ie,e,{expression:t.expression,property:e.args.length?Bn(p,e.args[0],{operator:"|",left:Bn(Ee,e,{value:0}),right:e.args[0]}):Bn(Ee,e,{value:0})}).optimize(n),right:Bn(Ye,e,{value:""})})).is_string=Wn,pe.optimize(n);break;case"apply":if(2==e.args.length&&e.args[1]instanceof s)return(ie=e.args[1].elements.slice()).unshift(e.args[0]),Bn(m,e,{expression:Bn(W,t,{expression:t.expression,property:"call"}),args:ie}).optimize(n);break;case"call":var y=t.expression;if(y instanceof nn&&(y=y.fixed_value()),y instanceof ve&&!y.contains_this())return(e.args.length?Xn(e,[e.args[0],Bn(m,e,{expression:t.expression,args:e.args.slice(1)})]):Bn(m,e,{expression:t.expression,args:[]})).optimize(n)}else if(n.option("side_effects")&&t instanceof m&&1==t.args.length&&gt(t.expression)&&"Object"==t.expression.name){var x;return(x=e.clone()).expression=st(e,t,t.args[0]),x.optimize(n)}if(n.option("unsafe_Function")&&gt(t)&&"Function"==t.name){if(0==e.args.length)return Bn(ae,e,{argnames:[],body:[]}).init_vars(t.scope);if(On(e.args,function(e){return e instanceof Ye}))try{var w="n(function("+e.args.slice(0,-1).map(function(e){return e.value}).join()+"){"+e.args[e.args.length-1].value+"})",k=Kn(w),T={ie:n.option("ie")};k.figure_out_scope(T);var S,A=new rt(n.options);(k=k.transform(A)).figure_out_scope(T),k.compute_char_frequency(T),k.mangle_names(T),k.walk(new yn(function(e){return!!S||(e instanceof ve?(S=e,!0):void 0)}));w=et();return v.prototype._codegen.call(S,w),e.args=[Bn(Ye,e,{value:S.argnames.map(function(e){return e.print_to_string()}).join()}),Bn(Ye,e.args[e.args.length-1],{value:w.get().replace(/^\{|\}$/g,"")})],e}catch(n){if(!(n instanceof Jn))throw n;we.warn("Error parsing code passed to new Function [{start}]",e.args[e.args.length-1]),we.warn(n.toString())}}var D=t instanceof nn?t.fixed_value():t,O=n.parent(),q=n.self(),F=D instanceof ve&&(!is_async(D)||n.option("awaits")&&O instanceof u)&&(!Sn(D)||n.option("yields")&&q instanceof mn&&q.nested),M=F&&D.first_statement(),C=0,j=!1,H=!On(e.args,function(e){return!(e instanceof He)}),N=F&&On(D.argnames,function(n,t){if(1==C&&e.args[t]instanceof He&&(C=2),n instanceof P){if(C||(C=1),At(1==C&&e.args[t])||(C=2),Ri(D,n.value))return!1;n=n.name}return!(n instanceof R&&(j=!0,Ri(D,n)))})&&!(D.rest instanceof R&&Ri(D,D.rest)),I=N&&n.option("inline")&&!e.is_expr_pure(n)&&(t===D||mi(D,n));if(I&&M instanceof Me){var L=M.value;if(t===D&&!D.name&&(!L||L.is_constant_expression())&&gi(D,_i(n)))return Xn(e,me(L)).optimize(n)}if(F&&!D.contains_this()){var V,J=!1;if(I&&!D.uses_arguments&&!D.pinned()&&!(D.name&&D instanceof ge)&&(t===D||!Oi(n,V=t.definition(),D)&&D.is_constant_expression(Mn(n)))&&(L=function(e){var t=D.body.length;if(t<2&&(e=ye(e)))return e;if(n.option("inline")<3)return!1;e=null;for(var i=0;i<t;i++){var r=D.body[i];if(r instanceof hn){if(J){if(!e)continue;if(!(e instanceof Pe))return!1;xt(r)||(e=null)}else if(!xt(r)){if(e&&!(e instanceof Pe))return!1;e=null,J=!0}}else{if(r instanceof AST_AsyncDefun||r instanceof Y||r instanceof X)continue;if(e)return!1;e=r}}return ye(e)}(M))){var K,Q,Z,ee,ne=t===D||V.single_use&&V.references.length-V.replaced==1;if(function(){if(C||j||H||J||D.rest)return;if(n.option("inline")<2&&D.argnames.length)return;if(!D.variables.all(function(e){return e.references.length-e.replaced<2&&e.orig[0]instanceof Je}))return;var t,i=n.find_parent(Ce),r=!1,o=_i(n,i),s=[],a=!1,c=new yn(function(e,i){if(r)return!0;if(e instanceof p&&Dt[e.operator]||e instanceof z)s=null;else{if(e instanceof Ce)return r=!0;if(o&&e instanceof Be&&o[e.name])return r=!0;if(e instanceof nn){var u=e.definition();if(D.variables.get(e.name)!==u)return void(s=null);if(u.init instanceof _e)return r=!0;if(tt(e,c.parent()))return r=!0;var l=xe(u);if(t<l||(t=l),!s)return;a?s=null:s.push(D.argnames[l])}else if(!a)return e instanceof f&&e.left instanceof qe?(e.left.expression.walk(c),e.left instanceof Ie&&e.left.property.walk(c),e.right.walk(c),a=!0,!0):e.has_side_effects(n)?(i(),a=!0,!0):void 0}});if(L.walk(c),r)return;var u=e.args.length;if(s&&D.argnames.length>=u){for(u=D.argnames.length;u-- >t&&D.argnames[u]===s.pop(););u++}return u<=t||On(e.args.slice(t,u),a&&!s?function(e){return e.is_constant_expression(i)}:function(e){return!e.has_side_effects(n)})}()){var ie=e.args.slice(),se=[],ce=L.clone(!0).transform(new bn(function(n){if(n instanceof nn){var t=n.definition();if(D.variables.get(n.name)!==t)return se.push(n),n;var i=xe(t),r=ie[i];if(!r)return Bn(dn,e);ie[i]=null;var o=this.parent();return o?st(o,n,r):r}})),ue=D.inlined;t!==D&&(D.inlined=!0);var le=[];ie.forEach(function(e){e&&((e=e.clone(!0)).walk(new yn(function(e){e instanceof nn&&se.push(e)})),le.push(e))},[]),le.push(ce);var pe=Xn(e,le).optimize(n);if(D.inlined=ue,pe=st(O,q,pe),ne||zt(pe,e)===pe)return se.forEach(function(e){e.scope=t===D?D.parent_scope:t.scope,e.reference();var n=e.definition();ne&&n.replaced++,n.single_use=!1}),pe;pe.has_side_effects(n)||(e.drop_side_effect_free=function(e,n){var t=this.args.slice();return t.unshift(this.expression),Xn(this,t).drop_side_effect_free(e,n)})}if(ne&&function(){var e,i=new Fn,r=0;ee=q;do{if(ee.variables&&ee.variables.each(function(e){i.set(e.name,!0)}),e=ee,(ee=n.parent(r++))instanceof E){if(!ee.static)return!1}else if(ee instanceof $)Z=[];else if(ee instanceof re){if(ee.init===e)continue;Z=[]}else if(ee instanceof oe){if(ee.init===e)continue;if(ee.object===e)continue;Z=[]}}while(!(ee instanceof Ce));if(!(Q=ee.body.indexOf(e)+1))return!1;if(!gi(D,_i(n,ee)))return!1;var o=(t!==D||D.parent_scope.resolve()===ee)&&!ee.pinned();ee instanceof an&&(n.toplevel.vars?i.set("arguments",!0):o=!1);K=new Fn;var s=n.option("inline");return!(!function(e,n){var t=!1;return D.each_argname(function(i){if(!t&&!i.unused){if(!n||ke(e,i.name))return t=!0;K.set(i.name,!0),Z&&Z.push(i.definition())}}),!t}(i,s>=2&&o)||!function(e,n){for(var t=0;t<D.body.length;t++){var i=D.body[t];if(i instanceof _e){var r=i.name;if(!n)return!1;if(K.has(r.name))return!1;if(ke(e,r.name))return!1;if(!On(i.enclosed,function(n){return n.scope===ee||n.scope===i||!e.has(n.name)}))return!1;Z&&Z.push(r.definition())}else if(i instanceof hn){if(!n)return!1;for(var o=i.definitions.length;--o>=0;){var r=i.definitions[o].name;if(ke(e,r.name))return!1;Z&&Z.push(r.definition())}}}return!0}(i,s>=3&&o)||Z&&0!=Z.length&&ji(D,Z))}()){D._squeezed=!0,t!==D&&(D.parent_scope=t.scope);pe=Xn(e,function(){var t=[],i=[];C>1||j||H||D.rest?function(n,t){function i(e,i){if(i.unused)return he(i);var r=i.definition();r.assignments++,r.references.push(e);var o=Bn(tn,i);r.orig.push(o),r.eliminated++,Se(n,t,o)}t.push(Bn(f,e,{operator:"=",left:Bn(U,e,{elements:D.argnames.map(function(e){return e.unused?Bn(fe,e):e.convert_symbol(nn,i)}),rest:D.rest&&D.rest.convert_symbol(nn,i)}),right:Bn(s,e,{elements:e.args.slice()})}))}(t,i):function(n,t){for(var i=D.argnames.length,r=e.args.length;--r>=i;)t.push(e.args[r]);var o=[];for(r=i;--r>=0;){var s,a=D.argnames[r];a instanceof P?(o.push(a),s=a.name):s=a;var c=e.args[r];if(s.unused||ee.var_names().has(s.name))c&&t.push(c);else{var u=Bn(tn,s),l=s.definition();l.orig.push(u),l.eliminated++,void 0!==s.unused?(Se(n,t,u),c&&t.push(c)):(!c&&a===s&&(Z||"arguments"==s.name&&!Tn(D)&&Tn(ee))&&(c=Bn(dn,e)),Se(n,t,u,c))}}for(n.reverse(),t.reverse(),r=o.length;--r>=0;){var p=o[r];if(void 0!==p.name.unused)t.push(p.value);else{var d=Bn(nn,p.name);p.name.definition().references.push(d),t.push(Bn(f,p,{operator:"=",left:d,right:p.value}))}}}(t,i);var r=function(e,t){var i=[Q,0],r=[],o=[],s=[],a=[],f=[];return D.body.filter(Z?function(n){if(!(n instanceof _e))return!0;var t=Bn(tn,Ii(n.name)),i=t.definition();return i.fixed=!1,i.orig.push(t),i.eliminated++,Se(e,o,t,Jt(n,!0)),!1}:function(e){if(!(e instanceof _e))return!0;var n=e.name.definition();return ee.functions.set(n.name,n),ee.variables.set(n.name,n),ee.enclosed.push(n),ee.var_names().set(n.name,!0),i.push(e),!1}).forEach(function(e){if(e instanceof hn)for(var t=0;t<e.definitions.length;t++){var i=e.definitions[t],o=Ii(i.name),c=i.value;c&&f.length>0&&(f.push(c),c=Xn(i,f),f=[]),Se(r,s,o,c),Z&&(K.has(o.name)||1==o.definition().orig.length&&D.functions.has(o.name)||a.push(Bi(n,o)))}else e instanceof Pe&&f.push(e.body)}),[].push.apply(e,r),[].push.apply(t,a),[].push.apply(t,o),[].push.apply(t,s),i}(t,i);i.push(L),t.length&&r.push(Bn(hn,D,{definitions:t}));return[].splice.apply(ee.body,r),D.enclosed.forEach(function(e){ee.var_names().has(e.name)||(ee.enclosed.push(e),ee.var_names().set(e.name,!0))}),i}()).optimize(n);return st(O,q,pe)}}if(n.option("side_effects")&&N&&On(D.body,pt)&&(D===t?ni(D,n):!C&&!j&&!D.rest)&&(!Tn(D)||!D.value)&&gi(D,_i(n)))return Xn(e,me()).optimize(n)}if(n.option("drop_console")&&t instanceof qe){for(var de=t.expression;de.expression;)de=de.expression;if(gt(de)&&"console"==de.name)return Bn(dn,e).optimize(n)}return n.option("negate_iife")&&O instanceof Pe&&vt(q)?e.negate(n,!0):jt(n,e);function he(e){return Bn(Ie,e,{expression:Bn(s,e,{elements:[]}),property:Bn(Ee,e,{value:0})})}function me(n){var t=e.args.slice(),i=C>1||j||D.rest;if((i||H)&&(t=[Bn(s,e,{elements:t})]),i){var r=new bn(function(e,n){if(e instanceof P)return Bn(P,e,{name:e.name.transform(r)||he(e),value:e.value});if(e instanceof U){var t=[];return e.elements.forEach(function(e,n){(e=e.transform(r))&&(t[n]=e)}),$t(e,t),Bn(U,e,{elements:t})}if(e instanceof G){var i=[],o=[];return e.properties.forEach(function(n){var t=n.key,s=n.value.transform(r);s?(o.length&&(t instanceof we||(t=nt(t,n)),o.push(t),t=Xn(e,o),o=[]),i.push(Bn(B,n,{key:t,value:s}))):t instanceof we&&o.push(t)}),o.length&&i.push(Bn(B,e,{key:Xn(e,o),value:he(e)})),Bn(G,e,{properties:i})}return e instanceof Je?null:void 0}),o=[];D.argnames.forEach(function(e,n){(e=e.transform(r))&&(o[n]=e)});var a=D.rest&&D.rest.transform(r);a&&(o.length=D.argnames.length),$t(D,o),t[0]=Bn(f,e,{operator:"=",left:Bn(U,D,{elements:o,rest:a}),right:t[0]})}else D.argnames.forEach(function(e){e instanceof P&&t.push(e.value)});return t.push(n||Bn(dn,e)),t}function be(){return e.call_only?Bn(Ee,e,{value:0}):Bn(dn,e)}function ye(n){return n?n instanceof Me?n.value||be():n instanceof Pe?e.call_only?n.body:Bn(pn,n,{operator:"void",expression:n.body}):void 0:be()}function xe(e){for(var n=D.argnames.length;--n>=0;)if(D.argnames[n].definition()===e)return n}function ke(e,n){return e.has(n)||Nn[n]||ee.var_names().has(n)}function Se(n,t,i,r){var o=i.definition();if(ee.var_names().has(i.name)||(ee.var_names().set(i.name,!0),n.push(Bn(vn,i,{name:i,value:null}))),ee.variables.set(i.name,o),ee.enclosed.push(o),r){var s=Bn(nn,i);o.assignments++,o.references.push(s),t.push(Bn(f,e,{operator:"=",left:s,right:r}))}}}),e(xe,function(e,n){if(n.option("unsafe")){var t=e.expression;if(gt(t))switch(t.name){case"Array":case"Error":case"Function":case"Object":case"RegExp":return Bn(m,e).transform(n)}}if(n.option("sequences")){var i=hi(e);if(i!==e)return i.optimize(n)}return n.option("unused")&&vi(e,n),e}),e(je,function(e,n){var t=function(){if(!n.option("side_effects"))return e.expressions;var t=[],i=En(n),r=e.expressions.length-1;return e.expressions.forEach(function(e,o){o<r&&(e=e.drop_side_effect_free(n,i)),e&&(ft(t,e),i=!1)}),t}(),i=t.length-1;return function(){for(var e=1;e<i;e++){var o=t[e-1],s=r(o);if(s){var a=t[e];if(n.option("conditionals")){var f=bi(n,s,o.right,a);if(f){o.right=f,t.splice(e--,1),i--;continue}}n.option("dead_code")&&r(a)===s&&a.right.is_constant_expression(s.scope.resolve())&&(t[--e]=o.right)}}}(),function(){if(!n.option("side_effects"))return;for(;i>0&&At(t[i],n);)i--;i<t.length-1&&(t[i]=Bn(pn,e,{operator:"void",expression:t[i]}),t.length=i+1)}(),0==i?((e=st(n.parent(),n.self(),t[0]))instanceof je||(e=e.optimize(n)),e):(e.expressions=t,e);function r(e){return e instanceof f&&"="==e.operator&&e.left instanceof nn&&e.left.definition()}}),e(ln,function(e,n){if(n.option("sequences")){var t=hi(e);if(t!==e)return t.optimize(n)}return jt(n,e)});var yi=Hn("+ -"),xi=Hn("* / %");e(pn,function(e,n){var t=e.operator,i=e.expression;if(n.option("sequences")&&function(){switch(t){case"delete":return!f(i.tail_node());case"typeof":return!gt(i.tail_node());default:return!0}}()){var r=hi(e);if(r!==e)return r.optimize(n)}switch(t){case"+":if(!n.option("evaluate"))break;if(!i.is_number(n,!0))break;var o=n.parent();if(o instanceof pn&&"delete"==o.operator)break;return i;case"-":if(i instanceof le&&(i=i.transform(n)),i instanceof Ee||i instanceof le)return e;break;case"!":if(!n.option("booleans"))break;if(i.is_truthy())return Xn(e,[i,Bn(te,e)]).optimize(n);if(n.in_boolean_context()){if(i instanceof pn&&"!"==i.operator)return i.expression;if(i instanceof p){var s=En(n);e=(s?Ot:zt)(e,i.negate(n,s))}}break;case"delete":if(!n.option("evaluate"))break;if(f(i))break;return Xn(e,[i,Bn(fn,e)]).optimize(n);case"typeof":if(!n.option("booleans"))break;if(!n.in_boolean_context())break;we.warn("Boolean expression always true [{start}]",e);var a=[Bn(fn,e)];return i instanceof nn&&D(i,n)||a.unshift(i),Xn(e,a).optimize(n);case"void":if(!n.option("side_effects"))break;return(i=i.drop_side_effect_free(n))?(e.expression=i,e):Bn(dn,e).optimize(n)}return n.option("evaluate")&&i instanceof p&&yi[t]&&xi[i.operator]&&(i.left.is_constant()||!i.right.has_side_effects(n))?Bn(p,e,{operator:i.operator,left:Bn(pn,i.left,{operator:t,expression:i.left}),right:i.right}):jt(n,e);function f(e){return e instanceof le||e instanceof ye||e instanceof AST_NewTarget||e instanceof qe||e instanceof nn||e instanceof dn}}),e(u,function(e,n){if(!n.option("awaits"))return e;if(n.option("sequences")){var t=hi(e);if(t!==e)return t.optimize(n)}if(n.option("side_effects")){var i=e.expression;if(i instanceof u)return i.optimize(n);if(i instanceof pn&&i.expression instanceof u)return i.optimize(n);for(var r,o=0,s=e;r=n.parent(o++);s=r){if(Tn(r)){if(r.value===s)return i.optimize(n)}else if(r instanceof Me){var a=!0;do{if(s=r,(r=n.parent(o++))instanceof cn&&(r.bfinally||r.bcatch)!==s){a=!1;break}}while(r&&!(r instanceof Ce));if(a)return i.optimize(n)}else if(r instanceof je&&r.tail_node()===s)continue;break}}return e}),e(mn,function(e,n){if(!n.option("yields"))return e;if(n.option("sequences")){var t=hi(e);if(t!==e)return t.optimize(n)}var i=e.expression;if(e.nested&&"Call"==i.TYPE){var r=i.clone().optimize(n);if("Call"!=r.TYPE)return r}return e}),p.DEFMETHOD("lift_sequences",function(e){if(this.left instanceof qe){if(!(this.left.expression instanceof je))return this;var n=this.left.expression.expressions.slice();return(t=this.clone()).left=t.left.clone(),t.left.expression=n.pop(),n.push(t),Xn(this,n)}if(this.left instanceof je){n=this.left.expressions.slice();return(t=this.clone()).left=n.pop(),n.push(t),Xn(this,n)}if(this.right instanceof je){if(this.left.has_side_effects(e))return this;for(var t,i="="==this.operator&&this.left instanceof nn,r=(n=this.right.expressions).length-1,o=0;o<r&&(i||!n[o].has_side_effects(e));o++);if(o==r)return n=n.slice(),(t=this.clone()).right=n.pop(),n.push(t),Xn(this,n);if(o>0)return(t=this.clone()).right=Xn(this.right,n.slice(o)),(n=n.slice(0,o)).push(t),Xn(this,n)}return this});var wi=Hn("indexOf lastIndexOf"),ki=Hn("== === != !== * & | ^");function Ei(e,n){return e instanceof f?!n&&"="==e.operator&&Ei(e.right):e instanceof xe?!n:e instanceof je?Ei(e.tail_node(),n):e instanceof nn?!n&&Ei(e.fixed_value()):e instanceof s||e instanceof w||e instanceof ve||e instanceof Te}function Ti(e,n,t){switch(e){case"in":return Ei(n)||t&&t.option("unsafe_comps");case"instanceof":return n instanceof nn&&(n=n.fixed_value()),i(n)||t&&t.option("unsafe_comps");default:return!0}}function Si(e,n){if(n.is_constant())return!0;if(n instanceof f)return"="!=n.operator||Si(e,n.right);if(n instanceof p)return!Dt[n.operator]||Si(e,n.left)&&Si(e,n.right);if(n instanceof m)return is_async(n.expression);if(n instanceof z)return Si(e,n.consequent)&&Si(e,n.alternative);if(n instanceof je)return Si(e,n.tail_node());if(n instanceof nn){var t=n.fixed_value();return t&&Si(e,t)}return n instanceof rn?!n.tag||Fi(e,n.tag):n instanceof un||void 0}function Ai(e,n){return e instanceof f?Un(e.left,n)?e:e.left:e instanceof je?Ai(e.tail_node(),n):e instanceof pn&&UNARY_POSTFIX[e.operator]?Un(e.expression,n)?e:e.expression:e}function Di(e,n){return n instanceof W?Di(e,n.expression):n instanceof Ie?Di(e,n.expression)&&Di(e,n.property):n instanceof Be||!n.has_side_effects(e)}function zi(e,n){var t=e.right.tail_node();if(t!==e.right){var i=e.right.expressions.slice(0,-1);i.push(t.left),(t=t.clone()).left=Xn(e.right,i),e.right=t}e.left=Bn(p,e,{operator:e.operator,left:e.left,right:t.left,start:e.left.start,end:t.left.end}),e.right=t.right,n?e.left=e.left.transform(n):e.operator==t.left.operator&&zi(e.left)}function Oi(e,n,t){var r=0,o=e.self();do{if(o===t)return o;if(i(o)&&o.name&&o.name.definition()===n)return o}while(o=e.parent(r++))}function qi(e){var n=e.scope.resolve();return On(e.references,function(e){return n===e.scope.resolve()})}function Fi(e,n){return e.option("unsafe")&&n instanceof W&&"raw"==n.property&&gt(n.expression)&&"String"==n.expression.name}function Mi(e){var n=!1;if(e=e.replace(/\\(u\{[^{}]*\}?|u[\s\S]{0,4}|x[\s\S]{0,2}|[0-9]+|[\s\S])/g,function(e,t){var i=decode_escape_sequence(t);if("string"==typeof i)return i;n=!0}),!n)return e}function Ci(e,n){return e instanceof nn||e.TYPE===n.TYPE}function ji(e,n){var t=!1,i=new yn(function(e){return!!t||(e instanceof nn&&Yn(e.definition(),n)?t=!0:void 0)}),r=new yn(function(n){if(t)return!0;if(n instanceof ve&&n!==e){if(!(n.name||is_async(n)||Sn(n))){var o=r.parent();if(o instanceof m&&o.expression===n)return}return n.walk(i),!0}});return e.walk(r),t}e(p,function(e,n){if(!ki[e.operator]||!e.right.is_constant()||e.left.is_constant()||e.left instanceof p&&Qn[e.left.operator]>=Qn[e.operator]||P(),n.option("sequences")){var t=e.lift_sequences(n);if(t!==e)return t.optimize(n)}if(n.option("assignments")&&Dt[e.operator]){var r=Ai(e.left,n),o=e.right;if(r instanceof nn&&o instanceof f&&"="==o.operator&&r.equals(o.left)){r=r.clone();var s=Bn(f,e,{operator:"=",left:r,right:Bn(p,e,{operator:e.operator,left:e.left,right:o.right})});r.fixed&&(r.fixed=function(){return s.right},r.fixed.assigns=[s]);var a=r.definition();return a.references.push(r),a.replaced++,s.optimize(n)}}if(n.option("comparisons"))switch(e.operator){case"===":case"!==":if(At(e.left,n)&&e.right.is_defined(n))return we.warn("Expression always defined [{start}]",e),Xn(e,[e.right,Bn("==="==e.operator?te:fn,e)]).optimize(n);var c=!0;(e.left.is_string(n)&&e.right.is_string(n)||e.left.is_number(n)&&e.right.is_number(n)||e.left.is_boolean(n)&&e.right.is_boolean(n)||Di(n,e.left)&&e.left.equals(e.right))&&(e.operator=e.operator.slice(0,2));case"==":case"!=":if(!c&&At(e.left,n))e.left=Bn(ke,e.left);else if(n.option("typeofs")&&e.left instanceof Ye&&"undefined"==e.left.value&&e.right instanceof pn&&"typeof"==e.right.operator){((l=e.right.expression)instanceof nn?!l.is_declared(n):l instanceof qe&&n.option("ie"))||(e.right=l,e.left=Bn(dn,e.left).optimize(n),2==e.operator.length&&(e.operator+="="))}else if(e.left instanceof nn&&e.right instanceof nn&&e.left.definition()===e.right.definition()&&Ei(e.left))return Bn("="==e.operator[0]?fn:te,e).optimize(n);break;case"&&":case"||":var u=e.left;if(!(u instanceof p))break;if(u.operator!=("&&"==e.operator?"!==":"==="))break;if(!(e.right instanceof p))break;if(u.operator!=e.right.operator)break;if(At(u.left,n)&&e.right.left instanceof ke||u.left instanceof ke&&At(e.right.left,n)){var l;if((l=u.right)instanceof f&&"="==l.operator&&(l=l.left),l.has_side_effects(n))break;if(!l.equals(e.right.right))break;return u.operator=u.operator.slice(0,-1),u.left=Bn(ke,e),u}}var d=!1,h=n.parent();if(n.option("booleans")){r=Ai(e.left,n);if(Dt[e.operator]&&!r.has_side_effects(n)){if(r.equals(e.right))return st(h,n.self(),e.left).optimize(n);si(n,r)}d=n.in_boolean_context()}if(d)switch(e.operator){case"+":var v=e.left.evaluate(n,!0);if(v&&"string"==typeof v||(v=e.right.evaluate(n,!0))&&"string"==typeof v){we.warn("+ in boolean context always true [{start}]",e);var _=[];if(e.left.evaluate(n)instanceof we&&_.push(e.left),e.right.evaluate(n)instanceof we&&_.push(e.right),_.length<2)return _.push(Bn(fn,e)),Xn(e,_).optimize(n);e.truthy=!0}break;case"==":if(e.left instanceof Ye&&""==e.left.value&&e.right.is_string(n))return Bn(pn,e,{operator:"!",expression:e.right}).optimize(n);break;case"!=":if(e.left instanceof Ye&&""==e.left.value&&e.right.is_string(n))return e.right.optimize(n)}if(n.option("comparisons")&&e.is_boolean(n)){if("Binary"!=h.TYPE){var g=Bn(pn,e,{operator:"!",expression:e.negate(n)});if(qt(n,e,g)===g)return g}switch(e.operator){case">":P("<");break;case">=":P("<=")}}if(n.option("conditionals")&&Dt[e.operator]){if(e.left instanceof p&&e.operator==e.left.operator){var m=Bn(p,e,{operator:e.operator,left:e.left.right,right:e.right}),b=m.transform(n);m!==b&&(e.left=e.left.left,e.right=b)}(T=e.right.tail_node())instanceof p&&e.operator==T.operator&&zi(e,n)}if(n.option("strings")&&"+"==e.operator){if(e.right instanceof Ye&&""==e.right.value&&e.left.is_string(n))return e.left.optimize(n);if(e.left instanceof Ye&&""==e.left.value&&e.right.is_string(n))return e.right.optimize(n);if(e.left instanceof p&&"+"==e.left.operator&&e.left.left instanceof Ye&&""==e.left.left.value&&e.right.is_string(n)&&(e.left.right.is_constant()||!e.right.has_side_effects(n)))return e.left=e.left.right,e.optimize(n);(T=e.right.tail_node())instanceof p&&e.operator==T.operator&&(e.left.is_string(n)&&T.is_string(n)||T.left.is_string(n)&&(e.left.is_constant()||!T.right.has_side_effects(n)))&&zi(e,n)}if(n.option("evaluate")){var y=!0;switch(e.operator){case"&&":if(!(E=oi(n,e.left)))return we.warn("Condition left of && always false [{start}]",e),st(h,n.self(),e.left).optimize(n);if(!(E instanceof we))return we.warn("Condition left of && always true [{start}]",e),Xn(e,[e.left,e.right]).optimize(n);if(e.right.evaluate(n,!0)){if((d||"&&"==h.operator&&h.left===n.self())&&!(e.right.evaluate(n)instanceof we))return we.warn("Dropping side-effect-free && [{start}]",e),e.left.optimize(n)}else{if(d&&!(e.right.evaluate(n)instanceof we))return we.warn("Boolean && always false [{start}]",e),Xn(e,[e.left,Bn(te,e)]).optimize(n);e.falsy=!0}if("||"==e.left.operator)if(!(k=oi(n,e.left.right)))return Bn(z,e,{condition:e.left.left,consequent:e.right,alternative:e.left.right}).optimize(n);break;case"??":var x=!0;case"||":var w,k,E=oi(n,e.left,x);if(x?null==E:!E)return we.warn("Condition left of {operator} always {value} [{start}]",{operator:e.operator,value:x?"nullish":"false",start:e.start}),Xn(e,[e.left,e.right]).optimize(n);if(!(E instanceof we))return we.warn("Condition left of {operator} always {value} [{start}]",{operator:e.operator,value:x?"defined":"true",start:e.start}),st(h,n.self(),e.left).optimize(n);if(x||!(w=e.right.evaluate(n,!0))||w instanceof we){if((d||"||"==h.operator&&h.left===n.self())&&!e.right.evaluate(n))return we.warn("Dropping side-effect-free {operator} [{start}]",e),e.left.optimize(n)}else{if(d&&!(e.right.evaluate(n)instanceof we))return we.warn("Boolean || always true [{start}]",e),Xn(e,[e.left,Bn(fn,e)]).optimize(n);e.truthy=!0}if(!x&&"&&"==e.left.operator)if((k=oi(n,e.left.right))&&!(k instanceof we))return Bn(z,e,{condition:e.left.left,consequent:e.left.right,alternative:e.right}).optimize(n);break;case"+":if(e.left instanceof q&&e.right instanceof p&&"+"==e.right.operator&&e.right.left instanceof q&&e.right.is_string(n)&&(e=Bn(p,e,{operator:"+",left:Bn(Ye,e.left,{value:""+e.left.value+e.right.left.value,start:e.left.start,end:e.right.left.end}),right:e.right.right})),e.right instanceof q&&e.left instanceof p&&"+"==e.left.operator&&e.left.right instanceof q&&e.left.is_string(n)&&(e=Bn(p,e,{operator:"+",left:e.left.left,right:Bn(Ye,e.right,{value:""+e.left.right.value+e.right.value,start:e.left.right.start,end:e.right.end})})),e.right instanceof pn&&"-"==e.right.operator&&e.left.is_number(n)){e=Bn(p,e,{operator:"-",left:e.left,right:e.right.expression});break}if(e.left instanceof pn&&"-"==e.left.operator&&j()&&e.right.is_number(n)){e=Bn(p,e,{operator:"-",left:e.right,right:e.left.expression});break}if(n.option("unsafe_math")&&e.left instanceof p&&Qn[e.left.operator]==Qn[e.operator]&&e.right.is_constant()&&(e.right.is_boolean(n)||e.right.is_number(n))&&e.left.is_number(n)&&!e.left.right.is_constant()&&(e.left.left.is_boolean(n)||e.left.left.is_number(n))){e=Bn(p,e,{operator:e.left.operator,left:Bn(p,e,{operator:e.operator,left:e.right,right:e.left.left}),right:e.left.right});break}case"-":if(e.right instanceof pn&&"-"==e.right.operator&&e.left.is_number(n)&&e.right.expression.is_number(n)){e=Bn(p,e,{operator:"+",left:e.left,right:e.right.expression});break}case"*":case"/":y=n.option("unsafe_math"),"+"!=e.operator&&["left","right"].forEach(function(t){var i=e[t];if(i instanceof pn&&"+"==i.operator){var r=i.expression;(r.is_boolean(n)||r.is_number(n)||r.is_string(n))&&(e[t]=r)}});case"&":case"|":case"^":if("-"==e.operator||"/"==e.operator||!e.left.is_boolean(n)&&!e.left.is_number(n)||!e.right.is_boolean(n)&&!e.right.is_number(n)||!j()||e.left instanceof p&&e.left.operator!=e.operator&&Qn[e.left.operator]>=Qn[e.operator]||(e=qt(n,e,Bn(p,e,{operator:e.operator,left:e.right,right:e.left}),e.right instanceof q&&!(e.left instanceof q))),!y||!e.is_number(n))break;if(!(e.right instanceof p&&"%"!=e.right.operator&&Qn[e.right.operator]==Qn[e.operator]&&e.right.is_number(n)&&("+"!=e.operator||e.right.left.is_boolean(n)||e.right.left.is_number(n)))||"-"==e.operator&&e.left.is_negative_zero()||!e.right.left.is_constant_expression()&&e.right.right.has_side_effects(n)||function(e){var n=!1;return e.walk(new yn(function(e){if(n)return!0;if(e instanceof f){if(e.left instanceof qe)return n=!0}else if(e instanceof un&&unary_side_effects[e.operator]&&e.expression instanceof qe)return n=!0})),n}(e.right.right)||"+"!=(e=Bn(p,e,{operator:F(e.operator,e.right.operator),left:Bn(p,e.left,{operator:e.operator,left:e.left,right:e.right.left,start:e.left.start,end:e.right.left.end}),right:e.right.right})).operator||e.right.is_boolean(n)||e.right.is_number(n)||(e.right=Bn(pn,e.right,{operator:"+",expression:e.right})),e.right instanceof q&&e.left instanceof p&&"%"!=e.left.operator&&Qn[e.left.operator]==Qn[e.operator]&&e.left.is_number(n))if(e.left.left instanceof q){r=M(e.operator,e.left.left,e.right,{start:e.left.left.start,end:e.right.end});e=M(e.left.operator,jt(n,r),e.left.right,e)}else if(e.left.right instanceof q){var T,S=F(e.left.operator,e.operator);!(T=jt(n,M(S,e.left.right,e.right,e.left))).is_constant()||"-"==e.left.operator&&0!=e.right.value&&0==+T.value&&e.left.left.is_negative_zero()||(e=M(e.left.operator,e.left.left,T,e))}break;case"instanceof":if(i(e.right))return Xn(e,[e,Bn(te,e)]).optimize(n)}if(!(h instanceof pn&&"delete"==h.operator)){if(e.left instanceof Ee&&!e.right.is_constant())switch(e.operator){case"+":if(0==e.left.value){if(e.right.is_boolean(n))return Bn(pn,e,{operator:"+",expression:e.right}).optimize(n);if(e.right.is_number(n)&&!e.right.is_negative_zero())return e.right}break;case"*":if(1==e.left.value)return Bn(pn,e,{operator:"+",expression:e.right}).optimize(n)}if(e.right instanceof Ee&&!e.left.is_constant())switch(e.operator){case"+":if(0==e.right.value){if(e.left.is_boolean(n))return Bn(pn,e,{operator:"+",expression:e.left}).optimize(n);if(e.left.is_number(n)&&!e.left.is_negative_zero())return e.left}break;case"-":if(0==e.right.value)return Bn(pn,e,{operator:"+",expression:e.left}).optimize(n);break;case"/":if(1==e.right.value)return Bn(pn,e,{operator:"+",expression:e.left}).optimize(n)}}}if(n.option("typeofs"))switch(e.operator){case"&&":ri(e.left,e.right,null);break;case"||":ri(e.left,null,e.right)}if(n.option("unsafe")){var A=C(e.right);if(d&&A&&("=="==e.operator||"!="==e.operator)&&e.left instanceof Ee&&0==e.left.value)return("=="==e.operator?Bn(pn,e,{operator:"!",expression:e.right}):e.right).optimize(n);var D=C(e.left);if(n.option("comparisons")&&function(){switch(e.operator){case"<=":return A&&e.left instanceof Ee&&0==e.left.value;case"<":if(D&&e.right instanceof Ee&&0==e.right.value)return!0;case"==":case"!=":return!!A&&(e.left instanceof Ee&&-1==e.left.value||e.left instanceof pn&&"-"==e.left.operator&&e.left.expression instanceof Ee&&1==e.left.expression.value)}}()){var O=Bn(pn,e,{operator:"!",expression:Bn(pn,e,{operator:"~",expression:D?e.left:e.right})});switch(e.operator){case"<":if(D)break;case"<=":case"!=":O=Bn(pn,e,{operator:"!",expression:O})}return O.optimize(n)}}return jt(n,e);function F(e,n){switch(e){case"-":return"+"==n?"-":"+";case"/":return"*"==n?"/":"*";default:return n}}function M(e,t,i,r){return"+"==e&&(t.is_boolean(n)||t.is_number(n)||(t=Bn(pn,t,{operator:"+",expression:t})),i.is_boolean(n)||i.is_number(n)||(i=Bn(pn,i,{operator:"+",expression:i}))),Bn(p,r,{operator:e,left:t,right:i})}function C(e){return"Call"==e.TYPE&&e.expression instanceof W&&wi[e.expression.property]}function j(){return e.left.is_constant()||e.right.is_constant()||!e.left.has_side_effects(n)&&!e.right.has_side_effects(n)}function P(n){if(j()){n&&(e.operator=n);var t=e.left;e.left=e.right,e.right=t}}}),e(Xe,function(e){return e}),e(nn,function(e,n){if(!n.option("ie")&&gt(e)&&(!e.scope.resolve().uses_with||!n.find_parent(gn)))switch(e.name){case"undefined":return Bn(dn,e).optimize(n);case"NaN":return Bn(ye,e).optimize(n);case"Infinity":return Bn(le,e).optimize(n)}var t=n.parent();if(n.option("reduce_vars")&&tt(n.self(),t)!==n.self()){var r,o,s,a=e.definition(),f=e.fixed_value(),c=a.single_use&&!(t instanceof m&&t.is_expr_pure(n));if(c)if(i(f)){if(a.scope===e.scope.resolve(!0)&&!a.in_loop||n.option("reduce_funcs")&&1!=a.escaped.depth&&!f.inlined)if(a.redefined())c=!1;else if(Oi(n,a,f))c=!1;else if(f.name&&f.name.definition()!==a)c=!1;else if(f.parent_scope!==e.scope||it(a))if(mi(f,n)){if("f"==(c=f.is_constant_expression(e.scope))){var u=e.scope;do{(u instanceof _e||u instanceof ge)&&(u.inlined=!0)}while(u=u.parent_scope)}}else c=!1;else f.name&&("await"==f.name.name&&is_async(f)||"yield"==f.name.name&&Sn(f))?c=!1:f.has_side_effects(n)?c=!1:n.option("ie")&&f instanceof w&&(c=!1);else c=!1;c&&(f.parent_scope=e.scope)}else(!f||a.recursive_refs>0||!f.is_constant_expression()||f.drop_side_effect_free(n))&&(c=!1);if(c){if(a.single_use=!1,f._squeezed=!0,f.single_use=!0,f instanceof H&&(f=Xt(f)),f instanceof _e&&(f=Jt(f)),i(f)){var l=[];u=e.scope;do{if(l.push(u),u===a.scope)break}while(u=u.parent_scope);f.enclosed.forEach(function(e){if(!f.variables.has(e.name))for(var n=0;n<l.length;n++){var t=l[n];if(!Rn(t.enclosed,e))return;t.var_names().set(e.name,!0)}})}if(a.recursive_refs>0){var p,d,h=(x=f.clone(!0)).name.definition(),v=x.variables.get(x.name.name),_=v&&v.orig[0];x instanceof w?(p="def_function",d=AST_SymbolClass):(p="def_variable",d=Qe),_ instanceof d||((_=Bn(d,x.name)).scope=x,x.name=_,(v=x[p](_)).recursive_refs=a.recursive_refs),x.walk(new yn(function(e){if(e instanceof We)e!==_&&((n=e.definition()).orig.push(e),n.eliminated++);else if(e instanceof nn){var n;if((n=e.definition())===h)e.thedef=n=v;else{n.single_use=!1;var t=e.fixed_value();i(t)&&t.name&&t.name.definition()===n&&n.scope===t.name.scope&&f.variables.get(t.name.name)===n&&(t.name=t.name.clone(),e.thedef=n=x.variables.get(t.name.name)||x[p](t.name))}n.references.push(e)}}))}else f instanceof Ce?(n.push(f),x=f.optimize(n),n.pop()):x=f.optimize(n),x=x.transform(new bn(function(e,n){return e instanceof Ce?e:(n(e=e.clone(),this),e)}));return a.replaced++,x}if(f&&!1!==(r=e.fixed||a.fixed).should_replace)if(f instanceof sn?it(a)||!qi(a)||function(n){var t=e.scope;for(;t!==n.scope;){if(t instanceof w)return!0;t=t.parent_scope}}(a)||(s=f):(o=f.evaluate(n,!0))!==f&&"function"!=typeof o&&(null===o||"object"!=typeof o||n.option("unsafe_regexp")&&o instanceof RegExp&&!a.cross_loop&&qi(a))&&(s=nt(o,f)),s){if(void 0===r.should_replace){var g=s.optimize(n).print_to_string().length;k(f)||(g=Math.min(g,f.print_to_string().length));var b=a.name.length;if(n.option("unused")&&!n.exposed(a)){var y=a.references.length-a.replaced-a.assignments;y=Math.min(y,a.references.filter(function(e){return e.fixed===r}).length),b+=(b+2+g)/Math.max(1,y)}r.should_replace=g-Math.floor(b)<n.eval_threshold}var x;if(r.should_replace)return k(f)?(x=s.optimize(n))===s&&(x=x.clone(!0)):(x=zt(s.optimize(n),f))!==s&&x!==f||(x=x.clone(!0)),a.replaced++,x}}return e;function k(e){var n;return e.walk(new yn(function(e){if(e instanceof nn&&(n=!0),n)return!0})),n}}),e(rn,function(e,n){if(!n.option("templates"))return e;var t=e.tag;if(!t||Fi(n,t)){for(var i,r=[],o=[],s=0;s<e.strings.length;s++){var a=e.strings[s];if(!t){var f=Mi(a);f&&(a=v(f))}if(s>0){var c=e.expressions[s-1],u=_(c);if(u){var l,d=o[o.length-1]+u+a;if(t||typeof(l=Mi(d))==i){o[o.length-1]=l?v(l):d;continue}}r.push(c)}o.push(a),t||(i=typeof f)}if(!t&&o.length>1){if(""==o[o.length-1])return Bn(p,e,{operator:"+",left:Bn(rn,e,{expressions:r.slice(0,-1),strings:o.slice(0,-1)}).transform(n),right:r[r.length-1]}).optimize(n);if(""==o[0]){var h=Bn(p,e,{operator:"+",left:Bn(Ye,e,{value:""}),right:r[0]});for(s=1;""==o[s]&&s<r.length;s++)h=Bn(p,e,{operator:"+",left:h,right:r[s]});return qt(n,e,Bn(p,e,{operator:"+",left:h.transform(n),right:Bn(rn,e,{expressions:r.slice(s),strings:o.slice(s)}).transform(n)}).optimize(n))}}e.expressions=r,e.strings=o}return jt(n,e);function v(e){return e.replace(/\r|\\|`|\${/g,function(e){return"\\"+("\r"==e?"r":e)})}function _(e){var i=e.evaluate(n);if(i!==e&&!(t&&/\r|\\|`/.test(i)||(i=v(""+i)).length>e.print_to_string().length+"${}".length))return i}}),e(dn,function(e,n){if(n.option("unsafe_undefined")){var t=Mn(n).find_variable("undefined");if(t){var i=Bn(nn,e,{name:"undefined",scope:t.scope,thedef:t});return i.is_undefined=!0,i}}var r=tt(n.self(),n.parent());return r&&Ci(r,e)?e:Bn(pn,e,{operator:"void",expression:Bn(Ee,e,{value:0})})}),e(le,function(e,n){var t=tt(n.self(),n.parent());return t&&Ci(t,e)?e:!n.option("keep_infinity")||t||Mn(n).find_variable("Infinity")?Bn(p,e,{operator:"/",left:Bn(Ee,e,{value:1}),right:Bn(Ee,e,{value:0})}):e}),e(ye,function(e,n){var t=tt(n.self(),n.parent());return t&&Ci(t,e)?e:t||Mn(n).find_variable("NaN")?Bn(p,e,{operator:"/",left:Bn(Ee,e,{value:0}),right:Bn(Ee,e,{value:0})}):e});var Pi=Hn("+ - * / % >> << >>> | ^ &"),Hi=Hn("* | ^ &");function Ni(e,n){if(!e)return!1;var t=n.parent();return"Call"!=t.TYPE||(t.expression!==n.self()||!(e instanceof nn&&!(e=e.fixed_value()))&&(e instanceof ve&&!e.contains_this()))}function Yi(e){return e instanceof Se&&"string"==typeof e.key&&!(e instanceof ze&&e.value.contains_super())}function Ii(e){var n=e.definition().redefined();return n&&((e=e.clone()).thedef=n),e}function Ri(e,n){var t=!1;return n.walk(new yn(function(n){return!!t||(n instanceof nn&&e.variables.get(n.name)===n.definition()?t=!0:void 0)})),t}function Ui(e,n){var t=[];e.references.forEach(function(e){var i=e.fixed;i&&Rn(t,i)&&(i.assigns?i.assigns.unshift(n):i.assigns=[n])})}function Bi(e,n){var t=Bn(nn,n),i=Bn(f,n,{operator:"=",left:t,right:Bn(dn,n).transform(e)}),r=n.definition();return r.fixed&&(t.fixed=function(){return i.right},t.fixed.assigns=[i],Ui(r,i)),r.assignments++,r.references.push(t),i}e(f,function(e,n){if(n.option("dead_code"))if(e.left instanceof qe){if("="==e.operator){if(e.redundant){var t=[e.left.expression];return e.left instanceof Ie&&t.push(e.left.property),t.push(e.right),Xn(e,t).optimize(n)}if(e.left.equals(e.right)&&!e.left.has_side_effects(n))return e.right;var i=e.left.expression;if(i instanceof ve||!n.has_directive("use strict")&&i instanceof q&&!i.may_throw_on_access(n))return e.left instanceof W?e.right:Xn(e,[e.left.property,e.right]).optimize(n)}}else if(e.left instanceof nn&&D(e.left,n)){var r;if("="==e.operator&&e.left.equals(e.right)&&!((r=n.parent())instanceof pn&&"delete"==r.operator))return e.right;if(e.left.is_immutable())return x();var o,s=e.left.definition(),a=s.scope.resolve(),c=a===n.find_parent(ve),u=0;if(r=n.self(),!a.uses_arguments||!it(s)||n.has_directive("use strict"))do{if(o=r,(r=n.parent(u++))instanceof f){if(r.left instanceof nn&&r.left.definition()===s){if(m(u,r,!c))break;return x(s)}if(r.left.match_symbol(function(e){if(e instanceof qe)return!0}))break}else{if(r instanceof J){if(!c)break;if(m(u,r))break;if(ji(a,[s]))break;return x(s)}if(r instanceof Pe){if(!c)break;if(ji(a,[s]))break;var l;do{if(l=r,(r=n.parent(u++))===a&&kt(r.body,l))return x(s)}while(g(l,r));break}if(r instanceof vn){if(!(r.name instanceof We))continue;if(r.name.definition()!==s)continue;if(m(u,r))break;return x(s)}}}while(_(o,r))}if(n.option("sequences")){var d=e.lift_sequences(n);if(d!==e)return d.optimize(n)}if(n.option("assignments")){if("="==e.operator&&e.left instanceof nn&&e.right instanceof p){if(e.right.left instanceof nn&&e.right.left.name==e.left.name&&Pi[e.right.operator])return b(e.right.right);if(e.right.right instanceof nn&&e.right.right.name==e.left.name&&Hi[e.right.operator]&&!e.right.left.has_side_effects(n))return b(e.right.left)}if(("-="==e.operator||"+="==e.operator&&(e.left.is_boolean(n)||e.left.is_number(n)))&&e.right instanceof Ee&&1==e.right.value){var h=e.operator.slice(0,-1);return Bn(pn,e,{operator:h+h,expression:e.left})}}return jt(n,e);function _(e,n){if(n instanceof p)switch(e){case n.left:return n.right.is_constant_expression(a);case n.right:return!0;default:return!1}if(n instanceof z)switch(e){case n.condition:return n.consequent.is_constant_expression(a)&&n.alternative.is_constant_expression(a);case n.consequent:case n.alternative:return!0;default:return!1}if(n instanceof je){var t=n.expressions,i=t.indexOf(e);if(i<0)return!1;for(var r=t.length;--r>i;)if(!t[r].is_constant_expression(a))return!1;return!0}return n instanceof pn}function g(e,n){return n instanceof v?kt(n.body,e):n instanceof y?kt(n.body,e):n instanceof ie?kt(n.body,e):n instanceof ce?n.body===e||n.alternative===e:n instanceof cn?n.bfinally?n.bfinally===e:n.bcatch===e:void 0}function m(t,i,r){var o=e.right;e.right=Bn(ke,o);var s=i.may_throw(n);return e.right=o,Pn(n,t,i,a,s,r)}function b(n){var t=e.left.fixed;return t&&(t.to_binary=K(function(e){return e.left},t)),Bn(f,e,{operator:e.right.operator+"=",left:e.left,right:n})}function x(t){return t&&(t.fixed=!1),("="!=e.operator?Bn(p,e,{operator:e.operator.slice(0,-1),left:e.left,right:e.right}):st(n.parent(),e,e.right)).optimize(n)}}),e(z,function(e,n){if(n.option("sequences")&&e.condition instanceof je){var t=e.condition.expressions.slice();return(_=e.clone()).condition=t.pop(),t.push(_),Xn(e,t).optimize(n)}if(!n.option("conditionals"))return e;var i=e.condition;if(n.option("booleans")&&!i.has_side_effects(n)&&si(n,i),!(i=oi(n,i)))return we.warn("Condition always false [{start}]",e),Xn(e,[e.condition,e.alternative]).optimize(n);if(!(i instanceof we))return we.warn("Condition always true [{start}]",e),Xn(e,[e.condition,e.consequent]).optimize(n);var r=En(n),o=i.negate(n,r);(r?Ot:zt)(i,o)===o&&(e=Bn(z,e,{condition:o,consequent:e.alternative,alternative:e.consequent}),o=i,i=e.condition);var s=e.consequent,a=e.alternative,c=Ai(i,n);if(Di(n,c)){if(c.equals(s))return Bn(p,e,{operator:"||",left:i,right:a}).optimize(n);if(c.equals(a))return Bn(p,e,{operator:"&&",left:i,right:s}).optimize(n)}var u=s.tail_node();if(u instanceof f){var l="="==u.operator,d=l?a.tail_node():a;if((l||s===u)&&d instanceof f&&u.operator==d.operator&&u.left.equals(d.left)&&(l&&u.left instanceof nn||!i.has_side_effects(n)&&T(s)&&T(a)))return Bn(f,e,{operator:u.operator,left:u.left,right:Bn(z,e,{condition:i,consequent:S(s),alternative:S(a)})})}d=a.tail_node();if(u.equals(d))return Xn(e,s.equals(a)?[i,s]:[Bn(z,e,{condition:i,consequent:A(s),alternative:A(a)}),d]).optimize(n);var h,v=function n(t,r,o){var s=t.tail_node();var a=r.tail_node();if(!function e(n,t){if(n.TYPE!=t.TYPE)return;if(n.optional!=t.optional)return;if(n instanceof m){if(-1!=k(n,t))return;return"Call"!=n.TYPE||!(n.expression instanceof qe||t.expression instanceof qe)||e(n.expression,t.expression)}if(!(n instanceof qe))return;var i=n.property;var r=t.property;return(i instanceof we?i.equals(r):i==r)&&!(n.expression instanceof AST_Super||t.expression instanceof AST_Super)}(s,a))return!o&&Bn(z,e,{condition:i,consequent:t,alternative:r});var f=s.clone();var c=E(t,s,"expression");var u=E(r,a,"expression");var l=n(c,u);s.expression instanceof je&&(l=st(s,s.expression,l));f.expression=l;return f}(s,a,!0);if(v)return v;if(s instanceof m&&a.TYPE==s.TYPE&&(h=k(s,a))>=0&&s.expression.equals(a.expression)&&!i.has_side_effects(n)&&!s.expression.has_side_effects(n)){var _=s.clone(),g=s.args[h];return _.args[h]=g instanceof He?Bn(He,e,{expression:Bn(z,e,{condition:i,consequent:g.expression,alternative:a.args[h].expression})}):Bn(z,e,{condition:i,consequent:g,alternative:a.args[h]}),_}if(u instanceof z&&u.alternative.equals(a))return Bn(z,e,{condition:Bn(p,e,{left:i,operator:"&&",right:E(s,u,"condition")}),consequent:u.consequent,alternative:at(u.alternative,a)});if(u instanceof z&&u.consequent.equals(a))return Bn(z,e,{condition:Bn(p,e,{left:o,operator:"||",right:E(s,u,"condition")}),consequent:at(u.consequent,a),alternative:u.alternative});if(d instanceof z&&s.equals(d.consequent))return Bn(z,e,{condition:Bn(p,e,{left:i,operator:"||",right:E(a,d,"condition")}),consequent:at(s,d.consequent),alternative:d.alternative});if(d instanceof z&&s.equals(d.alternative))return Bn(z,e,{condition:Bn(p,e,{left:o,operator:"&&",right:E(a,d,"condition")}),consequent:d.consequent,alternative:at(s,d.alternative)});if(u instanceof p&&"&&"==u.operator&&u.right.equals(a))return Bn(p,e,{operator:"&&",left:Bn(p,e,{operator:"||",left:o,right:E(s,u,"left")}),right:at(u.right,a)}).optimize(n);if(u instanceof p&&"||"==u.operator&&u.right.equals(a))return Bn(p,e,{operator:"||",left:Bn(p,e,{operator:"&&",left:i,right:E(s,u,"left")}),right:at(u.right,a)}).optimize(n);if(d instanceof p&&"&&"==d.operator&&d.right.equals(s))return Bn(p,e,{operator:"&&",left:Bn(p,e,{operator:"||",left:i,right:E(a,d,"left")}),right:at(s,d.right)}).optimize(n);if(d instanceof p&&"||"==d.operator&&d.right.equals(s))return Bn(p,e,{operator:"||",left:Bn(p,e,{operator:"&&",left:o,right:E(a,d,"left")}),right:at(s,d.right)}).optimize(n);var b=n.option("booleans")&&n.in_boolean_context();return x(s)?w(a)?y(i):Bn(p,e,{operator:"||",left:y(i),right:a}).optimize(n):w(s)?x(a)?y(i.negate(n)):Bn(p,e,{operator:"&&",left:y(i.negate(n)),right:a}).optimize(n):x(a)?Bn(p,e,{operator:"||",left:y(i.negate(n)),right:s}).optimize(n):w(a)?Bn(p,e,{operator:"&&",left:y(i),right:s}).optimize(n):(n.option("typeofs")&&ri(i,s,a),e);function y(e){return e.is_boolean(n)?e:Bn(pn,e,{operator:"!",expression:e.negate(n)})}function x(e){return e instanceof fn||b&&e instanceof q&&e.value||e instanceof pn&&"!"==e.operator&&e.expression instanceof q&&!e.expression.value}function w(e){return e instanceof te||b&&(e instanceof q&&!e.value||e instanceof pn&&"void"==e.operator&&!e.expression.has_side_effects(n))||e instanceof pn&&"!"==e.operator&&e.expression instanceof q&&e.expression.value}function k(e,n){var t=e.args,i=n.args,r=t.length;if(r!=i.length)return-2;for(var o=0;o<r;o++)if(!t[o].equals(i[o])){if(t[o]instanceof He!=i[o]instanceof He)return-3;for(var s=o+1;s<r;s++)if(!t[s].equals(i[s]))return-2;return o}return-1}function E(e,n,t){if(e===n)return n[t];var i=e.expressions.slice(0,-1);return i.push(n[t]),Xn(e,i)}function T(e){return e===e.tail_node()||On(e.expressions.slice(0,-1),function(e){return!e.has_side_effects(n)})}function S(e){if(!(e instanceof je))return e.right;var n=e.expressions.slice();return n.push(n.pop().right),Xn(e,n)}function A(e){return e instanceof je?Xn(e,e.expressions.slice(0,-1)):Bn(Ee,e,{value:0})}}),e(_,function(e,n){if(!n.option("booleans"))return e;if(n.in_boolean_context())return Bn(Ee,e,{value:+e.value});var t=n.parent();return t instanceof p&&("=="==t.operator||"!="==t.operator)?(we.warn("Non-strict equality against boolean: {operator} {value} [{start}]",{operator:t.operator,value:e.value,start:t.start}),Bn(Ee,e,{value:+e.value})):Bn(pn,e,{operator:"!",expression:Bn(Ee,e,{value:1-e.value})})}),e(He,function(e,n){var t=e.expression;return n.option("spreads")&&t instanceof s&&!(n.parent()instanceof Te)?jn.splice(t.elements.map(function(e){return e instanceof fe?Bn(dn,e).optimize(n):e})):e}),e(Ie,function(e,n){var t=e.expression,i=e.property,r=di(e,n);if(r)return r;if(n.option("properties")){var a=i.evaluate(n);if(a!==i){if("string"==typeof a)if("undefined"==a)a=void 0;else(D=parseFloat(a)).toString()==a&&(a=D);i=e.property=zt(i,nt(a,i).transform(n));var f=""+a;if(Zn(f)&&f.length<=i.print_to_string().length+1)return Bn(W,e,{optional:e.optional,expression:t,property:f,quoted:!0}).optimize(n)}}var c,u,l,p,d=n.parent(),h=tt(n.self(),d);if(n.option("arguments")&&t instanceof nn&&x(c=t.definition())&&!t.in_arg&&i instanceof Ee&&Math.floor(w=i.value)==w&&(u=c.scope)===function(){var e,t=0;for(;e=n.parent(t++);)if(e instanceof ve){if(e instanceof o)return;if(Tn(e))continue;return l=n.parent(t),e}}()&&u.uses_arguments<(h?2:3)){d instanceof pn&&"delete"==d.operator&&(c.deleted||(c.deleted=[]),c.deleted[w]=!0);var v=u.argnames[w];if(c.deleted&&c.deleted[w])v=null;else if(v){var _;v instanceof Je&&"await"!=v.name&&t.scope.find_variable(v.name)===(_=v.definition())?(n.has_directive("use strict")||u.name||u.rest||!(l instanceof m&&w<l.args.length&&On(l.args.slice(0,w+1),function(e){return!(e instanceof He)}))||!On(u.argnames,function(e){return e instanceof Je}))&&(z()||_.assignments||_.orig.length>1)&&(v=null):v=null}else if((h||!z())&&w<u.argnames.length+5&&n.drop_fargs(u,l)&&!u.rest)for(;w>=u.argnames.length;)v=u.make_var(Je,u,"argument_"+u.argnames.length),u.argnames.push(v);if(v&&find_if(function(e){return e.name===v.name},u.argnames)===v){h&&c.reassigned--;var g=Bn(nn,v);return g.reference(),v.unused=void 0,g}}if(h)return e;if(n.option("sequences")&&"Call"!=d.TYPE&&!(d instanceof oe&&d.init===e)){var b=hi(e);if(b!==e)return b.optimize(n)}if(a!==i){var y=e.flatten_object(f,n);y&&(t=e.expression=y.expression,i=e.property=y.property)}if(n.option("properties")&&n.option("side_effects")&&i instanceof Ee&&t instanceof s&&On(p=t.elements,function(e){return!(e instanceof He)})){var w,k=p[w=i.value];if(Ni(k,n)){for(var E=k instanceof fe,T=!E,S=[],A=p.length;--A>w;){(D=p[A].drop_side_effect_free(n))&&(S.unshift(D),T&&D.has_side_effects(n)&&(T=!1))}for(T||S.unshift(k);--A>=0;){var D;(D=p[A].drop_side_effect_free(n))?S.unshift(D):E?S.unshift(Bn(fe,p[A])):w--}return T?(S.push(k),Xn(e,S).optimize(n)):Bn(Ie,e,{expression:Bn(s,t,{elements:S}),property:Bn(Ee,i,{value:w})})}}return jt(n,e);function z(){return!n.option("reduce_vars")||c.reassigned}}),ge.DEFMETHOD("contains_super",function(){var e=!1,n=this;return n.walk(new yn(function(t){return!!e||(t instanceof AST_Super?e=!0:t!==n&&t instanceof Ce&&!Tn(t)||void 0)})),e}),function(e){e(a,Ln),e(c,Ln),e(we,function(){var e=!1,n=this;return n.walk(new yn(function(t){return!!e||(t instanceof sn?e=!0:t!==n&&t instanceof Ce&&!Tn(t)||void 0)})),e})}(function(e,n){e.DEFMETHOD("contains_this",n)}),qe.DEFMETHOD("flatten_object",function(e,n){if(n.option("properties")&&"__proto__"!==e){var t=this.expression;if(t instanceof Te)for(var i=t.properties,r=i.length;--r>=0;){var o=i[r];if(o.key===e){if(!On(i,Yi))return;if(!Ni(o.value,n))return;for(var f,u,l=[],p=0;p<i.length;p++){var d=i[p].value;if(i[p]instanceof ze){var h,v=!(d.uses_arguments||Sn(d)||d.contains_this());if(v){u||(u=n.find_parent(Ce));var _=_i(n,u);d.each_argname(function(e){_[e.name]&&(v=!1)})}if(v)h=is_async(d)?c:a;else{if(!(r!=p||(f=n.parent())instanceof m&&f.expression===this))return;h=d.CTOR}d=Bn(h,d)}l.push(d)}return Bn(Ie,this,{expression:Bn(s,t,{elements:l}),property:Bn(Ee,this,{value:r})})}}}}),e(W,function(e,n){"arguments"!=e.property&&"caller"!=e.property||we.warn("Function.prototype.{property} not supported [{start}]",e);var t=n.parent();if(tt(n.self(),t))return e;var i=di(e,n);if(i)return i;if(n.option("sequences")&&"Call"!=t.TYPE&&!(t instanceof oe&&t.init===e)){var r=hi(e);if(r!==e)return r.optimize(n)}if(n.option("unsafe_proto")&&e.expression instanceof W&&"prototype"==e.expression.property){var o=e.expression.expression;if(gt(o))switch(o.name){case"Array":e.expression=Bn(s,e.expression,{elements:[]});break;case"Function":e.expression=Bn(ae,e.expression,{argnames:[],body:[]}).init_vars(o.scope);break;case"Number":e.expression=Bn(Ee,e.expression,{value:0});break;case"Object":e.expression=Bn(Te,e.expression,{properties:[]});break;case"RegExp":e.expression=Bn(Fe,e.expression,{value:/t/});break;case"String":e.expression=Bn(Ye,e.expression,{value:""})}}var a=e.flatten_object(e.property,n);return a?a.optimize(n):jt(n,e)}),e(U,function(e,n){return n.option("rests")&&e.rest instanceof U?Bn(U,e,{elements:e.elements.concat(e.rest.elements),rest:e.rest.rest}):e}),e(B,function(e,n){if(n.option("objects")){var t=e.key;t instanceof we&&(t=t.evaluate(n))!==e.key&&(e.key=""+t)}return e}),e(Te,function(e,n){if(!n.option("objects"))return e;var t=!1,i=!1,r=!1,o=n.has_directive("use strict"),s=[],a=new Fn,f=[];if(e.properties.forEach(function(e){if(!(e instanceof He))return l(e);i=!0;var o=e.expression;n.option("spreads")&&o instanceof Te&&On(o.properties,function(e){return!(e instanceof AST_ObjectGetter)&&(!(e instanceof He)&&("__proto__"!==e.key||(e instanceof AST_ObjectSetter||!e.value.has_side_effects(n))))})?(t=!0,o.properties.forEach(function(e){var t=e.key,i=e instanceof AST_ObjectSetter;if("__proto__"===t){if(!i)return;t=nt(t,e)}l(i?Bn(Se,e,{key:t,value:Bn(dn,e).optimize(n)}):e)})):(r=!0,u(),f.push(e))}),u(),!t)return e;if(i&&r&&1==f.length){var c=f[0];c instanceof Ae&&c.key instanceof Ee&&(c.key=""+c.key.value)}return Bn(Te,e,{properties:f});function u(){s.forEach(function(n){var i=a.get(n);switch(i.length){case 0:return;case 1:return f.push(i[0])}t=!0;var s=o&&!r&&i.pop();f.push(1==i.length?i[0]:Bn(Se,e,{key:i[0].key,value:Xn(e,i.map(function(e){return e.value}))})),s&&f.push(s),i.length=0}),s=[],a=new Fn}function l(e){var t=e.key;t instanceof we&&(i=!0,(t=t.evaluate(n))===e.key||"__proto__"===t?r=!0:t=e.key=""+t),Yi(e)?(e.value.has_side_effects(n)&&u(),s.push(t),a.add(t,e)):(u(),f.push(e)),i&&!r&&"string"==typeof t&&Q.test(t)&&(r=!0,a.has(t)&&(e=a.get(t)[0]),e.key=Bn(Ee,e,{value:+t}))}}),function(e){function n(e,n,t,i,r,o,s){for(var a=[],f=o.expressions,c=t,u=f.length-(s||0),l=u;--u>=0;c=!0,r=!1){var p=f[u].try_inline(e,n,c,i,r);p&&(d(),a.push(p))}if(0!=a.length)return d(),!t&&a[0]instanceof Pe&&(a[0]=Bn(Me,o,{value:a[0].body})),Bn(v,o,{body:a.reverse()});function d(){l>u+1&&a.push(Bn(Pe,o,{body:Xn(o,f.slice(u+1,l))})),l=u}}e(we,In),e(f,In),e(u,function(e,n,t,i){if(e.option("awaits")){var r=this,o=r.expression.try_inline(e,n,t,i,!0);if(o)return t||Kt(o,function(n){n.in_bool=!1;var t=n.value;t instanceof u||(n.value=Bn(u,r,{expression:t||Bn(dn,n).transform(e)}))}),Ut(o)?o:Bn(v,r,{body:[o,Bn(Pe,r,{body:Bn(u,r,{expression:Bn(Ee,r,{value:0})})})]})}}),e(p,function(e,n,t,i,r){if(void 0!==t){var o=this,s=o.operator;if(Dt[s]){var a=o.right.try_inline(e,n,t,i,r);if(a)return Bn(ce,o,{condition:function(n){switch(s){case"&&":return n;case"||":return n.negate(e);case"??":return Bn(p,o,{operator:"==",left:Bn(ke,o),right:n})}}(o.left),body:a,alternative:t?null:Bn(Me,o,{value:Bn(dn,o).transform(e)})})}}}),e(v,function(e,n,t,i){if(!t&&this.variables){var r=this.body,o=r.length-1;if(!(o<0)){var s=r[o].try_inline(e,this,t,i);if(s)return r[o]=s,this}}}),e(m,function(e,n,t,i,r){if(!(e.option("inline")<4)){var o=this;if(!o.is_expr_pure(e)){var a=o.expression;if(a instanceof ge&&!(a.name||a.uses_arguments||a.pinned()||Sn(a))){var f=Tn(a);if(!(f&&a.value||a.body[0]instanceof L||a.contains_this())){n||(n=Mn(e));var c=new Fn;for(c.set("NaN",!0);!(n instanceof Ce);)n.variables.each(function(e){c.set(e.name,!0)}),n=n.parent_scope;if(Yn(n,e.stack)&&!(n.pinned()&&a.variables.size()>(f?0:1))){if(n instanceof an){if(a.variables.size()>(f?0:1)){if(!e.toplevel.vars)return;if(a.functions.size()>0&&!e.toplevel.funcs)return}c.set("arguments",!0)}var l=!r&&is_async(a);if(l){if(!e.option("awaits"))return;if(!is_async(n))return;if(o.may_throw(e))return}var p=n.var_names();if(i&&(i=[]),a.variables.all(function(e,n){return i&&i.push(e),!c.has(n)&&!p.has(n)||!f&&"arguments"==n&&1==e.orig.length})&&!(i&&i.length>0&&ji(a,i))){var d=!0;if(On(a.argnames,function(e){var n=!1,t=new yn(function(e){return!!n||(e instanceof P?Ri(a,e.value)?n=!0:(e.name.walk(t),!0):e instanceof B?e.key instanceof we&&Ri(a,e.key)?n=!0:(e.value.walk(t),!0):e instanceof Je&&!On(e.definition().orig,function(e){return!(e instanceof $e)})?n=!0:void 0)});return e.walk(t),!n&&(e instanceof Je||(d=!1),!0)})){if(a.rest){if(Ri(a,a.rest))return;d=!1}var h;if(t?h=function(e){var n=!1;return e.walk(new yn(function(e){return!!n||(l&&(e instanceof u||e instanceof AST_ForAwaitOf)||e instanceof Me?n=!0:e instanceof Ce||void 0)})),!n}:(r||is_async(a)||qn(n))&&(h=function(e){var n=!1,t=new yn(function(e){return!!n||(e instanceof Me?n=!0:e instanceof Ce||void 0)});return e.walk(new yn(function(e){return!!n||(e instanceof cn?(e.bfinally&&On(e.body,function(e){return e.walk(t),!n})&&e.bcatch&&e.bcatch.walk(t),!0):e instanceof Ce||void 0)})),!n}),(!h||On(a.body,h))&&gi(a,_i(e,n))){a.functions.each(function(e,t){n.functions.set(t,e)});var _=[];a.variables.each(function(t,r){if((f||"arguments"!=r||1!=t.orig.length)&&(p.set(r,!0),n.enclosed.push(t),n.variables.set(r,t),t.single_use=!1,i&&t.references.length!=t.replaced&&t.orig.length!=t.eliminated&&(1!=t.orig.length||!a.functions.has(r))&&On(t.orig,function(e){return!(e instanceof Ve)&&(e instanceof Je?!e.unused&&t.scope.resolve()!==a:!(e instanceof Ze))}))){var o=t.orig[0];o instanceof Ge||_.push(Bn(Pe,o,{body:Bi(e,Ii(o))}))}});var g=Object.create(null),m=new Fn;if(d&&On(o.args,function(e){return!(e instanceof He)})){var b=o.args.slice();a.argnames.forEach(function(n){var t=b.shift();if(n.unused)t&&_.push(Bn(Pe,o,{body:t}));else{var i=Bn(vn,o,{name:n.convert_symbol(tn,x),value:t||Bn(dn,o).transform(e)});n instanceof Je&&Ui(n.definition(),i),_.push(Bn(hn,o,{definitions:[i]}))}}),b.length&&_.push(Bn(Pe,o,{body:Xn(o,b)}))}else _.push(Bn(hn,o,{definitions:[Bn(vn,o,{name:Bn(U,o,{elements:a.argnames.map(function(e){return e.unused?Bn(fe,e):e.convert_symbol(tn,x)}),rest:a.rest&&a.rest.convert_symbol(tn,x)}),value:Bn(s,o,{elements:o.args.slice()})})]}));m.each(function(e,n){var t=g[n];[].unshift.apply(t.orig,e),t.eliminated+=e.length}),[].push.apply(_,i?a.body.filter(function(e){if(!(e instanceof _e))return!0;var n=Bn(tn,Ii(e.name)),t=n.definition();return t.fixed=!1,t.orig.push(n),t.eliminated++,_.push(Bn(hn,e,{definitions:[Bn(vn,e,{name:n,value:Jt(e,!0)})]})),!1}):a.body);var y=Bn(v,o,{body:_});return t||(l&&Kt(y,function(e){var n=e.value;At(n)||(e.value=Bn(u,o,{expression:n}))}),_.push(Bn(Me,o,{value:qn(n)?Bn(dn,o).transform(e):null}))),y}}}}}}}}function x(e,n){var t=n.definition();g[t.id]=t,m.add(t.id,e)}}),e(z,function(e,n,t,i,r){var o=this.consequent.try_inline(e,n,t,i,r),s=this.alternative.try_inline(e,n,t,i,r);if(o||s)return Bn(ce,this,{condition:this.condition,body:o||a(this.consequent),alternative:s||a(this.alternative)});function a(e){return t?Bn(Pe,e,{body:e}):Bn(Me,e,{value:e})}}),e(re,function(e,n,t,i){var r=this.body.try_inline(e,n,!0,!0);r&&(this.body=r);var o=this.init;return o&&(o=o.try_inline(e,n,!0,i))?(this.init=null,o instanceof v?(o.body.push(this),o):Bn(v,o,{body:[o,this]})):r&&this}),e(oe,function(e,t,i,r){var o=this.body.try_inline(e,t,!0,!0);o&&(this.body=o);var s=this.object;if(s instanceof je){var a=n(e,t,!0,r,!1,s,1);if(a)return this.object=s.tail_node(),a.body.push(this),a}return o&&this}),e(ce,function(e,t,i,r){var o=this.body.try_inline(e,t,i,r);o&&(this.body=o);var s=this.alternative;s&&(s=s.try_inline(e,t,i,r))&&(this.alternative=s);var a=this.condition;if(a instanceof je){var f=n(e,t,!0,r,!1,a,1);if(f)return this.condition=a.tail_node(),f.body.push(this),f}return(o||s)&&this}),e(pe,function(e,n,t,i){var r=this.body.try_inline(e,n,!0,!0);if(r)return this.body=r,this}),e(he,function(e,n,t,i){var r=this.body.try_inline(e,n,t,i);if(r){if(this.body instanceof pe&&r instanceof v){var o=r.body.pop();return this.body=o,r.body.push(this),r}return this.body=r,this}}),e(xe,In),e(Me,function(e,n,t,i){var r=this.value;return r&&r.try_inline(e,n,void 0,"try"===i)}),e(je,function(e,t,i,r,o){return n(e,t,i,r,o,this)}),e(Pe,function(e,n,t,i){for(var r=this.body;r instanceof pn;){var o=r.operator;if(unary_side_effects[o])break;if("void"==o)break;r=r.expression}return t||At(r)||(r=Bn(pn,this,{operator:"void",expression:r})),r.try_inline(e,n,t||!1,i)}),e(pn,function(e,n,t,i,r){var o=this,s=o.operator;if(!unary_side_effects[s]){t||"void"!=s||(t=!1);var a=o.expression.try_inline(e,n,t,i,r);if(a)return t||Kt(a,function(n){n.in_bool=!1;var t=n.value;"void"==s&&At(t)||(n.value=Bn(pn,o,{operator:s,expression:t||Bn(dn,n).transform(e)}))}),a}}),e(gn,function(e,t,i,r){var o=this.body.try_inline(e,t,i,r);o&&(this.body=o);var s=this.expression;if(s instanceof je){var a=n(e,t,!0,r,!1,s,1);if(a)return this.expression=s.tail_node(),a.body.push(this),a}return o&&this}),e(mn,function(e,n,t,i){if(e.option("yields")&&this.nested){var r=this.expression;if("Call"==r.TYPE){var o=r.expression;switch(o.CTOR){case AST_AsyncGeneratorFunction:o=Bn(AST_AsyncFunction,o);break;case AST_GeneratorFunction:o=Bn(ae,o);break;default:return}return(r=r.clone()).expression=o,r.try_inline(e,n,t,i)}}})}(function(e,n){e.DEFMETHOD("try_inline",n)}),e(Me,function(e,n){var t=e.value;return t&&n.option("side_effects")&&At(t,n)&&!qn(n.find_parent(Ce))&&(e.value=null),e})}(function(e,n){e.DEFMETHOD("optimize",function(e){if(this._optimized)return this;if(e.has_directive("use asm"))return this;var t=n(this,e);return t._optimized=!0,t})}),{Compressor:rt}});
//# sourceMappingURL=sourcemaps/compress.js.map
