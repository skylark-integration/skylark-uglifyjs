/**
 * skylark-uglifyjs - A version of uglifyjs that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./utils","./ast","./output","./parse","./scope"],function(e,n,t,i,r){"use strict";const{AST_Accessor:o,AST_Array:s,AST_Arrow:a,AST_Assign:f,AST_AsyncArrow:c,AST_Await:u,AST_BigInt:l,AST_Binary:p,AST_Block:d,AST_BlockScope:h,AST_BlockStatement:v,AST_Boolean:_,AST_Break:g,AST_Call:m,AST_Case:b,AST_Catch:y,AST_Chain:x,AST_Class:w,AST_ClassExpression:k,AST_ClassInitBlock:T,AST_ClassProperty:E,AST_ClassStaticBlock:S,AST_ConciseMethod:A,AST_Conditional:D,AST_Const:z,AST_Constant:O,AST_Continue:q,AST_Debugger:F,AST_Default:M,AST_DefaultAssign:C,AST_DefaultValue:j,AST_DefClass:P,AST_Definitions:H,AST_Defun:N,AST_Destructuring:Y,AST_Destructured:I,AST_DestructuredArray:R,AST_DestructuredKeyVal:L,AST_DestructuredObject:U,AST_Directive:V,AST_Do:B,AST_Dot:G,AST_DWLoop:W,AST_EmptyStatement:$,AST_Exit:X,AST_Expansion:J,AST_Export:K,AST_ExportDeclaration:Q,AST_ExportDefault:Z,AST_ExportReferences:ee,AST_False:ne,AST_Finally:te,AST_For:ie,AST_ForEnumeration:re,AST_ForIn:oe,AST_Function:se,AST_Hole:ae,AST_If:fe,AST_Import:ce,AST_Infinity:ue,AST_IterationStatement:le,AST_Jump:pe,AST_LabeledStatement:de,AST_Lambda:he,AST_LambdaDefinition:ve,AST_LambdaExpression:_e,AST_Let:ge,AST_LoopControl:me,AST_NaN:be,AST_New:ye,AST_Node:xe,AST_Null:we,AST_Number:ke,AST_Object:Te,AST_ObjectKeyVal:Ee,AST_ObjectProperty:Se,AST_ObjectIdentity:Ae,AST_ObjectMethod:De,AST_PrefixedTemplateString:ze,AST_PropAccess:Oe,AST_RegExp:qe,AST_Return:Fe,AST_Scope:Me,AST_Sequence:Ce,AST_SimpleStatement:je,AST_Spread:Pe,AST_Statement:He,AST_String:Ne,AST_Sub:Ye,AST_Switch:Ie,AST_SwitchBranch:Re,AST_Symbol:Le,AST_SymbolCatch:Ue,AST_SymbolClassProperty:Ve,AST_SymbolConst:Be,AST_SymbolDeclaration:Ge,AST_SymbolDefun:We,AST_SymbolExport:$e,AST_SymbolFunarg:Xe,AST_SymbolImport:Je,AST_SymbolLambda:Ke,AST_SymbolLet:Qe,AST_SymbolMethod:Ze,AST_SymbolRef:en,AST_Template:nn,AST_TemplateString:tn,AST_This:rn,AST_Toplevel:on,AST_True:sn,AST_Try:an,AST_Unary:fn,AST_UnaryPostfix:cn,AST_UnaryPrefix:un,AST_Undefined:ln,AST_Var:pn,AST_VarDef:dn,AST_While:hn,AST_With:vn,AST_Yield:_n,TreeTransformer:gn,TreeWalker:mn,_INLINE:bn,_NOINLINE:yn,_PURE:xn,first_in_statement:wn,is_arrow:kn,is_generator:Tn,walk_body:En,walk_lambda:Sn}=n,{all:An,defaults:Dn,Dictionary:zn,has_annotation:On,HOP:qn,make_node:Fn,makePredicate:Mn,MAP:Cn,member:jn,noop:Pn,push_uniq:Hn,regexp_source_fix:Nn,regexp_is_safe:Yn,remove:In,return_false:Rn,return_null:Ln,return_true:Un,return_this:Vn}=e,{is_basic_identifier_string:Bn,JS_Parse_Error:Gn,parse:Wn,PRECEDENCE:$n,is_identifier_string:Xn}=i,{OutputStream:Jn}=t,{base54:Kn,is_lhs:Qn}=r;function Zn(e,n){if(!(this instanceof Zn))return new Zn(e,n);gn.call(this,this.before,this.after),this.options=Dn(e,{annotations:!n,arguments:!n,arrows:!n,assignments:!n,awaits:!n,booleans:!n,collapse_vars:!n,comparisons:!n,conditionals:!n,dead_code:!n,default_values:!n,directives:!n,drop_console:!1,drop_debugger:!n,evaluate:!n,expression:!1,functions:!n,global_defs:!1,hoist_exports:!n,hoist_funs:!1,hoist_props:!n,hoist_vars:!1,ie:!1,if_return:!n,imports:!n,inline:!n,join_vars:!n,keep_fargs:n,keep_fnames:!1,keep_infinity:!1,loops:!n,merge_vars:!n,module:!1,negate_iife:!n,objects:!n,optional_chains:!n,passes:1,properties:!n,pure_funcs:null,pure_getters:!n&&"strict",reduce_funcs:!n,reduce_vars:!n,rests:!n,sequences:!n,side_effects:!n,spreads:!n,strings:!n,switches:!n,templates:!n,top_retain:null,toplevel:!(!e||!e.module&&!e.top_retain),typeofs:!n,unsafe:!1,unsafe_comps:!1,unsafe_Function:!1,unsafe_math:!1,unsafe_proto:!1,unsafe_regexp:!1,unsafe_undefined:!1,unused:!n,varify:!n,webkit:!1,yields:!n},!0);var t=this.options.evaluate;this.eval_threshold=/eager/.test(t)?1/0:+t;var i=this.options.global_defs;if("object"==typeof i)for(var r in i)/^@/.test(r)&&qn(i,r)&&(i[r.slice(1)]=Wn(i[r],{expression:!0}));!0===this.options.inline&&(this.options.inline=4),this.drop_fargs=this.options.keep_fargs?Rn:function(e,n){if(e.length_read)return!1;var t=e.name;if(!t)return n&&"Call"==n.TYPE&&n.expression===e;if(t.fixed_value()!==e)return!1;var i=t.definition();if(i.direct_access)return!1;var r=i.escaped;return r&&1!=r.depth},this.options.module&&(this.directives["use strict"]=!0);var o=this.options.pure_funcs;"function"==typeof o?this.pure_funcs=o:"string"==typeof o?this.pure_funcs=function(e){var n;return e instanceof m?n=e.expression:e instanceof nn&&(n=e.tag),!(n&&o===n.print_to_string())}:Array.isArray(o)?this.pure_funcs=function(e){var n;return e instanceof m?n=e.expression:e instanceof nn&&(n=e.tag),!(n&&jn(n.print_to_string(),o))}:this.pure_funcs=Un;var s=this.options.sequences;this.sequences_limit=1==s?800:0|s;var a=this.options.top_retain;a instanceof RegExp?this.top_retain=function(e){return a.test(e.name)}:"function"==typeof a?this.top_retain=a:a&&("string"==typeof a&&(a=a.split(/,/)),this.top_retain=function(e){return jn(e.name,a)});var f=this.options.toplevel;this.toplevel="string"==typeof f?{funcs:/funcs/.test(f),vars:/vars/.test(f)}:{funcs:f,vars:f}}return Zn.prototype=new gn(function(e,n,t){if(e._squeezed)return e;var i=e instanceof Me;i&&(this.option("arrows")&&kn(e)&&e.value&&(e.body=[e.first_statement()],e.value=null),e.hoist_properties(this),e.hoist_declarations(this),e.process_returns(this)),n(e,this),n(e,this);var r=e.optimize(this);return!i||r!==e||this.has_directive("use asm")||r.pinned()||(r.drop_unused(this),r.merge_variables(this)&&r.drop_unused(this),n(r,this)),r===e&&(r._squeezed=!0),r}),Zn.prototype.option=function(e){return this.options[e]},Zn.prototype.exposed=function(e){if(e.exported)return!0;if(e.undeclared)return!0;if(!(e.global||e.scope.resolve()instanceof on))return!1;var n=this.toplevel;return!An(e.orig,function(e){return n[e instanceof We?"funcs":"vars"]})},Zn.prototype.compress=function(e){(e=e.resolve_defines(this)).hoist_exports(this),this.option("expression")&&e.process_expression(!0);for(var n=this.options.merge_vars,t=+this.options.passes||1,i=1/0,r=!1,o={ie:this.option("ie")},s=0;s<t;s++)if(e.figure_out_scope(o),(s>0||this.option("reduce_vars"))&&e.reset_opt_flags(this),this.options.merge_vars=n&&(r||s==t-1),e=e.transform(this),t>1){var a=0;if(e.walk(new mn(function(){a++})),xe.info("pass {pass}: last_count: {min_count}, count: {count}",{pass:s,min_count:i,count:a}),a<i)i=a,r=!1;else{if(r)break;r=!0}}return this.option("expression")&&e.process_expression(!1),e},function(e){function n(e,n){var t=n.get_property();if(!(t instanceof xe)){var i;if(e instanceof s){var r=e.elements;if("length"==t)return Kn(r.length,e);"number"==typeof t&&t in r&&(i=r[t])}else if(e instanceof he){if("length"==t)return e.length_read=!0,Kn(e.argnames.length,e)}else if(e instanceof Te){t=""+t;for(var o=e.properties,a=o.length;--a>=0;){if(!Ci(o[a]))return;i||o[a].key!==t||(i=o[a].value)}}return i instanceof en&&i.fixed_value()||i}}function t(e,i,r,o,a,c,u){var l=i.parent(a);if(!(e.option("unsafe")&&l instanceof G&&function(e,n){return e instanceof _?Ft.Boolean[n]:e instanceof ke?Ft.Number[n]:e instanceof Ne?Ft.String[n]:"valueOf"!=n&&(e instanceof s?Ft.Array[n]:e instanceof he?Ft.Function[n]:e instanceof Te?Ft.Object[n]:e instanceof qe?Ft.RegExp[n]&&!e.value.global:void 0)}(o,l.property))){var d=Qn(r,l);if(d)return d;if(0!=a||!o||!o.is_constant()){if(l instanceof s)return t(e,i,l,l,a+1);if(l instanceof f)switch(l.operator){case"=":return t(e,i,l,o,a+1,c,u);case"&&=":case"||=":case"??=":return t(e,i,l,l,a+1);default:return}if(l instanceof p){if(!kt[l.operator])return;return t(e,i,l,l,a+1)}if(l instanceof m)return!c&&l.expression===r&&!l.is_expr_pure(e)&&(!(o instanceof _e)||!(l instanceof ye)&&o.contains_this());if(l instanceof D){if(l.condition===r)return;return t(e,i,l,l,a+1)}if(l instanceof re)return l.init===r;if(l instanceof Ee){if(l.value!==r)return;var h=i.parent(a+1);return t(e,i,h,h,a+2)}if(l instanceof Oe){if(l.expression!==r)return;var v=n(o,l);return(!c||u)&&t(e,i,l,v,a+1)}if(l instanceof Ce){if(l.tail_node()!==r)return;return t(e,i,l,o,a+1,c,u)}}}}function i(e){return e instanceof w||e instanceof he}function r(e){return e instanceof w||e instanceof N||e instanceof se}function x(e){return"arguments"==e.name&&e.scope.uses_arguments}function S(e,n){do{if(e===n)return!1;if(n instanceof Me)return!0}while(n=n.parent_scope)}function A(e,n,t){var i=e.redef||e.definition();return(!e.in_arg||!is_funarg(i))&&An(i.orig,function(e){return e instanceof Be||e instanceof Qe?e instanceof Je||n&&si(n,e):!(t&&e instanceof Ke)})}function C(e,n,t,i){return i instanceof f?"="==i.operator&&i.right===t:i instanceof m?i.expression!==t||i instanceof ye:i instanceof AST_ClassField?i.value===t&&!i.static:i instanceof X?i.value===t&&n.resolve()!==e.scope.resolve():i instanceof dn?i.value===t:void 0}function Y(e,n){var t=Yn(en,e);return t.fixed=n||Yn(ln,e),t}function J(e,n){return function(t){var i=e(t),r=(t=Y(i,n),i.definition());return r.references.push(t),r.replaced++,t}}e(xe,function(e,n){return e}),on.DEFMETHOD("hoist_exports",function(e){if(e.option("hoist_exports")){for(var n=this.body,t=[],i=0;i<n.length;i++){var r=n[i];r instanceof Q?(n[i]=r=r.body,r instanceof H?r.definitions.forEach(function(e){e.name.match_symbol(o,!0)}):o(r.name)):r instanceof ee&&(n.splice(i--,1),[].push.apply(t,r.properties))}t.length&&n.push(Yn(ee,this,{properties:t}))}function o(e){if(e instanceof Ge){var n=Yn($e,e);n.alias=Yn(Ne,n,{value:n.name}),t.push(n)}}}),Me.DEFMETHOD("process_expression",function(e,n){var t=this,i=new gn(function(r){if(e){if(r instanceof V&&(r=Yn(je,r,{body:Yn(Ne,r)})),r instanceof je)return n?n(r):Yn(Fe,r,{value:r.body})}else if(r instanceof Fe){if(n)return n(r);var o=r.value;return o instanceof Ne?Yn(V,o):Yn(je,r,{body:o||Yn(un,r,{operator:"void",expression:Yn(ke,r,{value:0})})})}if(r instanceof d){if(r instanceof he){if(r!==t)return r}else if("awaits"===e&&r instanceof an&&r.bfinally)return r;for(var s=r.body.length;--s>=0;){var a=r.body[s];if(!gt(a,!0)){r.body[s]=a.transform(i);break}}}else r instanceof fe?(r.body=r.body.transform(i),r.alternative&&(r.alternative=r.alternative.transform(i))):r instanceof vn&&(r.body=r.body.transform(i));return r});t.transform(i)}),on.DEFMETHOD("unwrap_expression",function(){switch(this.body.length){case 0:return Yn(un,this,{operator:"void",expression:Yn(ke,this,{value:0})});case 1:var e=this.body[0];if(e instanceof V)return Yn(Ne,e);if(e instanceof je)return e.body;default:return Yn(m,this,{expression:Yn(se,this,{argnames:[],body:this.body}).init_vars(this),args:[]})}}),xe.DEFMETHOD("wrap_expression",function(){var e=this;return is_statement(e)||(e=Yn(je,e,{body:e})),e instanceof on||(e=Yn(on,e,{body:[e]})),e});var K=/^(0|[1-9][0-9]*)$/;function ze(e){e._squeezed=!1,e._optimized=!1,e instanceof h&&(e._var_names=void 0),e instanceof en&&(e.fixed=void 0)}function Ve(e,n){return this.transform(new gn(function(t,i){return t instanceof j?((t=t.clone()).name=t.name.transform(this),t):t instanceof I?(i(t=t.clone(),this),t):t instanceof L?((t=t.clone()).value=t.value.transform(this),t):t.convert_symbol(e,n)}))}function Ze(e,n){var t=Yn(e,this);return n(t,this)||t}function tn(e){var n=e.definition();n.assignments++,n.references.push(e)}function bn(e,n){var t=new mn(function(i){return i instanceof j?(i.value.walk(n),i.name.walk(t),!0):i instanceof L?(i.key instanceof xe&&i.key.walk(n),i.value.walk(t),!0):e(i)});this.walk(t)}function yn(e){return e(this)}function xn(e,n){var t=!1,i=new mn(function(r){return!!t||(r instanceof j?n?(r.name.walk(i),!0):t=!0:r instanceof L?!n&&r.key instanceof xe?t=!0:(r.value.walk(i),!0):e(r)?t=!0:void 0)});return this.walk(i),t}function Dn(e){return e instanceof AST_AsyncGeneratorDefun||e instanceof AST_AsyncGeneratorFunction}function On(e){var n=0,t=e.self();do{if(t.variables)return t}while(t=e.parent(n++))}function Fn(e,n,t,i,r,o){for(var s;s=e.parent(n++);t=s){if(s===i)return!1;if(o&&s instanceof he){if(s.name||is_async(s)||Tn(s))return!0}else if(s instanceof an){if(s.bfinally&&s.bfinally!==t)return!0;if(r&&s.bcatch&&s.bcatch!==t)return!0}}return!1}!function(e){function r(e,n,t){t.assignments=0,t.bool_return=0,t.drop_return=0,t.cross_loop=!1,t.direct_access=!1,t.escaped=[],t.fixed=!t.const_redefs&&!t.scope.pinned()&&!n.exposed(t)&&!(t.init instanceof _e&&t.init!==t.scope)&&t.init,t.reassigned=0,t.recursive_refs=0,t.references=[],t.single_use=void 0}function o(e,n,t){t.variables.each(function(e){r(0,n,e)})}function a(e,n,t){t.fn_defs=[],t.variables.each(function(i){r(0,n,i);var o=i.init;o instanceof ve&&(t.fn_defs.push(o),o.safe_ids=null),null===i.fixed?(i.safe_ids=e.safe_ids,b(e,i)):i.fixed&&(e.loop_ids[i.id]=e.in_loop,b(e,i))}),t.may_call_this=function(){t.may_call_this=t.contains_this()?Un:Rn},t.uses_arguments&&t.each_argname(function(e){e.definition().last_ref=!1}),n.option("ie")&&t.variables.each(function(e){var n=e.orig[0].definition();n!==e&&(n.fixed=!1)})}function c(e,n){var t=n.safe_ids;return void 0===t||t===e.safe_ids}function u(e,n){var t=e.fn_scanning;e.fn_scanning=n,n.walk(e),e.fn_scanning=t}function l(e,n){n.enclosed.forEach(function(t){if(n.variables.get(t.name)!==t&&!k(e,t)){t.single_use=!1;var i=t.fixed;"function"==typeof i&&(i=i()),i instanceof he&&void 0!==i.safe_ids||(t.fixed=!1)}})}function d(e,n,t){var i=t.safe_ids;if(void 0!==i&&!1!==i)if(t.parent_scope.resolve().may_call_this===Un)jn(t,e.fn_visited)&&l(e,t);else if(i){var r=jn(t,e.fn_visited);i===e.safe_ids?r||u(e,t):r?l(e,t):t.safe_ids=!1}else e.fn_scanning&&e.fn_scanning!==n.scope.resolve()?t.safe_ids=!1:(t.safe_ids=e.safe_ids,u(e,t))}function v(e,n){var t=n.fn_defs,i=n.may_call_this===Un?t:t.filter(function(n){return!1===n.safe_ids||(n.safe_ids=e.safe_ids,u(e,n),!1)});g(e),i.forEach(function(n){n.safe_ids=e.safe_ids,u(e,n)}),t.forEach(function(e){e.safe_ids=void 0}),n.fn_defs=void 0,n.may_call_this=void 0}function _(e,n){var t=Object.create(e.safe_ids);n||(t.seq={}),e.safe_ids=t}function g(e){e.safe_ids=Object.getPrototypeOf(e.safe_ids)}function b(e,n){e.safe_ids[n.id]={}}function y(e,n){e.references.push(n),!1!==e.last_ref&&(e.last_ref=n)}function k(e,n){if("m"==n.single_use)return!1;var t=e.safe_ids[n.id];if(t){var i=qn(e.safe_ids,n.id);if(!i){var r=e.safe_ids.seq;t.read?t.read!==r&&(t.read=!0):t.read=r}return null==n.fixed?!x(n)&&((!n.global||"arguments"!=n.name)&&(e.loop_ids[n.id]=null,n.fixed=Yn(ln,n.orig[0]),i&&(n.safe_ids=void 0),!0)):!t.assign||t.assign===e.safe_ids}return n.fixed instanceof ve}function E(e,n,t){if(!t){if(is_funarg(n)&&n.scope.uses_arguments&&!e.has_directive("use strict"))return!1;if(!An(n.orig,function(e){return!(e instanceof Be)}))return!1}if(void 0===n.fixed)return t||An(n.orig,function(e){return!(e instanceof Qe)});if(!1===n.fixed||0===n.fixed)return!1;var i=e.safe_ids[n.id];if(n.safe_ids)return n.safe_ids[n.id]=!1,n.safe_ids=void 0,null===n.fixed||qn(e.safe_ids,n.id)&&!i.read;if(!qn(e.safe_ids,n.id)){if(!i)return!1;if(i.read||e.in_loop){var r=e.find_parent(h);if(r instanceof w)return!1;if(n.scope.resolve()!==r.resolve())return!1}i.assign=!(!i.assign||i.assign===e.safe_ids)||e.safe_ids}if(null!=n.fixed&&i.read){if(i.read!==e.safe_ids.seq)return!1;if(e.loop_ids[n.id]!==e.in_loop)return!1}return k(e,n)&&An(n.orig,function(e){return!(e instanceof Ke)})}function z(e){if(!e)return!1;if(e instanceof f){var n=e.operator;return"="==n?z(e.right):!kt[n.slice(0,-1)]}return e instanceof Ce?z(e.tail_node()):e.is_constant()||i(e)||e instanceof Ae}function O(e,t,i,r,o,a,f){var c=e.parent(a);if(!o||!o.is_constant()){if(C(t,i,r,c))return t.escaped.push(c),!(f>1)||o&&o.is_constant_expression(i)||(f=1),(!t.escaped.depth||t.escaped.depth>f)&&(t.escaped.depth=f),t.scope.resolve()!==i.resolve()&&(t.escaped.cross_scope=!0),void(t.fixed&&(t.fixed.escaped=t.escaped));if(function(e,n){return n instanceof s||(n instanceof p?kt[n.operator]:n instanceof D?n.condition!==e:n instanceof Ce?n.tail_node()===e:n instanceof Pe||void 0)}(r,c))O(e,t,i,c,c,a+1,f);else if(c instanceof Ee&&c.value===r){var u=e.parent(a+1);O(e,t,i,u,u,a+2,f)}else if(c instanceof Oe&&c.expression===r&&(O(e,t,i,c,o=n(o,c),a+1,f+1),o))return;a>0||c instanceof m&&c.expression===r||c instanceof Ce&&c.tail_node()!==r||c instanceof je||c instanceof fn&&!unary_side_effects[c.operator]||(t.direct_access=!0,t.fixed&&(t.fixed.direct_access=!0))}}function q(e){if(e instanceof Ye){var n=e.expression;if(n instanceof en){var t=n.definition();if(x(t)){var i=e.property;i.is_constant()&&(i=i.value),(i instanceof xe||K.test(i))&&(t.reassigned++,(i instanceof xe?t.scope.argnames:[t.scope.argnames[i]]).forEach(function(e){e instanceof Xe&&(e.definition().fixed=!1)}))}}}}function F(e,n){var t,i;return function(){var r=e();return t!==r&&(t=r,i=n(r)),i}}function P(e,n,t,i,r){var o=new mn(function(t){if(t instanceof j)return ze(t),_(e,!0),t.value.walk(e),g(e),(f=i)&&(i=function(e,n,t){var i,r;return function(){if(r===n)return n;var o=t(),s=ei(e,o,!0);return s instanceof xe?r=n:i!==o&&(i=o,r=void 0===s?Bn(n,[o,n.value]):o),r}}(n,t,f)),t.name.walk(o),i=f,!0;if(t instanceof R){ze(t);var a,f=i;if(t.elements.forEach(function(e,n){if(e instanceof ae)return ze(e);f&&(i=F(f,function(t){return Yn(Ye,e,{expression:t,property:Yn(ke,e,{value:n})})})),e.walk(o)}),t.rest)f&&(i=n.option("rests")&&F(f,function(e){if(!(e instanceof s))return t;for(var n=0,i=t.elements.length;n<i;n++)if(e.elements[n]instanceof Pe)return t;return a||(a=Yn(s,t,{})),a.elements=e.elements.slice(i),a})),t.rest.walk(o);return i=f,!0}if(t instanceof U){ze(t);f=i;return t.properties.forEach(function(n){ze(n),n.key instanceof xe&&(_(e),n.key.walk(e),g(e)),f&&(i=F(f,function(e){var t=n.key,i=Ye;return"string"==typeof t&&(Xn(t)?i=G:t=Kn(t,n)),Yn(i,n,{expression:e,property:t})})),n.value.walk(o)}),t.rest&&(i=!1,t.rest.walk(o)),i=f,!0}return r(t,i,function(){for(var n=e.stack.length,i=0,r=o.stack.length-1;i<r;i++)e.stack.push(o.stack[i]);t.walk(e),e.stack.length=n}),!0});t.walk(o)}function N(e,n,t){var i=this;i.inlined=!1;var r=e.parent(),o=!is_async(i)&&!Tn(i),f=!o,c=!1;i.walk(new mn(function(e){return f?c=!0:e instanceof Fe?f=!0:e instanceof Me&&e!==i||void 0})),c&&_(e,o),a(e,t,i);var u=!i.uses_arguments||e.has_directive("use strict");i.argnames.forEach(function(n,o){var s=r.args[o];P(e,t,n,function(){var e=i.argnames.indexOf(n),t=e<0?s:r.args[e];return t instanceof Ce&&t.expressions.length<2&&(t=t.expressions[0]),t||Yn(ln,r)},h)});var l,p=i.rest;p&&P(e,t,p,t.option("rests")&&function(){return i.rest!==p?p:(l||(l=Yn(s,i,{})),l.elements=r.args.slice(i.argnames.length),l)},h),Sn(i,e);var d=e.safe_ids;return v(e,i),c||(e.safe_ids=d),!0;function h(n,t){var i=n.definition();t&&u&&void 0===i.fixed?(b(e,i),e.loop_ids[i.id]=e.in_loop,i.fixed=t,i.fixed.assigns=[n]):i.fixed=!1}}e(xe,Pn),e(f,function(e,n,i){var r=this,o=r.left,s=r.right,a=o instanceof en&&o.definition(),f=a||o instanceof I;switch(r.operator){case"=":return o.equals(s)&&!o.has_side_effects(i)?(s.walk(e),function n(t){ze(t);if(t instanceof G)n(t.expression);else if(t instanceof Ye)n(t.expression),t.property.walk(e);else if(t instanceof en){var i=t.definition();y(i,t),i.fixed&&(t.fixed=i.fixed,t.fixed.assigns?t.fixed.assigns.push(r):t.fixed.assigns=[r])}else t.walk(e)}(o),r.redundant=!0,!0):a&&s instanceof _e?(h(),s.parent_scope.resolve().fn_defs.push(s),s.safe_ids=null,a.fixed&&r.write_only||d(e,a,s),!0):f?(s.walk(e),h(),!0):void q(o);case"&&=":case"||=":case"??=":var c=!0;default:if(!f)return q(o),v();a.assignments++;var u=a.fixed;if(t(i,e,r,r,0))return a.fixed=!1,v();var l=k(e,a);return c&&_(e,!0),s.walk(e),c&&g(e),l&&!o.in_arg&&E(e,a)?(y(a,o),b(e,a),a.single_use&&(a.single_use=!1),o.fixed=a.fixed=function(){return Yn(p,r,{operator:r.operator.slice(0,-1),left:Y(o,u),right:r.right})},o.fixed.assigns=u&&u.assigns?u.assigns.slice():[a.orig[0]],o.fixed.assigns.push(r),o.fixed.to_binary=J(function(e){return e.left},u)):(o.walk(e),a.fixed=!1),!0}function h(){var n=a&&Ei(e,a),f=t(i,e,r,s,0,z(s),n);P(e,i,o,function(){return r.right},function(n,t,i){if(!(n instanceof en))return q(n),void i();var a=n.definition();a.assignments++,t&&!n.in_arg&&E(e,a)?(y(a,n),b(e,a),(o instanceof I||1==a.orig.length&&a.orig[0]instanceof We)&&(a.single_use=!1),e.loop_ids[a.id]=e.in_loop,a.fixed=f?0:t,n.fixed=t,n.fixed.assigns=[r],O(e,a,n.scope,r,s,0,1)):(i(),a.fixed=!1)})}function v(){if(c)return o.walk(e),_(e,!0),s.walk(e),g(e),!0}}),e(p,function(e){if(kt[this.operator])return this.left.walk(e),_(e,!0),this.right.walk(e),g(e),!0}),e(h,function(e,n,t){o(0,t,this)}),e(m,function(e,n){var t=this.expression;if(t instanceof _e){var i=lt(this);return this.args.forEach(function(n){n.walk(e),n instanceof Pe&&(i=!1)}),i&&(t.reduce_vars=N),t.walk(e),i&&delete t.reduce_vars,!0}if("Call"==this.TYPE)switch(e.in_boolean_context()){case"d":var r=!0;case!0:!function e(n,t){if(n instanceof f){if("="!=n.operator)return;e(n.left,t),e(n.right,t)}else if(n instanceof p){if(!kt[n.operator])return;e(n.left,t),e(n.right,t)}else if(n instanceof D)e(n.consequent,t),e(n.alternative,t);else if(n instanceof en){var i=n.definition();i.bool_return++,t&&i.drop_return++}}(t,r)}t.walk(e);var o=this.optional;o&&_(e,!0),this.args.forEach(function(n){n.walk(e)}),o&&g(e);var s=t instanceof en&&t.fixed_value();return s instanceof he?d(e,t.definition(),s):e.find_parent(Me).may_call_this(),!0}),e(w,function(e,n,t){var i=this;o(0,t,i),i.extends&&i.extends.walk(e);var r=i.properties.filter(function(n){return ze(n),n.key instanceof xe&&(e.push(n),n.key.walk(e),e.pop()),n.value});if(i.name){var s=i.name.definition(),a=e.parent();(a instanceof Q||a instanceof Z)&&(s.single_use=!1),E(e,s,!0)?(b(e,s),e.loop_ids[s.id]=e.in_loop,s.fixed=function(){return i},s.fixed.assigns=[i],ii(s)||(s.single_use=!1)):s.fixed=!1}return r.forEach(function(n){e.push(n),!n.static||vt(n)&&n.value.contains_this()?(_(e),n.value.walk(e),g(e)):n.value.walk(e),e.pop()}),!0}),e(T,function(e,n,t){return _(e,!0),a(e,t,this),n(),v(e,this),!0}),e(D,function(e){return this.condition.walk(e),_(e,!0),this.consequent.walk(e),g(e),_(e,!0),this.alternative.walk(e),g(e),!0}),e(j,function(e){return _(e,!0),this.value.walk(e),g(e),this.name.walk(e),!0}),e(B,function(e){var n=e.in_loop;return e.in_loop=this,_(e),this.body.walk(e),Qt(this,e.parent())&&(g(e),_(e)),this.condition.walk(e),g(e),e.in_loop=n,!0}),e(ie,function(e,n,t){o(0,t,this),this.init&&this.init.walk(e);var i=e.in_loop;return e.in_loop=this,_(e),this.condition&&this.condition.walk(e),this.body.walk(e),this.step&&(Qt(this,e.parent())&&(g(e),_(e)),this.step.walk(e)),g(e),e.in_loop=i,!0}),e(re,function(e,n,t){o(0,t,this),this.object.walk(e);var i=e.in_loop;e.in_loop=this,_(e);var r=this.init;return r instanceof H?r.definitions[0].name.mark_symbol(function(e){if(e instanceof Ge){var n=e.definition();n.assignments++,n.fixed=!1}},e):r instanceof I||r instanceof en?r.mark_symbol(function(e){if(e instanceof en){var n=e.definition();y(n,e),n.assignments++,e.is_immutable()||(n.fixed=!1)}},e):r.walk(e),this.body.walk(e),g(e),e.in_loop=i,!0}),e(fe,function(e){return this.condition.walk(e),_(e,!0),this.body.walk(e),g(e),this.alternative&&(_(e,!0),this.alternative.walk(e),g(e)),!0}),e(de,function(e){return _(e,!0),this.body.walk(e),g(e),!0}),e(he,function(e,n,t){var i=this;return!c(e,i)||(!Hn(e.fn_visited,i)||(i.inlined=!1,_(e),a(e,t,i),n(),v(e,i),i.name&&O(e,i.name.definition(),i,i.name,i,0,1),!0))}),e(ve,function(e,n,t){var i=this,r=i.name.definition(),o=e.parent();return(o instanceof Q||o instanceof Z)&&(r.single_use=!1),!c(e,i)||(!Hn(e.fn_visited,i)||(i.inlined=!1,_(e),a(e,t,i),n(),v(e,i),!0))}),e(Ye,function(e){if(this.optional)return this.expression.walk(e),_(e,!0),this.property.walk(e),g(e),!0}),e(Ie,function(e,n,t){o(0,t,this),this.expression.walk(e);var i=!0;return this.body.forEach(function(n){n instanceof M||(n.expression.walk(e),i&&(i=!1,_(e,!0)))}),i||g(e),En(this,e),!0}),e(Re,function(e){return _(e,!0),En(this,e),g(e),!0}),e(Ue,function(){this.definition().fixed=!1}),e(Je,function(){this.definition().fixed=!1}),e(en,function(e,n,r){var o=this,s=o.definition(),a=s.fixed||s.last_ref&&s.last_ref.fixed;y(s,o),1==s.references.length&&!s.fixed&&s.orig[0]instanceof We&&(e.loop_ids[s.id]=e.in_loop);var f,c=Ei(e,s);switch(c&&c.enclosed.forEach(function(n){if(s!==n&&n.scope.resolve()!==c){var t=n.fixed&&n.fixed.assigns;if(t&&!(t[t.length-1]instanceof dn)){var i=e.safe_ids[n.id];i&&(i.assign=!0)}}}),"m"==s.single_use&&s.fixed&&(s.fixed=0,s.single_use=!1),s.fixed){case 0:k(e,s)||(s.fixed=!1);case!1:var u=s.redefined();u&&S(s.scope,o.scope)&&(u.single_use=!1);break;case void 0:s.fixed=!1;break;default:if(!k(e,s)){s.fixed=!1;break}o.in_arg&&s.orig[0]instanceof Ke&&(o.fixed=s.scope);var l=o.fixed_value();c?s.recursive_refs++:l&&function(e,n){return e.option("unused")&&!n.scope.pinned()&&!1!==n.single_use&&n.references.length-n.recursive_refs==1&&!(is_funarg(n)&&n.scope.uses_arguments)}(r,s)?(s.in_loop=e.loop_ids[s.id]!==e.in_loop,s.single_use=i(l)&&!l.pinned()&&(!s.in_loop||e.parent()instanceof m)||!s.in_loop&&s.scope===o.scope.resolve()&&l.is_constant_expression()):s.single_use=!1,t(r,e,o,l,0,z(l),c)&&(s.single_use?s.single_use="m":s.fixed=0),s.fixed&&e.loop_ids[s.id]!==e.in_loop&&(s.cross_loop=!0),O(e,s,o.scope,o,l,0,1)}o.fixed||(o.fixed=0===s.fixed?a:s.fixed),l instanceof he&&!((f=e.parent())instanceof m&&f.expression===o)&&d(e,s,l)}),e(nn,function(e,n){var t=this.tag;if(t){if(t instanceof _e)return this.expressions.forEach(function(n){n.walk(e)}),t.walk(e),!0;t.walk(e),this.expressions.forEach(function(n){n.walk(e)});var i=t instanceof en&&t.fixed_value();return i instanceof he?d(e,t.definition(),i):e.find_parent(Me).may_call_this(),!0}}),e(on,function(e,n,t){return this.globals.each(function(e){r(0,t,e)}),_(e,!0),a(e,t,this),n(),v(e,this),!0}),e(an,function(e,n,t){return o(0,t,this),_(e,!0),En(this,e),g(e),this.bcatch&&(_(e,!0),this.bcatch.walk(e),g(e)),this.bfinally&&this.bfinally.walk(e),!0}),e(fn,function(e,n){var t=this;if(UNARY_POSTFIX[t.operator]){var i=t.expression;if(i instanceof en){var r=i.definition();r.assignments++;var o=r.fixed;return k(e,r)&&!i.in_arg&&E(e,r)?(y(r,i),b(e,r),r.single_use&&(r.single_use=!1),r.fixed=function(){return Yn(p,t,{operator:t.operator.slice(0,-1),left:Yn(un,t,{operator:"+",expression:Y(i,o)}),right:Yn(ke,t,{value:1})})},r.fixed.assigns=o&&o.assigns?o.assigns.slice():[],r.fixed.assigns.push(t),t instanceof un?i.fixed=r.fixed:(i.fixed=function(){return Yn(un,t,{operator:"+",expression:Y(i,o)})},i.fixed.assigns=o&&o.assigns,i.fixed.to_prefix=J(function(e){return e.expression},r.fixed))):(i.walk(e),r.fixed=!1),!0}q(i)}}),e(dn,function(e,n,t){var i=this,r=i.value;if(r instanceof _e&&i.name instanceof Ge){s(),r.parent_scope.resolve().fn_defs.push(r),r.safe_ids=null;var o=i.name.definition();o.fixed||d(e,o,r)}else r?(r.walk(e),s()):e.parent()instanceof ge&&s();return!0;function s(){P(e,t,i.name,function(){return i.value||Yn(ln,i)},function(n,t){var r=n.definition();t&&E(e,r,!0)?(b(e,r),e.loop_ids[r.id]=e.in_loop,r.fixed=t,r.fixed.assigns=[i],(n instanceof Be&&r.redefined()||!A(n)&&!ii(r))&&(r.single_use=!1)):r.fixed=!1})}}),e(hn,function(e,n){var t=e.in_loop;return e.in_loop=this,_(e),n(),g(e),e.in_loop=t,!0})}(function(e,n){e.DEFMETHOD("reduce_vars",n)}),on.DEFMETHOD("reset_opt_flags",function(e){var n=new mn(e.option("reduce_vars")?function(t,i){return ze(t),t.reduce_vars(n,i,e)}:ze);n.fn_scanning=null,n.fn_visited=[],n.in_loop=null,n.loop_ids=Object.create(null),n.safe_ids=Object.create(null),n.safe_ids.seq={},this.walk(n)}),Le.DEFMETHOD("fixed_value",function(e){var n=this.definition(),t=n.fixed;if(t)return this.fixed&&(t=this.fixed),(t instanceof xe?t:t()).tail_node();if(!(t=0===t&&this.fixed))return t;var i=(t instanceof xe?t:t()).tail_node();return e&&1!=n.escaped.depth&&bi(i,!0)?i:i.is_constant()?i:void 0}),en.DEFMETHOD("is_immutable",function(){var e=this.redef||this.definition();return e.orig[0]instanceof Ke&&(1==e.orig.length||!!this.in_arg&&!(e.orig[1]instanceof Xe))}),xe.DEFMETHOD("convert_symbol",Pn),j.DEFMETHOD("convert_symbol",Ve),I.DEFMETHOD("convert_symbol",Ve),Ge.DEFMETHOD("convert_symbol",Ze),en.DEFMETHOD("convert_symbol",Ze),j.DEFMETHOD("mark_symbol",bn),I.DEFMETHOD("mark_symbol",bn),Ge.DEFMETHOD("mark_symbol",yn),en.DEFMETHOD("mark_symbol",yn),xe.DEFMETHOD("match_symbol",function(e){return e(this)}),j.DEFMETHOD("match_symbol",xn),I.DEFMETHOD("match_symbol",xn);var Cn=Mn("Infinity NaN undefined");function Nn(e,n){if(e instanceof AST_Atom)return!0;if(e instanceof Ae)return!0;if(e instanceof Oe){if("__proto__"===e.property)return!0;if((e=e.expression)instanceof en){if(e.is_immutable())return!1;e=e.fixed_value()}return!e||(!!e.tail_node().is_constant()||Nn(e,n))}if(e instanceof en){if(e.is_immutable())return!0;var t=e.definition();return n.exposed(t)&&Cn[t.name]}return!1}function Yn(e,n,t){return t?(t.start=n.start,t.end=n.end):t=n,new e(t)}function Bn(e,n){return 1==n.length?n[0]:Yn(Ce,e,{expressions:n.reduce(it,[])})}function Kn(e,n){switch(typeof e){case"string":return Yn(Ne,n,{value:e});case"number":return isNaN(e)?Yn(be,n):isFinite(e)?1/e<0?Yn(un,n,{operator:"-",expression:Yn(ke,n,{value:-e})}):Yn(ke,n,{value:e}):e<0?Yn(un,n,{operator:"-",expression:Yn(ue,n)}):Yn(ue,n);case"boolean":return Yn(e?sn:ne,n);case"undefined":return Yn(ln,n);default:if(null===e)return Yn(we,n);if(e instanceof RegExp)return Yn(qe,n,{value:e});throw new Error(string_template("Can't handle constant of type: {type}",{type:typeof e}))}}function et(e){return e instanceof Oe||pt(e)&&"eval"==e.name}function nt(e,n,t){var i=!1;return"Call"==e.TYPE?i=e.expression===n&&et(t):e instanceof nn?i=e.tag===n&&et(t):e instanceof un&&(i="delete"==e.operator||"typeof"==e.operator&&pt(t)),i?Bn(n,[Yn(ke,n,{value:0}),t]):t}function tt(e,n){var t=new zn;return e.walk(new mn(function(e){if(e instanceof en){var n=e.definition(),i=e.fixed;i&&t.has(n.id)?t.get(n.id)!==i&&t.set(n.id,!1):t.set(n.id,i)}})),t.size()>0&&n.walk(new mn(function(e){if(e instanceof en){var n=e.definition(),i=e.fixed;i&&t.has(n.id)&&t.get(n.id)!==i&&(e.fixed=!1)}})),n}function it(e,n){return n instanceof Ce?[].push.apply(e,n.expressions):e.push(n),e}function rt(e){return e instanceof z||e instanceof P||e instanceof ge}function ot(e){if(e instanceof ve){var n=e.name.definition(),t=e.name.scope;return n.scope===t||An(n.references,function(e){var n=e.scope;do{if(n===t)return!0}while(n=n.parent_scope)})}return!rt(e)}function st(e){if(null===e)return[];if(e instanceof v)return An(e.body,ot)?e.body:[e];if(e instanceof $)return[];if(is_statement(e))return[e];throw new Error("Can't convert thing to statement array")}function at(e){return null===e||(e instanceof $||e instanceof v&&0==e.body.length)}function ft(e){return An(e.body,function(e){return at(e)||e instanceof N||e instanceof pn&&_t(e)})}function ct(e){return e instanceof le&&e.body instanceof v?e.body:e}function ut(e){if("Call"!=e.TYPE)return!1;do{e=e.expression}while(e instanceof Oe);return e instanceof _e?!kn(e):ut(e)}function lt(e){var n=e.expression;if(n.name)return!1;if(!(e instanceof ye))return!0;var t=!1;return n.walk(new mn(function(e){return!!t||(e instanceof AST_NewTarget?t=!0:e instanceof Me&&e!==n||void 0)})),!t}function pt(e){return e instanceof en&&e.definition().undeclared}var dt,ht=Mn("Array Boolean clearInterval clearTimeout console Date decodeURI decodeURIComponent encodeURI encodeURIComponent Error escape eval EvalError Function isFinite isNaN JSON Map Math Number parseFloat parseInt RangeError ReferenceError RegExp Object Set setInterval setTimeout String SyntaxError TypeError unescape URIError WeakMap WeakSet");function vt(e){return e.static&&e.value&&(e instanceof AST_ClassField||e instanceof AST_ClassInit)}function _t(e){return An(e.definitions,function(e){return!e.value})}function gt(e,n){return e instanceof P?n&&!e.extends&&An(e.properties,function(e){return!(e.key instanceof xe)&&!vt(e)}):e instanceof H?(n||e instanceof pn)&&_t(e):e instanceof Q?gt(e.body,n):e instanceof Z?gt(e.body,n):e instanceof ve}function mt(e,n){var t=e.lastIndexOf(n);if(t<0)return!1;for(;++t<e.length;)if(!gt(e[t],!0))return!1;return!0}function bt(e,n){var t;if(e.init instanceof v&&(t=e.init,e.init=t.body.pop(),t.body.push(e)),e.init instanceof N?(t||(t=Yn(v,e,{body:[e]})),t.body.splice(-1,0,e.init),e.init=null):e.init instanceof je?e.init=e.init.body:at(e.init)&&(e.init=null),t)return n?List.splice(t.body):t}function yt(e,n){var i,a,c,l,_,k,T=Y(n,function(e){return e instanceof he});!function(){var e=n.self(),t=0;do{if(!i&&e.variables&&(i=e),e instanceof y)n.parent(t).bfinally&&(_||(_={}),_.bfinally=!0),t++;else if(e instanceof te)t++;else if(e instanceof le)l=!0;else{if(e instanceof Me){k=e;break}e instanceof an&&(_||(_={}),e.bcatch&&(_.bcatch=!0),e.bfinally&&(_.bfinally=!0))}}while(e=n.parent(t++))}();var E,S,O=10;do{if(S=E,E=0,K(e)&&(E=1),!E&&1==S)break;if(n.option("dead_code")&&(ee(e,n)&&(E=2),!E&&2==S))break;if(n.option("if_return")&&(Z(e,n)&&(E=3),!E&&3==S))break;if(n.option("awaits")&&n.option("side_effects")&&(ne(e,n)&&(E=4),!E&&4==S))break;if(n.option("inline")>=4&&(ae(e,n)&&(E=5),!E&&5==S))break;if(n.sequences_limit>0){if(ce(e,n)&&(E=6),!E&&6==S)break;if(be(e,n)&&(E=7),!E&&7==S)break}if(n.option("join_vars")&&(Ne(e)&&(E=8),!E&&8==S))break;n.option("collapse_vars")&&J(e,n)&&(E=9)}while(E&&O-- >0);return e;function Y(e,n){var t,i=e.self(),r=0;do{if(i instanceof y)i=e.parent(r++);else if(i instanceof de)i=i.body;else if(i instanceof Re){var o=e.parent(r);(o.body[o.body.length-1]===i||s(i.body))&&(r++,i=o)}do{if(n(t=i))return t;i=e.parent(r++)}while(i instanceof fe)}while(t&&(i instanceof v||i instanceof y||i instanceof Me||i instanceof Re||i instanceof an)&&mt(i.body,t));function s(e){for(var n=e.length;--n>=0;)if(e[n]instanceof g)return!0;return!1}}function J(e,n){if(!k.pinned()){for(var g,y,T=new zn,E=[],S=!1,z=new zn,O=e.length,q=new gn(function(e,t){if(Be)return e;if(!Ve)return e!==Y[$]?e:++$<Y.length?rn(e,q):(Ve=!0,(ne=(ee?function e(n,t){var i=q.parent(t);if(i instanceof s)return e(i,t+1);if(i instanceof f){return ve(i)?n:i.left.match_symbol(function(e){return e instanceof en&&(oe.name==e.name||ee.name==e.name)})?n:i.left!==n&&kt[r=i.operator.slice(0,-1)]?En(i,r,t):e(i,t+1)}if(i instanceof u)return e(i,t+1);if(i instanceof p){var r;return i.left!==n&&kt[r=i.operator]?En(i,r,t):e(i,t+1)}if(i instanceof m)return i;if(i instanceof b)return i.expression!==n?n:e(i,t+1);if(i instanceof D)return i.condition!==n?n:e(i,t+1);if(i instanceof H)return Dn(i,t+1);if(i instanceof B)return n;if(i instanceof X)return Dn(i,t+1);if(i instanceof ie)return i.init!==n&&i.condition!==n?n:e(i,t+1);if(i instanceof re)return i.init!==n?n:e(i,t+1);if(i instanceof fe)return i.condition!==n?n:e(i,t+1);if(i instanceof Se){var o=q.parent(t+1);return An(o.properties,function(e){return e instanceof Ee})?e(o,t+2):o}if(i instanceof Oe){var a=i.expression;return a===n?e(i,t+1):n}if(i instanceof Ce)return(i.tail_node()===n?e:Dn)(i,t+1);if(i instanceof je)return Dn(i,t+1);if(i instanceof Pe)return e(i,t+1);if(i instanceof Ie)return i.expression!==n?n:e(i,t+1);if(i instanceof fn)return"delete"==i.operator?n:e(i,t+1);if(i instanceof dn)return i.name.match_symbol(function(e){return e instanceof Ge&&(oe.name==e.name||ee.name==e.name)})?n:e(i,t+1);if(i instanceof hn)return i.condition!==n?n:e(i,t+1);if(i instanceof _n)return e(i,t+1);return null}:function e(n,t){var i=q.parent(t);if(i instanceof s)return n;if(i instanceof f)return n;if(i instanceof u)return n;if(i instanceof p)return n;if(i instanceof m)return n;if(i instanceof b)return n;if(i instanceof D)return n;if(i instanceof H)return Dn(i,t+1);if(i instanceof X)return n;if(i instanceof fe)return n;if(i instanceof le)return n;if(i instanceof Se)return n;if(i instanceof Oe)return n;if(i instanceof Ce)return(i.tail_node()===n?e:Dn)(i,t+1);if(i instanceof je)return Dn(i,t+1);if(i instanceof Pe)return n;if(i instanceof Ie)return n;if(i instanceof fn)return n;if(i instanceof dn)return n;if(i instanceof _n)return n;return null})(e,0))===e&&(Be=!0),e);var i,r,a=q.parent();if(!te&&pn(e,a)&&(te=a),pe&&ce&&Je&&!te&&e instanceof f&&"="!=e.operator&&e.left.equals(oe))return $e++,S=!0,xe.info("Cascading {this} [{start}]",e),Je=!1,ze=Vn(oe),e.right.transform(q),Ln(J),Be?i=J:(Be=!0,i=Yn(p,J,{operator:pe,left:oe.fixed&&oe.definition().fixed?oe.fixed.to_binary(J):oe,right:Ne})),Yn(f,e,{operator:"=",left:e.left,right:Yn(p,e,{operator:e.operator.slice(0,-1),left:i,right:e.right})});if(function(e,t){if(e===Ne)return!0;if(t instanceof ie&&e!==t.init)return!0;if(e instanceof f)return"="!=e.operator&&oe.equals(e.left);if(e instanceof m)return oe instanceof Oe&&(!!oe.equals(e.expression)&&!(Ne instanceof _e&&!Ne.contains_this()));return e instanceof w?!n.has_directive("use strict"):e instanceof F||(e instanceof N?de&&oe.name===e.name.name:e instanceof L?e.key instanceof xe:e instanceof W||e instanceof me||e instanceof an||e instanceof vn)}(e,a))return Be=!0,e;if(e.single_use)return e;if(!(e instanceof Ge)&&(ce&&oe.equals(e)||ue&&(r=ue(e,this)))){if(!Je||te&&(r||!qe||!Ue))return r||ee||(Be=!0),e;if(Qn(e,a))return ee&&!r&&(Q=!0),e;if(!r&&Z&&e.fixed!==oe.fixed)return Be=!0,e;if(ee)return te&&0==K&&(K=V-$e),r||$e++,e;if($e++,S=Be=!0,xe.info("Collapsing {this} [{start}]",e),"Binary"==J.TYPE)return Un(J,e),Yn(f,J,{operator:"=",left:J.right.left,right:"&&"==J.operator?Yn(D,J,{condition:J.left,consequent:J.right.right,alternative:e}):Yn(D,J,{condition:J.left,consequent:e,alternative:J.right.right})});if(J instanceof cn)return Yn(un,J,{operator:J.operator,expression:oe.fixed&&oe.definition().fixed?oe.fixed.to_prefix(J):oe});if(J instanceof un)return Ln(J),J;if(Un(Ne,e),J instanceof dn){var c=J.name.definition();return c.references.length-c.replaced!=1||n.exposed(c)?Yn(f,J,{operator:"=",left:e,right:Ne}):(c.replaced++,nt(a,e,Ne))}Ln(Ne);var l=J.clone();return l.right=Ne,l}if(function(e,t){if(!(e instanceof en))return!1;if(e.is_declared(n)){if(e.fixed_value())return!1;if(A(e))return!(t instanceof Oe&&t.expression===e)&&x(e.definition())}else if(sn(e,t))return!1;return!Ue||(ue=!1,!1)}(e,a))return Be=!0,e;if((bn(e,a)||ve(e))&&(ne=e,e instanceof Me&&(Be=!0)),e instanceof o){var d=Je;return Je=!1,t(e,q),Je=d,tn(e)}if(e instanceof I){d=Je;return Je=!1,t(e,q),Je=d,tn(e)}if(e instanceof j){e.name=e.name.transform(q);d=Je;return Je=!1,e.value=e.value.transform(q),Je=d,tn(e)}if(!(!(e instanceof h)||e instanceof Me||e.variables&&e.variables.all(function(e){return!we.has(e.name)&&!ze.has(e.name)}))){d=Je;return Je=!1,rn(e,q)||t(e,q),Je=d,tn(e)}return rn(e,q)?tn(e):void 0},tn),P=new gn(function(e){if(Be)return e;if(!Ve){if(e!==Y[$])return e;switch($++,Y.length-$){case 0:if(Ve=!0,Q)return e;if(e!==J)return e;if(e instanceof dn)return e;Ze.replaced++;var n=P.parent();return n instanceof Ce&&n.tail_node()!==e?(ee.replaced++,Ne===He?List.skip:Bn(He,He.expressions.slice(0,-1))):Ne;case 1:if(!Q&&e.body===J)return Ve=!0,Ze.replaced++,ee.replaced++,null;default:return rn(e,P)}}if(e instanceof en&&e.definition()===Ze){if(Qn(e,P.parent()))return e;--$e||(Be=!0),xe.info("Replacing {this} [{start}]",e);var t=Ne.clone();return t.scope=e.scope,t.reference(),$e==K?(Be=!0,Yn(f,J,{operator:"=",left:e,right:t})):(Ze.replaced++,t)}return e instanceof M||e instanceof Me?e:void 0},function(e){return Wn(e,P)});--O>=0;){0==O&&n.option("unused")&&xn();var Y=[];for(wn(e[O]);E.length>0;){var V,$=0,J=(Y=E.pop())[Y.length-1],K=-1,Q=!1,Z=!1,ee=null,ne=null,te=null,oe=Cn(J),ae=oe&&oe.has_side_effects(n),ce=oe&&(!ae||oe instanceof en)&&!Nn(oe,n),ue=Hn(J);if(ce||ue){var pe=J instanceof f&&J.operator.slice(0,-1),de=J.name instanceof Xe,ve=Rn;if(J.may_throw(n)){if(de&&is_async(k))continue;ve=_?function(e){return e.has_side_effects(n)}:et}var be=!1,ye=!1,we=new zn,De=!0,ze=Vn(J),qe=$n(oe),He=Pn(J),Ne=He;ae||(!pe&&Ne instanceof Ce&&(Ne=Ne.tail_node()),ae=Xn());var Re=_||!qe?function(e){return e instanceof I}:Rn,Ue=Jn(J),Ve=de,Be=!1,$e=0,Je=!g||!Ve;if(!Je){for(var Ke=J.arg_index+1;!Be&&Ke<g.length;Ke++)g[Ke]&&g[Ke].transform(q);Je=!0}for(var Qe=O;!Be&&Qe<e.length;Qe++)e[Qe].transform(q);if(ee){if(!$e||V>$e+Q){E.push(Y),y=!0;continue}$e==K&&(Q=!0);var Ze=oe.definition();Be=!1,$=0,Ve=de;for(Qe=O;!Be&&Qe<e.length;Qe++)e[Qe].transform(P)||e.splice(Qe--,1);$e=J instanceof dn&&J===Y[Y.length-1]&&Ze.references.length==Ze.replaced&&!n.exposed(Ze),ee.last_ref=!1,ee.single_use=!1,S=!0}$e&&Gn(J)}}}return S}function tn(e){return Be?e:(ne===e&&(Be=!0),te===e&&(te=null),e)}function rn(e,n){if(e instanceof h){if(e instanceof Me)return e;if(e instanceof w){e.name&&(e.name=e.name.transform(n)),!Be&&e.extends&&(e.extends=e.extends.transform(n));for(var t=[],i=[],r=0;!Be&&r<e.properties.length;r++){(o=e.properties[r]).key instanceof xe&&(o.key=o.key.transform(n)),o.static&&(o instanceof AST_ClassField?o.value&&t.push(o):o instanceof AST_ClassInit&&[].push.apply(i,o.value.body))}for(r=0;!Be&&r<i.length;r++)i[r].transform(n);for(r=0;!Be&&r<t.length;r++){var o;(o=t[r]).value=o.value.transform(n)}return e}if(e instanceof re)return e.object=e.object.transform(n),Be=!0,e;if(e instanceof Ie){e.expression=e.expression.transform(n);for(r=0;!Be&&r<e.body.length;r++){var s=e.body[r];if(s instanceof b){if(!Ve){if(s!==Y[$])continue;$++}if(s.expression=s.expression.transform(n),!Ue)break;ue=!1}}return Be=!0,e}}}function sn(e,n){return n instanceof f?"="==n.operator&&n.left===e:n instanceof j?n.name===e:n instanceof R||(n instanceof L?n.value===e:void 0)}function pn(e,n){return n instanceof f?n.left!==e&&kt[n.operator.slice(0,-1)]:n instanceof p?n.left!==e&&kt[n.operator]:n instanceof m?n.optional&&n.expression!==e:n instanceof b?n.expression!==e:n instanceof D?n.condition!==e:n instanceof fe?n.condition!==e:n instanceof Ye?n.optional&&n.expression!==e:void 0}function bn(e,t){if(e instanceof u)return!0;if("Binary"==e.TYPE)return!yi(e.operator,e.right,n);if(e instanceof m){var i=e.expression;if(i instanceof en&&(h=i.definition(),i=i.fixed_value()),!(i instanceof he))return!e.is_expr_pure(n);if(h&&Ei(n,h,i))return!0;if(i.collapse_scanning)return!1;i.collapse_scanning=!0;var o=Je;Je=!1;for(var a=ne,f=te,c=0;!Be&&c<i.argnames.length;c++)yn(g,i.argnames[c],e.args[c])&&(Be=!0);if(!Be)if(i.rest&&yn(g,i.rest,Yn(s,e,{elements:e.args.slice(c)})))Be=!0;else if(kn(i)&&i.value)i.value.transform(q);else for(c=0;!Be&&c<i.body.length;c++){var l=i.body[c];if(l instanceof Fe){l.value&&l.value.transform(q);break}l.transform(q)}return te=f,ne=a,Je=o,i.collapse_scanning=!1,Be?(Be=!1,!0):!1}if(e instanceof w){if(!_)return!1;var p=e.extends;return!!p&&(p instanceof en&&(p=p.fixed_value()),!r(p))}if(e instanceof X){if(_){if(_.bfinally)return!0;if(_.bcatch&&e instanceof AST_Throw)return!0}return ae||oe instanceof Oe||Zn(oe)}if(e instanceof se)return n.option("ie")&&e.name&&ze.has(e.name.name);if(e instanceof Ae)return Kn(e,t);if(e instanceof Oe){if(ae)return!0;var d=e.expression;if(d instanceof en&&x(d.definition()))return!0;if(n.option("unsafe")){if(pt(d)&&ht[d.name])return!1;if(Ct(d))return!1}return!De||!ee&&(!(!_&&qe)&&(!e.optional&&d.may_throw_on_access(n)))}if(e instanceof Pe)return!0;if(e instanceof en){if(Kn(e,t))return!sn(e,t);if(ae&&Zn(e))return!0;var h=e.definition();return(_||h.scope.resolve()!==k)&&!A(e)}if(e instanceof nn)return!e.is_expr_pure(n);if(e instanceof dn)return!!Re(e.name)||(e.value||t instanceof ge)&&e.name.match_symbol(function(e){return e instanceof Ge&&(ze.has(e.name)||ae&&Zn(e))},!0);if(e instanceof _n)return!0;var v=Qn(e.left,e);return!!v&&(v instanceof Oe||(!!Re(v)||v.match_symbol(function(e){return e instanceof en&&(ze.has(e.name)||be&&n.exposed(e.definition()))},!0)));function g(e){return e.transform(q),Be}}function yn(e,t,i){if(t instanceof j)return e(t.value)||yn(e,t.name,t.value)||!wt(i)&&yn(e,t.name,i);if(!i)return!(t instanceof Le);if(t instanceof I){if(t.rest&&yn(e,t.rest))return!0;if(t instanceof R)return i instanceof s?!An(t.elements,function(n,t){return!yn(e,n,i[t])}):!i.is_string(n)||!An(t.elements,function(n){return!yn(e,n)});if(t instanceof U)return!!i.may_throw_on_access(n)||!An(t.properties,function(n){return!(n.key instanceof xe&&e(n.key))&&!yn(e,n.value)})}}function xn(){if(!1!==c){var e=n.parent(),t=n.self();if(void 0===c){if(!(t instanceof _e)||Tn(t)||t.uses_arguments||t.pinned()||!(e instanceof m)||e.expression!==t||!An(e.args,function(e){return!(e instanceof Pe)}))return void(c=!1);if(!lt(e))return;c=!0}var i,r=t.in_strict_mode(n)&&!t.parent_scope.resolve(!0).in_strict_mode(n);is_async(t)?(i=function(e){return e instanceof Le&&"await"==e.name},a=!0):(i=function(e){return e instanceof u&&!s.find_parent(Me)},void 0===a&&(a=Fn(n,1,e,null,!0,!0)));for(var o=null,s=new mn(function(e,n){if(!h)return!0;if(i(e)||e instanceof _n)return h=null,!0;if(e instanceof Ae)return!r&&o||(h=null),!0;var s;if(e instanceof en)return(e.in_arg&&!ii(e.definition())||(s=t.variables.get(e.name))&&s!==e.definition())&&(h=null),!0;if(e instanceof Me&&!kn(e)){var a=o;return o=e,n(),o=a,!0}}),f=(g=e.args.slice()).length,l=new zn,p=t.argnames.length;--p>=0;){var d=t.argnames[p],h=g[p],v=null;if(d instanceof j&&(v=d.value,d=d.name,g[f+p]=v),d instanceof I){if(a&&yn(function(e){return e.has_side_effects(n)},d,h)){E.length=0;break}g[f+p]=t.argnames[p]}else if(!l.has(d.name)&&(l.set(d.name,!0),v&&(h=wt(h)?v:null),h||v?h instanceof he&&h.pinned()?h=null:h&&h.walk(s):h=Yn(ln,d).transform(n),h)){var _=Yn(dn,d,{name:d,value:h});_.name_index=p,_.arg_index=v?f+p:p,E.unshift([_])}}t.rest&&g.push(t.rest)}}function wn(e,n){if(Y.push(e),e instanceof s)e.elements.forEach(function(e){wn(e,n)});else if(e instanceof f){var t=e.left;t instanceof I||E.push(Y.slice()),wn(t),wn(e.right),t instanceof en&&"="==e.operator&&T.set(t.name,(T.get(t.name)||0)+1)}else if(e instanceof u)wn(e.expression,n);else if(e instanceof p){var i=kt[e.operator];n&&i&&"??"!=e.operator&&e.right instanceof f&&"="==e.right.operator&&!(e.right.left instanceof I)&&E.push(Y.slice()),wn(e.left,!i&&n),wn(e.right,n)}else if(e instanceof m)wn(e.expression),e.args.forEach(wn);else if(e instanceof b)wn(e.expression);else if(e instanceof D)wn(e.condition),wn(e.consequent,n),wn(e.alternative,n);else if(e instanceof H)e.definitions.forEach(wn);else if(e instanceof G)wn(e.expression);else if(e instanceof W)wn(e.condition),e.body instanceof d||wn(e.body);else if(e instanceof X)e.value&&wn(e.value);else if(e instanceof ie)e.init&&wn(e.init,!0),e.condition&&wn(e.condition),e.step&&wn(e.step,!0),e.body instanceof d||wn(e.body);else if(e instanceof re)wn(e.object),e.body instanceof d||wn(e.body);else if(e instanceof fe)wn(e.condition),e.body instanceof d||wn(e.body),!e.alternative||e.alternative instanceof d||wn(e.alternative);else if(e instanceof Te)e.properties.forEach(function(e){Y.push(e),e.key instanceof xe&&wn(e.key),e instanceof Ee&&wn(e.value,n),Y.pop()});else if(e instanceof Ce){var r=e.expressions.length-(n?0:1);e.expressions.forEach(function(e,n){wn(e,n<r)})}else if(e instanceof je)wn(e.body,!0);else if(e instanceof Pe)wn(e.expression);else if(e instanceof Ye)wn(e.expression),wn(e.property);else if(e instanceof Ie)wn(e.expression),e.body.forEach(wn);else if(e instanceof fn)UNARY_POSTFIX[e.operator]?E.push(Y.slice()):wn(e.expression);else if(e instanceof dn){if(e.name instanceof AST_SymbolVar)if(e.value){var o=e.name.definition();o.references.length>o.replaced&&E.push(Y.slice())}else z.set(e.name.name,(z.get(e.name.name)||0)+1);e.value&&wn(e.value)}else e instanceof _n&&e.expression&&wn(e.expression);Y.pop()}function En(e,n,t){var i;do{i=e,e=q.parent(++t)}while(e instanceof f&&e.operator.slice(0,-1)==n||e instanceof p&&e.operator==n);return i}function Sn(e,n,t,i,r){var o=Je;Je=!1;var s=ne,a=te,f=q.stack;return q.stack=[i],e.transform(q),q.stack=f,te=a,ne=s,Je=o,Be?(Be=!1,t):n(i,r+1)}function Dn(e,n){var t=q.parent(n);if(bn(e,t))return e;if(pn(e,t))return e;if(t instanceof s)return Dn(t,n+1);if(t instanceof f)return o(t.left);if(t instanceof u)return e;if(t instanceof p)return Dn(t,n+1);if(t instanceof m)return Dn(t,n+1);if(t instanceof b)return Dn(t,n+1);if(t instanceof D)return Dn(t,n+1);if(t instanceof H)return Dn(t,n+1);if(t instanceof X)return Dn(t,n+1);if(t instanceof fe)return Dn(t,n+1);if(t instanceof le)return e;if(t instanceof Se){var i=q.parent(n+1);return An(i.properties,function(e){return e instanceof Ee})?Dn(i,n+2):i}if(t instanceof Oe){var r=t.expression;return r===e?Dn(t,n+1):Sn(r,Dn,e,t,n)}return t instanceof Ce?Dn(t,n+1):t instanceof je?Dn(t,n+1):t instanceof Pe?e:t instanceof Ie?Dn(t,n+1):t instanceof fn?Dn(t,n+1):t instanceof dn?o(t.name):t instanceof _n?e:null;function o(i){return ve(t)?e:i!==e&&i instanceof I?Sn(i,Dn,e,t,n):Dn(t,n+1)}}function qn(e){if(y)y=!1;else if(!(V<1)){var t=(e=e.tail_node())instanceof f&&"="==e.operator?e.left:e;if(t instanceof en){var i=t.definition();if(!i.undeclared&&!x(i)){if(t!==e){if(Nn(t,n))return;if(i.references.length-i.replaced<2)return;var r=J.clone();r[r instanceof f?"right":"value"]=t,J.name_index>=0&&(r.name_index=J.name_index,r.arg_index=J.arg_index),J=r}return ee=i}}}}function Mn(e){return e.references.length-e.replaced-(T.get(e.name)||0)}function Cn(e){if(e instanceof f){if(!((r=e.left)instanceof en))return r;var t=r.definition();if(k.uses_arguments&&is_funarg(t))return r;if(n.exposed(t))return r;if(V=Mn(t),t.fixed&&r.fixed){var i=t.references.filter(function(e){return e.fixed===r.fixed}).length-1;i<V&&(V=i,K=0,Z=!0)}return"="==e.operator&&qn(e.right),r}if(e instanceof p)return e.right.left;if(e instanceof fn)return e.expression;if(e instanceof dn){var r;if((t=(r=e.name).definition()).const_redefs)return;if(!jn(r,t.orig))return;if(k.uses_arguments&&is_funarg(t))return;var o=t.orig.length-t.eliminated-(z.get(t.name)||0);return V=Mn(t),t.fixed&&(V=Math.min(V,t.references.filter(function(n){if(!n.fixed)return!0;if(!n.fixed.assigns)return!0;var t=n.fixed.assigns[0];return t===r||Pn(t)===e.value}).length)),o>1&&!(r instanceof Xe)?(qn(e.value),Yn(en,r)):qn(e.value)||1==V&&!n.exposed(t)?Yn(en,r):void 0}}function Pn(e){if(e instanceof f)return e.right;if(e instanceof p){var n=e.clone();return n.right=e.right.right,n}return e instanceof dn?e.value:void 0}function Hn(e){if(!(e instanceof f&&e.right.single_use)){for(var t,i=Object.create(null),r=new mn(function(e){e instanceof en&&(i[e.definition().id]=!0)});e instanceof f&&"="==e.operator;)e.left.walk(r),e=e.right;if(e instanceof Ae)return c;if(e instanceof en){var o=e.evaluate(n);return o===e?c:In(o,c)}if(e.is_truthy())return In(!0,Rn);if(e.is_constant()){var a=e.evaluate(n);if(!(a instanceof xe))return In(a,c)}return oe instanceof en&&(!!function e(t){return!(t instanceof s)&&(t instanceof p&&kt[t.operator]?e(t.left)&&e(t.right):!(t instanceof m)&&(t instanceof D?e(t.consequent)&&e(t.alternative):!(t instanceof Te||t.has_side_effects(n))))}(e)&&(e.walk(new mn(function(e){if(t)return!0;e instanceof en&&i[e.definition().id]&&(t=!0)})),!t&&c))}function c(n){return e.equals(n)}}function In(e,t){return function(i,r){if(r.in_boolean_context()){if(e&&i.is_truthy()&&!i.has_side_effects(n))return!0;if(i.is_constant()){var o=i.evaluate(n);if(!(o instanceof xe))return!o==!e}}return t(i)}}function Ln(e){for(;e.write_only&&(e.write_only=!1,e instanceof f);)e=e.right}function Un(e,n){var t=n.scope||On(q)||i;e.walk(new mn(function(e){if(e instanceof h)return!0;e instanceof Le&&(e.scope=t)}))}function Vn(e){var i=new zn;e instanceof dn&&(e.name.definition().fixed||(De=!1),i.add(e.name.name,oe));var r=k.uses_arguments&&!n.has_directive("use strict"),o=k instanceof on,s=new mn(function(a){var c;if(a instanceof en){if(!(c=a.fixed_value())){c=a;var u=a.definition(),l=a.fixed&&a.fixed.escaped||u.escaped;u.undeclared||!u.assignments&&l&&!l.cross_scope||!C(u,a.scope,a,s.parent())&&Si(u)||(De=!1)}}else a instanceof Ae&&(c=a);if(c)i.add(a.name,t(n,s,a,c,0));else{if(a instanceof he){for(var d,h=0,v=a;d=s.parent(h++);v=d){if(d instanceof f){if(d.left===v)break;if("="==d.operator)continue;if(kt[d.operator.slice(0,-1)])continue;break}if(d instanceof p){if(kt[d.operator])continue;break}if(d instanceof m)return;if(d instanceof Me)return;if(d instanceof Ce){if(d.tail_node()===v)continue;break}if(d instanceof nn){if(d.tag)return;break}}return a.enclosed.forEach(function(e){e.scope!==a&&we.set(e.name,!0)}),!0}r&&a instanceof Ye&&(k.each_argname(function(e){n.option("reduce_vars")&&!e.definition().assignments||(e.definition().fixed||(De=!1),i.add(e.name,!0))}),r=!1)}if(o)if("Call"==a.TYPE){if(ye)return;var _=a.expression;if(_ instanceof Oe)return;if(_ instanceof _e&&!_.contains_this())return;ye=!0}else a instanceof Oe&&function e(n){return n instanceof en&&!(n=n.fixed_value())||(n instanceof f?"="==n.operator&&e(n.right):n instanceof Oe||n instanceof Ae)}(a.expression)&&(a!==oe||e instanceof fn?be=!0:ye=!0)});return e.walk(s),i}function Gn(t){var i=Ne===He?null:Bn(He,He.expressions.slice(0,-1)),r=t.name_index;if(r>=0){var o,s=k.argnames[r];s instanceof j?(k.argnames[r]=s=s.clone(),s.value=i||Yn(ke,s,{value:0})):(o=n.parent().args)[r]&&(k.argnames[r]=s.clone(),o[r]=i||Yn(ke,o[r],{value:0}))}else{var a=Y.length-1,f=Y[a];(f instanceof dn||Y[a-1].body===f)&&a--;var c=new gn(function(e,n,t){if(Ve)return e;if(e!==Y[$])return e;if(++$<=a)return rn(e,c);if(Ve=!0,e instanceof H){z.set(f.name.name,(z.get(f.name.name)||0)+1),ee&&ee.replaced++;var r=e.definitions,o=r.indexOf(f),s=f.clone();if(s.value=null,!i)return e.definitions[o]=s,e;var u=[Yn(je,i,{body:i})];if(o>0){var l=e.clone();l.definitions=r.slice(0,o),u.unshift(l),(e=e.clone()).definitions=r.slice(o)}return u.push(e),e.definitions[0]=s,t?List.splice(u):Yn(v,e,{body:u})}return i?is_statement(e)?Yn(je,i,{body:i}):i:t?List.skip:null},function(e,n){return e instanceof ie?bt(e,n):Wn(e,c)});Be=!1,Ve=!1,$=0,(e[O]=e[O].transform(c))||e.splice(O,1)}}function Wn(e,n){if(e instanceof Ce)switch(e.expressions.length){case 0:return null;case 1:return nt(n.parent(),e,e.expressions[0])}}function $n(e){var n=root_expr(e);if(!(n instanceof en))return!1;if(n.definition().scope.resolve()!==k)return!1;if(!l)return!0;if(pe)return!1;if(J instanceof fn)return!1;var t=ze.get(n.name);return!t||t[0]===e}function Xn(){return!(J instanceof fn)&&Ne.has_side_effects(n)}function Jn(e){if(e instanceof fn)return!1;if(ae)return!1;if(ee)return!0;if(!(oe instanceof en))return!1;var n;if(e instanceof dn)n=1;else{if("="!=e.operator)return!1;n=2}var t=oe.definition();if(t.references.length-t.replaced==n)return!0;if(!t.fixed)return!1;if(!oe.fixed)return!1;var i=oe.fixed.assigns,r=0;return!!An(t.references,function(e,n){var t=e.fixed;return!!t&&(!t.to_binary&&!t.to_prefix&&(t===oe.fixed?(r++,!0):i&&t.assigns&&i[0]!==t.assigns[0]))})&&(r==n&&(Z=!0,!0))}function Kn(e,n){var t=ze.get(e.name);if(t&&!An(t,function(e){return!e}))return t[0]!==oe||void(ue=!1)}function Zn(e){var t=e.definition();return!(1==t.orig.length&&t.orig[0]instanceof We)&&(t.scope.resolve()!==k||(!(!ye||!n.exposed(t))||!An(t.references,function(e){return e.scope.resolve(!0)===k})))}function et(e,n){if(e instanceof f)return et(e.left,!0);if(e instanceof fn)return et(e.expression,!0);if(e instanceof dn)return e.value&&et(e.value);if(n){if(e instanceof G)return et(e.expression,!0);if(e instanceof Ye)return et(e.expression,!0);if(e instanceof en)return e.definition().scope.resolve()!==k}return!1}}function K(e){for(var n=!1,t=[],i=0;i<e.length;){var r=e[i];if(r instanceof v&&An(r.body,ot))n=!0,K(r.body),[].splice.apply(e,[i,1].concat(r.body)),i+=r.body.length;else{if(r instanceof V){if(jn(r.value,t)){n=!0,e.splice(i,1);continue}t.push(r.value)}r instanceof $?(n=!0,e.splice(i,1)):i++}}return n}function Z(e,n){for(var t,i,r,o=!1,s=n.parent(),a=n.self(),f=T&&s&&"Call"==s.TYPE&&s.expression===a,c=T&&n.option("conditionals")&&n.option("sequences"),u=!(_&&_.bfinally&&Dn(k)),l=function(e){for(var n=0,t=e.length;--t>=0;){var i=e[t];if(i instanceof fe&&i.body instanceof Fe&&++n>1)return!0}return!1}(e),p=e.length;--p>=0;){var h=e[p],m=G(p),b=e[m];if(T&&t&&!b&&h instanceof Fe&&u&&!(a instanceof Re)){if(!(S=h.value)){o=!0,e.splice(p,1);continue}var y=S.tail_node();if(wt(y)){o=!0,S instanceof un?S=S.expression:y instanceof un&&((S=S.clone()).expressions[S.expressions.length-1]=y.expression),e[p]=Yn(je,h,{body:S});continue}}if(h instanceof fe){var x=Ht(h.body);if(R(x)){x.label&&In(x.label.thedef.references,x),o=!0,(h=h.clone()).body=Yn(v,h,{body:V(h.body,x)}),h.alternative=Yn(v,h,{body:st(h.alternative).concat(L(r,i))}),B(x.value,r),e[p]=h,e[p]=h.transform(n);continue}if(x&&!h.alternative&&b instanceof pe){var w=h.condition,E=p+1==m&&h.body instanceof v;if((w=Tt(w,w.negate(n),E))!==h.condition){o=!0,(h=h.clone()).condition=w;var S=h.body;h.body=Yn(v,b,{body:L(!0,null,m+1)}),e.splice(p,1,h,S),(!T||a instanceof d&&a.body===e)&&(e[p]=h.transform(n));continue}}var A=Ht(h.alternative);if(R(A)){A.label&&In(A.label.thedef.references,A),o=!0,(h=h.clone()).body=Yn(v,h.body,{body:st(h.body).concat(L(r,i))}),h.alternative=Yn(v,h.alternative,{body:V(h.alternative,A)}),B(A.value,r),e[p]=h,e[p]=h.transform(n);continue}if(n.option("typeofs")){if(x&&!A){var O=Yn(v,a,{body:e.slice(p+1)});Zt(h.condition,null,O)}if(!x&&A){O=Yn(v,a,{body:e.slice(p+1)});Zt(h.condition,O)}}}if(h instanceof fe&&h.body instanceof Fe){var F,M,C=h.body.value,j=h.body.in_bool||b instanceof Fe&&b.in_bool;if(!h.alternative&&b instanceof Fe&&(u||!C==!b.value)){o=!0,(h=h.clone()).alternative=Yn(v,b,{body:L(!0,null,m+1)}),e[p]=h,e[p]=h.transform(n);continue}if(T&&t&&!b&&!h.alternative&&(j||C&&l||C instanceof D&&(wt(C.consequent,n)||wt(C.alternative,n)))){o=!0,(h=h.clone()).alternative=Yn(Fe,h,{value:null}),e[p]=h,e[p]=h.transform(n);continue}if(c&&!h.alternative&&(!(M=e[F=W(p)])&&f||M instanceof fe&&M.body instanceof Fe)&&(b?b instanceof je&&G(m)==e.length:!t)){o=!0;var H=[];h=h.clone(),H.push(h.condition),h.condition=Bn(h,H),h.alternative=Yn(v,a,{body:L().concat(Yn(Fe,a,{value:null}))}),e[p]=h.transform(n),p=F+1;continue}}h instanceof g||h instanceof X?i=h:t&&i&&i===b&&J(h)}return o;function N(e){return Y(n,function(n){return n===e})}function I(e,n){if(!i)return!1;if(i.TYPE!=e.TYPE)return!1;var t=e.value;if(!t)return!1;var r=i.equals(e);return!r&&t instanceof Ce&&(t=t.tail_node(),i.value&&i.value.equals(t)&&(r=2)),!r&&!n&&i.value instanceof Ce&&i.value.tail_node().equals(t)&&(r=3),r}function R(t){if(r=!1,!function(e){if(e instanceof X){if(r=I(e))return!0;if(!T)return!1;if(!(e instanceof Fe))return!1;var t=e.value;return!(t&&!wt(t.tail_node())||a instanceof Re&&(!i||i instanceof X&&i.value||(r=4,0)))}if(!(e instanceof me))return!1;if(a instanceof Re)if(i instanceof X){if(!T)return!1;if(i.value)return!1;r=!0}else if(i){if(n.loopcontrol_target(i)!==s)return!1;r=!0}else if(!1===i)return!1;var o=n.loopcontrol_target(e);return e instanceof q?N(ct(o)):!(o instanceof le)&&N(o)}(t))return!1;for(var o=e.length;--o>p;){var f=e[o];if(f instanceof P){if(f.name.definition().preinit)return!1}else if((f instanceof z||f instanceof ge)&&!An(f.definitions,function(e){return!e.name.match_symbol(function(e){return e instanceof Ge&&e.definition().preinit})}))return!1}return!0}function L(n,t,r){var o=[],s=!1,a=p+1;n?t?r=e.lastIndexOf(t):(t=e[r])!==i&&(i=!1):(r=e.length,i=null);var f=e.splice(a,r-a).filter(function(e){return e instanceof ve?(o.push(e),!1):(rt(e)&&(s=!0),!0)});return 3===n&&(f.push(Yn(je,t.value,{body:Bn(t.value,t.value.expressions.slice(0,-1))})),t.value=t.value.tail_node()),[].push.apply(s?f:e,o),f}function U(e,n){if(e)switch(n){case 4:return e;case 3:if(!(e instanceof Ce))break;case 2:return Bn(e,e.expressions.slice(0,-1))}}function V(e,n){for(var t,i=st(e),o=i;(t=o[o.length-1])!==n;)o=t.body;o.pop();var s=n.value;return r&&(s=U(s,r)),s&&o.push(Yn(je,s,{body:s})),i}function B(e,n){if(n&&e){switch(n){case 4:return;case 3:case 2:e=e.tail_node()}tt(e,i.value)}}function G(n){t=!0;for(var i=n;++i<e.length;){var r=e[i];if(!gt(r)){if(!(r instanceof pn))break;t=!1}}return i}function W(n){for(var t=n;--t>=0;){var i=e[t];if(!(i instanceof pn)&&!gt(i))break}return t}function J(e,n,t){if(e instanceof X){var r=!(n&&e instanceof AST_Throw)&&I(e,!0);if(r){o=!0;var s=U(e.value,r);return s?Yn(je,s,{body:s}):t?null:Yn($,e)}}else if(e instanceof fe)e.body=J(e.body,n),e.alternative&&(e.alternative=J(e.alternative,n));else if(e instanceof de)e.body=J(e.body,n);else if(e instanceof an){if(!e.bfinally||!i.value||i.value.is_constant())e.bcatch&&J(e.bcatch,n),(a=J(e.body.pop(),!0,!0))&&e.body.push(a)}else if(e instanceof d&&!(e instanceof Me||e instanceof Ie)){var a;(a=J(e.body.pop(),n,!0))&&e.body.push(a)}return e}}function ee(e,n){var t,i=n.self();i instanceof y?i=n.parent():i instanceof de&&(i=i.body);for(var r=0,o=0,s=e.length;r<s;r++){var a=e[r];if(a instanceof me){var f=n.loopcontrol_target(a);ct(f)!==i||a instanceof g&&f instanceof le?e[o++]=a:a.label&&In(a.label.thedef.references,a)}else e[o++]=a;if(Ht(a)){t=e.slice(r+1);break}}return e.length=o,t&&t.forEach(function(t){xt(n,t,e)}),e.length!=s}function ne(e,n){if(!(!T||_&&_.bfinally)){for(var t=!1,i=e.length;--i>=0;){var r=e[i];if(!(r instanceof je))break;var o=r.body;if(!(o instanceof u))break;var s=o.expression;if(!xi(n,s))break;if(t=!0,s=s.drop_side_effect_free(n,!0)){r.body=s;break}}return e.length=i+1,t}}function ae(e,n){var t=!1,r=e.length-1;if(T&&r>=0){var o=_&&_.bfinally&&Dn(k);(a=e[r].try_inline(n,i,o))&&(e[r--]=a,t=!0)}for(var s=l&&_&&_.bfinally?"try":l;r>=0;r--){var a;(a=e[r].try_inline(n,i,!0,s))&&(e[r]=a,t=!0)}return t}function ce(e,n){if(!(e.length<2)){for(var t=[],i=0,r=0,o=e.length;r<o;r++){var s=e[r];s instanceof je?(t.length>=n.sequences_limit&&a(),it(t,s.body)):gt(s)?e[i++]=s:(a(),e[i++]=s)}return a(),e.length=i,i!=o}function a(){if(t.length){var n=Bn(t[0],t);e[i++]=Yn(je,n,{body:n}),t=[]}}}function ue(e,n){if(!(e instanceof v))return e;for(var t=null,i=0;i<e.body.length;i++){var r=e.body[i];if(r instanceof pn&&_t(r))n.push(r);else{if(t||rt(r))return!1;t=r}}return t}function be(e,n){for(var t,i=!1,r=0,o=0;o<e.length;o++){var s=e[o];if(t)if(s instanceof X)!s.value&&Dn(k)||(s.value=d(s.value||Yn(ln,s)).optimize(n));else if(s instanceof ie){if(!(s.init instanceof H)){var a=!1;t.body.walk(new mn(function(e){return!!(a||e instanceof Me)||(e instanceof p&&"in"==e.operator?(a=!0,!0):void 0)})),a||(s.init?s.init=d(s.init):(s.init=t.body,r--,i=!0))}}else s instanceof oe?rt(s.init)||(s.object=d(s.object)):s instanceof fe?s.condition=d(s.condition):s instanceof Ie?s.expression=d(s.expression):s instanceof vn&&(s.expression=d(s.expression));if(n.option("conditionals")&&s instanceof fe){var f=[],c=ue(s.body,f),u=ue(s.alternative,f);if(!1!==c&&!1!==u&&f.length>0){var l=f.length;f.push(Yn(fe,s,{condition:s.condition,body:c||Yn($,s.body),alternative:u})),f.unshift(r,1),[].splice.apply(e,f),o+=l,r+=l+1,t=null,i=!0;continue}}e[r++]=s,t=s instanceof je?s:null}return e.length=r,i;function d(e){r--,i=!0;var n=t.body;return Bn(n,[n,e])}}function ye(e){return e instanceof f?[e]:e instanceof Ce?e.expressions.slice():void 0}function we(e,n,t){var i=ye(n);if(i){t=t||0;for(var r=!1,o=i.length-t;--o>=0;){var s=i[o];if(l(s)){var a;if(s.left instanceof en)a=i.slice(o+1);else{if(!(s.left instanceof Oe&&l(s.left.expression)))continue;a=i.slice(o+1);var c=s.clone();s=s.left.expression,c.left=c.left.clone(),c.left.expression=s.left.clone(),a.unshift(c)}0!=a.length&&He(s.left,s.right,a)&&(r=!0,i=i.slice(0,o).concat(s,a))}}if(e instanceof H){for(o=e.definitions.length;--o>=0;){var u=e.definitions[o];if(u.value){He(u.name,u.value,i)&&(r=!0),ze(u,i,t)&&(r=!0);break}}e instanceof pn&&qe(e.definitions,i,t)&&(r=!0)}return r&&i}function l(e){return e instanceof f&&"="==e.operator}}function De(e,n){if(e instanceof je&&!_t(n)){var t=ye(e.body);if(t){var i=[];if(qe(i,t.reverse(),0))return n.definitions=i.reverse().concat(n.definitions),t.reverse()}}}function ze(e,t,i){if(n.option("conditionals")&&!(e.name instanceof I)){for(var r=!1,o=e.name.definition();t.length>i;){var s=hi(n,o,e.value,t[0]);if(!s)break;e.value=s,t.shift(),r=!0}return r}}function qe(e,n,t){for(var i=!1;n.length>t;){var r=n[0];if(!(r instanceof f))break;if("="!=r.operator)break;var o=r.left;if(!(o instanceof en))break;if(pt(o))break;if(o.scope.resolve()!==k)break;var s=o.definition();if(s.scope!==k)break;if(s.orig.length>s.eliminated+1)break;if("SymbolVar"!=s.orig[0].TYPE)break;var a=Yn(AST_SymbolVar,o);e.push(Yn(dn,r,{name:a,value:r.right})),s.orig.push(a),s.replaced++,n.shift(),i=!0}return i}function He(e,t,i){var r=new zn;for(r.set(e.name,!0);t instanceof f&&"="==t.operator;)t.left instanceof en&&r.set(t.left.name,!0),t=t.right;if(t instanceof Te){var o=!1;do{if(!s(i[0]))break;i.shift(),o=!0}while(i.length);return o}function s(e){if(e instanceof f&&"="==e.operator&&e.left instanceof Oe){var i=e.left.expression;if(i instanceof en&&r.has(i.name)&&e.right.is_constant_expression(k)){var o=e.left.property;if(o instanceof xe&&(s(o)&&(o=e.left.property=o.right.clone()),o=o.evaluate(n)),!(o instanceof xe)){var a="__proto__"==(o=""+o)||n.has_directive("use strict")?function(e){var n=e.key;return"string"==typeof n&&n!=o&&"__proto__"!=n}:function(e){var n=e.key;return e instanceof AST_ObjectGetter||e instanceof AST_ObjectSetter?"string"==typeof n&&n!=o:"__proto__"!==n};if(An(t.properties,a))return t.properties.push(Yn(Ee,e,{key:o,value:e.right})),!0}}}}}function Ne(e){for(var n,t=!1,i=0,r=-1;i<e.length;i++){var o=e[i],s=e[r];if(o instanceof H)if(s&&s.TYPE==o.TYPE)s.definitions=s.definitions.concat(o.definitions),t=!0;else if(n&&n.TYPE==o.TYPE&&_t(o))n.definitions=n.definitions.concat(o.definitions),t=!0;else if(o instanceof pn){(f=De(s,o))?(f.length&&(s.body=Bn(s,f),r++),t=!0):r++,e[r]=n=o}else e[++r]=o;else{if(o instanceof X)o.value=u(o.value);else if(o instanceof ie){if(f=we(s,o.init))t=!0,o.init=f.length?Bn(o.init,f):null;else{if(s instanceof pn&&(!o.init||o.init.TYPE==s.TYPE)){o.init&&(s.definitions=s.definitions.concat(o.init.definitions)),o=o.clone(),n=o.init=s,e[r]=l(o),t=!0;continue}if(n&&o.init&&n.TYPE==o.init.TYPE&&_t(o.init))n.definitions=n.definitions.concat(o.init.definitions),o.init=null,t=!0;else if(o.init instanceof pn&&(n=o.init,f=De(s,o.init))){if(t=!0,0==f.length){e[r]=l(o);continue}s.body=Bn(s,f)}}}else if(o instanceof re){if(n&&n.TYPE==o.init.TYPE){var a=n.definitions.slice();o.init=o.init.definitions[0].name.convert_symbol(en,function(e,n){a.push(Yn(dn,n,{name:n,value:null})),n.definition().references.push(e)}),n.definitions=a,t=!0}o.object=u(o.object)}else if(o instanceof fe)o.condition=u(o.condition);else if(o instanceof je){var f,c;if(f=we(s,o.body)){if(t=!0,!f.length)continue;o.body=Bn(o.body,f)}else if(s instanceof H&&(c=e[i+1])&&s.TYPE==c.TYPE&&(c=c.definitions[0]).value){t=!0,c.value=Bn(o,[o.body,c.value]);continue}}else o instanceof Ie?o.expression=u(o.expression):o instanceof vn&&(o.expression=u(o.expression));e[++r]=n?l(o):o}}return e.length=r+1,t;function u(e){var n=we(s,e,1);if(!n)return e;t=!0;var i=e.tail_node();return n[n.length-1]!==i&&n.push(i.left),Bn(e,n)}function l(e){return e.transform(new gn(function(e,i,r){if(e instanceof H){if(n===e)return e;if(n.TYPE!=e.TYPE)return e;var o=this.parent();return o instanceof re&&o.init===e?e:_t(e)?(n.definitions=n.definitions.concat(e.definitions),t=!0,o instanceof ie&&o.init===e?null:r?List.skip:Yn($,e)):e}return e instanceof Q?e:e instanceof Me?e:is_statement(e)?void 0:e}))}}}function xt(e,n,t){var i,r=!1;function o(e){i?(i.push(e),ot(e)||(i.required=!0)):t.push(e)}n.walk(new mn(function(s,a){if(s instanceof P)return s.extends=null,s.properties=[],o(s),!0;if(s instanceof H){var f=[];return s.remove_initializers(e,f)&&xe.warn("Dropping initialization in unreachable code [{start}]",s),f.length>0&&(s.definitions=f,o(s)),!0}if(s instanceof ve)return o(s),!0;if(s instanceof Me)return!0;if(s instanceof h){var c=i;return i=[],a(),i.required?t.push(Yn(v,n,{body:i})):i.length&&[].push.apply(t,i),i=c,!0}s instanceof me||(r=!0)})),r&&xe.warn("Dropping unreachable code [{start}]",n)}function wt(e,n){return null==e||e.is_undefined||e instanceof ln||e instanceof un&&"void"==e.operator&&!(n&&e.expression.has_side_effects(n))}en.DEFMETHOD("is_declared",function(e){return this.defined||!this.definition().undeclared||e.option("unsafe")&&ht[this.name]}),(dt=function(e,n){e.DEFMETHOD("in_strict_mode",n)})(w,Un),dt(Me,function(e){for(var n=this.body,t=0;t<n.length;t++){var i=n[t];if(!(i instanceof V))break;if("use strict"==i.value)return!0}var r=this.parent_scope;return r?r.resolve(!0).in_strict_mode(e):e.option("module")}),function(e){e(xe,Rn),e(s,Un),e(f,function(){return"="==this.operator&&this.right.is_truthy()}),e(he,Un),e(Te,Un),e(qe,Un),e(Ce,function(){return this.tail_node().is_truthy()}),e(en,function(){var e=this.fixed_value();if(!e)return!1;this.is_truthy=Rn;var n=e.is_truthy();return delete this.is_truthy,n})}(function(e,n){e.DEFMETHOD("is_truthy",n)}),function(e){function n(e,n,t){switch(e){case"-":return n.is_negative_zero()&&(!(t instanceof O)||0==t.value);case"&&":case"||":return n.is_negative_zero()||t.is_negative_zero();case"*":case"/":case"%":case"**":return!0;default:return!1}}e(xe,Un),e(s,Rn),e(f,function(){var e=this.operator;return"="==e?this.right.is_negative_zero():n(e.slice(0,-1),this.left,this.right)}),e(p,function(){return n(this.operator,this.left,this.right)}),e(O,function(){return 0==this.value&&1/this.value<0}),e(he,Rn),e(Te,Rn),e(qe,Rn),e(Ce,function(){return this.tail_node().is_negative_zero()}),e(en,function(){var e=this.fixed_value();if(!e)return!0;this.is_negative_zero=Un;var n=e.is_negative_zero();return delete this.is_negative_zero,n}),e(un,function(){return"+"==this.operator&&this.expression.is_negative_zero()||"-"==this.operator})}(function(e,n){e.DEFMETHOD("is_negative_zero",n)}),function(e){function n(e,n){return n||/strict/.test(e.option("pure_getters"))}xe.DEFMETHOD("may_throw_on_access",function(e,n){return!e.option("pure_getters")||this._dot_throw(e,n)}),e(xe,n),e(s,Rn),e(f,function(e){var n=this.operator,t=this.left,i=this.right;return"="!=n?kt[n.slice(0,-1)]&&(t._dot_throw(e)||i._dot_throw(e)):!!i._dot_throw(e)&&(!(t instanceof en)||(!(i instanceof p&&"||"==i.operator&&t.name==i.left.name)||i.right._dot_throw(e)))}),e(p,function(e){return kt[this.operator]&&(this.left._dot_throw(e)||this.right._dot_throw(e))}),e(w,function(e,t){return n(e,t)&&!An(this.properties,function(e){return!!e.private||(!e.static||!(e instanceof AST_ClassGetter||e instanceof AST_ClassSetter))})}),e(D,function(e){return this.consequent._dot_throw(e)||this.alternative._dot_throw(e)}),e(O,Rn),e(G,function(e,t){if(!n(e,t))return!1;var r=this.expression;return r instanceof en&&(r=r.fixed_value()),!("prototype"==this.property&&i(r))}),e(he,Rn),e(we,Un),e(Te,function(e,t){return n(e,t)&&!An(this.properties,function(n){return!(n instanceof AST_ObjectGetter||n instanceof AST_ObjectSetter)&&!("__proto__"===n.key&&n.value._dot_throw(e,t))})}),e(Ae,function(e,t){return n(e,t)&&!this.scope.resolve().new}),e(Ce,function(e){return this.tail_node()._dot_throw(e)}),e(en,function(e,t){if(this.is_undefined)return!0;if(!n(e,t))return!1;if(pt(this)&&this.is_declared(e))return!1;if(this.is_immutable())return!1;var i=this.definition();if(x(i)&&!i.scope.rest&&An(i.scope.argnames,function(e){return e instanceof Xe}))return i.scope.uses_arguments>2;var r=this.fixed_value(!0);return!r||(this._dot_throw=Un,r._dot_throw(e)?(delete this._dot_throw,!0):(this._dot_throw=Rn,!1))}),e(un,function(){return"void"==this.operator}),e(cn,Rn),e(ln,Un)}(function(e,n){e.DEFMETHOD("_dot_throw",n)}),function(e){function n(e,n,t){switch(n){case"&&":return t.left.is_defined(e)&&t.right.is_defined(e);case"||":return t.left.is_truthy()||t.right.is_defined(e);case"??":return t.left.is_defined(e)||t.right.is_defined(e);default:return!0}}e(xe,Rn),e(s,Un),e(f,function(e){var t=this.operator;return"="==t?this.right.is_defined(e):n(e,t.slice(0,-1),this)}),e(p,function(e){return n(e,this.operator,this)}),e(D,function(e){return this.consequent.is_defined(e)&&this.alternative.is_defined(e)}),e(O,Un),e(ae,Rn),e(he,Un),e(Te,Un),e(Ce,function(e){return this.tail_node().is_defined(e)}),e(en,function(e){if(this.is_undefined)return!1;if(pt(this)&&this.is_declared(e))return!0;if(this.is_immutable())return!0;var n=this.fixed_value();if(!n)return!1;this.is_defined=Rn;var t=n.is_defined(e);return delete this.is_defined,t}),e(un,function(){return"void"!=this.operator}),e(cn,Un),e(ln,Rn)}(function(e,n){e.DEFMETHOD("is_defined",n)}),function(e){e(xe,Rn),e(f,function(e){return"="==this.operator&&this.right.is_boolean(e)});var n=Mn("in instanceof == != === !== < <= >= >");e(p,function(e){return n[this.operator]||kt[this.operator]&&this.left.is_boolean(e)&&this.right.is_boolean(e)}),e(_,Un);var t=Mn("every hasOwnProperty isPrototypeOf propertyIsEnumerable some");e(m,function(e){if(!e.option("unsafe"))return!1;var n=this.expression;return n instanceof G&&(t[n.property]||"test"==n.property&&n.expression instanceof qe)}),e(D,function(e){return this.consequent.is_boolean(e)&&this.alternative.is_boolean(e)}),e(ye,Rn),e(Ce,function(e){return this.tail_node().is_boolean(e)}),e(en,function(e){var n=this.fixed_value();if(!n)return!1;this.is_boolean=Rn;var t=n.is_boolean(e);return delete this.is_boolean,t});var i=Mn("! delete");e(un,function(){return i[this.operator]})}(function(e,n){e.DEFMETHOD("is_boolean",n)}),function(e){e(xe,Rn);var n=Mn("- * / % ** & | ^ << >> >>>");e(f,function(e){return n[this.operator.slice(0,-1)]||"="==this.operator&&this.right.is_number(e)}),e(p,function(e){return!!n[this.operator]||"+"==this.operator&&((this.left.is_boolean(e)||this.left.is_number(e))&&(this.right.is_boolean(e)||this.right.is_number(e)))});var t=Mn(["charCodeAt","getDate","getDay","getFullYear","getHours","getMilliseconds","getMinutes","getMonth","getSeconds","getTime","getTimezoneOffset","getUTCDate","getUTCDay","getUTCFullYear","getUTCHours","getUTCMilliseconds","getUTCMinutes","getUTCMonth","getUTCSeconds","getYear","indexOf","lastIndexOf","localeCompare","push","search","setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear"]);e(m,function(e){if(!e.option("unsafe"))return!1;var n=this.expression;return n instanceof G&&(t[n.property]||pt(n.expression)&&"Math"==n.expression.name)}),e(D,function(e){return this.consequent.is_number(e)&&this.alternative.is_number(e)}),e(ye,Rn),e(ke,Un),e(Ce,function(e){return this.tail_node().is_number(e)}),e(en,function(e,n){var t=this.fixed_value();if(!t)return!1;if(n&&t instanceof un&&"+"==t.operator&&t.expression.equals(this))return!1;this.is_number=Rn;var i=t.is_number(e);return delete this.is_number,i});var i=Mn("+ - ~ ++ --");e(fn,function(){return i[this.operator]})}(function(e,n){e.DEFMETHOD("is_number",n)}),function(e){e(xe,Rn),e(f,function(e){switch(this.operator){case"+=":if(this.left.is_string(e))return!0;case"=":return this.right.is_string(e)}}),e(p,function(e){return"+"==this.operator&&(this.left.is_string(e)||this.right.is_string(e))});var n=Mn(["charAt","substr","substring","toExponential","toFixed","toLowerCase","toPrecision","toString","toUpperCase","trim"]);e(m,function(e){if(!e.option("unsafe"))return!1;var t=this.expression;return t instanceof G&&n[t.property]}),e(D,function(e){return this.consequent.is_string(e)&&this.alternative.is_string(e)}),e(Ce,function(e){return this.tail_node().is_string(e)}),e(Ne,Un),e(en,function(e){var n=this.fixed_value();if(!n)return!1;this.is_string=Rn;var t=n.is_string(e);return delete this.is_string,t}),e(nn,function(e){return!this.tag||Ai(e,this.tag)}),e(un,function(){return"typeof"==this.operator})}(function(e,n){e.DEFMETHOD("is_string",n)});var kt=Mn("&& || ??");function Tt(e,n,t){return n.print_to_string().length-e.print_to_string().length<(t||0)?n:e}function Et(e,n,t){return Tt(Yn(je,e,{body:e}),Yn(je,n,{body:n}),t).body}function St(e,n,t,i){return(wn(e)?Et:Tt)(n,t,i)}function At(e){var n=Object.create(null);return Object.keys(e).forEach(function(t){n[t]=Mn(e[t])}),n}function Dt(e){for(var n=0;n<e.length;n++){var t=e[n];if(!(t instanceof V))return t}}function zt(){return this.value?Yn(Fe,this.value,{value:this.value}):Dt(this.body)}function Ot(e,n){var t=n.evaluate(e);return t===n?n:St(e,n,t=Kn(t,n).optimize(e),e.eval_threshold)}!function(e){function n(e){xe.warn("global_defs {this} redefined [{start}]",e)}on.DEFMETHOD("resolve_defines",function(e){return e.option("global_defs")?(this.figure_out_scope({ie:e.option("ie")}),this.transform(new gn(function(t){var i=t._find_defs(e,"");if(i){for(var r,o=0,s=t;(r=this.parent(o++))&&r instanceof Oe&&r.expression===s;)s=r;if(!Qn(s,r))return i;n(t)}}))):this}),e(xe,Pn),e(G,function(e,n){return this.expression._find_defs(e,"."+this.property+n)}),e(Ge,function(e){this.definition().global&&qn(e.option("global_defs"),this.name)&&n(this)}),e(en,function(e,n){if(this.definition().global){var t=e.option("global_defs"),i=this.name+n;return qn(t,i)?function e(n,t){if(n instanceof xe)return n.clone(!0);if(Array.isArray(n))return Yn(s,t,{elements:n.map(function(n){return e(n,t)})});if(n&&"object"==typeof n){var i=[];for(var r in n)qn(n,r)&&i.push(Yn(Ee,t,{key:r,value:e(n[r],t)}));return Yn(Te,t,{properties:i})}return Kn(n,t)}(t[i],this):void 0}})}(function(e,n){e.DEFMETHOD("_find_defs",n)}),a.DEFMETHOD("first_statement",zt),c.DEFMETHOD("first_statement",zt),he.DEFMETHOD("first_statement",function(){return Dt(this.body)}),he.DEFMETHOD("length",function(){for(var e=this.argnames,n=0;n<e.length&&!(e[n]instanceof j);n++);return n});var qt=["constructor","toString","valueOf"],Ft=At({Array:["indexOf","join","lastIndexOf","slice"].concat(qt),Boolean:qt,Function:qt,Number:["toExponential","toFixed","toPrecision"].concat(qt),Object:qt,RegExp:["exec","test"].concat(qt),String:["charAt","charCodeAt","concat","indexOf","italics","lastIndexOf","match","replace","search","slice","split","substr","substring","toLowerCase","toUpperCase","trim"].concat(qt)}),Mt=At({Array:["isArray"],Math:["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","atan2","pow","max","min"],Number:["isFinite","isNaN"],Object:["create","getOwnPropertyDescriptor","getOwnPropertyNames","getPrototypeOf","isExtensible","isFrozen","isSealed","keys"],String:["fromCharCode","raw"]});function Ct(e){if(!(e instanceof G))return!1;var n=e.expression;if(!pt(n))return!1;var t=Mt[n.name];return t&&(t[e.property]||"Math"==n.name&&"random"==e.property)}!function(e){e(xe,Rn),e(O,Un),e(qe,Rn);var n=Mn("! ~ - + void");e(un,function(){return n[this.operator]&&this.expression instanceof O})}(function(e,n){e.DEFMETHOD("is_constant",n)}),function(e){xe.DEFMETHOD("evaluate",function(e,n){if(!e.option("evaluate"))return this;var t=[],i=this._eval(e,n,t,1);return t.forEach(function(e){delete e._eval}),n?i:!i||i instanceof RegExp?i:"function"==typeof i||"object"==typeof i?this:i});var n=new mn(function(e){e instanceof f&&t(e.left),e instanceof re&&t(e.init),e instanceof fn&&UNARY_POSTFIX[e.operator]&&t(e.expression)});function t(e){e instanceof R?e.elements.forEach(t):e instanceof U?e.properties.forEach(function(e){t(e.value)}):e instanceof Oe?t(e.expression):e instanceof en&&e.definition().references.forEach(function(e){delete e._eval})}e(He,function(){throw new Error(string_template("Cannot evaluate a statement [{start}]",this))}),e(o,Vn),e(l,Vn),e(w,Vn),e(xe,Vn),e(O,function(){return this.value}),e(f,function(e,i,r,o){var s=this.left;if(!i){if(!(s instanceof en))return this;if(!qn(s,"_eval")){if(!s.fixed)return this;var a=s.definition();if(!a.fixed)return this;if(a.undeclared)return this;if(a.last_ref!==s)return this;if("m"==a.single_use)return this;if(this.right.has_side_effects(e))return this}}var f,c=this.operator;f=!qn(s,"_eval")&&s instanceof en&&s.fixed&&s.definition().fixed?s:"="==c?this.right:Yn(p,this,{operator:c.slice(0,-1),left:s,right:this.right}),s.walk(n);var u=f._eval(e,i,r,o);return"object"==typeof u?this:(t(s),u)}),e(Ce,function(e,t,i,r){if(!t)return this;for(var o=this.expressions,s=0,a=o.length-1;s<a;s++)o[s].walk(n);var f=o[a],c=f._eval(e,t,i,r);return c===f?this:c}),e(he,function(e){if(e.option("unsafe")){var n=function(){};return n.node=this,n.toString=function(){return"function(){}"},n}return this}),e(s,function(e,n,t,i){if(e.option("unsafe")){for(var r=[],o=0;o<this.elements.length;o++){var s=this.elements[o];if(s instanceof ae)return this;var a=s._eval(e,n,t,i);if(s===a)return this;r.push(a)}return r}return this}),e(Te,function(e,n,t,i){if(e.option("unsafe")){for(var r={},o=0;o<this.properties.length;o++){var s=this.properties[o];if(!(s instanceof Ee))return this;var a=s.key;if(a instanceof xe&&(a=a._eval(e,n,t,i))===s.key)return this;switch(a){case"__proto__":case"toString":case"valueOf":return this}if(r[a]=s.value._eval(e,n,t,i),r[a]===s.value)return this}return r}return this});var i=Mn("! typeof void");e(un,function(e,r,o,s){var a=this.expression,f=this.operator;if(e.option("typeofs")&&"typeof"==f&&(a instanceof he||a instanceof en&&a.fixed_value()instanceof he))return"function";var c=a instanceof en&&a.definition();i[f]||c&&c.fixed||s++,a.walk(n);var u=a._eval(e,r,o,s);if(u===a){if(r&&"void"==f)return;return this}switch(f){case"!":return!u;case"typeof":return u instanceof RegExp?this:typeof u;case"void":return;case"~":return~u;case"-":return-u;case"+":return+u;case"++":case"--":if(!c)return this;if(!r){if(c.undeclared)return this;if(c.last_ref!==a)return this}return qn(a,"_eval")&&(u=+(f[0]+1)+ +u),t(a),u}return this}),e(cn,function(e,i,r,o){var s=this.expression;if(s instanceof en){if(!qn(s,"_eval")){if(!s.fixed)return this;if(!i){var a=s.definition();if(!a.fixed)return this;if(a.undeclared)return this;if(a.last_ref!==s)return this}}}else if(!i)return this;s instanceof en&&s.definition().fixed||o++,s.walk(n);var f=s._eval(e,i,r,o);return f===s?this:(t(s),+f)});var r=Mn("&& || === !==");e(p,function(e,n,t,i){r[this.operator]||i++;var o=this.left._eval(e,n,t,i);if(o===this.left)return this;if(this.operator==(o?"||":"&&"))return o;var s,a=n&&!(o&&"object"==typeof o),f=this.right._eval(e,a,t,i);if(f===this.right)return this;switch(this.operator){case"&&":s=o&&f;break;case"||":s=o||f;break;case"??":s=null==o?f:o;break;case"|":s=o|f;break;case"&":s=o&f;break;case"^":s=o^f;break;case"+":s=o+f;break;case"-":s=o-f;break;case"*":s=o*f;break;case"/":s=o/f;break;case"%":s=o%f;break;case"<<":s=o<<f;break;case">>":s=o>>f;break;case">>>":s=o>>>f;break;case"==":s=o==f;break;case"===":s=o===f;break;case"!=":s=o!=f;break;case"!==":s=o!==f;break;case"<":s=o<f;break;case"<=":s=o<=f;break;case">":s=o>f;break;case">=":s=o>=f;break;case"**":s=Math.pow(o,f);break;case"in":if(f&&"object"==typeof f&&qn(f,o)){s=!0;break}default:return this}if(isNaN(s))return e.find_parent(vn)?this:s;if(e.option("unsafe_math")&&!n&&s&&"number"==typeof s&&("+"==this.operator||"-"==this.operator)){var c=Math.max(0,u(o),u(f));if(c<16)return+s.toFixed(c)}return s;function u(e){var n=/(\.[0-9]*)?(e[^e]+)?$/.exec(+e);return(n[1]||".").length-1-(n[2]||"").slice(1)}}),e(D,function(e,n,t,i){var r=this.condition._eval(e,n,t,i);if(r===this.condition)return this;var o=r?this.consequent:this.alternative,s=o._eval(e,n,t,i);return s===o?this:s}),e(en,function(e,n,t,i){var r,o=this.fixed_value();if(!o)return this;if(qn(o,"_eval"))r=o._eval();else{if(this._eval=Vn,r=o._eval(e,n,t,i),delete this._eval,r===o)return this;o._eval=function(){return r},t.push(o)}return r&&"object"==typeof r&&!function(e,n){var t=e.definition().escaped;switch(t.length){case 0:return!0;case 1:var i=!1;return t[0].walk(new mn(function(n){return!!i||(n===e?i=!0:n instanceof Me||void 0)})),i;default:return n<=t.depth}}(this,i)?this:r});var c={Array:Array,Math:Math,Number:Number,Object:Object,String:String},u=At({Math:["E","LN10","LN2","LOG2E","LOG10E","PI","SQRT1_2","SQRT2"],Number:["MAX_VALUE","MIN_VALUE","NaN","NEGATIVE_INFINITY","POSITIVE_INFINITY"]}),d=Mn("global ignoreCase multiline source");function h(e,n,t,i,r){for(var o=[],s=0;s<e.length;s++){var a=e[s],f=a._eval(n,t,i,r);if(a===f)return;o.push(f)}return o}e(Oe,function(e,n,t,i){if(e.option("unsafe")){var r,o=this.expression;if(!pt(o)&&(null==(r=o._eval(e,n,t,i+1))||r===o))return this;var s=this.property;if(s instanceof xe&&(s=s._eval(e,n,t,i))===this.property)return this;if(void 0===r){var a=u[o.name];if(!a||!a[s])return this;r=c[o.name]}else if(r instanceof RegExp){if(!d[s])return this}else if("object"==typeof r){if(!qn(r,s))return this}else if("function"==typeof r)switch(s){case"name":return r.node.name?r.node.name.name:"";case"length":return r.node.length();default:return this}return r[s]}return this}),e(m,function(e,t,i,r){var o=this.expression,s=o instanceof en?o.fixed_value():o;if(s instanceof a||s instanceof N||s instanceof se){if(s.evaluating)return this;if(s.name&&s.name.definition().recursive_refs>0)return this;if(this.is_expr_pure(e))return this;var f=h(this.args,e,t,i,r);if(!An(s.argnames,function(n,o){if(n instanceof j){if(!f)return!1;if(void 0===f[o]){var s=n.value._eval(e,t,i,r);if(s===n.value)return!1;f[o]=s}n=n.name}return!(n instanceof I)}))return this;if(s.rest instanceof I)return this;if(!f&&!t)return this;var u=s.first_statement();if(!(u instanceof Fe)){if(t){s.walk(n);var l=!1;if(s.evaluating=!0,En(s,new mn(function(n){return!!l||(n instanceof Fe?(n.value&&void 0!==n.value._eval(e,!0,i,r)&&(l=!0),!0):n instanceof Me&&n!==s||void 0)})),s.evaluating=!1,!l)return}return this}if(!(d=u.value))return;var p=[];return(!f||An(s.argnames,function(e,n){return b(e,f[n])})&&(!s.rest||b(s.rest,f.slice(s.argnames.length)))||t)&&(t&&s.argnames.forEach(function(e){e instanceof j&&e.value.walk(n)}),s.evaluating=!0,d=d._eval(e,t,i,r),s.evaluating=!1),p.forEach(function(e){delete e._eval}),d===u.value?this:d}if(e.option("unsafe")&&o instanceof Oe){var d,v=o.property;if(v instanceof xe&&(v=v._eval(e,t,i,r))===o.property)return this;var _=o.expression;if(pt(_)){var g=Mt[_.name];if(!g||!g[v])return this;d=c[_.name]}else{if(null==(d=_._eval(e,t,i,r+1))||d===_)return this;var m=Ft[d.constructor.name];if(!m||!m[v])return this;if(d instanceof RegExp&&d.global&&!(_ instanceof qe))return this}if(!(f=h(this.args,e,t,i,r)))return this;if("replace"==v&&"function"==typeof f[1])return this;try{return d[v].apply(d,f)}catch(e){xe.warn("Error evaluating {this} [{start}]",this)}finally{d instanceof RegExp&&(d.lastIndex=0)}}return this;function b(e,n){e instanceof j&&(e=e.name);var t=e.definition();if(t.orig[t.orig.length-1]!==e)return!1;var i=n;return t.references.forEach(function(e){e._eval=function(){return i},p.push(e)}),!0}}),e(ye,Vn),e(nn,function(e,n,t,i){if(!e.option("templates"))return this;if(this.tag){if(!Ai(e,this.tag))return this;f=function(e){return e}}var r=h(this.expressions,e,n,t,i);if(!r)return this;for(var o=!1,s=f(this.strings[0]),a=0;a<r.length;a++)s+=r[a]+f(this.strings[a+1]);return o?(this._eval=Vn,this):s;function f(e){return"string"!=typeof(e=Di(e))&&(o=!0),e}})}(function(e,n){e.DEFMETHOD("_eval",n)}),function(e){function n(e){return Yn(un,e,{operator:"!",expression:e})}function t(e,t,i){var r=n(e);return i?Tt(r,Yn(je,t,{body:t}))===r?r:t:Tt(r,t)}e(xe,function(){return n(this)}),e(He,function(){throw new Error("Cannot negate a statement")}),e(p,function(e,i){var r=this.clone(),o=this.operator;if(e.option("unsafe_comps"))switch(o){case"<=":return r.operator=">",r;case"<":return r.operator=">=",r;case">=":return r.operator="<",r;case">":return r.operator="<=",r}switch(o){case"==":return r.operator="!=",r;case"!=":return r.operator="==",r;case"===":return r.operator="!==",r;case"!==":return r.operator="===",r;case"&&":return r.operator="||",r.left=r.left.negate(e,i),r.right=r.right.negate(e),t(this,r,i);case"||":return r.operator="&&",r.left=r.left.negate(e,i),r.right=r.right.negate(e),t(this,r,i)}return n(this)}),e(k,function(){return n(this)}),e(D,function(e,n){var i=this.clone();return i.consequent=i.consequent.negate(e),i.alternative=i.alternative.negate(e),t(this,i,n)}),e(_e,function(){return n(this)}),e(Ce,function(e){var n=this.expressions.slice();return n.push(n.pop().negate(e)),Bn(this,n)}),e(un,function(){return"!"==this.operator?this.expression:n(this)})}(function(e,n){e.DEFMETHOD("negate",function(e,t){return n.call(this,e,t)})});var jt=Mn("Boolean decodeURI decodeURIComponent Date encodeURI encodeURIComponent Error escape EvalError isFinite isNaN Number Object parseFloat parseInt RangeError ReferenceError String SyntaxError TypeError unescape URIError"),Pt=Mn("Map Set WeakMap WeakSet");function Ht(e){return e&&e.aborts()}m.DEFMETHOD("is_expr_pure",function(e){if(e.option("unsafe")){var n=this.expression;if(pt(n)){if(jt[n.name])return!0;if(this instanceof ye&&Pt[n.name])return!0}if(Ct(n))return!0}return e.option("annotations")&&this.pure||!e.pure_funcs(this)}),nn.DEFMETHOD("is_expr_pure",function(e){var n=this.tag;if(!n)return!0;if(e.option("unsafe")){if(pt(n)&&jt[n.name])return!0;if(n instanceof G&&pt(n.expression)){var t=Mt[n.expression.name];return t&&(t[n.property]||"Math"==n.expression.name&&"random"==n.property)}}return!e.pure_funcs(this)}),xe.DEFMETHOD("is_call_pure",Rn),m.DEFMETHOD("is_call_pure",function(e){if(!e.option("unsafe"))return!1;var n=this.expression;if(!(n instanceof G))return!1;var t,i=n.expression,r=n.property;if(i instanceof s)t=Ft.Array;else if(i.is_boolean(e))t=Ft.Boolean;else if(i.is_number(e))t=Ft.Number;else if(i instanceof qe)t=Ft.RegExp;else if(i.is_string(e)){if(t=Ft.String,"replace"==r){var o=this.args[1];if(o&&!o.is_string(e))return!1}}else n.may_throw_on_access(e)||(t=Ft.Object);return t&&t[r]}),function(e){e(xe,Rn),e(s,Un),e(f,function(){switch(this.operator){case"=":return this.right.safe_to_spread();case"&&=":case"||=":case"??=":return this.left.safe_to_spread()&&this.right.safe_to_spread()}return!0}),e(p,function(){return!kt[this.operator]||this.left.safe_to_spread()&&this.right.safe_to_spread()}),e(O,Un),e(he,Un),e(Te,function(){return An(this.properties,function(e){return!(e instanceof AST_ObjectGetter||e instanceof Pe)})}),e(Ce,function(){return this.tail_node().safe_to_spread()}),e(en,function(){var e=this.fixed_value();return e&&e.safe_to_spread()}),e(fn,Un)}(function(e,n){e.DEFMETHOD("safe_to_spread",n)}),function(e){function n(e,n,t){return!An(e,t?function(e){return e instanceof Pe?!t(e,n):!e.has_side_effects(n)}:function(e){return!e.has_side_effects(n)})}function t(e,n){var t=e.expression;return!t.is_string(n)||t.has_side_effects(n)}e(xe,Un),e(s,function(e){return n(this.elements,e,t)}),e(f,function(e){var n=this.left;if(!(n instanceof Oe))return!0;var t=n.expression;return!(t instanceof Ae)||!t.scope.resolve().new||n instanceof Ye&&n.property.has_side_effects(e)||this.right.has_side_effects(e)}),e(p,function(e){return this.left.has_side_effects(e)||this.right.has_side_effects(e)||!yi(this.operator,this.right,e)}),e(d,function(e){return n(this.body,e)}),e(m,function(e){return!(this.is_expr_pure(e)||this.is_call_pure(e)&&!this.expression.has_side_effects(e))||n(this.args,e,t)}),e(b,function(e){return this.expression.has_side_effects(e)||n(this.body,e)}),e(w,function(e){var t=this.extends;return!(!t||(t instanceof en&&(t=t.fixed_value()),r(t)))||n(this.properties,e)}),e(E,function(e){return this.key instanceof xe&&this.key.has_side_effects(e)||this.static&&this.value&&this.value.has_side_effects(e)}),e(D,function(e){return this.condition.has_side_effects(e)||this.consequent.has_side_effects(e)||this.alternative.has_side_effects(e)}),e(O,Rn),e(H,function(e){return n(this.definitions,e)}),e(R,function(e){return n(this.elements,e)}),e(L,function(e){return this.key instanceof xe&&this.key.has_side_effects(e)||this.value.has_side_effects(e)}),e(U,function(e){return n(this.properties,e)}),e(G,function(e){return this.expression.may_throw_on_access(e)||this.expression.has_side_effects(e)}),e($,Rn),e(fe,function(e){return this.condition.has_side_effects(e)||this.body&&this.body.has_side_effects(e)||this.alternative&&this.alternative.has_side_effects(e)}),e(de,function(e){return this.body.has_side_effects(e)}),e(he,Rn),e(Te,function(e){return n(this.properties,e,function(e,n){var t=e.expression;return!t.safe_to_spread()||t.has_side_effects(n)})}),e(Ae,Rn),e(Se,function(e){return this.key instanceof xe&&this.key.has_side_effects(e)||this.value.has_side_effects(e)}),e(Ce,function(e){return n(this.expressions,e)}),e(je,function(e){return this.body.has_side_effects(e)}),e(Ye,function(e){return this.expression.may_throw_on_access(e)||this.expression.has_side_effects(e)||this.property.has_side_effects(e)}),e(Ie,function(e){return this.expression.has_side_effects(e)||n(this.body,e)}),e(Ge,Rn),e(en,function(e){return!this.is_declared(e)||!A(this,e)}),e(nn,function(e){return!this.is_expr_pure(e)||n(this.expressions,e)}),e(an,function(e){return n(this.body,e)||this.bcatch&&this.bcatch.has_side_effects(e)||this.bfinally&&this.bfinally.has_side_effects(e)}),e(fn,function(e){return unary_side_effects[this.operator]||this.expression.has_side_effects(e)}),e(dn,function(){return this.value})}(function(e,n){e.DEFMETHOD("has_side_effects",n)}),function(e){function n(e,n){for(var t=e.length;--t>=0;)if(e[t].may_throw(n))return!0;return!1}function t(e,t){return!!e.may_throw(t)||(e instanceof en&&(e=e.fixed_value()),!(e instanceof he)||(!!n(e.argnames,t)||(!!n(e.body,t)||kn(e)&&e.value&&e.value.may_throw(t))))}e(xe,Un),e(O,Rn),e($,Rn),e(he,Rn),e(Ae,Rn),e(Ge,Rn),e(s,function(e){return n(this.elements,e)}),e(f,function(e){return!!this.right.may_throw(e)||!(!e.has_directive("use strict")&&"="==this.operator&&this.left instanceof en)&&this.left.may_throw(e)}),e(u,function(e){return this.expression.may_throw(e)}),e(p,function(e){return this.left.may_throw(e)||this.right.may_throw(e)||!yi(this.operator,this.right,e)}),e(d,function(e){return n(this.body,e)}),e(m,function(e){if(n(this.args,e))return!0;if(this.is_expr_pure(e))return!1;this.may_throw=Un;var i=t(this.expression,e);return delete this.may_throw,i}),e(b,function(e){return this.expression.may_throw(e)||n(this.body,e)}),e(D,function(e){return this.condition.may_throw(e)||this.consequent.may_throw(e)||this.alternative.may_throw(e)}),e(j,function(e){return this.name.may_throw(e)||this.value&&this.value.may_throw(e)}),e(H,function(e){return n(this.definitions,e)}),e(G,function(e){return!this.optional&&this.expression.may_throw_on_access(e)||this.expression.may_throw(e)}),e(re,function(e){if(this.init.may_throw(e))return!0;var n=this.object;return!!n.may_throw(e)||(!((n=n.tail_node())instanceof s||n.is_string(e))||this.body.may_throw(e))}),e(fe,function(e){return this.condition.may_throw(e)||this.body&&this.body.may_throw(e)||this.alternative&&this.alternative.may_throw(e)}),e(de,function(e){return this.body.may_throw(e)}),e(Te,function(e){return n(this.properties,e)}),e(Se,function(e){return this.value.may_throw(e)||this.key instanceof xe&&this.key.may_throw(e)}),e(Fe,function(e){return this.value&&this.value.may_throw(e)}),e(Ce,function(e){return n(this.expressions,e)}),e(je,function(e){return this.body.may_throw(e)}),e(Ye,function(e){return!this.optional&&this.expression.may_throw_on_access(e)||this.expression.may_throw(e)||this.property.may_throw(e)}),e(Ie,function(e){return this.expression.may_throw(e)||n(this.body,e)}),e(en,function(e){return!this.is_declared(e)||!A(this,e)}),e(nn,function(e){if(n(this.expressions,e))return!0;if(this.is_expr_pure(e))return!1;if(!this.tag)return!1;this.may_throw=Un;var i=t(this.tag,e);return delete this.may_throw,i}),e(an,function(e){return(this.bcatch?this.bcatch.may_throw(e):n(this.body,e))||this.bfinally&&this.bfinally.may_throw(e)}),e(fn,function(e){return this.expression.may_throw(e)&&!("typeof"==this.operator&&this.expression instanceof en)}),e(dn,function(e){return this.name.may_throw(e)||this.value&&this.value.may_throw(e)})}(function(e,n){e.DEFMETHOD("may_throw",n)}),function(e){function n(e,n){for(var t=e.length;--t>=0;)if(!e[t].is_constant_expression(n))return!1;return!0}e(xe,Rn),e(s,function(e){return n(this.elements,e)}),e(p,function(e){return this.left.is_constant_expression(e)&&this.right.is_constant_expression(e)&&yi(this.operator,this.right)}),e(w,function(e){var t=this.extends;return!(t&&!r(t))&&n(this.properties,e)}),e(E,function(e){return"string"==typeof this.key&&(!this.value||this.value.is_constant_expression(e))}),e(O,Un),e(he,function(e){var n=this,t=!0,i=[];return n.walk(new mn(function(r,o){if(!t)return!0;if(r instanceof h){if(r===n)return;return i.push(r),o(),i.pop(),!0}if(r instanceof en){if(n.inlined||r.redef||r.in_arg)return t=!1,!0;if(n.variables.has(r.name))return!0;var s=r.definition();if(jn(s.scope,i))return!0;if(e&&!s.redefined()){var a=e.find_variable(r.name);if(a?a===s:s.undeclared)return t="f",!0}return t=!1,!0}return r instanceof Ae?(kn(n)&&An(i,function(e){return!(e instanceof Me)||kn(e)})&&(t=!1),!0):void 0})),t}),e(Te,function(e){return n(this.properties,e)}),e(Se,function(e){return"string"==typeof this.key&&this.value.is_constant_expression(e)}),e(fn,function(e){return this.expression.is_constant_expression(e)})}(function(e,n){e.DEFMETHOD("is_constant_expression",n)}),function(e){function n(){var e=this.body.length;return e>0&&Ht(this.body[e-1])}e(He,Ln),e(pe,Vn),e(v,n),e(Re,n),e(fe,function(){return this.alternative&&Ht(this.body)&&Ht(this.alternative)&&this})}(function(e,n){e.DEFMETHOD("aborts",n)});var Nt=Mn(["use asm","use strict"]);function Yt(e,n,t){switch(e.body.length){case 0:return t?List.skip:Yn($,e);case 1:var i=e.body[0];return ot(i)?n instanceof le&&i instanceof ve?e:i:e}return e}function It(e,n){n.option("rests")&&(e.uses_arguments||e.rest instanceof R&&n.drop_fargs(e,n.parent())&&(e.argnames=e.argnames.concat(e.rest.elements),e.rest=e.rest.rest))}function Rt(e,n){if(!n.option("arrows"))return e;It(e,n),e.value&&(e.body=[e.first_statement()]);var t=yt(e.body,n);switch(t.length){case 1:var i=t[0];if(i instanceof Fe){e.body.length=0,e.value=i.value;break}default:e.body=t,e.value=null}return e}e(V,function(e,n){return!n.option("directives")||Nt[e.value]&&n.has_directive(e.value)===e?e:Yn($,e)}),e(F,function(e,n){return n.option("drop_debugger")?Yn($,e):e}),e(de,function(e,n){if(e.body instanceof fe||e.body instanceof g){var t=yt([e.body],n);switch(t.length){case 0:e.body=Yn($,e);break;case 1:e.body=t[0];break;default:e.body=Yn(v,e,{body:t})}}return n.option("unused")&&0==e.label.references.length?e.body:e}),e(me,function(e,n){if(!n.option("dead_code"))return e;var t=e.label;if(t){var i=n.loopcontrol_target(e);e.label=null,n.loopcontrol_target(e)===i?In(t.thedef.references,e):e.label=t}return e}),e(d,function(e,n){return e.body=yt(e.body,n),e}),e(v,function(e,n){return e.body=yt(e.body,n),Yt(e,n.parent())}),e(he,function(e,n){return It(e,n),e.body=yt(e.body,n),e}),e(a,Rt),e(c,Rt),e(se,function(e,n){It(e,n),e.body=yt(e.body,n);var t=n.parent();if(n.option("inline"))for(var i=0;i<e.body.length;i++){var r=e.body[i];if(!(r instanceof V)){if(r instanceof Fe){if(i!=e.body.length-1)break;var o=r.value;if(!o||"Call"!=o.TYPE)break;if(o.is_expr_pure(n))break;var s,a=o.expression;if(a instanceof en){if(e.name&&e.name.definition()===a.definition())break;s=a.fixed_value()}else s=a;if(!(s instanceof N||s instanceof se))break;if(s.rest)break;if(s.uses_arguments)break;if(s===a){if(s.parent_scope!==e)break;if(!An(s.enclosed,function(n){return n.scope!==e}))break}if((s!==a||s.name)&&(t instanceof AST_ClassMethod||t instanceof De)&&t.value===n.self())break;if(s.contains_this())break;var f=s.argnames.length;if(f>0&&n.option("inline")<2)break;if(f>e.argnames.length)break;if(!An(e.argnames,function(e){return e instanceof Xe}))break;if(!An(o.args,function(e){return!(e instanceof Pe)}))break;for(var c=0;c<f;c++){var u=o.args[c];if(!(u instanceof en))break;if(u.definition()!==e.argnames[c].definition())break}if(c<f)break;for(;c<o.args.length&&!o.args[c].has_side_effects(n);c++);if(c<o.args.length)break;if(f<e.argnames.length&&!n.drop_fargs(e,t)){if(!n.drop_fargs(s,o))break;do{s.argnames.push(s.make_var(Xe,s,"argument_"+f))}while(++f<e.argnames.length)}return a}break}}return e});var Lt=Mn("arguments await yield");function Ut(e,n){for(var t=n.length;--t>=0;)n[t]||(n[t]=Yn(ae,e))}function Vt(e,n){var t=Yn(k,e);return t.name&&(t.name=n?null:Yn(AST_SymbolClass,t.name)),t}function Bt(e,n){var t;switch(e.CTOR){case AST_AsyncDefun:t=AST_AsyncFunction;break;case AST_AsyncGeneratorDefun:t=AST_AsyncGeneratorFunction;break;case N:t=se;break;case AST_GeneratorDefun:t=AST_GeneratorFunction}var i=Yn(t,e);return i.name=n?null:Yn(Ke,e.name),i}function Gt(e,n){e.walk(new mn(function(t){return t instanceof Fe?(n(t),!0):t instanceof Me&&t!==e||void 0}))}function Wt(e){var n=Object.create(null);return Gt(e,function(e){var t=e.value;if(t&&(t=t.tail_node()),t instanceof en){var i=t.definition().id;n[i]=(n[i]||0)+1}}),n}function $t(e,n,t){if(t.exposed(e))return!1;switch(e.references.length-e.replaced-(n[e.id]||0)){case e.drop_return:return"d";case e.bool_return:return!0}}function Xt(e,n){Gt(e,function(e){e.in_bool=!0;var t=e.value;if(t){var i=ei(n,t);i?i instanceof xe||(t=t.drop_side_effect_free(n),e.value=t?Bn(e.value,[t,Yn(ke,e.value,{value:1})]):Yn(ke,e.value,{value:1})):(t=t.drop_side_effect_free(n),e.value=t?Bn(e.value,[t,Yn(ke,e.value,{value:0})]):null)}})}function Jt(e,n){if(!e.name||!n.option("ie"))return!0;var t=e.name.definition();return!n.exposed(t)&&An(t.references,function(e){return!(e instanceof en)})}function Kt(e,n,t){if(n instanceof he){var i=kn(n),r=is_async(n),o=!1,s=!1;if(i&&e.option("arrows"))if(n.value){if(!r||xi(e,n.value)){var f=n.value.drop_side_effect_free(e);f!==n.value&&(o=!0,n.value=f)}}else s=!0;else if(!Tn(n))if(!t&&n.name){var l=n.name.definition();s=l.references.length==l.replaced}else s=!0;if(s&&(n.process_expression(!1,function(n){var t=n.value;if(t){if(r&&!xi(e,t))return n;t=t.drop_side_effect_free(e,!0)}return o=!0,t?Yn(je,n,{body:t}):Yn($,n)}),Gt(n,function(n){var t=n.value;if(t){if(r&&!xi(e,t))return;var i=t.drop_side_effect_free(e);i!==t&&(o=!0,i&&r&&!xi(e,i)&&(i=i.negate(e)),n.value=i)}})),r&&e.option("awaits")){s&&n.process_expression("awaits",function(n){var t=n.body;if(t instanceof u){if(xi(e,t.expression)){if(o=!0,!(t=t.expression.drop_side_effect_free(e,!0)))return Yn($,n);n.body=t}}else if(t instanceof Ce){for(var i=t.expressions,r=i.length;--r>=0;){var s=i[r];if(!(s instanceof u))break;var a=s.expression;if(!xi(e,a))break;if(o=!0,i[r]=a.drop_side_effect_free(e))break}switch(r){case-1:return Yn($,n);case 0:n.body=i[0];break;default:i.length=r+1}}return n});var p=!s&&n.name||i&&n.value&&!xi(e,n.value),d=new mn(function(t){return!!p||(d.parent()===n&&t.may_throw(e)?p=!0:t instanceof u?p=!0:t instanceof AST_ForAwaitOf?p=!0:t instanceof Fe?t.value&&!xi(e,t.value)?p=!0:void 0:t instanceof Me&&t!==n||void 0)});if(n.walk(d),!p){var h;switch(n.CTOR){case c:h=a;break;case AST_AsyncFunction:h=se;break;case AST_AsyncGeneratorFunction:h=AST_GeneratorFunction}return Yn(h,n)}}return o&&n.clone()}}function Qt(e,n,t){t||(t=me);var i=!1,r=new mn(function(n){return!!(i||n instanceof Me)||(n instanceof t&&r.loopcontrol_target(n)===e?i=!0:void 0)});return n instanceof de&&r.push(n),r.push(e),e.body.walk(r),i}function Zt(e,n,t){if(e instanceof Ce&&(e=e.tail_node()),e instanceof p)if(e.left instanceof Ne){if(e.right instanceof un&&"typeof"==e.right.operator){var i=e.right.expression;if(pt(i)){var r,o="undefined"==e.left.value;switch(e.operator){case"==":r=o?t:n;break;case"!=":r=o?n:t;break;default:return}if(r){var s,a=!1,c=i.definition(),u=[],l=[],d=new mn(function(e,n){if(a)return!0;if(e instanceof f){var t=e.left;if(!(t instanceof en&&t.definition()===c))return;switch(e.right.walk(d),e.operator){case"=":case"&&=":a=!0}return!0}if(e instanceof m)return n(),(s=e.expression.tail_node())instanceof en&&(s=s.fixed_value(),i=u.length),s instanceof he?Hn(l,s)&&s.walk(d):a=!0,i>=0&&(u.length=i),!0;if(e instanceof W){var i=u.length;return n(),a&&(u.length=i),!0}if(e instanceof ie){e.init&&e.init.walk(d);i=u.length;return e.condition&&e.condition.walk(d),e.body.walk(d),e.step&&e.step.walk(d),a&&(u.length=i),!0}if(e instanceof re){e.object.walk(d);i=u.length;return e.init.walk(d),e.body.walk(d),a&&(u.length=i),!0}if(e instanceof Me){if(e===s)return;return!0}return e instanceof en?(e.definition()===c&&u.push(e),!0):void 0});r.walk(d),u.forEach(function(e){e.defined=!0})}}}}else switch(e.operator){case"&&":Zt(e.left,n),Zt(e.right,n);break;case"||":Zt(h(e.left),t),Zt(h(e.right),t)}function h(e){if(e instanceof p)switch(e.operator){case"==":return(e=e.clone()).operator="!=",e;case"!=":return(e=e.clone()).operator="==",e}}}function ei(e,n,t){return!!n.truthy||(wt(n)?void 0:!(n.falsy&&!t)&&(!!n.is_truthy()||n.evaluate(e,!0)))}function ni(e,n){var t,i=0,r=!1,o=e.self();if(!is_statement(o))for(;;){if(t=o,(o=e.parent(i++))instanceof p)switch(t){case o.left:if(kt[o.operator])continue;break;case o.right:if(a(o.left))switch(o.operator){case"&&":n[r?"falsy":"truthy"]=!0;break;case"||":case"??":n[r?"truthy":"falsy"]=!0}}else if(o instanceof D){var s=o.condition;if(s===t)continue;if(a(s))switch(t){case o.consequent:n[r?"falsy":"truthy"]=!0;break;case o.alternative:n[r?"truthy":"falsy"]=!0}}else{if(o instanceof X)break;if(o instanceof fe)break;if(o instanceof Ce){if(o.expressions[0]===t)continue}else if(o instanceof je)break}return}for(;;){if(t=o,(o=e.parent(i++))instanceof v){if(o.body[0]===t)continue}else if(o instanceof fe&&a(o.condition))switch(t){case o.body:n[r?"falsy":"truthy"]=!0;break;case o.alternative:n[r?"truthy":"falsy"]=!0}return}function a(e){return!!n.equals(e)||e instanceof un&&("!"==e.operator&&(!!n.equals(e.expression)&&(r=!0,!0)))}}function ti(e){return function(n,t){var i=!1;return this.definitions.forEach(function(r){r.value&&(i=!0),r.name.match_symbol(function(i){i instanceof Ge&&t.push(Yn(dn,i,{name:i,value:e(n,i)}))},!0)}),i}}function ii(e){return"arguments"!=e.name&&e.orig.length<(e.orig[0]instanceof Ke?3:2)}function ri(e,n){if(e.exposed(n))return!0;for(var t=n.scope.resolve(),i=n.scope;i!==t;)if((i=i.parent_scope).var_names().has(n.name))return!0}function oi(e,n){return Yn(pn,e,{definitions:e.definitions.map(function(e){return Yn(dn,e,{name:e.name.convert_symbol(AST_SymbolVar,function(e,t){var i=e.definition();i.orig[i.orig.indexOf(t)]=e,i.scope!==n&&(i.scope=n,n.variables.set(i.name,i),n.enclosed.push(i),n.var_names().set(i.name,!0))}),value:e.value})})})}function si(e,n){var t=n.definition();return(t.fixed||0===t.fixed)&&ii(t)&&Si(t)&&!ri(e,t)}function ai(e,n){return n.option("varify")&&An(e.definitions,function(e){return!e.name.match_symbol(function(e){if(e instanceof Ge)return!si(n,e)},!0)})?oi(e,n.find_parent(Me)):e}function fi(e,n){if(n.option("optional_chains")&&e.terminal)do{var t=e.expression;if(e.optional){var i=ei(n,t,!0);if(null==i)return Yn(un,e,{operator:"void",expression:t}).optimize(n);i instanceof xe||(e.optional=!1)}e=t}while(("Call"==e.TYPE||e instanceof Oe)&&!e.terminal)}function ci(e,n){var t=e.expression;if(!(t instanceof Ce))return e;var i=t.expressions.slice(),r=e.clone();return r.expression=i.pop(),i.push(r),Bn(e,i)}function ui(e,n,t){var i=e.expression,r=i instanceof en?i.fixed_value():i;if(r instanceof he&&!r.uses_arguments&&!(r.pinned()||t&&t.indexOf(r)<0)){var o=e.args;if(An(o,function(e){return!(e instanceof Pe)})){var a=r.argnames,f=r===i&&!r.name;if(r.rest){if(!f||!n.option("rests"))return;var c=a.length;for(o=o.slice(0,c);o.length<c;)o.push(Yn(ln,e).optimize(n));o.push(Yn(s,e,{elements:e.args.slice(c)})),a=a.concat(r.rest),r.rest=null}else o=o.slice(),a=a.slice();for(var u=0,l=0,p=f&&n.option("default_values"),d=f&&n.drop_fargs(r,e)?function(e,t){return!e||(e instanceof R?0==e.elements.length&&!e.rest&&t instanceof s:e instanceof U?0==e.properties.length&&!e.rest&&t&&!t.may_throw_on_access(n):e.unused)}:Rn,h=[],v=0;v<o.length;v++){var _=a[v];if(p&&_ instanceof j&&o[v].is_defined(n)&&(a[v]=_=_.name),_&&void 0===_.unused){if(d(_,o[v])){g=o[v].drop_side_effect_free(n);a.splice(v,1),o.splice(v,1),g&&h.push(g),v--;continue}h.push(o[v]),o[u++]=Bn(e,h),h=[]}else{var g=o[v].drop_side_effect_free(n);if(d(_)){_&&a.splice(v,1),o.splice(v,1),g&&h.push(g),v--;continue}if(g)h.push(g),o[u++]=Bn(e,h),h=[];else if(_){if(!h.length){o[u++]=Yn(ke,o[v],{value:0});continue}o[u++]=Bn(e,h),h=[]}}l=u}for(;v<a.length;v++)d(a[v])&&a.splice(v--,1);if(r.argnames=a,o.length=l,e.args=o,h.length){var m=Bn(e,h);o.push(o.length<a.length?Yn(un,e,{operator:"void",expression:m}):m)}}}}function li(e,n){n||(n=e.find_parent(Me));var t=[];return(is_async(n)||n instanceof on&&e.option("module"))&&t.push("await"),Tn(n)&&t.push("yield"),t.length&&Mn(t)}function pi(e,n){if(!n)return!0;var t=!0,i=new mn(function(r){if(!t)return!0;if(r instanceof Me){if(r===e)return;if(kn(r))for(var o=0;t&&o<r.argnames.length;o++)r.argnames[o].walk(i);else r instanceof ve&&n[r.name.name]&&(t=!1);return!0}r instanceof Le&&n[r.name]&&r!==e.name&&(t=!1)});return e.walk(i),t}function di(e,n){return e.in_strict_mode(n)||!n.has_directive("use strict")}function hi(e,n,t,i){if(i instanceof p&&("&&"==i.operator||"||"==i.operator)&&i.right instanceof f&&"="==i.right.operator&&i.right.left instanceof en&&i.right.left.definition()===n&&!t.has_side_effects(e)&&r(i.left)&&r(i.right.right))return n.replaced++,"&&"==i.operator?Yn(D,i,{condition:i.left,consequent:i.right.right,alternative:t}):Yn(D,i,{condition:i.left,consequent:t,alternative:i.right.right});function r(t){if(!t.has_side_effects(e)){var i=!1;return t.walk(new mn(function(e){return!!i||(e instanceof en&&e.definition()===n?i=!0:void 0)})),!i}}}Me.DEFMETHOD("merge_variables",function(e){if(e.option("merge_vars")){var n,t,i=[],r={},o=this,s=[],a=[],c=0,u=new zn,l=Object.create(null),d=Object.create(null),h=new mn(function(s,a){if(s instanceof f){var c=s.left,d=s.right;return c instanceof I?(d.walk(h),O(en,F,c),!0):kt[s.operator.slice(0,-1)]?(c.walk(h),A(),d.walk(h),c instanceof en&&F(c),z(),!0):c instanceof en?("="!=s.operator&&F(c,!0),d.walk(h),F(c),!0):void 0}if(s instanceof p){if(!kt[s.operator])return;return S(s),!0}var v;if(s instanceof g)return(v=h.loopcontrol_target(s))instanceof le||C(v),!0;if(s instanceof m)return(y=s.expression)instanceof _e?(s.args.forEach(function(e){e.walk(h)}),y.walk(h)):(a(),E(y)),!0;if(s instanceof w)return s.name&&s.name.walk(h),s.extends&&s.extends.walk(h),s.properties.filter(function(e){return e.key instanceof xe&&e.key.walk(h),e.value}).forEach(function(e){e.static?e.value.walk(h):(A(),r.block=s,e.value.walk(h),z())}),!0;if(s instanceof D)return S(s.condition,s.consequent,s.alternative),!0;if(s instanceof q)return(v=h.loopcontrol_target(s))instanceof B&&C(v),!0;if(s instanceof B){A(),r.block=s,r.loop=!0;var _=r;return s.body.walk(h),r.inserted===s&&(r=_),s.condition.walk(h),z(),!0}if(s instanceof ie)return s.init&&s.init.walk(h),A(),r.block=s,r.loop=!0,s.condition&&s.condition.walk(h),s.body.walk(h),s.step&&s.step.walk(h),z(),!0;if(s instanceof re)return s.object.walk(h),A(),r.block=s,r.loop=!0,s.init.walk(h),s.body.walk(h),z(),!0;if(s instanceof fe)return S(s.condition,s.body,s.alternative),!0;if(s instanceof de){A(),r.block=s;_=r;return s.body.walk(h),r.inserted===s&&(r=_),z(),!0}if(s instanceof Me){if(A(),r.block=s,s===o&&(t=r),s instanceof he){s.name&&(l[s.name.definition().id]=!1);var b=s.uses_arguments&&!h.has_directive("use strict")?function(e){l[e.definition().id]=!1}:function(e){F(e)};i.push(s),s.argnames.forEach(function(e){O(Xe,b,e)}),s.rest&&O(Xe,b,s.rest),i.pop()}return Sn(s,h),z(),!0}if(s instanceof Ye){var y=s.expression;return s.optional?(y.walk(h),A(),s.property.walk(h),z()):a(),E(y),!0}if(s instanceof Ie){s.expression.walk(h);_=r;return s.body.forEach(function(e){e instanceof M||(e.expression.walk(h),_===r&&A())}),r=_,s.body.forEach(function(e){A(),r.block=s;var n=r;En(e,h),r.inserted===s&&(r=n),z()}),!0}if(s instanceof Be||s instanceof Qe)return l[s.definition().id]=!1,!0;if(s instanceof en)return F(s,!0),!0;if(s instanceof an){var x=n;return n=s,En(s,h),s.bcatch&&(s.bcatch.argname&&s.bcatch.argname.mark_symbol(function(e){if(e instanceof Ue){var n=e.definition();l[n.id]=!1,(n=n.redefined())&&(l[n.id]=!1)}},h),s.bfinally||(n=x)?En(s.bcatch,h):(A(),En(s.bcatch,h),z())),n=x,s.bfinally&&s.bfinally.walk(h),!0}if(s instanceof fn){if(!UNARY_POSTFIX[s.operator])return;var k=s.expression;if(!(k instanceof en))return;return F(k,!0),!0}if(s instanceof dn){var T=s.value;return T?T.walk(h):T=r.block instanceof re&&r.block.init===h.parent(),O(Ge,T?function(e){e instanceof AST_SymbolVar?F(e):e.walk(h)}:function(e){if(e instanceof AST_SymbolVar){var n=e.definition().id,t=l[n];t?t.push(e):n in l||u.add(n,e)}else e.walk(h)},s.name),!0}if(s instanceof hn)return A(),r.block=s,r.loop=!0,a(),z(),!0;function E(n){if(e.option("ie")){var t=root_expr(n);t instanceof en&&t.walk(h)}}function S(e,n,t){var i=r,o=[i,i];if(e instanceof p)switch(e.operator){case"&&":o[0]=S(e.left,e.right)[0];break;case"||":case"??":o[1]=S(e.left,null,e.right)[1];break;default:e.walk(h)}else e instanceof D?S(e.condition,e.consequent,e.alternative):e.walk(h);return r=o[0],n&&(A(),n.walk(h)),o[0]=r,r=o[1],t&&(A(),t.walk(h)),o[1]=r,r=i,o}});h.directives=Object.create(e.directives),o.walk(h);for(var v=!1,_=Object.create(null);s.length&&a.length;){var b=a.shift();if(b){var y=b.definition,x=l[y.id];if(x){for(x={end:x.end};y.id in _;)y=_[y.id];x.start=l[y.id].start;var k=[];do{var T=s.shift();if(!(b.index>T.index)){var E=T.definition;if(E.id in d){var S=l[E.id];if(S){if(S.start.block===x.start.block&&H(S,x)&&(!S.start.loop&&Si(y)||H(x,S))&&(!e.option("webkit")||is_funarg(y)===is_funarg(E))&&!E.const_redefs&&An(S.scopes,function(e){return e.find_variable(y.name)===y})){S.forEach(function(e){e.thedef=y,e.name=y.name,e instanceof en?(y.references.push(e),E.replaced++):(y.orig.push(e),E.eliminated++)}),E.fixed||(y.fixed=!1),_[E.id]=y,v=!0;break}k.push(T)}}}}while(s.length);k.length&&(s=k.concat(s))}}}return v}function A(){r=Object.create(r)}function z(){r=Object.getPrototypeOf(r)}function O(e,n,t){var i=new mn(function(t){if(!(t instanceof I))return t instanceof j?(A(),t.value.walk(h),z(),t.name.walk(i)):t instanceof L?t.key instanceof xe?t.value instanceof Oe?(A(),r.block=t,t.key.walk(h),t.value.walk(i),z()):(t.key.walk(h),t.value.walk(i)):t.value.walk(i):t instanceof e?n(t):t.walk(h),!0});t.walk(i)}function F(f,p){var v,_=f.definition();if(p&&!An(i,function(e){return!(v=e.variables.get(f.name))||(!is_funarg(v)||v!==_&&!_.undeclared&&e.parent_scope.find_variable(f.name)!==_)}))return l[_.id]=l[v.id]=!1;var g=r;if(n&&(A(),g=r,z()),_.id in l){if(!(m=l[_.id]))return;if(m.start.block!==g.block)return l[_.id]=!1;if(b(f),m.end=g,_.id in d)a[d[_.id]]=null;else if(!p)return}else{if((v=o.variables.get(_.name))!==_)return v&&t===g&&(l[v.id]=!1),l[_.id]=!1;if(e.exposed(_)||Lt[f.name])return l[_.id]=!1;var m;if((m=u.get(_.id)||[]).scopes=[],b(f),l[_.id]=m,!p)return m.start=g,s.push({index:c++,definition:_});if(g.block!==o)return l[_.id]=!1;m.start=t}function b(e){m.push(e),Hn(m.scopes,e.scope);var n=On(h);n!==e.scope&&Hn(m.scopes,n)}d[_.id]=a.length,a.push({index:c++,definition:_})}function C(e){for(var n=[];;){if(qn(r,"block")){var t=r.block;if(t instanceof de&&(t=t.body),t===e)break}n.push(r),z()}for(r.inserted=r.block,A();n.length;){var i=n.pop();A(),qn(i,"block")&&(r.block=i.block),qn(i,"loop")&&(r.loop=i.loop)}}function P(e,n){return e===n||e.isPrototypeOf(n)}function H(e,n){return P(e.start,e.end)||P(e.start,n.start)}}),Me.DEFMETHOD("drop_unused",function(e){if(e.option("unused")){var n=this,t=!(n instanceof on)||e.toplevel.funcs,i=!(n instanceof on)||e.toplevel.vars,r=/keep_assign/.test(e.option("unused"))?Rn:function(n,t){var i,r=!1;if(n instanceof f?(n.write_only||"="==n.operator)&&(i=s(n.left,t)):n instanceof fn&&n.write_only&&(i=s(n.expression,t)),i instanceof en){var o=i.definition();if(!c[o.id]&&!e.exposed(o)&&A(i,e,r))return i}function s(n,t){if(n instanceof Oe){var i=n.expression;if(!i.may_throw_on_access(e,!0))return r=!0,t&&n instanceof Ye&&t.unshift(n.property),s(i,t)}else if(n instanceof f&&"="==n.operator){n.write_only="p";var o=s(n.right);return t?(t.assign=n,o instanceof en?o:n.left):o}return n}},a=Object.create(null),c=Object.create(null),u=function(t){return(u=function n(t,i,r){var o=e.parent(i);if(!o)return r;var s=o instanceof he&&jn(t,o.argnames);return n(o,i+1,s?function(e){var n=r(e);if(n)return n;if(n=o.variables.get(e)){var t=n.orig[0];if(t instanceof Xe||t instanceof Ke)return n}}:o.variables?function(e){return r(e)||o.variables.get(e)}:r)}(n,0,Pn))(t)},l=Object.create(null),h=[],_=Object.create(null),g=Object.create(null),b=Object.create(null),w=Object.create(null),T=Object.create(null);n instanceof on&&e.top_retain&&n.variables.each(function(n){!e.top_retain(n)||n.id in _||(xe.info("Retaining variable {name}",n),_[n.id]=!0,h.push(n))});var E=new zn,O=new zn,q=this,F=new mn(function(r,o){if(r instanceof he&&r.uses_arguments&&!F.has_directive("use strict")&&r.each_argname(function(e){var n=e.definition();n.id in _||(_[n.id]=!0,h.push(n))}),r!==n){if(q===n){if(r instanceof P){var s=r.name.definition();(u=t&&!s.exported)||s.id in _||(_[s.id]=!0,h.push(s));var a=F.parent()instanceof Z;a?c[s.id]=!0:!u||s.id in g||(g[s.id]=1),r.extends&&r.extends.walk(F);var f=[];return r.properties.forEach(function(e){e.key instanceof xe&&e.key.walk(F);var n=e.value;n&&(vt(e)?(!a&&n.contains_this()&&(a=!0),l(n)):f.push(n))}),f.forEach(u&&a?l:function(e){O.add(s.id,e)}),!0}if(r instanceof ve){var u;s=r.name.definition();return(u=t&&!s.exported)||s.id in _||(_[s.id]=!0,h.push(s)),O.add(s.id,r),F.parent()instanceof Z?(c[s.id]=!0,we(r,o,!0)):(!u||s.id in g||(g[s.id]=1),!0)}if(r instanceof H)return r.definitions.forEach(function(n){var t=n.value,o=t&&(n.name instanceof I||t.has_side_effects(e)),s=o&&"="==t.tail_node().operator;n.name.mark_symbol(function(e){if(e instanceof Ge){var a=e.definition();if(T[a.id]=(T[a.id]||0)+1,r instanceof pn&&a.orig[0]instanceof Ue){var f=a.redefined();f&&(T[f.id]=(T[f.id]||0)+1)}return a.id in _||i&&!a.exported&&(r instanceof z?!a.redefined():!a.const_redefs)&&(r instanceof pn||ii(a))||(_[a.id]=!0,h.push(a)),t&&(o?s&&me(a,e,w[a.id]):O.add(a.id,t),E.add(a.id,n)),pe(a),!0}},F),o&&t.walk(F)}),!0;if(r instanceof Xe){s=r.definition();return T[s.id]=(T[s.id]||0)+1,E.add(s.id,r),!0}if(r instanceof Je)return(s=r.definition()).id in _||i&&ii(s)||(_[s.id]=!0,h.push(s)),!0}return we(r,o,!0)}function l(e){var n=q;q=r,e.walk(F),q=n}});F.directives=Object.create(e.directives),n.walk(F);var M=e.option("keep_fnames")?Rn:e.option("ie")?function(n){return!e.exposed(n)&&n.references.length==n.replaced}:function(e){return!(e.id in _)||!(e.orig.length-e.eliminated<2)&&(e.orig[1]instanceof Xe||An(e.references,function(e){return!e.in_arg}))};e.option("ie")&&O.each(function(e,n){n in _||e.forEach(function(e){e.walk(new mn(function(e){return e instanceof se&&e.name&&!M(e.name.definition())?(e.walk(F),!0):e instanceof Me||void 0}))})}),F=new mn(we);for(var C=0;C<h.length;C++){var Y=O.get(h[C].id);Y&&Y.forEach(function(e){e.walk(F)})}Object.keys(a).forEach(function(e){var n=a[e];if(n){n=n.reduce(function(e,n){return n.forEach(function(n){Hn(e,n)}),e},[]);var t=(E.get(e)||[]).filter(function(e){return find_if(e instanceof fn?function(n){return n===e}:function(n){return n===e||!(n instanceof fn)&&K(n)===K(e)},n)});n.length==t.length?a[e]=t:delete a[e]}else delete a[e]});var L=[],B=[],G=new gn(function(n){if(n instanceof j)return Ae(G,n);if(n instanceof I&&n.rest&&(n.rest=n.rest.transform(G)),n instanceof R){for(var t=!n.rest,i=n.elements.length;--i>=0;){var r=n.elements[i].transform(G);r?(n.elements[i]=r,t=!1):t?n.elements.pop():n.elements[i]=Yn(ae,n.elements[i])}return n}if(n instanceof U){var o=[];return n.properties.forEach(function(t){var i=!1;if(t.key instanceof xe&&(t.key=t.key.transform(W),i=t.key.has_side_effects(e)),(i||n.rest)&&function(e){return(e instanceof j?e.name:e)instanceof Ge}(t.value))t.value=t.value.transform(W),o.push(t);else{var r=t.value.transform(G);!r&&n.rest&&(r=t.value instanceof R?Yn(R,t.value,{elements:[]}):Yn(U,t.value,{properties:[]})),r&&(t.value=r,o.push(t))}}),n.properties=o,n}return n instanceof Ge?Se(n):void 0}),W=new gn(function(c,u,h){var g=W.parent();if(i){var b=[];if(ae=r(c,b)){if(function(e,n){var t=e.definition(),i=_[t.id];return!i||n[n instanceof f?"left":"expression"]===e&&(i===e&&t.references.length-t.replaced==1||le(t,n)<0)}(ae,c)&&(c instanceof f&&(S=be(c),!0===c.write_only&&(S=S.drop_side_effect_free(e))),S||(S=Yn(ke,c,{value:0}))),S){if(b.assign){var w=b.assign.drop_side_effect_free(e);w&&(w.write_only=!0,b.unshift(w))}switch(g instanceof Ce&&g.tail_node()!==c&&!S.has_side_effects(e)||b.push(S),b.length){case 0:return List.skip;case 1:return nt(g,c,b[0].transform(W));default:return Bn(c,b.map(function(e){return e.transform(W)}))}}}else if(c instanceof cn&&c.expression instanceof en&&le(c.expression.definition(),c)<0)return Yn(un,c,{operator:"+",expression:c.expression})}if(c instanceof p&&"instanceof"==c.operator){if(!((ae=c.right)instanceof en))return;if(ae.definition().id in _)return;var E=c.left.drop_side_effect_free(e),S=Yn(ne,c).optimize(e);return E?Bn(c,[E,S]):S}if(c instanceof m)return L.push(c),c.args=c.args.map(function(e){return e.transform(W)}),c.expression=c.expression.transform(W),c;if(q===n){if(t&&c!==n&&c instanceof P)if(!((ce=c.name.definition()).id in _)){X(c.name,"Dropping unused class {name}"),ce.eliminated++,u(c,W);var D=Vt(c,!0);return g instanceof Z?D:(D=D.drop_side_effect_free(e,!0))?Yn(je,c,{body:D}):h?List.skip:Yn($,c)}if(c instanceof k&&c.name&&M(c.name.definition())&&(c.name=null),c instanceof he){if(t&&c!==n&&c instanceof ve)if(!((ce=c.name.definition()).id in _))return X(c.name,"Dropping unused function {name}"),ce.eliminated++,g instanceof Z?(qe(),Bt(c,!0)):h?List.skip:Yn($,c);if(qe(),c instanceof _e&&c.name&&M(c.name.definition())&&(c.name=null),!(c instanceof o)){var O,F,C=e.drop_fargs(c,g);if(C&&g instanceof m&&g.expression===c)for(O=g.args,F=0;F<O.length&&!(O[F]instanceof Pe);F++);var j=c.argnames,Y=c.rest,U=!1,V=!1;if(Y){if(V=!0,!O||F<j.length||Y instanceof Xe)Y=Y.transform(G);else Y=(D=De(Y,Yn(s,g,{elements:O.slice(j.length)}),Se,!c.uses_arguments,Y)).name,O.length=j.length,D.value.elements.length&&[].push.apply(O,D.value.elements);Y instanceof I&&!Y.rest&&(Y instanceof R?0==Y.elements.length&&(Y=null):0==Y.properties.length&&(Y=null)),c.rest=Y,Y&&(C=!1,U=!0)}for(var K=C?-1:c.length(),te=O&&!c.uses_arguments&&g!==e.parent(),oe=j.length;--oe>=0;){var ae;if((ae=j[oe])instanceof Xe){var ce;(ce=ae.definition()).id in _?(C=!1,le(ce,ae)<0&&(ae.unused=null)):C?(X(ae,"Dropping unused function argument {name}"),j.pop(),ce.eliminated++,ae.unused=!0):ae.unused=!0}else{var ue;if(V=!0,!O||F<oe)ue=ae.transform(G);else ue=(D=De(ae,O[oe],Se,te,ae)).name,D.value&&(O[oe]=D.value);ue?(C=!1,j[oe]=ue,U||(U=!(ue instanceof Xe))):C?(J(ae,"Dropping unused default argument {name}"),j.pop()):oe>K?(J(ae,"Dropping unused default argument assignment {name}"),ae.name instanceof Xe?ae.name.unused=!0:U=!0,j[oe]=ae.name):(J(ae,"Dropping unused default argument value {name}"),j[oe]=ae=ae.clone(),ae.value=Yn(ke,ae,{value:0}),U=!0)}}V&&!U&&c.uses_arguments&&!W.has_directive("use strict")&&(c.rest=Yn(R,c,{elements:[]})),B.push(c)}return c}if(c instanceof y&&c.argname instanceof I&&c.argname.transform(G),c instanceof H&&!(g instanceof re&&g.init===c)){var pe=[],me=[],ye=[],we=[],Te=0,Ee=c instanceof pn;switch(c.definitions.forEach(function(n){n.value&&(n.value=n.value.transform(W));var t=n.value;if(n.name instanceof I){var r=De(n.name,t,function(e){return i?e.definition().id in _?e:b(e)?e:Ee&&!A(e)?e:null:e},!0);r.name?(n=Yn(dn,n,{name:r.name,value:t=r.value}),y()):r.value&&we.push(r.value)}else{var o,s,f,u,l=n.name.definition(),p=Ee?A(n.name):ii(l);if(!p||!i||l.id in _)if(t&&((o=le(l,n))<0||(u=t.tail_node())instanceof en&&u.definition()===l)&&(n=n.clone(),(t=t.drop_side_effect_free(e))&&xe.warn("Side effects in definition of variable {name} [{start}]",n.name),c instanceof z?n.value=t||Yn(ke,n,{value:0}):(n.value=null,t&&we.push(t)),t=null,o>=0&&(a[l.id][o]=n)),t||c instanceof ge)if(e.option("functions")&&!e.option("ie")&&p&&t&&1==T[l.id]&&0==l.assignments&&(f=t.tail_node())instanceof _e&&!x(l)&&!kn(f)&&function(e,t){return 0==t.length?e===n.name.fixed_value():An(t,function(n){return e===n.fixed_value()})}(f,l.references)&&function(n){if(!Ee||e.has_directive("use strict")||!(n instanceof se))return g instanceof Me;return g instanceof d||g instanceof ie&&g.init===c||g instanceof fe}(f)&&!1!==(s=function(n,t){if(!n.name)return null;var i,r=n.name.definition();if(r.orig.length>1)return null;if(r.assignments>0)return!1;if(r.name==t)return r;if(e.option("keep_fnames"))return!1;switch(t){case"await":i=is_async;break;case"yield":i=Tn}return An(r.references,function(e){var r=e.scope;if(r.find_variable(t)!==l)return!1;if(i)do{if(r=r.resolve(),i(r))return!1}while(r!==n&&(r=r.parent_scope));return!0})&&r}(f,n.name.name))){var h;switch(xe.warn("Declaring {name} as function [{start}]",n.name),f.CTOR){case AST_AsyncFunction:h=AST_AsyncDefun;break;case AST_AsyncGeneratorFunction:h=AST_AsyncGeneratorDefun;break;case se:h=N;break;case AST_GeneratorFunction:h=AST_GeneratorDefun}var v=Yn(h,f);v.name=Yn(We,n.name);var m=n.name.scope.resolve().def_function(v.name);s&&s.forEach(function(e){e.name=m.name,e.thedef=m,e.reference()}),pe.push(v),t!==f&&[].push.apply(we,t.expressions.slice(0,-1))}else p&&T[l.id]>1&&!(g instanceof Q)&&l.orig.indexOf(n.name)>l.eliminated&&(T[l.id]--,Te++),y();else g instanceof Q?y():p&&T[l.id]>1?(xe.info("Dropping declaration of variable {name} [{start}]",n.name),T[l.id]--,l.eliminated++):me.push(n);else b(n.name)?((t=t&&t.drop_side_effect_free(e))&&we.push(t),T[l.id]>1?(xe.warn("Dropping duplicated declaration of variable {name} [{start}]",n.name),T[l.id]--,l.eliminated++):(n.value=null,me.push(n))):((t=t&&t.drop_side_effect_free(e))?(xe.warn("Side effects in initialization of unused variable {name} [{start}]",n.name),we.push(t)):X(n.name,"Dropping unused variable {name}"),l.eliminated++)}function b(e){var n=e.definition();return n.orig[0]instanceof Ue&&n.scope.resolve()===e.scope.resolve()}function y(){we.length>0&&(0==ye.length?pe.push(Yn(je,c,{body:Bn(c,we)})):t?(we.push(t),n.value=Bn(t,we)):n.value=Yn(un,n,{operator:"void",expression:Bn(n,we)}),we=[]),ye.push(n)}}),me.length){case 0:if(0==ye.length)break;if(ye.length==Te){[].unshift.apply(we,ye.map(function(e){xe.info("Dropping duplicated definition of variable {name} [{start}]",e.name);var n=e.name.definition(),t=Yn(en,e.name);n.references.push(t);var i=Yn(f,e,{operator:"=",left:t,right:e.value}),r=le(n,e);return r>=0&&(a[n.id][r]=i),n.assignments++,n.eliminated++,i}));break}case 1:if(0==ye.length){var Ae=me[0].name.definition().id;if(Ae in l){c.definitions=me,l[Ae].init=c;break}}default:var ze;ye.length>0&&(ze=ye[0].value)instanceof Ce&&(ye[0].value=ze.tail_node(),pe.push(Yn(je,c,{body:Bn(ze,ze.expressions.slice(0,-1))}))),c.definitions=me.concat(ye),pe.push(c)}return we.length>0&&pe.push(Yn(je,c,{body:Bn(c,we)})),ee(pe,c,h)}if(c instanceof f)return u(c,W),c.left instanceof I?(D=De(c.left,c.right,function(e){return e},!0===c.write_only)).name?Yn(f,c,{operator:c.operator,left:D.name,right:D.value}):D.value?D.value:g instanceof Ce&&g.tail_node()!==c?List.skip:Yn(ke,c,{value:0}):c;if(c instanceof de&&c.body instanceof ie){if(u(c,W),c.body instanceof v){var Oe=c.body;return c.body=Oe.body.pop(),Oe.body.push(c),h?List.splice(Oe.body):Oe}return c}if(c instanceof Me)return qe(),c;if(c instanceof Je)return!e.option("imports")||c.definition().id in _?c:h?List.skip:null}function qe(){var e=q;q=c,u(c,W),q=e}},function(n,t){if(n instanceof v)return Yt(n,W.parent(),t);if(n instanceof Q){var r=n.body;if(!(r instanceof v))return;return n.body=r.body.pop(),r.body.push(n),t?List.splice(r.body):r}if(n instanceof ie)return bt(n,t);if(n instanceof oe){if(!i||!e.option("loops"))return;if(!at(n.body))return;var o=ye(n);if(!o)return;var s=o.definition();if(s.id in _)return;X(o,"Dropping unused loop variable {name}"),l[s.id]===n&&delete l[s.id];var a=[],f=n.object.drop_side_effect_free(e);return f&&(xe.warn("Side effects in object of for-in loop [{start}]",f),a.push(Yn(je,n,{body:f}))),n.init instanceof H&&s.orig[0]instanceof Ue&&a.push(n.init),ee(a,n,t)}if(n instanceof ce)return n.properties&&0==n.properties.length&&(n.properties=null),n;if(n instanceof Ce){if(n.expressions.length>1)return;return nt(W.parent(),n,n.expressions[0])}});W.push(e.parent()),W.directives=Object.create(e.directives),n.transform(W),n instanceof he&&1==n.body.length&&n.body[0]instanceof V&&"use strict"==n.body[0].value&&(n.body.length=0),L.forEach(function(n){ui(n,e,B)})}function X(e,n){xe[e.definition().references.length>0?"info":"warn"](n+" [{start}]",e)}function J(e,n){e.name instanceof Xe?X(e.name,n):xe.info(n+" [{start}]",e)}function K(e){return e[e instanceof f?"right":"value"]}function ee(e,n,t){switch(e.length){case 0:return t?List.skip:Yn($,n);case 1:return e[0];default:return t?List.splice(e):Yn(v,n,{body:e})}}function te(e,t){return e.scope.resolve()===n&&(e.fixed&&t.fixed||(a[e.id]=!1),!1!==a[e.id])}function ue(e,n){a[e.id]||(a[e.id]=[]),n.fixed.assigns&&Hn(a[e.id],n.fixed.assigns)}function le(e,n){var t=a[e.id];return t&&t.indexOf(n)}function pe(e){g[e.id]>1&&!(e.id in _)&&(_[e.id]=!0,h.push(e)),g[e.id]=0}function me(e,n,t){e.id in _||(n&&t?(_[e.id]=n,h.push(e)):(b[e.id]=n,w[e.id]=t))}function be(n){var t=n.right;if(!n.write_only)return t;if(!(t instanceof p&&kt[t.operator]))return t;if(!(t.left instanceof en))return t;if(!(n.left instanceof en))return t;var i=n.left.definition();return t.left.definition()!==i?t:t.right.has_side_effects(e)?t:(te(i,t.left)&&ue(i,t.left),t.right)}function ye(e){var n=e.init;if(n instanceof H)return(n=n.definitions[0].name)instanceof Ge&&n;for(;n instanceof Oe;)n=n.expression.tail_node();return n instanceof en?n:void 0}function we(t,o,s){t instanceof f&&t.left instanceof en&&((A=t.left.definition()).scope.resolve()===n&&E.add(A.id,t));(t instanceof en&&t.in_arg&&(T[t.definition().id]=0),t instanceof fn&&t.expression instanceof en)&&((A=t.expression.definition()).scope.resolve()===n&&E.add(A.id,t));var a=[];if(k=r(t,a)){if((z=k.definition()).scope.resolve()!==n&&n.variables.get(k.name)!==z)return;if(x(z)&&!An(n.argnames,function(e){return!e.match_symbol(function(e){if(e instanceof Xe){var n=e.definition();return n.references.length>n.replaced}},!0)}))return;if("p"===t.write_only&&t.right.may_throw_on_access(e,!0))return;var c=a.assign;if(c&&(c.write_only=!0,c.walk(F)),a.forEach(function(e){e.walk(F)}),t instanceof f){var d=be(t),v=!1;if(s&&!0===t.write_only&&!d.has_side_effects(e)?O.add(z.id,d):(d.walk(F),v="="==d.tail_node().operator),t.left===k)t.write_only&&!v||me(z,k,w[z.id]);else{var m=k.fixed_value();m&&m.is_constant()||me(z,b[z.id],!0)}}return te(z,k)&&Qn(k,t)!==k&&ue(z,k),pe(z),!0}if(t instanceof p){if("instanceof"!=t.operator)return;if(!((k=t.right)instanceof en))return;var y=k.definition().id;if(!g[y])return;return t.left.walk(F),g[y]++,!0}if(t instanceof oe){var k,A;if(t.init instanceof en&&q===n)(y=t.init.definition().id)in l||(l[y]=t);if(!i||!e.option("loops"))return;if(!at(t.body))return;if(t.init.has_side_effects(e))return;if(!(k=ye(t)))return;if((A=k.definition()).scope.resolve()!==n){var D=u(k.name);if(D===A||D&&D.redefined()===A)return}return t.object.walk(F),!0}if(t instanceof en){var z;if((z=t.definition()).id in _||(_[z.id]=!0,h.push(z)),S(z.scope,t.scope)){var M=z.redefined();!M||M.id in _||(_[M.id]=!0,h.push(M))}return te(z,t)&&ue(z,t),!0}if(t instanceof Me){var C=q;return q=t,o(),q=C,!0}}function Se(e){return e.definition().id in _?e:(e instanceof Xe&&(e.unused=!0),null)}function Ae(n,t){if(t.value=t.value.transform(W),!t.name.transform(n)){if(t.name instanceof I)return null;var i=t.value.drop_side_effect_free(e);if(!i)return null;X(t.name,"Side effects in default value of unused variable {name}"),(t=t.clone()).name.unused=null,t.value=i}return t}function De(n,t,i,r,a){var c=new gn(function(n){if(n instanceof j){if(!(e.option("default_values")&&t&&t.is_defined(e))){var f=r;r=!1;var p=Ae(c,n);return r=f,!p&&r&&t&&(t=t.drop_side_effect_free(e)),p}n===a?a=n=n.name:n=n.name}if(n instanceof R){f=r;var d,h=t;t instanceof en&&(r=!1,t=t.fixed_value()),t instanceof s?(d=!0,w=t.elements):(d=t&&t.is_string(e),w=!1);var v=[],_=r&&[],g=0;if(n.elements.forEach(function(e,n){(t=w&&w[n])instanceof ae?t=null:t instanceof Pe&&(r&&(_.length=g,Ut(h,_),[].push.apply(_,w.slice(n)),h.elements=_),t=w=!1),(e=e.transform(c))&&(v[g]=e),r&&t&&(_[g]=t),!e&&!t&&r&&w||g++}),t=w&&Yn(s,h,{elements:w.slice(n.elements.length)}),n.rest){var m=r;r=!1,n.rest=n.rest.transform(e.option("rests")?c:W),r=m,n.rest&&(v.length=g)}if(r&&(t&&!n.rest&&(t=t.drop_side_effect_free(e)),t instanceof s?t=t.elements:t instanceof Ce?t=t.expressions:t&&(t=[t]),t&&t.length&&(_.length=g,[].push.apply(_,t))),t=h,r=f,w&&_&&(Ut(t,_),(t=t.clone()).elements=_),d){if(!n.rest)switch(v.length){case 0:if(n===a)break;return r&&(t=t.drop_side_effect_free(e)),null;case 1:if(!r)break;if(n===a)break;var b=v[0];if(b.has_side_effects(e))break;if(t.has_side_effects(e)&&b.match_symbol(function(e){return e instanceof Oe}))break;return t=Yn(Ye,n,{expression:t,property:Yn(ke,n,{value:0})}),b}}else v.length=n.elements.length;return Ut(n,v),n.elements=v,n}if(n instanceof U){var y,x,w;f=r,h=t;t instanceof en&&(r=!1,t=t.fixed_value()),t instanceof Te&&(y=[],x=new zn,w=t.properties.map(function(n,t){if((n=n.clone())instanceof Pe)x=!1;else{var i=n.key;i instanceof xe&&(i=i.evaluate(e,!0)),i instanceof xe?x=!1:!x||n instanceof AST_ObjectSetter||x.set(i,n),y[t]=i}return n})),n.rest&&(t=!1,n.rest=n.rest.transform(e.option("rests")?c:W));var k=new zn,T=r&&new zn,E=[];if(n.properties.map(function(n){var t=n.key;return t instanceof xe&&(n.key=t=t.transform(W),t=t.evaluate(e,!0)),t instanceof xe?T=!1:k.set(t,!k.has(t)),t}).forEach(function(e,i){var s,a=n.properties[i];if(e instanceof xe)r=!1,t=!1,s=a.value.transform(c)||l(a.value);else{r=T&&k.get(e);var f=x&&x.get(e);f?(t=f.value)instanceof o&&(t=!1):t=!1,(s=a.value.transform(c))?T&&T.set(e,!1):((n.rest||u(a))&&(s=l(a.value)),T&&!T.has(e)&&(f?(T.set(e,f),null===t&&x.set(e,u(f)&&Yn(Ee,f,{key:f.key,value:Yn(ke,f,{value:0})}))):T.set(e,!0))),t&&(f.value=t)}s&&(a.value=s,E.push(a))}),t=h,r=f,T&&y&&((t=t.clone()).properties=List(w,function(t,i){if(t instanceof Pe)return t;var r=y[i];if(r instanceof xe)return t;if(T.has(r)){var o=T.get(r);if(!o)return t;if(o===t)return x.get(r)||List.skip}else if(n.rest)return t;var s=t.value.drop_side_effect_free(e);return s?(t.value=s,t):u(t)?Yn(Ee,t,{key:t.key,value:Yn(ke,t,{value:0})}):List.skip})),t&&!n.rest)switch(E.length){case 0:if(n===a)break;if(t.may_throw_on_access(e,!0))break;return r&&(t=t.drop_side_effect_free(e)),null;case 1:if(!r)break;if(n===a)break;var S=E[0];if(S.key instanceof xe)break;if(S.value.has_side_effects(e))break;if(t.has_side_effects(e)&&S.value.match_symbol(function(e){return e instanceof Oe}))break;return t=Yn(Ye,n,{expression:t,property:Kn(S.key,S)}),S.value}return n.properties=E,n}return!(n=n instanceof ae?null:i(n))&&r&&t&&(t=t.drop_side_effect_free(e)),n});return{name:n.transform(c),value:t};function u(n){return n.key instanceof xe&&n.key.has_side_effects(e)}function l(n){return n instanceof j?l(n.name):n instanceof I?(null===t?t=Yn(ke,n,{value:0}):t&&(t.may_throw_on_access(e,!0)?t=Yn(s,n,{elements:t instanceof Ce?t.expressions:[t]}):function e(n){if(n instanceof f)n.write_only=!1,e(n.right);else if(n instanceof p){if(!kt[n.operator])return;e(n.left),e(n.right)}else n instanceof D?(e(n.consequent),e(n.alternative)):n instanceof Ce?e(n.tail_node()):n instanceof fn&&(n.write_only=!1)}(t)),Yn(U,n,{properties:[]})):(n.unused=null,n)}}}),Me.DEFMETHOD("hoist_declarations",function(e){if(!e.has_directive("use asm")){var n=e.option("hoist_funs"),t=e.option("hoist_vars"),i=this;if(t){var r=0;i.walk(new mn(function(e){return r>1||(e instanceof Q||(e instanceof Me&&e!==i||(e instanceof pn?(r++,!0):void 0)))})),r<=1&&(t=!1)}if(n||t){var o=new zn,s=[],a=[],f=new zn,c=new gn(function(r,u,l){if(r!==i){if(r instanceof V)return s.push(r),l?List.skip:Yn($,r);if(r instanceof ve)return n?(p=c.parent())instanceof Q?r:p instanceof Z?r:p!==i&&e.has_directive("use strict")?r:(a.push(r),l?List.skip:Yn($,r)):r;if(r instanceof pn){if(!t)return r;var p;if((p=c.parent())instanceof Q)return r;if(!An(r.definitions,function(e){var n=e.name;return n instanceof AST_SymbolVar&&!o.has(n.name)&&i.find_variable(n.name)===n.definition()}))return r;r.definitions.forEach(function(e){f.set(e.name.name,e)});var d=r.to_assignments();if(p instanceof re&&p.init===r){if(d)return d;var h=r.definitions[0].name;return Yn(en,h)}return p instanceof ie&&p.init===r?d:d?Yn(je,r,{body:d}):l?List.skip:Yn($,r)}return r instanceof Me?r:r instanceof Be?(o.set(r.name,!0),r):void 0}});if(i.transform(c),f.size()>0){var u=[];i instanceof he&&i.each_argname(function(e){An(e.definition().references,function(e){return!e.in_arg})&&f.del(e.name)}),f.each(function(e,n){(e=e.clone()).name=e.name.clone(),e.value=null,u.push(e),f.set(n,e),e.name.definition().orig.unshift(e.name)}),u.length>0&&a.push(Yn(pn,i,{definitions:u}))}i.body=s.concat(a,i.body)}}}),Me.DEFMETHOD("process_returns",Pn),N.DEFMETHOD("process_returns",function(e){if(e.option("booleans")&&!(e.parent()instanceof Z))switch($t(this.name.definition(),Wt(this),e)){case"d":Kt(e,this,!0);break;case!0:Xt(this,e)}}),se.DEFMETHOD("process_returns",function(e){if(e.option("booleans")){var n=!0,t=Wt(this);if(!this.name||l(this.name.definition())){var i=e.parent();if(i instanceof f){if("="!=i.operator)return;if(!((o=i.left)instanceof en))return;if(!l(o.definition()))return}else if(i instanceof m&&i.expression!==this){var r=i.expression;if(r instanceof en&&(r=r.fixed_value()),!(r instanceof he))return;if(r.uses_arguments||r.pinned())return;for(var o,s=i.args,a=0;a<s.length;a++){var c=s[a];if(c===this){if(!(o=r.argnames[a])&&r.rest)return;break}if(c instanceof Pe)return}if(o instanceof j&&(o=o.name),o instanceof Xe&&!l(o.definition()))return}else{if("Call"!=i.TYPE)return;e.pop();var u=e.in_boolean_context();switch(e.push(this),u){case!0:n=!1;case"d":break;default:return}}n?Kt(e,this,!0):Xt(this,e)}}function l(i){switch($t(i,t,e)){case!0:n=!1;case"d":return!0}}}),h.DEFMETHOD("var_names",function(){var e=this._var_names;return e||(this._var_names=e=new zn,this.enclosed.forEach(function(n){e.set(n.name,!0)}),this.variables.each(function(n,t){e.set(t,!0)})),e}),Me.DEFMETHOD("make_var",function(e,n,t){var i=[this];n instanceof Ge&&n.definition().references.forEach(function(e){var n=e.scope;do{if(!Hn(i,n))return;n=n.parent_scope}while(n&&n!==this)});for(var r=t=t.replace(/^[^a-z_$]|[^a-z0-9_$]/gi,"_"),o=0;!An(i,function(e){return!e.var_names().has(r)});o++)r=t+"$"+o;var s=Yn(e,n,{name:r,scope:this}),a=this.def_variable(s);return i.forEach(function(e){e.enclosed.push(a),e.var_names().set(r,!0)}),s}),Me.DEFMETHOD("hoist_properties",function(e){if(e.option("hoist_props")&&!e.has_directive("use asm")){var n=this;if(!kn(n)||!n.value){var t=n instanceof on&&e.top_retain||Rn,i=Object.create(null),r=new gn(function(e,t){if(e instanceof f){if("="!=e.operator)return;if(!e.write_only)return;if(!o(e.left,e.right,1))return;t(e,r);var s=new zn,a=[],c=[];return e.right.properties.forEach(function(t){var i=d(AST_SymbolVar,e.left,t.key);c.push(Yn(dn,e,{name:i,value:null}));var r=Yn(en,e,{name:i.name,scope:n,thedef:i.definition()});r.reference(),a.push(Yn(f,e,{operator:"=",left:r,right:t.value}))}),s.value=e.right,i[e.left.definition().id]=s,n.body.splice(n.body.indexOf(r.stack[1])+1,0,Yn(pn,e,{definitions:c})),Bn(e,a)}if(e instanceof Me){if(e===n)return;var u=r.parent();if("Call"==u.TYPE&&u.expression===e)return;return e}if(e instanceof dn){if(!o(e.name,e.value,0))return;t(e,r);s=new zn;var l=[],p=e.clone();return p.value=e.name instanceof Be?Yn(ke,e,{value:0}):null,l.push(p),e.value.properties.forEach(function(n){l.push(Yn(dn,e,{name:d(e.name.CTOR,e.name,n.key),value:n.value}))}),s.value=e.value,i[e.name.definition().id]=s,List.splice(l)}function d(e,t,i){var r=n.make_var(e,t,t.name+"_"+i);return s.set(i,r.definition()),r}});n.transform(r),n.transform(new gn(function(e,n){if(e instanceof Oe){if(!(e.expression instanceof en))return;if(!(o=i[e.expression.definition().id]))return;if(e.expression.fixed_value()!==o.value)return;var t=o.get(e.get_property()),r=Yn(en,e,{name:t.name,scope:e.expression.scope,thedef:t});return r.reference(),r}if(e instanceof en){var o;if(!(o=i[e.definition().id]))return;if(e.fixed_value()!==o.value)return;return Yn(Te,e,{properties:[]})}}))}}function o(i,r,o){if(i instanceof Le){var s=i.definition();if(s.assignments==o&&s.references.length-s.replaced!=o&&!s.single_use&&n.find_variable(i.name)===s&&!t(s)&&i.fixed_value()===r){var a=i.fixed||s.fixed;if(!(a.direct_access||a.escaped&&1==a.escaped.depth))return r instanceof Te&&r.properties.length>0&&A(i,e)&&An(r.properties,function(e){return Ci(e)&&"__proto__"!==e.key})}}}}),function(e){function n(e,n,t,i){for(var r=e.length,o=[],s=!1,a=0;a<r;a++){var f,c=e[a];(f=i&&c instanceof Pe?i(c,n,t):c.drop_side_effect_free(n,t))!==c&&(s=!0),f&&(o.push(f),t=!1)}return o.length?s?o:e:null}function t(e,n,t){var i=e.expression;return i.is_string(n)?i.drop_side_effect_free(n,t):e}function i(e){return e instanceof Pe?Yn(s,e,{elements:[e]}):e}e(xe,Vn),e(o,Ln),e(s,function(e,r){var o=n(this.elements,e,r,t);return o?o===this.elements&&An(o,function(e){return e instanceof Pe})?this:Bn(this,o.map(i)):null}),e(f,function(e){var n=this.left;if(n instanceof Oe){var t=n.expression;if(t.may_throw_on_access(e,!0))return this;if(e.has_directive("use strict")&&t.is_constant())return this}return n.has_side_effects(e)?this:kt[this.operator.slice(0,-1)]?this:(this.write_only=!0,root_expr(n).is_constant_expression(e.find_parent(Me))?this.right.drop_side_effect_free(e):this)}),e(u,function(e){if(!e.option("awaits"))return this;var n=this.expression;if(!xi(e,n))return this;n instanceof un&&"!"==n.operator&&(n=n.expression);var t=n.drop_side_effect_free(e);if(t===n)return this;t?xi(e,t)||(t=t.negate(e)):t=Yn(ke,n,{value:0});var i=this.clone();return i.expression=t,i}),e(p,function(e,n){var t=this.left,i=this.right,r=this.operator;if(!yi(r,i,e))return(o=t.drop_side_effect_free(e,n))===t?this:((a=this.clone()).left=o||Yn(ke,t,{value:0}),a);var o,s=i.drop_side_effect_free(e,n);if(!s)return t.drop_side_effect_free(e,n);if(kt[r]&&s.has_side_effects(e)){var a=this;if(s!==i&&((a=a.clone()).right=s.drop_side_effect_free(e)),"??"==r)return a;var f=a.clone();f.operator="&&"==r?"||":"&&",f.left=t.negate(e,n);var c=f.right.tail_node();c instanceof p&&f.operator==c.operator&&Ti(f);var u=n?Et:Tt;return"&&"==r?u(a,f):u(f,a)}return(o=t.drop_side_effect_free(e,n))?(s=s.drop_side_effect_free(e))?Bn(this,[o,s]):o:s}),e(m,function(e,r){var o=this;if(o.is_expr_pure(e)){o.pure&&xe.warn("Dropping __PURE__ call [{start}]",o);var s=n(o.args,e,r,t);return s&&Bn(o,s.map(i))}var a=o.expression;if(o.is_call_pure(e))return(p=o.args.slice()).unshift(a.expression),(p=n(p,e,r,t))&&Bn(o,p.map(i));if(e.option("yields")&&Tn(a)){var f=o.clone();f.expression=Yn(se,a),f.expression.body=[];var c=f.transform(e);if(c!==f)return c.drop_side_effect_free(e,r)}var u=Kt(e,a);if(u&&((o=o.clone()).expression=u,a._squeezed&&(o.expression._squeezed=!0)),o instanceof ye){var l=a;if(l instanceof en&&(l=l.fixed_value()),l instanceof he){var p;if(function(e,n){e.new=!0;var t=An(e.body,function(e){return!e.has_side_effects(n)})&&An(e.argnames,function(e){return!e.match_symbol(Rn)})&&!(e.rest&&e.rest.match_symbol(Rn));return e.new=!1,t}(l,e))return(p=o.args.slice()).unshift(a),(p=n(p,e,r,t))&&Bn(o,p.map(i));l.contains_this()||((o=Yn(m,o)).expression=o.expression.clone(),o.args=o.args.slice())}}return o.call_only=!0,o}),e(k,function(e,t){for(var i=this,o=[],s=[],f=0,c=i.properties,u=0;u<c.length;u++){var l=c[u];if(l.key instanceof xe&&o.push(l.key),vt(l)){var p=l.value;if(p.has_side_effects(e)){if(p.contains_this())return i;l instanceof AST_ClassInit?(f++,s.push(l)):s.push(p)}}}var d=i.extends;if(d&&(d instanceof en&&(d=d.fixed_value()),(d=!r(d))||o.unshift(i.extends)),(o=n(o,e,t))&&(t=!1),s=n(s,e,t),!o){if(!d&&!s&&!i.name)return null;o=[]}if(d||i.name||!e.has_directive("use strict")){var h=Vt(i);return d||(h.extends=null),h.properties=[],s?s.length==f?(o.length&&s.unshift(Yn(AST_ClassField,i,{key:Bn(i,o),value:null})),h.properties=s):h.properties.push(Yn(AST_ClassField,i,{static:!0,key:o.length?Bn(i,o):"c",value:v()})):o.length&&h.properties.push(Yn(AST_ClassMethod,i,{key:Bn(i,o),value:Yn(se,i,{argnames:[],body:[]}).init_vars(h)})),h}return s&&o.push(Yn(m,i,{expression:Yn(a,i,{argnames:[],body:[],value:v()}).init_vars(i.parent_scope),args:[]})),Bn(i,o);function v(){return Bn(i,s.map(function(e){if(!(e instanceof AST_ClassInit))return e;var n=Yn(a,e.value);return n.argnames=[],Yn(m,e,{expression:n,args:[]})}))}}),e(D,function(e){var n,t,i=this.consequent.drop_side_effect_free(e),r=this.alternative.drop_side_effect_free(e);return i===this.consequent&&r===this.alternative?this:(e.option("ie")&&(n=[],i instanceof se&&(n.push(i),i=null),r instanceof se&&(n.push(r),r=null)),i?r?((t=this.clone()).consequent=i,t.alternative=r):t=Yn(p,this,{operator:"&&",left:this.condition,right:i}):t=r?Yn(p,this,{operator:"||",left:this.condition,right:r}):this.condition.drop_side_effect_free(e),n?(t&&n.push(t),0==n.length?null:Bn(this,n)):t)}),e(O,Ln),e(G,function(e,n){var t=this.expression;return t.may_throw_on_access(e)?this:t.drop_side_effect_free(e,n)}),e(se,function(e){return Jt(this,e)?null:this}),e(_e,Ln),e(Te,function(e,t){var i=[];this.properties.forEach(function(e){e instanceof Pe?i.push(e):(e.key instanceof xe&&i.push(e.key),i.push(e.value))});var r=n(i,e,t,function(e,n,t){var i=e.expression;return i.safe_to_spread()?i.drop_side_effect_free(n,t):e});return r?r!==i||An(r,function(e){return!(e instanceof Pe)})?Bn(this,r.map(function(e){return e instanceof Pe?Yn(Te,e,{properties:[e]}):e})):this:null}),e(Ae,Ln),e(Ce,function(e,t){var i=n(this.expressions,e,t);if(!i)return null;var r,o,s,a=i.length-1,c=i[a];if(e.option("awaits")&&a>0&&c instanceof u&&c.expression.is_constant()){var l=(i=i.slice(0,-1))[--a];c.expression=xi(e,l)?l:l.negate(e),i[a]=c}return e.option("conditionals")&&a>0&&(r=i[a-1])instanceof f&&"="==r.operator&&(s=r.left)instanceof en&&(o=hi(e,s.definition(),r.right,c))&&((r=r.clone()).right=o,(i=i.slice(0,-2)).push(r.drop_side_effect_free(e,t))),i===this.expressions?this:Bn(this,i)}),e(Ye,function(e,n){var t=this.expression;if(t.may_throw_on_access(e))return this;var i=this.property;return(t=t.drop_side_effect_free(e,n))?(i=i.drop_side_effect_free(e))?Bn(this,[t,i]):t:i.drop_side_effect_free(e,n)}),e(en,function(e){return this.is_declared(e)&&A(this,e)?null:this}),e(nn,function(e,n){var t=this;if(t.is_expr_pure(e)){var i=t.expressions;return 0==i.length?null:Bn(t,i).drop_side_effect_free(e,n)}var r=t.tag,o=Kt(e,r);return o&&((t=t.clone()).tag=o,r._squeezed&&(t.tag._squeezed=!0)),t}),e(fn,function(e,n){var t=this.expression;if(unary_side_effects[this.operator])return this.write_only=!t.has_side_effects(e),this;if("typeof"==this.operator&&t instanceof en&&A(t,e))return null;var i=t.drop_side_effect_free(e,n);return n&&i&&ut(i)?i===t&&"!"==this.operator?this:i.negate(e,n):i})}(function(e,n){e.DEFMETHOD("drop_side_effect_free",n)}),e(je,function(e,n){if(n.option("side_effects")){var t=e.body,i=t.drop_side_effect_free(n,!0);if(!i)return xe.warn("Dropping side-effect-free statement [{start}]",e),Yn($,e);if(i!==t)return Yn(je,e,{body:i})}return e}),e(hn,function(e,n){return n.option("loops")?Yn(ie,e).optimize(n):e}),e(B,function(e,n){if(!n.option("loops"))return e;var t=ei(n,e.condition);if(!(t instanceof xe)){if(t&&!Qt(e,n.parent(),q))return Yn(ie,e,{body:Yn(v,e.body,{body:[e.body,Yn(je,e.condition,{body:e.condition})]})}).optimize(n);if(!Qt(e,n.parent()))return Yn(v,e.body,{body:[e.body,Yn(je,e.condition,{body:e.condition})]}).optimize(n)}if(e.body instanceof v&&!Qt(e,n.parent(),q)){for(var i=e.body.body,r=i.length;--r>=0;){var o=i[r];if(o instanceof fe&&!o.alternative&&o.body instanceof g&&n.loopcontrol_target(o.body)===e){if(s(o.condition))break;e.condition=Yn(p,e,{operator:"&&",left:o.condition.negate(n),right:e.condition}),i.splice(r,1)}else if(o instanceof je){if(s(o.body))break;e.condition=Bn(e,[o.body,e.condition]),i.splice(r,1)}else if(!gt(o,!0))break}e.body=Yt(e.body,n.parent())}return e.body instanceof $?Yn(ie,e).optimize(n):e.body instanceof je?Yn(ie,e,{condition:Bn(e.condition,[e.body.body,e.condition]),body:Yn($,e)}).optimize(n):e;function s(n){var t=!1;return n.walk(new mn(function(n){return!!t||(n instanceof en?(jn(n.definition(),e.enclosed)||(t=!0),!0):void 0)})),t}}),e(ie,function(e,n){if(!n.option("loops"))return e;if(n.option("side_effects")&&(e.init&&(e.init=e.init.drop_side_effect_free(n)),e.step&&(e.step=e.step.drop_side_effect_free(n))),e.condition){var t=ei(n,e.condition);if(t)t instanceof xe||(e.body=Yn(v,e.body,{body:[Yn(je,e.condition,{body:e.condition}),e.body]}),e.condition=null);else if(n.option("dead_code")){var i=[];return is_statement(e.init)?i.push(e.init):e.init&&i.push(Yn(je,e.init,{body:e.init})),i.push(Yn(je,e.condition,{body:e.condition})),xt(n,e.body,i),Yn(v,e,{body:i}).optimize(n)}}return function e(n,t){var i=a(n.body);if(t.option("dead_code")&&(i instanceof g||i instanceof q&&f(i)||i instanceof X)){var r=[];is_statement(n.init)?r.push(n.init):n.init&&r.push(Yn(je,n.init,{body:n.init}));var o=f(i)||i instanceof X;return n.condition&&o?r.push(Yn(fe,n,{condition:n.condition,body:i,alternative:null})):n.condition?r.push(Yn(je,n.condition,{body:n.condition})):o&&r.push(i),xt(t,n.body,r),Yn(v,n,{body:r})}if(i instanceof fe){var s=a(i.body);if(s instanceof g&&!f(s))return n.condition?n.condition=Yn(p,n.condition,{left:n.condition,operator:"&&",right:i.condition.negate(t)}):n.condition=i.condition.negate(t),r=st(i.alternative),xt(t,i.body,r),c(r);if((s=a(i.alternative))instanceof g&&!f(s))return n.condition?n.condition=Yn(p,n.condition,{left:n.condition,operator:"&&",right:i.condition}):n.condition=i.condition,r=st(i.body),xt(t,i.alternative,r),c(r)}return n;function a(e){return e instanceof v?e.body[0]:e}function f(e){return t.loopcontrol_target(e)!==t.self()}function c(i){return n.body instanceof v?(n.body=n.body.clone(),n.body.body=i.concat(n.body.body.slice(1)),n.body=n.body.transform(t)):n.body=Yn(v,n.body,{body:i}).transform(t),e(n,t)}}(e,n)}),e(re,function(e,n){if(n.option("varify")&&rt(e.init)){var t=e.init.definitions[0].name;(t instanceof I||t instanceof Qe)&&!t.match_symbol(function(e){if(e instanceof Ge){var t=e.definition();return!Si(t)||ri(n,t)}},!0)&&(e.init=oi(e.init,e.resolve()))}return e}),e(fe,function(e,n){if(at(e.alternative)&&(e.alternative=null),!n.option("conditionals"))return e;if(n.option("booleans")&&!e.condition.has_side_effects(n)&&ni(n,e.condition),n.option("dead_code")){var t=ei(n,e.condition);if(!t){xe.warn("Condition always false [{start}]",e.condition);var i=[Yn(je,e.condition,{body:e.condition}).transform(n)];return xt(n,e.body,i),e.alternative&&i.push(e.alternative),Yn(v,e,{body:i}).optimize(n)}if(!(t instanceof xe)){xe.warn("Condition always true [{start}]",e.condition);i=[Yn(je,e.condition,{body:e.condition}).transform(n),e.body];return e.alternative&&xt(n,e.alternative,i),Yn(v,e,{body:i}).optimize(n)}}var r=e.condition.negate(n),o=e.condition.print_to_string().length,s=r.print_to_string().length,a=s<o;if(e.alternative&&a){a=!1,e.condition=r;var c=e.body;e.body=e.alternative,e.alternative=at(c)?null:c}var u=[],l=[],d=[],h=Y(e.body,u,l,d),_=[],g=[],m=[],b=Y(e.alternative,_,g,m);if(h instanceof v||b instanceof v){i=[];var x=[];if(h&&([].push.apply(i,u),[].push.apply(x,l),h instanceof v?e.body=h:0==h.length?e.body=Yn($,e.body):e.body=Yn(je,e.body,{body:Bn(e.body,h)}),d.forEach(tn)),b&&([].push.apply(i,_),[].push.apply(x,g),b instanceof v?e.alternative=b:0==b.length?e.alternative=null:e.alternative=Yn(je,e.alternative,{body:Bn(e.alternative,b)}),m.forEach(tn)),x.length>0&&i.push(Yn(pn,e,{definitions:x})),i.length>0)return i.push(e.transform(n)),Yn(v,e,{body:i}).optimize(n)}else if(h&&b){i=u.concat(_);return(l.length>0||g.length>0)&&i.push(Yn(pn,e,{definitions:l.concat(g)})),0==h.length?i.push(Yn(je,e.condition,{body:b.length>0?Yn(p,e,{operator:"||",left:e.condition,right:Bn(e.alternative,b)}).transform(n):e.condition.clone()}).optimize(n)):0==b.length?(o===s&&!a&&e.condition instanceof p&&"||"==e.condition.operator&&(a=!0),i.push(Yn(je,e,{body:Yn(p,e,{operator:a?"||":"&&",left:a?r:e.condition,right:Bn(e.body,h)}).transform(n)}).optimize(n))):i.push(Yn(je,e,{body:Yn(D,e,{condition:e.condition,consequent:Bn(e.body,h),alternative:Bn(e.alternative,b)})}).optimize(n)),d.forEach(tn),m.forEach(tn),Yn(v,e,{body:i}).optimize(n)}if(at(e.body)&&(e=Yn(fe,e,{condition:r,body:e.alternative,alternative:null})),e.alternative instanceof X&&e.body.TYPE==e.alternative.TYPE){var w=e.body.value,k=e.alternative.value;if(!w&&!k)return Yn(v,e,{body:[Yn(je,e,{body:e.condition}),e.body]}).optimize(n);if(w&&k||!function(){var e=!1,t=0,i=n.self();do{if(i instanceof y)n.parent(t).bfinally&&(e=!0),t++;else if(i instanceof te)t++;else{if(i instanceof Me)return e&&Dn(i);i instanceof an&&i.bfinally&&(e=!0)}}while(i=n.parent(t++))}()){var T=Yn(e.body.CTOR,e,{value:Yn(D,e,{condition:e.condition,consequent:w||Yn(ln,e.body).transform(n),alternative:k||Yn(ln,e.alternative).transform(n)})});return T instanceof Fe&&(T.in_bool=e.body.in_bool||e.alternative.in_bool),T}}if(e.body instanceof fe&&!e.body.alternative&&!e.alternative&&(e=Yn(fe,e,{condition:Yn(p,e.condition,{operator:"&&",left:e.condition,right:e.body.condition}),body:e.body.body,alternative:null})),Ht(e.body)&&e.alternative){var E=e.alternative;return e.alternative=null,Yn(v,e,{body:[e,E]}).optimize(n)}if(Ht(e.alternative)){i=e.body;return e.body=e.alternative,e.condition=a?r:e.condition.negate(n),e.alternative=null,Yn(v,e,{body:[e,i]}).optimize(n)}if(e.alternative){for(var S=P(e.body),A=H(S),z=P(e.alternative),O=H(z),q=[];A>=0&&O>=0;){var F=S[A],M=z[O];if(F.equals(M))S.splice(A--,1),z.splice(O--,1),q.unshift(tt(F,M));else{if(!(F instanceof je))break;if(!(M instanceof je))break;var C=F.body.tail_node(),j=M.body.tail_node();if(!C.equals(j))break;A=N(S,F.body,A),O=N(z,M.body,O),q.unshift(Yn(je,C,{body:tt(C,j)}))}}if(q.length>0)return e.body=S.length>0?Yn(v,e,{body:S}):Yn($,e),e.alternative=z.length>0?Yn(v,e,{body:z}):null,q.unshift(e),Yn(v,e,{body:q}).optimize(n)}return n.option("typeofs")&&Zt(e.condition,e.body,e.alternative),e;function P(e){return e instanceof v?e.body:[e]}function H(e){for(var n=e.length;--n>=0&&gt(e[n],!0););return n}function N(e,n,t){return n instanceof Ce?e[t]=Yn(je,n,{body:Bn(n,n.expressions.slice(0,-1))}):e.splice(t--,1),t}function Y(e,t,i,r){if(null==e)return[];if(e instanceof v){for(var o=[],s=0;s<e.body.length;s++){var a=e.body[s];if(!(a instanceof $)){if(a instanceof X){if(0==s)return;o.length>0&&(a=a.clone(),o.push(a.value||Yn(ln,a).transform(n)),a.value=Bn(e,o));var c=e.clone();return c.body=c.body.slice(s+1),c.body.unshift(a),c}if(a instanceof ve)t.push(a);else if(a instanceof je){if(!n.option("sequences")&&o.length>0)return;o.push(a.body)}else{if(!(a instanceof pn))return;if(!n.option("sequences")&&o.length>0)return;a.remove_initializers(n,i),a.definitions.forEach(u)}}}return o}if(e instanceof ve)return t.push(e),[];if(e instanceof $)return[];if(e instanceof je)return[e.body];if(e instanceof pn){o=[];return e.remove_initializers(n,i),e.definitions.forEach(u),o}function u(e){e.value&&o.push(Yn(f,e,{operator:"=",left:e.name.convert_symbol(en,function(e){r.push(e)}),right:e.value}))}}}),e(Ie,function(e,n){if(!n.option("switches"))return e;if(!n.option("dead_code"))return e;for(var t,i,r,o=[],s=[],a=[],f=0,c=e.body.length;f<c;f++){if((t=e.body[f])instanceof M){var u=o[o.length-1];if(i||E(t.body[0],n)&&(!u||Ht(u))){A(t,u);continue}i=t}else{var l=t.expression,d=Yn(p,e,{operator:"===",left:e.expression,right:l}).evaluate(n,!0);if(!d){l.has_side_effects(n)&&a.push(l),A(t,o[o.length-1]);continue}if(!(d instanceof xe)){if(i){var h=o.indexOf(i);o.splice(h,1),A(i,o[h-1]),i=null}for(l.has_side_effects(n)?r=t:i=t=Yn(M,t);++f<c;)A(e.body[f],t)}}if(f+1>=c||Ht(t)){u=o[o.length-1];var _=t.body;if(Ht(u))switch(u.body.length-_.length){case 1:if(!E(x=u.body[u.body.length-1],n))break;_=_.concat(x);case 0:var m=Yn(v,u),y=Yn(v,t,{body:_});m.equals(y)&&(u.body=[])}}a.length&&(t instanceof M?o.push(Yn(b,e,{expression:Bn(e,a),body:[]})):(a.push(t.expression),t.expression=Bn(e,a)),a=[]),o.push(t)}for(a.length&&!r&&o.push(Yn(b,e,{expression:Bn(e,a),body:[]}));t=o[o.length-1];){var x;if(E(x=t.body[t.body.length-1],n)&&t.body.pop(),t===i){if(!ft(t))break}else{if(t.expression.has_side_effects(n))break;if(i){if(!ft(i))break;if(o[o.length-2]!==i)break;i.body=i.body.concat(t.body),t.body=[]}else if(!ft(t))break}A(t),o.pop()===i&&(i=null)}if(!t)return s.push(Yn(je,e.expression,{body:e.expression})),a.length&&s.push(Yn(je,e,{body:Bn(e,a)})),Yn(v,e,{body:s}).optimize(n);if(t===i)for(;(t=o[o.length-2])&&!(t instanceof M)&&ft(t);){if((l=t.expression).has_side_effects(n)){if((u=o[o.length-3])&&!Ht(u))break;i.body.unshift(Yn(je,e,{body:l}))}A(t),o.splice(-2,1)}if(o[0].body=s.concat(o[0].body),e.body=o,n.option("conditionals"))switch(o.length){case 1:if(!S(o[0]))break;l=o[0].expression,_=o[0].body.slice();return o[0]!==i&&o[0]!==r?Yn(fe,e,{condition:Yn(p,e,{operator:"===",left:e.expression,right:l}),body:Yn(v,e,{body:_}),alternative:null}).optimize(n):(l&&_.unshift(Yn(je,l,{body:l})),_.unshift(Yn(je,e.expression,{body:e.expression})),Yn(v,e,{body:_}).optimize(n));case 2:if(!jn(i,o)||!S(o[1]))break;var w=(_=o[0].body.slice()).length&&E(_[_.length-1],n);if(w&&_.pop(),!An(_,S))break;var k=o[1].body.length&&Yn(v,o[1]),T=Yn(fe,e,{condition:Yn(p,e,o[0]===i?{operator:"!==",left:e.expression,right:o[1].expression}:{operator:"===",left:e.expression,right:o[0].expression}),body:Yn(v,o[0],{body:_}),alternative:w&&k||null});return!w&&k&&(T=Yn(v,e,{body:[T,k]})),T.optimize(n)}return e;function E(n,t){return n instanceof g&&t.loopcontrol_target(n)===e}function S(n){var t=!1,i=new mn(function(e){if(t||e instanceof he||e instanceof je)return!0;E(e,i)&&(t=!0)});return i.push(e),n.walk(i),!t}function A(e,t){t&&!Ht(t)?t.body=t.body.concat(e.body):xt(n,e,s)}}),e(an,function(e,n){if(e.body=yt(e.body,n),n.option("dead_code")){if(ft(e)&&!(e.bcatch&&e.bcatch.argname&&e.bcatch.argname.match_symbol(function(e){return e instanceof Ue&&!A(e)},!0))){var t=[];return e.bcatch&&(xt(n,e.bcatch,t),t.forEach(function(e){e instanceof pn&&e.definitions.forEach(function(e){var n=e.name.definition().redefined();n&&(e.name=e.name.clone(),e.name.thedef=n)})})),t.unshift(Yn(v,e).optimize(n)),e.bfinally&&t.push(Yn(v,e.bfinally).optimize(n)),Yn(v,e,{body:t}).optimize(n)}if(e.bfinally&&ft(e.bfinally)){t=Yn(v,e.bfinally).optimize(n);if(t=e.body.concat(t),!e.bcatch)return Yn(v,e,{body:t}).optimize(n);e.body=t,e.bfinally=null}}return e}),z.DEFMETHOD("remove_initializers",ti(function(e,n){return Yn(ln,n).optimize(e)})),ge.DEFMETHOD("remove_initializers",ti(Ln)),pn.DEFMETHOD("remove_initializers",ti(Ln)),H.DEFMETHOD("to_assignments",function(){var e=this.definitions.reduce(function(e,n){var t=n.name.definition(),i=n.value;if(i){i instanceof Ce&&(i=i.clone());var r=Yn(en,n.name),o=Yn(f,n,{operator:"=",left:r,right:i});e.push(o);var s=function(){return o.right};s.assigns=[o],s.direct_access=t.direct_access,s.escaped=t.escaped,r.fixed=s,t.references.forEach(function(e){if(e.fixed){var i=e.fixed.assigns;i&&i[0]===n&&(i.length>1||e.fixed.to_binary||e.fixed.to_prefix?i[0]=o:(e.fixed=s,t.fixed===e.fixed&&(t.fixed=s)))}}),t.references.push(r)}return t.assignments++,t.eliminated++,t.single_use=!1,e},[]);return 0==e.length?null:Bn(this,e)}),e(z,ai),e(ge,ai),e(m,function(e,n){var t=e.expression,i=fi(e,n);if(i)return i;if(n.option("sequences"))if(t instanceof Oe){if((r=ci(t))!==t)return(x=e.clone()).expression=r.expressions.pop(),r.expressions.push(x),r.optimize(n)}else if(!et(t.tail_node())){var r;if((r=ci(e))!==e)return r.optimize(n)}if(n.option("unused")&&ui(e,n),n.option("unsafe"))if(pt(t))switch(t.name){case"Array":if(1==e.args.length){if((_=e.args[0])instanceof ke)try{var o=_.value;if(o>6)break;for(var a=Array(o),c=0;c<o;c++)a[c]=Yn(ae,e);return Yn(s,e,{elements:a})}catch(n){xe.warn("Invalid array length: {length} [{start}]",{length:o,start:e.start});break}if(!_.is_boolean(n)&&!_.is_string(n))break}return Yn(s,e,{elements:e.args});case"Object":if(0==e.args.length)return Yn(Te,e,{properties:[]});break;case"String":if(0==e.args.length)return Yn(Ne,e,{value:""});if(1==e.args.length)return Yn(p,e,{operator:"+",left:Yn(Ne,e,{value:""}),right:e.args[0]}).optimize(n);break;case"Number":if(0==e.args.length)return Yn(ke,e,{value:0});if(1==e.args.length)return Yn(un,e,{operator:"+",expression:Yn(p,e,{operator:"+",left:Yn(Ne,e,{value:""}),right:e.args[0]})}).optimize(n);break;case"Boolean":if(0==e.args.length)return Yn(ne,e).optimize(n);if(1==e.args.length)return Yn(un,e,{operator:"!",expression:Yn(un,e,{operator:"!",expression:e.args[0]})}).optimize(n);break;case"RegExp":var l=[];if(An(e.args,function(e){var t=e.evaluate(n);return l.unshift(t),e!==t}))try{return St(n,e,Yn(qe,e,{value:RegExp.apply(RegExp,l)}))}catch(n){xe.warn("Error converting {this} [{start}]",e)}}else if(t instanceof G)switch(t.property){case"toString":var d=t.expression;if(0==e.args.length&&!(d.may_throw_on_access(n)||d instanceof AST_Super))return Yn(p,e,{operator:"+",left:Yn(Ne,e,{value:""}),right:d}).optimize(n);break;case"join":if(t.expression instanceof s&&e.args.length<2)e:{var h=e.args[0];if(0==t.expression.elements.length&&!(h instanceof Pe))return h?Bn(e,[h,Yn(Ne,e,{value:""})]).optimize(n):Yn(Ne,e,{value:""});if(!(h&&(h=h.evaluate(n))instanceof xe)){a=[];var _,g=[];for(c=0;c<t.expression.elements.length;c++){var b=t.expression.elements[c];if((V=b.evaluate(n))!==b)g.push(V);else{if(b instanceof Pe)break e;g.length>0&&(a.push(Yn(Ne,e,{value:g.join(h)})),g.length=0),a.push(b)}}return g.length>0&&a.push(Yn(Ne,e,{value:g.join(h)})),1==a.length?a[0].is_string(n)?a[0]:Yn(p,a[0],{operator:"+",left:Yn(Ne,e,{value:""}),right:a[0]}):""==h?(_=a[0].is_string(n)||a[1].is_string(n)?a.shift():Yn(Ne,e,{value:""}),a.reduce(function(e,n){return Yn(p,n,{operator:"+",left:e,right:n})},_).optimize(n)):((le=e.clone()).expression=le.expression.clone(),le.expression.expression=le.expression.expression.clone(),le.expression.expression.elements=a,St(n,e,le))}}break;case"charAt":if(e.args.length<2)return(le=Yn(p,e,{operator:"||",left:Yn(Ye,e,{expression:t.expression,property:e.args.length?Yn(p,e.args[0],{operator:"|",left:Yn(ke,e,{value:0}),right:e.args[0]}):Yn(ke,e,{value:0})}).optimize(n),right:Yn(Ne,e,{value:""})})).is_string=Un,le.optimize(n);break;case"apply":if(2==e.args.length&&e.args[1]instanceof s)return(te=e.args[1].elements.slice()).unshift(e.args[0]),Yn(m,e,{expression:Yn(G,t,{expression:t.expression,property:"call"}),args:te}).optimize(n);break;case"call":var y=t.expression;if(y instanceof en&&(y=y.fixed_value()),y instanceof he&&!y.contains_this())return(e.args.length?Bn(e,[e.args[0],Yn(m,e,{expression:t.expression,args:e.args.slice(1)})]):Yn(m,e,{expression:t.expression,args:[]})).optimize(n)}else if(n.option("side_effects")&&t instanceof m&&1==t.args.length&&pt(t.expression)&&"Object"==t.expression.name){var x;return(x=e.clone()).expression=nt(e,t,t.args[0]),x.optimize(n)}if(n.option("unsafe_Function")&&pt(t)&&"Function"==t.name){if(0==e.args.length)return Yn(se,e,{argnames:[],body:[]}).init_vars(t.scope);if(An(e.args,function(e){return e instanceof Ne}))try{var w="n(function("+e.args.slice(0,-1).map(function(e){return e.value}).join()+"){"+e.args[e.args.length-1].value+"})",k=Wn(w),T={ie:n.option("ie")};k.figure_out_scope(T);var E,S=new Zn(n.options);(k=k.transform(S)).figure_out_scope(T),k.compute_char_frequency(T),k.mangle_names(T),k.walk(new mn(function(e){return!!E||(e instanceof he?(E=e,!0):void 0)}));w=Jn();return v.prototype._codegen.call(E,w),e.args=[Yn(Ne,e,{value:E.argnames.map(function(e){return e.print_to_string()}).join()}),Yn(Ne,e.args[e.args.length-1],{value:w.get().replace(/^\{|\}$/g,"")})],e}catch(n){if(!(n instanceof Gn))throw n;xe.warn("Error parsing code passed to new Function [{start}]",e.args[e.args.length-1]),xe.warn(n.toString())}}var A=t instanceof en?t.fixed_value():t,z=n.parent(),O=n.self(),q=A instanceof he&&(!is_async(A)||n.option("awaits")&&z instanceof u)&&(!Tn(A)||n.option("yields")&&O instanceof _n&&O.nested),F=q&&A.first_statement(),M=0,C=!1,P=!An(e.args,function(e){return!(e instanceof Pe)}),H=q&&An(A.argnames,function(n,t){if(1==M&&e.args[t]instanceof Pe&&(M=2),n instanceof j){if(M||(M=1),wt(1==M&&e.args[t])||(M=2),Pi(A,n.value))return!1;n=n.name}return!(n instanceof I&&(C=!0,Pi(A,n)))})&&!(A.rest instanceof I&&Pi(A,A.rest)),Y=H&&n.option("inline")&&!e.is_expr_pure(n)&&(t===A||di(A,n));if(Y&&F instanceof Fe){var V=F.value;if(t===A&&!A.name&&(!V||V.is_constant_expression())&&pi(A,li(n)))return Bn(e,ge(V)).optimize(n)}if(q&&!A.contains_this()){var B,X=!1;if(Y&&!A.uses_arguments&&!A.pinned()&&!(A.name&&A instanceof _e)&&(t===A||!Ei(n,B=t.definition(),A)&&A.is_constant_expression(On(n)))&&(V=function(e){var t=A.body.length;if(t<2&&(e=be(e)))return e;if(n.option("inline")<3)return!1;e=null;for(var i=0;i<t;i++){var r=A.body[i];if(r instanceof pn){if(X){if(!e)continue;if(!(e instanceof je))return!1;_t(r)||(e=null)}else if(!_t(r)){if(e&&!(e instanceof je))return!1;e=null,X=!0}}else{if(r instanceof AST_AsyncDefun||r instanceof N||r instanceof $)continue;if(e)return!1;e=r}}return be(e)}(F))){var J,K,Q,Z,ee=t===A||B.single_use&&B.references.length-B.replaced==1;if(function(){if(M||C||P||X||A.rest)return;if(n.option("inline")<2&&A.argnames.length)return;if(!A.variables.all(function(e){return e.references.length-e.replaced<2&&e.orig[0]instanceof Xe}))return;var t,i=n.find_parent(Me),r=!1,o=li(n,i),s=[],a=!1,c=new mn(function(e,i){if(r)return!0;if(e instanceof p&&kt[e.operator]||e instanceof D)s=null;else{if(e instanceof Me)return r=!0;if(o&&e instanceof Le&&o[e.name])return r=!0;if(e instanceof en){var u=e.definition();if(A.variables.get(e.name)!==u)return void(s=null);if(u.init instanceof ve)return r=!0;if(Qn(e,c.parent()))return r=!0;var l=ye(u);if(t<l||(t=l),!s)return;a?s=null:s.push(A.argnames[l])}else if(!a)return e instanceof f&&e.left instanceof Oe?(e.left.expression.walk(c),e.left instanceof Ye&&e.left.property.walk(c),e.right.walk(c),a=!0,!0):e.has_side_effects(n)?(i(),a=!0,!0):void 0}});if(V.walk(c),r)return;var u=e.args.length;if(s&&A.argnames.length>=u){for(u=A.argnames.length;u-- >t&&A.argnames[u]===s.pop(););u++}return u<=t||An(e.args.slice(t,u),a&&!s?function(e){return e.is_constant_expression(i)}:function(e){return!e.has_side_effects(n)})}()){var te=e.args.slice(),oe=[],fe=V.clone(!0).transform(new gn(function(n){if(n instanceof en){var t=n.definition();if(A.variables.get(n.name)!==t)return oe.push(n),n;var i=ye(t),r=te[i];if(!r)return Yn(ln,e);te[i]=null;var o=this.parent();return o?nt(o,n,r):r}})),ce=A.inlined;t!==A&&(A.inlined=!0);var ue=[];te.forEach(function(e){e&&((e=e.clone(!0)).walk(new mn(function(e){e instanceof en&&oe.push(e)})),ue.push(e))},[]),ue.push(fe);var le=Bn(e,ue).optimize(n);if(A.inlined=ce,le=nt(z,O,le),ee||Tt(le,e)===le)return oe.forEach(function(e){e.scope=t===A?A.parent_scope:t.scope,e.reference();var n=e.definition();ee&&n.replaced++,n.single_use=!1}),le;le.has_side_effects(n)||(e.drop_side_effect_free=function(e,n){var t=this.args.slice();return t.unshift(this.expression),Bn(this,t).drop_side_effect_free(e,n)})}if(ee&&function(){var e,i=new zn,r=0;Z=O;do{if(Z.variables&&Z.variables.each(function(e){i.set(e.name,!0)}),e=Z,(Z=n.parent(r++))instanceof AST_ClassField){if(!Z.static)return!1}else if(Z instanceof W)Q=[];else if(Z instanceof ie){if(Z.init===e)continue;Q=[]}else if(Z instanceof re){if(Z.init===e)continue;if(Z.object===e)continue;Q=[]}}while(!(Z instanceof Me));if(!(K=Z.body.indexOf(e)+1))return!1;if(!pi(A,li(n,Z)))return!1;var o=(t!==A||A.parent_scope.resolve()===Z)&&!Z.pinned();Z instanceof on&&(n.toplevel.vars?i.set("arguments",!0):o=!1);J=new zn;var s=n.option("inline");return!(!function(e,n){var t=!1;return A.each_argname(function(i){if(!t&&!i.unused){if(!n||we(e,i.name))return t=!0;J.set(i.name,!0),Q&&Q.push(i.definition())}}),!t}(i,s>=2&&o)||!function(e,n){for(var t=0;t<A.body.length;t++){var i=A.body[t];if(i instanceof ve){var r=i.name;if(!n)return!1;if(J.has(r.name))return!1;if(we(e,r.name))return!1;if(!An(i.enclosed,function(n){return n.scope===Z||n.scope===i||!e.has(n.name)}))return!1;Q&&Q.push(r.definition())}else if(i instanceof pn){if(!n)return!1;for(var o=i.definitions.length;--o>=0;){var r=i.definitions[o].name;if(we(e,r.name))return!1;Q&&Q.push(r.definition())}}}return!0}(i,s>=3&&o)||Q&&0!=Q.length&&Oi(A,Q))}()){A._squeezed=!0,t!==A&&(A.parent_scope=t.scope);le=Bn(e,function(){var t=[],i=[];M>1||C||P||A.rest?function(n,t){function i(e,i){if(i.unused)return de(i);var r=i.definition();r.assignments++,r.references.push(e);var o=Yn(AST_SymbolVar,i);r.orig.push(o),r.eliminated++,Ee(n,t,o)}t.push(Yn(f,e,{operator:"=",left:Yn(R,e,{elements:A.argnames.map(function(e){return e.unused?Yn(ae,e):e.convert_symbol(en,i)}),rest:A.rest&&A.rest.convert_symbol(en,i)}),right:Yn(s,e,{elements:e.args.slice()})}))}(t,i):function(n,t){for(var i=A.argnames.length,r=e.args.length;--r>=i;)t.push(e.args[r]);var o=[];for(r=i;--r>=0;){var s,a=A.argnames[r];a instanceof j?(o.push(a),s=a.name):s=a;var c=e.args[r];if(s.unused||Z.var_names().has(s.name))c&&t.push(c);else{var u=Yn(AST_SymbolVar,s),l=s.definition();l.orig.push(u),l.eliminated++,void 0!==s.unused?(Ee(n,t,u),c&&t.push(c)):(!c&&a===s&&(Q||"arguments"==s.name&&!kn(A)&&kn(Z))&&(c=Yn(ln,e)),Ee(n,t,u,c))}}for(n.reverse(),t.reverse(),r=o.length;--r>=0;){var p=o[r];if(void 0!==p.name.unused)t.push(p.value);else{var d=Yn(en,p.name);p.name.definition().references.push(d),t.push(Yn(f,p,{operator:"=",left:d,right:p.value}))}}}(t,i);var r=function(e,t){var i=[K,0],r=[],o=[],s=[],a=[],f=[];return A.body.filter(Q?function(n){if(!(n instanceof ve))return!0;var t=Yn(AST_SymbolVar,ji(n.name)),i=t.definition();return i.fixed=!1,i.orig.push(t),i.eliminated++,Ee(e,o,t,Bt(n,!0)),!1}:function(e){if(!(e instanceof ve))return!0;var n=e.name.definition();return Z.functions.set(n.name,n),Z.variables.set(n.name,n),Z.enclosed.push(n),Z.var_names().set(n.name,!0),i.push(e),!1}).forEach(function(e){if(e instanceof pn)for(var t=0;t<e.definitions.length;t++){var i=e.definitions[t],o=ji(i.name),c=i.value;c&&f.length>0&&(f.push(c),c=Bn(i,f),f=[]),Ee(r,s,o,c),Q&&(J.has(o.name)||1==o.definition().orig.length&&A.functions.has(o.name)||a.push(Ni(n,o)))}else e instanceof je&&f.push(e.body)}),[].push.apply(e,r),[].push.apply(t,a),[].push.apply(t,o),[].push.apply(t,s),i}(t,i);i.push(V),t.length&&r.push(Yn(pn,A,{definitions:t}));return[].splice.apply(Z.body,r),A.enclosed.forEach(function(e){Z.var_names().has(e.name)||(Z.enclosed.push(e),Z.var_names().set(e.name,!0))}),i}()).optimize(n);return nt(z,O,le)}}if(n.option("side_effects")&&H&&An(A.body,at)&&(A===t?Jt(A,n):!M&&!C&&!A.rest)&&(!kn(A)||!A.value)&&pi(A,li(n)))return Bn(e,ge()).optimize(n)}if(n.option("drop_console")&&t instanceof Oe){for(var pe=t.expression;pe.expression;)pe=pe.expression;if(pt(pe)&&"console"==pe.name)return Yn(ln,e).optimize(n)}return n.option("negate_iife")&&z instanceof je&&ut(O)?e.negate(n,!0):Ot(n,e);function de(e){return Yn(Ye,e,{expression:Yn(s,e,{elements:[]}),property:Yn(ke,e,{value:0})})}function ge(n){var t=e.args.slice(),i=M>1||C||A.rest;if((i||P)&&(t=[Yn(s,e,{elements:t})]),i){var r=new gn(function(e,n){if(e instanceof j)return Yn(j,e,{name:e.name.transform(r)||de(e),value:e.value});if(e instanceof R){var t=[];return e.elements.forEach(function(e,n){(e=e.transform(r))&&(t[n]=e)}),Ut(e,t),Yn(R,e,{elements:t})}if(e instanceof U){var i=[],o=[];return e.properties.forEach(function(n){var t=n.key,s=n.value.transform(r);s?(o.length&&(t instanceof xe||(t=Kn(t,n)),o.push(t),t=Bn(e,o),o=[]),i.push(Yn(L,n,{key:t,value:s}))):t instanceof xe&&o.push(t)}),o.length&&i.push(Yn(L,e,{key:Bn(e,o),value:de(e)})),Yn(U,e,{properties:i})}return e instanceof Xe?null:void 0}),o=[];A.argnames.forEach(function(e,n){(e=e.transform(r))&&(o[n]=e)});var a=A.rest&&A.rest.transform(r);a&&(o.length=A.argnames.length),Ut(A,o),t[0]=Yn(f,e,{operator:"=",left:Yn(R,A,{elements:o,rest:a}),right:t[0]})}else A.argnames.forEach(function(e){e instanceof j&&t.push(e.value)});return t.push(n||Yn(ln,e)),t}function me(){return e.call_only?Yn(ke,e,{value:0}):Yn(ln,e)}function be(n){return n?n instanceof Fe?n.value||me():n instanceof je?e.call_only?n.body:Yn(un,n,{operator:"void",expression:n.body}):void 0:me()}function ye(e){for(var n=A.argnames.length;--n>=0;)if(A.argnames[n].definition()===e)return n}function we(e,n){return e.has(n)||Cn[n]||Z.var_names().has(n)}function Ee(n,t,i,r){var o=i.definition();if(Z.var_names().has(i.name)||(Z.var_names().set(i.name,!0),n.push(Yn(dn,i,{name:i,value:null}))),Z.variables.set(i.name,o),Z.enclosed.push(o),r){var s=Yn(en,i);o.assignments++,o.references.push(s),t.push(Yn(f,e,{operator:"=",left:s,right:r}))}}}),e(ye,function(e,n){if(n.option("unsafe")){var t=e.expression;if(pt(t))switch(t.name){case"Array":case"Error":case"Function":case"Object":case"RegExp":return Yn(m,e).transform(n)}}if(n.option("sequences")){var i=ci(e);if(i!==e)return i.optimize(n)}return n.option("unused")&&ui(e,n),e}),e(Ce,function(e,n){var t=function(){if(!n.option("side_effects"))return e.expressions;var t=[],i=wn(n),r=e.expressions.length-1;return e.expressions.forEach(function(e,o){o<r&&(e=e.drop_side_effect_free(n,i)),e&&(it(t,e),i=!1)}),t}(),i=t.length-1;return function(){for(var e=1;e<i;e++){var o=t[e-1],s=r(o);if(s){var a=t[e];if(n.option("conditionals")){var f=hi(n,s,o.right,a);if(f){o.right=f,t.splice(e--,1),i--;continue}}n.option("dead_code")&&r(a)===s&&a.right.is_constant_expression(s.scope.resolve())&&(t[--e]=o.right)}}}(),function(){if(!n.option("side_effects"))return;for(;i>0&&wt(t[i],n);)i--;i<t.length-1&&(t[i]=Yn(un,e,{operator:"void",expression:t[i]}),t.length=i+1)}(),0==i?((e=nt(n.parent(),n.self(),t[0]))instanceof Ce||(e=e.optimize(n)),e):(e.expressions=t,e);function r(e){return e instanceof f&&"="==e.operator&&e.left instanceof en&&e.left.definition()}}),e(cn,function(e,n){if(n.option("sequences")){var t=ci(e);if(t!==e)return t.optimize(n)}return Ot(n,e)});var vi=Mn("+ -"),_i=Mn("* / %");e(un,function(e,n){var t=e.operator,i=e.expression;if(n.option("sequences")&&function(){switch(t){case"delete":return!f(i.tail_node());case"typeof":return!pt(i.tail_node());default:return!0}}()){var r=ci(e);if(r!==e)return r.optimize(n)}switch(t){case"+":if(!n.option("evaluate"))break;if(!i.is_number(n,!0))break;var o=n.parent();if(o instanceof un&&"delete"==o.operator)break;return i;case"-":if(i instanceof ue&&(i=i.transform(n)),i instanceof ke||i instanceof ue)return e;break;case"!":if(!n.option("booleans"))break;if(i.is_truthy())return Bn(e,[i,Yn(ne,e)]).optimize(n);if(n.in_boolean_context()){if(i instanceof un&&"!"==i.operator)return i.expression;if(i instanceof p){var s=wn(n);e=(s?Et:Tt)(e,i.negate(n,s))}}break;case"delete":if(!n.option("evaluate"))break;if(f(i))break;return Bn(e,[i,Yn(sn,e)]).optimize(n);case"typeof":if(!n.option("booleans"))break;if(!n.in_boolean_context())break;xe.warn("Boolean expression always true [{start}]",e);var a=[Yn(sn,e)];return i instanceof en&&A(i,n)||a.unshift(i),Bn(e,a).optimize(n);case"void":if(!n.option("side_effects"))break;return(i=i.drop_side_effect_free(n))?(e.expression=i,e):Yn(ln,e).optimize(n)}return n.option("evaluate")&&i instanceof p&&vi[t]&&_i[i.operator]&&(i.left.is_constant()||!i.right.has_side_effects(n))?Yn(p,e,{operator:i.operator,left:Yn(un,i.left,{operator:t,expression:i.left}),right:i.right}):Ot(n,e);function f(e){return e instanceof ue||e instanceof be||e instanceof AST_NewTarget||e instanceof Oe||e instanceof en||e instanceof ln}}),e(u,function(e,n){if(!n.option("awaits"))return e;if(n.option("sequences")){var t=ci(e);if(t!==e)return t.optimize(n)}if(n.option("side_effects")){var i=e.expression;if(i instanceof u)return i.optimize(n);if(i instanceof un&&i.expression instanceof u)return i.optimize(n);for(var r,o=0,s=e;r=n.parent(o++);s=r){if(kn(r)){if(r.value===s)return i.optimize(n)}else if(r instanceof Fe){var a=!0;do{if(s=r,(r=n.parent(o++))instanceof an&&(r.bfinally||r.bcatch)!==s){a=!1;break}}while(r&&!(r instanceof Me));if(a)return i.optimize(n)}else if(r instanceof Ce&&r.tail_node()===s)continue;break}}return e}),e(_n,function(e,n){if(!n.option("yields"))return e;if(n.option("sequences")){var t=ci(e);if(t!==e)return t.optimize(n)}var i=e.expression;if(e.nested&&"Call"==i.TYPE){var r=i.clone().optimize(n);if("Call"!=r.TYPE)return r}return e}),p.DEFMETHOD("lift_sequences",function(e){if(this.left instanceof Oe){if(!(this.left.expression instanceof Ce))return this;var n=this.left.expression.expressions.slice();return(t=this.clone()).left=t.left.clone(),t.left.expression=n.pop(),n.push(t),Bn(this,n)}if(this.left instanceof Ce){n=this.left.expressions.slice();return(t=this.clone()).left=n.pop(),n.push(t),Bn(this,n)}if(this.right instanceof Ce){if(this.left.has_side_effects(e))return this;for(var t,i="="==this.operator&&this.left instanceof en,r=(n=this.right.expressions).length-1,o=0;o<r&&(i||!n[o].has_side_effects(e));o++);if(o==r)return n=n.slice(),(t=this.clone()).right=n.pop(),n.push(t),Bn(this,n);if(o>0)return(t=this.clone()).right=Bn(this.right,n.slice(o)),(n=n.slice(0,o)).push(t),Bn(this,n)}return this});var gi=Mn("indexOf lastIndexOf"),mi=Mn("== === != !== * & | ^");function bi(e,n){return e instanceof f?!n&&"="==e.operator&&bi(e.right):e instanceof ye?!n:e instanceof Ce?bi(e.tail_node(),n):e instanceof en?!n&&bi(e.fixed_value()):e instanceof s||e instanceof w||e instanceof he||e instanceof Te}function yi(e,n,t){switch(e){case"in":return bi(n)||t&&t.option("unsafe_comps");case"instanceof":return n instanceof en&&(n=n.fixed_value()),i(n)||t&&t.option("unsafe_comps");default:return!0}}function xi(e,n){if(n.is_constant())return!0;if(n instanceof f)return"="!=n.operator||xi(e,n.right);if(n instanceof p)return!kt[n.operator]||xi(e,n.left)&&xi(e,n.right);if(n instanceof m)return is_async(n.expression);if(n instanceof D)return xi(e,n.consequent)&&xi(e,n.alternative);if(n instanceof Ce)return xi(e,n.tail_node());if(n instanceof en){var t=n.fixed_value();return t&&xi(e,t)}return n instanceof nn?!n.tag||Ai(e,n.tag):n instanceof fn||void 0}function wi(e,n){return e instanceof f?Nn(e.left,n)?e:e.left:e instanceof Ce?wi(e.tail_node(),n):e instanceof un&&UNARY_POSTFIX[e.operator]?Nn(e.expression,n)?e:e.expression:e}function ki(e,n){return n instanceof G?ki(e,n.expression):n instanceof Ye?ki(e,n.expression)&&ki(e,n.property):n instanceof Le||!n.has_side_effects(e)}function Ti(e,n){var t=e.right.tail_node();if(t!==e.right){var i=e.right.expressions.slice(0,-1);i.push(t.left),(t=t.clone()).left=Bn(e.right,i),e.right=t}e.left=Yn(p,e,{operator:e.operator,left:e.left,right:t.left,start:e.left.start,end:t.left.end}),e.right=t.right,n?e.left=e.left.transform(n):e.operator==t.left.operator&&Ti(e.left)}function Ei(e,n,t){var r=0,o=e.self();do{if(o===t)return o;if(i(o)&&o.name&&o.name.definition()===n)return o}while(o=e.parent(r++))}function Si(e){var n=e.scope.resolve();return An(e.references,function(e){return n===e.scope.resolve()})}function Ai(e,n){return e.option("unsafe")&&n instanceof G&&"raw"==n.property&&pt(n.expression)&&"String"==n.expression.name}function Di(e){var n=!1;if(e=e.replace(/\\(u\{[^{}]*\}?|u[\s\S]{0,4}|x[\s\S]{0,2}|[0-9]+|[\s\S])/g,function(e,t){var i=decode_escape_sequence(t);if("string"==typeof i)return i;n=!0}),!n)return e}function zi(e,n){return e instanceof en||e.TYPE===n.TYPE}function Oi(e,n){var t=!1,i=new mn(function(e){return!!t||(e instanceof en&&jn(e.definition(),n)?t=!0:void 0)}),r=new mn(function(n){if(t)return!0;if(n instanceof he&&n!==e){if(!(n.name||is_async(n)||Tn(n))){var o=r.parent();if(o instanceof m&&o.expression===n)return}return n.walk(i),!0}});return e.walk(r),t}e(p,function(e,n){if(!mi[e.operator]||!e.right.is_constant()||e.left.is_constant()||e.left instanceof p&&$n[e.left.operator]>=$n[e.operator]||P(),n.option("sequences")){var t=e.lift_sequences(n);if(t!==e)return t.optimize(n)}if(n.option("assignments")&&kt[e.operator]){var r=wi(e.left,n),o=e.right;if(r instanceof en&&o instanceof f&&"="==o.operator&&r.equals(o.left)){r=r.clone();var s=Yn(f,e,{operator:"=",left:r,right:Yn(p,e,{operator:e.operator,left:e.left,right:o.right})});r.fixed&&(r.fixed=function(){return s.right},r.fixed.assigns=[s]);var a=r.definition();return a.references.push(r),a.replaced++,s.optimize(n)}}if(n.option("comparisons"))switch(e.operator){case"===":case"!==":if(wt(e.left,n)&&e.right.is_defined(n))return xe.warn("Expression always defined [{start}]",e),Bn(e,[e.right,Yn("==="==e.operator?ne:sn,e)]).optimize(n);var c=!0;(e.left.is_string(n)&&e.right.is_string(n)||e.left.is_number(n)&&e.right.is_number(n)||e.left.is_boolean(n)&&e.right.is_boolean(n)||ki(n,e.left)&&e.left.equals(e.right))&&(e.operator=e.operator.slice(0,2));case"==":case"!=":if(!c&&wt(e.left,n))e.left=Yn(we,e.left);else if(n.option("typeofs")&&e.left instanceof Ne&&"undefined"==e.left.value&&e.right instanceof un&&"typeof"==e.right.operator){((l=e.right.expression)instanceof en?!l.is_declared(n):l instanceof Oe&&n.option("ie"))||(e.right=l,e.left=Yn(ln,e.left).optimize(n),2==e.operator.length&&(e.operator+="="))}else if(e.left instanceof en&&e.right instanceof en&&e.left.definition()===e.right.definition()&&bi(e.left))return Yn("="==e.operator[0]?sn:ne,e).optimize(n);break;case"&&":case"||":var u=e.left;if(!(u instanceof p))break;if(u.operator!=("&&"==e.operator?"!==":"==="))break;if(!(e.right instanceof p))break;if(u.operator!=e.right.operator)break;if(wt(u.left,n)&&e.right.left instanceof we||u.left instanceof we&&wt(e.right.left,n)){var l;if((l=u.right)instanceof f&&"="==l.operator&&(l=l.left),l.has_side_effects(n))break;if(!l.equals(e.right.right))break;return u.operator=u.operator.slice(0,-1),u.left=Yn(we,e),u}}var d=!1,h=n.parent();if(n.option("booleans")){r=wi(e.left,n);if(kt[e.operator]&&!r.has_side_effects(n)){if(r.equals(e.right))return nt(h,n.self(),e.left).optimize(n);ni(n,r)}d=n.in_boolean_context()}if(d)switch(e.operator){case"+":var v=e.left.evaluate(n,!0);if(v&&"string"==typeof v||(v=e.right.evaluate(n,!0))&&"string"==typeof v){xe.warn("+ in boolean context always true [{start}]",e);var _=[];if(e.left.evaluate(n)instanceof xe&&_.push(e.left),e.right.evaluate(n)instanceof xe&&_.push(e.right),_.length<2)return _.push(Yn(sn,e)),Bn(e,_).optimize(n);e.truthy=!0}break;case"==":if(e.left instanceof Ne&&""==e.left.value&&e.right.is_string(n))return Yn(un,e,{operator:"!",expression:e.right}).optimize(n);break;case"!=":if(e.left instanceof Ne&&""==e.left.value&&e.right.is_string(n))return e.right.optimize(n)}if(n.option("comparisons")&&e.is_boolean(n)){if("Binary"!=h.TYPE){var g=Yn(un,e,{operator:"!",expression:e.negate(n)});if(St(n,e,g)===g)return g}switch(e.operator){case">":P("<");break;case">=":P("<=")}}if(n.option("conditionals")&&kt[e.operator]){if(e.left instanceof p&&e.operator==e.left.operator){var m=Yn(p,e,{operator:e.operator,left:e.left.right,right:e.right}),b=m.transform(n);m!==b&&(e.left=e.left.left,e.right=b)}(E=e.right.tail_node())instanceof p&&e.operator==E.operator&&Ti(e,n)}if(n.option("strings")&&"+"==e.operator){if(e.right instanceof Ne&&""==e.right.value&&e.left.is_string(n))return e.left.optimize(n);if(e.left instanceof Ne&&""==e.left.value&&e.right.is_string(n))return e.right.optimize(n);if(e.left instanceof p&&"+"==e.left.operator&&e.left.left instanceof Ne&&""==e.left.left.value&&e.right.is_string(n)&&(e.left.right.is_constant()||!e.right.has_side_effects(n)))return e.left=e.left.right,e.optimize(n);(E=e.right.tail_node())instanceof p&&e.operator==E.operator&&(e.left.is_string(n)&&E.is_string(n)||E.left.is_string(n)&&(e.left.is_constant()||!E.right.has_side_effects(n)))&&Ti(e,n)}if(n.option("evaluate")){var y=!0;switch(e.operator){case"&&":if(!(T=ei(n,e.left)))return xe.warn("Condition left of && always false [{start}]",e),nt(h,n.self(),e.left).optimize(n);if(!(T instanceof xe))return xe.warn("Condition left of && always true [{start}]",e),Bn(e,[e.left,e.right]).optimize(n);if(e.right.evaluate(n,!0)){if((d||"&&"==h.operator&&h.left===n.self())&&!(e.right.evaluate(n)instanceof xe))return xe.warn("Dropping side-effect-free && [{start}]",e),e.left.optimize(n)}else{if(d&&!(e.right.evaluate(n)instanceof xe))return xe.warn("Boolean && always false [{start}]",e),Bn(e,[e.left,Yn(ne,e)]).optimize(n);e.falsy=!0}if("||"==e.left.operator)if(!(k=ei(n,e.left.right)))return Yn(D,e,{condition:e.left.left,consequent:e.right,alternative:e.left.right}).optimize(n);break;case"??":var x=!0;case"||":var w,k,T=ei(n,e.left,x);if(x?null==T:!T)return xe.warn("Condition left of {operator} always {value} [{start}]",{operator:e.operator,value:x?"nullish":"false",start:e.start}),Bn(e,[e.left,e.right]).optimize(n);if(!(T instanceof xe))return xe.warn("Condition left of {operator} always {value} [{start}]",{operator:e.operator,value:x?"defined":"true",start:e.start}),nt(h,n.self(),e.left).optimize(n);if(x||!(w=e.right.evaluate(n,!0))||w instanceof xe){if((d||"||"==h.operator&&h.left===n.self())&&!e.right.evaluate(n))return xe.warn("Dropping side-effect-free {operator} [{start}]",e),e.left.optimize(n)}else{if(d&&!(e.right.evaluate(n)instanceof xe))return xe.warn("Boolean || always true [{start}]",e),Bn(e,[e.left,Yn(sn,e)]).optimize(n);e.truthy=!0}if(!x&&"&&"==e.left.operator)if((k=ei(n,e.left.right))&&!(k instanceof xe))return Yn(D,e,{condition:e.left.left,consequent:e.left.right,alternative:e.right}).optimize(n);break;case"+":if(e.left instanceof O&&e.right instanceof p&&"+"==e.right.operator&&e.right.left instanceof O&&e.right.is_string(n)&&(e=Yn(p,e,{operator:"+",left:Yn(Ne,e.left,{value:""+e.left.value+e.right.left.value,start:e.left.start,end:e.right.left.end}),right:e.right.right})),e.right instanceof O&&e.left instanceof p&&"+"==e.left.operator&&e.left.right instanceof O&&e.left.is_string(n)&&(e=Yn(p,e,{operator:"+",left:e.left.left,right:Yn(Ne,e.right,{value:""+e.left.right.value+e.right.value,start:e.left.right.start,end:e.right.end})})),e.right instanceof un&&"-"==e.right.operator&&e.left.is_number(n)){e=Yn(p,e,{operator:"-",left:e.left,right:e.right.expression});break}if(e.left instanceof un&&"-"==e.left.operator&&j()&&e.right.is_number(n)){e=Yn(p,e,{operator:"-",left:e.right,right:e.left.expression});break}if(n.option("unsafe_math")&&e.left instanceof p&&$n[e.left.operator]==$n[e.operator]&&e.right.is_constant()&&(e.right.is_boolean(n)||e.right.is_number(n))&&e.left.is_number(n)&&!e.left.right.is_constant()&&(e.left.left.is_boolean(n)||e.left.left.is_number(n))){e=Yn(p,e,{operator:e.left.operator,left:Yn(p,e,{operator:e.operator,left:e.right,right:e.left.left}),right:e.left.right});break}case"-":if(e.right instanceof un&&"-"==e.right.operator&&e.left.is_number(n)&&e.right.expression.is_number(n)){e=Yn(p,e,{operator:"+",left:e.left,right:e.right.expression});break}case"*":case"/":y=n.option("unsafe_math"),"+"!=e.operator&&["left","right"].forEach(function(t){var i=e[t];if(i instanceof un&&"+"==i.operator){var r=i.expression;(r.is_boolean(n)||r.is_number(n)||r.is_string(n))&&(e[t]=r)}});case"&":case"|":case"^":if("-"==e.operator||"/"==e.operator||!e.left.is_boolean(n)&&!e.left.is_number(n)||!e.right.is_boolean(n)&&!e.right.is_number(n)||!j()||e.left instanceof p&&e.left.operator!=e.operator&&$n[e.left.operator]>=$n[e.operator]||(e=St(n,e,Yn(p,e,{operator:e.operator,left:e.right,right:e.left}),e.right instanceof O&&!(e.left instanceof O))),!y||!e.is_number(n))break;if(!(e.right instanceof p&&"%"!=e.right.operator&&$n[e.right.operator]==$n[e.operator]&&e.right.is_number(n)&&("+"!=e.operator||e.right.left.is_boolean(n)||e.right.left.is_number(n)))||"-"==e.operator&&e.left.is_negative_zero()||!e.right.left.is_constant_expression()&&e.right.right.has_side_effects(n)||function(e){var n=!1;return e.walk(new mn(function(e){if(n)return!0;if(e instanceof f){if(e.left instanceof Oe)return n=!0}else if(e instanceof fn&&unary_side_effects[e.operator]&&e.expression instanceof Oe)return n=!0})),n}(e.right.right)||"+"!=(e=Yn(p,e,{operator:F(e.operator,e.right.operator),left:Yn(p,e.left,{operator:e.operator,left:e.left,right:e.right.left,start:e.left.start,end:e.right.left.end}),right:e.right.right})).operator||e.right.is_boolean(n)||e.right.is_number(n)||(e.right=Yn(un,e.right,{operator:"+",expression:e.right})),e.right instanceof O&&e.left instanceof p&&"%"!=e.left.operator&&$n[e.left.operator]==$n[e.operator]&&e.left.is_number(n))if(e.left.left instanceof O){r=M(e.operator,e.left.left,e.right,{start:e.left.left.start,end:e.right.end});e=M(e.left.operator,Ot(n,r),e.left.right,e)}else if(e.left.right instanceof O){var E,S=F(e.left.operator,e.operator);!(E=Ot(n,M(S,e.left.right,e.right,e.left))).is_constant()||"-"==e.left.operator&&0!=e.right.value&&0==+E.value&&e.left.left.is_negative_zero()||(e=M(e.left.operator,e.left.left,E,e))}break;case"instanceof":if(i(e.right))return Bn(e,[e,Yn(ne,e)]).optimize(n)}if(!(h instanceof un&&"delete"==h.operator)){if(e.left instanceof ke&&!e.right.is_constant())switch(e.operator){case"+":if(0==e.left.value){if(e.right.is_boolean(n))return Yn(un,e,{operator:"+",expression:e.right}).optimize(n);if(e.right.is_number(n)&&!e.right.is_negative_zero())return e.right}break;case"*":if(1==e.left.value)return Yn(un,e,{operator:"+",expression:e.right}).optimize(n)}if(e.right instanceof ke&&!e.left.is_constant())switch(e.operator){case"+":if(0==e.right.value){if(e.left.is_boolean(n))return Yn(un,e,{operator:"+",expression:e.left}).optimize(n);if(e.left.is_number(n)&&!e.left.is_negative_zero())return e.left}break;case"-":if(0==e.right.value)return Yn(un,e,{operator:"+",expression:e.left}).optimize(n);break;case"/":if(1==e.right.value)return Yn(un,e,{operator:"+",expression:e.left}).optimize(n)}}}if(n.option("typeofs"))switch(e.operator){case"&&":Zt(e.left,e.right,null);break;case"||":Zt(e.left,null,e.right)}if(n.option("unsafe")){var A=C(e.right);if(d&&A&&("=="==e.operator||"!="==e.operator)&&e.left instanceof ke&&0==e.left.value)return("=="==e.operator?Yn(un,e,{operator:"!",expression:e.right}):e.right).optimize(n);var z=C(e.left);if(n.option("comparisons")&&function(){switch(e.operator){case"<=":return A&&e.left instanceof ke&&0==e.left.value;case"<":if(z&&e.right instanceof ke&&0==e.right.value)return!0;case"==":case"!=":return!!A&&(e.left instanceof ke&&-1==e.left.value||e.left instanceof un&&"-"==e.left.operator&&e.left.expression instanceof ke&&1==e.left.expression.value)}}()){var q=Yn(un,e,{operator:"!",expression:Yn(un,e,{operator:"~",expression:z?e.left:e.right})});switch(e.operator){case"<":if(z)break;case"<=":case"!=":q=Yn(un,e,{operator:"!",expression:q})}return q.optimize(n)}}return Ot(n,e);function F(e,n){switch(e){case"-":return"+"==n?"-":"+";case"/":return"*"==n?"/":"*";default:return n}}function M(e,t,i,r){return"+"==e&&(t.is_boolean(n)||t.is_number(n)||(t=Yn(un,t,{operator:"+",expression:t})),i.is_boolean(n)||i.is_number(n)||(i=Yn(un,i,{operator:"+",expression:i}))),Yn(p,r,{operator:e,left:t,right:i})}function C(e){return"Call"==e.TYPE&&e.expression instanceof G&&gi[e.expression.property]}function j(){return e.left.is_constant()||e.right.is_constant()||!e.left.has_side_effects(n)&&!e.right.has_side_effects(n)}function P(n){if(j()){n&&(e.operator=n);var t=e.left;e.left=e.right,e.right=t}}}),e($e,function(e){return e}),e(en,function(e,n){if(!n.option("ie")&&pt(e)&&(!e.scope.resolve().uses_with||!n.find_parent(vn)))switch(e.name){case"undefined":return Yn(ln,e).optimize(n);case"NaN":return Yn(be,e).optimize(n);case"Infinity":return Yn(ue,e).optimize(n)}var t=n.parent();if(n.option("reduce_vars")&&Qn(n.self(),t)!==n.self()){var r,o,s,a=e.definition(),f=e.fixed_value(),c=a.single_use&&!(t instanceof m&&t.is_expr_pure(n));if(c)if(i(f)){if(a.scope===e.scope.resolve(!0)&&!a.in_loop||n.option("reduce_funcs")&&1!=a.escaped.depth&&!f.inlined)if(a.redefined())c=!1;else if(Ei(n,a,f))c=!1;else if(f.name&&f.name.definition()!==a)c=!1;else if(f.parent_scope!==e.scope||is_funarg(a))if(di(f,n)){if("f"==(c=f.is_constant_expression(e.scope))){var u=e.scope;do{(u instanceof ve||u instanceof _e)&&(u.inlined=!0)}while(u=u.parent_scope)}}else c=!1;else f.name&&("await"==f.name.name&&is_async(f)||"yield"==f.name.name&&Tn(f))?c=!1:f.has_side_effects(n)?c=!1:n.option("ie")&&f instanceof w&&(c=!1);else c=!1;c&&(f.parent_scope=e.scope)}else(!f||a.recursive_refs>0||!f.is_constant_expression()||f.drop_side_effect_free(n))&&(c=!1);if(c){if(a.single_use=!1,f._squeezed=!0,f.single_use=!0,f instanceof P&&(f=Vt(f)),f instanceof ve&&(f=Bt(f)),i(f)){var l=[];u=e.scope;do{if(l.push(u),u===a.scope)break}while(u=u.parent_scope);f.enclosed.forEach(function(e){if(!f.variables.has(e.name))for(var n=0;n<l.length;n++){var t=l[n];if(!Hn(t.enclosed,e))return;t.var_names().set(e.name,!0)}})}if(a.recursive_refs>0){var p,d,h=(x=f.clone(!0)).name.definition(),v=x.variables.get(x.name.name),_=v&&v.orig[0];x instanceof w?(p="def_function",d=AST_SymbolClass):(p="def_variable",d=Ke),_ instanceof d||((_=Yn(d,x.name)).scope=x,x.name=_,(v=x[p](_)).recursive_refs=a.recursive_refs),x.walk(new mn(function(e){if(e instanceof Ge)e!==_&&((n=e.definition()).orig.push(e),n.eliminated++);else if(e instanceof en){var n;if((n=e.definition())===h)e.thedef=n=v;else{n.single_use=!1;var t=e.fixed_value();i(t)&&t.name&&t.name.definition()===n&&n.scope===t.name.scope&&f.variables.get(t.name.name)===n&&(t.name=t.name.clone(),e.thedef=n=x.variables.get(t.name.name)||x[p](t.name))}n.references.push(e)}}))}else f instanceof Me?(n.push(f),x=f.optimize(n),n.pop()):x=f.optimize(n),x=x.transform(new gn(function(e,n){return e instanceof Me?e:(n(e=e.clone(),this),e)}));return a.replaced++,x}if(f&&!1!==(r=e.fixed||a.fixed).should_replace)if(f instanceof rn?is_funarg(a)||!Si(a)||function(n){var t=e.scope;for(;t!==n.scope;){if(t instanceof w)return!0;t=t.parent_scope}}(a)||(s=f):(o=f.evaluate(n,!0))!==f&&"function"!=typeof o&&(null===o||"object"!=typeof o||n.option("unsafe_regexp")&&o instanceof RegExp&&!a.cross_loop&&Si(a))&&(s=Kn(o,f)),s){if(void 0===r.should_replace){var g=s.optimize(n).print_to_string().length;k(f)||(g=Math.min(g,f.print_to_string().length));var b=a.name.length;if(n.option("unused")&&!n.exposed(a)){var y=a.references.length-a.replaced-a.assignments;y=Math.min(y,a.references.filter(function(e){return e.fixed===r}).length),b+=(b+2+g)/Math.max(1,y)}r.should_replace=g-Math.floor(b)<n.eval_threshold}var x;if(r.should_replace)return k(f)?(x=s.optimize(n))===s&&(x=x.clone(!0)):(x=Tt(s.optimize(n),f))!==s&&x!==f||(x=x.clone(!0)),a.replaced++,x}}return e;function k(e){var n;return e.walk(new mn(function(e){if(e instanceof en&&(n=!0),n)return!0})),n}}),e(nn,function(e,n){if(!n.option("templates"))return e;var t=e.tag;if(!t||Ai(n,t)){for(var i,r=[],o=[],s=0;s<e.strings.length;s++){var a=e.strings[s];if(!t){var f=Di(a);f&&(a=v(f))}if(s>0){var c=e.expressions[s-1],u=_(c);if(u){var l,d=o[o.length-1]+u+a;if(t||typeof(l=Di(d))==i){o[o.length-1]=l?v(l):d;continue}}r.push(c)}o.push(a),t||(i=typeof f)}if(!t&&o.length>1){if(""==o[o.length-1])return Yn(p,e,{operator:"+",left:Yn(nn,e,{expressions:r.slice(0,-1),strings:o.slice(0,-1)}).transform(n),right:r[r.length-1]}).optimize(n);if(""==o[0]){var h=Yn(p,e,{operator:"+",left:Yn(Ne,e,{value:""}),right:r[0]});for(s=1;""==o[s]&&s<r.length;s++)h=Yn(p,e,{operator:"+",left:h,right:r[s]});return St(n,e,Yn(p,e,{operator:"+",left:h.transform(n),right:Yn(nn,e,{expressions:r.slice(s),strings:o.slice(s)}).transform(n)}).optimize(n))}}e.expressions=r,e.strings=o}return Ot(n,e);function v(e){return e.replace(/\r|\\|`|\${/g,function(e){return"\\"+("\r"==e?"r":e)})}function _(e){var i=e.evaluate(n);if(i!==e&&!(t&&/\r|\\|`/.test(i)||(i=v(""+i)).length>e.print_to_string().length+"${}".length))return i}}),e(ln,function(e,n){if(n.option("unsafe_undefined")){var t=On(n).find_variable("undefined");if(t){var i=Yn(en,e,{name:"undefined",scope:t.scope,thedef:t});return i.is_undefined=!0,i}}var r=Qn(n.self(),n.parent());return r&&zi(r,e)?e:Yn(un,e,{operator:"void",expression:Yn(ke,e,{value:0})})}),e(ue,function(e,n){var t=Qn(n.self(),n.parent());return t&&zi(t,e)?e:!n.option("keep_infinity")||t||On(n).find_variable("Infinity")?Yn(p,e,{operator:"/",left:Yn(ke,e,{value:1}),right:Yn(ke,e,{value:0})}):e}),e(be,function(e,n){var t=Qn(n.self(),n.parent());return t&&zi(t,e)?e:t||On(n).find_variable("NaN")?Yn(p,e,{operator:"/",left:Yn(ke,e,{value:0}),right:Yn(ke,e,{value:0})}):e});var qi=Mn("+ - * / % >> << >>> | ^ &"),Fi=Mn("* | ^ &");function Mi(e,n){if(!e)return!1;var t=n.parent();return"Call"!=t.TYPE||(t.expression!==n.self()||!(e instanceof en&&!(e=e.fixed_value()))&&(e instanceof he&&!e.contains_this()))}function Ci(e){return e instanceof Ee&&"string"==typeof e.key&&!(e instanceof De&&e.value.contains_super())}function ji(e){var n=e.definition().redefined();return n&&((e=e.clone()).thedef=n),e}function Pi(e,n){var t=!1;return n.walk(new mn(function(n){return!!t||(n instanceof en&&e.variables.get(n.name)===n.definition()?t=!0:void 0)})),t}function Hi(e,n){var t=[];e.references.forEach(function(e){var i=e.fixed;i&&Hn(t,i)&&(i.assigns?i.assigns.unshift(n):i.assigns=[n])})}function Ni(e,n){var t=Yn(en,n),i=Yn(f,n,{operator:"=",left:t,right:Yn(ln,n).transform(e)}),r=n.definition();return r.fixed&&(t.fixed=function(){return i.right},t.fixed.assigns=[i],Hi(r,i)),r.assignments++,r.references.push(t),i}e(f,function(e,n){if(n.option("dead_code"))if(e.left instanceof Oe){if("="==e.operator){if(e.redundant){var t=[e.left.expression];return e.left instanceof Ye&&t.push(e.left.property),t.push(e.right),Bn(e,t).optimize(n)}if(e.left.equals(e.right)&&!e.left.has_side_effects(n))return e.right;var i=e.left.expression;if(i instanceof he||!n.has_directive("use strict")&&i instanceof O&&!i.may_throw_on_access(n))return e.left instanceof G?e.right:Bn(e,[e.left.property,e.right]).optimize(n)}}else if(e.left instanceof en&&A(e.left,n)){var r;if("="==e.operator&&e.left.equals(e.right)&&!((r=n.parent())instanceof un&&"delete"==r.operator))return e.right;if(e.left.is_immutable())return x();var o,s=e.left.definition(),a=s.scope.resolve(),c=a===n.find_parent(he),u=0;if(r=n.self(),!a.uses_arguments||!is_funarg(s)||n.has_directive("use strict"))do{if(o=r,(r=n.parent(u++))instanceof f){if(r.left instanceof en&&r.left.definition()===s){if(m(u,r,!c))break;return x(s)}if(r.left.match_symbol(function(e){if(e instanceof Oe)return!0}))break}else{if(r instanceof X){if(!c)break;if(m(u,r))break;if(Oi(a,[s]))break;return x(s)}if(r instanceof je){if(!c)break;if(Oi(a,[s]))break;var l;do{if(l=r,(r=n.parent(u++))===a&&mt(r.body,l))return x(s)}while(g(l,r));break}if(r instanceof dn){if(!(r.name instanceof Ge))continue;if(r.name.definition()!==s)continue;if(m(u,r))break;return x(s)}}}while(_(o,r))}if(n.option("sequences")){var d=e.lift_sequences(n);if(d!==e)return d.optimize(n)}if(n.option("assignments")){if("="==e.operator&&e.left instanceof en&&e.right instanceof p){if(e.right.left instanceof en&&e.right.left.name==e.left.name&&qi[e.right.operator])return b(e.right.right);if(e.right.right instanceof en&&e.right.right.name==e.left.name&&Fi[e.right.operator]&&!e.right.left.has_side_effects(n))return b(e.right.left)}if(("-="==e.operator||"+="==e.operator&&(e.left.is_boolean(n)||e.left.is_number(n)))&&e.right instanceof ke&&1==e.right.value){var h=e.operator.slice(0,-1);return Yn(un,e,{operator:h+h,expression:e.left})}}return Ot(n,e);function _(e,n){if(n instanceof p)switch(e){case n.left:return n.right.is_constant_expression(a);case n.right:return!0;default:return!1}if(n instanceof D)switch(e){case n.condition:return n.consequent.is_constant_expression(a)&&n.alternative.is_constant_expression(a);case n.consequent:case n.alternative:return!0;default:return!1}if(n instanceof Ce){var t=n.expressions,i=t.indexOf(e);if(i<0)return!1;for(var r=t.length;--r>i;)if(!t[r].is_constant_expression(a))return!1;return!0}return n instanceof un}function g(e,n){return n instanceof v?mt(n.body,e):n instanceof y?mt(n.body,e):n instanceof te?mt(n.body,e):n instanceof fe?n.body===e||n.alternative===e:n instanceof an?n.bfinally?n.bfinally===e:n.bcatch===e:void 0}function m(t,i,r){var o=e.right;e.right=Yn(we,o);var s=i.may_throw(n);return e.right=o,Fn(n,t,i,a,s,r)}function b(n){var t=e.left.fixed;return t&&(t.to_binary=J(function(e){return e.left},t)),Yn(f,e,{operator:e.right.operator+"=",left:e.left,right:n})}function x(t){return t&&(t.fixed=!1),("="!=e.operator?Yn(p,e,{operator:e.operator.slice(0,-1),left:e.left,right:e.right}):nt(n.parent(),e,e.right)).optimize(n)}}),e(D,function(e,n){if(n.option("sequences")&&e.condition instanceof Ce){var t=e.condition.expressions.slice();return(_=e.clone()).condition=t.pop(),t.push(_),Bn(e,t).optimize(n)}if(!n.option("conditionals"))return e;var i=e.condition;if(n.option("booleans")&&!i.has_side_effects(n)&&ni(n,i),!(i=ei(n,i)))return xe.warn("Condition always false [{start}]",e),Bn(e,[e.condition,e.alternative]).optimize(n);if(!(i instanceof xe))return xe.warn("Condition always true [{start}]",e),Bn(e,[e.condition,e.consequent]).optimize(n);var r=wn(n),o=i.negate(n,r);(r?Et:Tt)(i,o)===o&&(e=Yn(D,e,{condition:o,consequent:e.alternative,alternative:e.consequent}),o=i,i=e.condition);var s=e.consequent,a=e.alternative,c=wi(i,n);if(ki(n,c)){if(c.equals(s))return Yn(p,e,{operator:"||",left:i,right:a}).optimize(n);if(c.equals(a))return Yn(p,e,{operator:"&&",left:i,right:s}).optimize(n)}var u=s.tail_node();if(u instanceof f){var l="="==u.operator,d=l?a.tail_node():a;if((l||s===u)&&d instanceof f&&u.operator==d.operator&&u.left.equals(d.left)&&(l&&u.left instanceof en||!i.has_side_effects(n)&&E(s)&&E(a)))return Yn(f,e,{operator:u.operator,left:u.left,right:Yn(D,e,{condition:i,consequent:S(s),alternative:S(a)})})}d=a.tail_node();if(u.equals(d))return Bn(e,s.equals(a)?[i,s]:[Yn(D,e,{condition:i,consequent:A(s),alternative:A(a)}),d]).optimize(n);var h,v=function n(t,r,o){var s=t.tail_node();var a=r.tail_node();if(!function e(n,t){if(n.TYPE!=t.TYPE)return;if(n.optional!=t.optional)return;if(n instanceof m){if(-1!=k(n,t))return;return"Call"!=n.TYPE||!(n.expression instanceof Oe||t.expression instanceof Oe)||e(n.expression,t.expression)}if(!(n instanceof Oe))return;var i=n.property;var r=t.property;return(i instanceof xe?i.equals(r):i==r)&&!(n.expression instanceof AST_Super||t.expression instanceof AST_Super)}(s,a))return!o&&Yn(D,e,{condition:i,consequent:t,alternative:r});var f=s.clone();var c=T(t,s,"expression");var u=T(r,a,"expression");var l=n(c,u);s.expression instanceof Ce&&(l=nt(s,s.expression,l));f.expression=l;return f}(s,a,!0);if(v)return v;if(s instanceof m&&a.TYPE==s.TYPE&&(h=k(s,a))>=0&&s.expression.equals(a.expression)&&!i.has_side_effects(n)&&!s.expression.has_side_effects(n)){var _=s.clone(),g=s.args[h];return _.args[h]=g instanceof Pe?Yn(Pe,e,{expression:Yn(D,e,{condition:i,consequent:g.expression,alternative:a.args[h].expression})}):Yn(D,e,{condition:i,consequent:g,alternative:a.args[h]}),_}if(u instanceof D&&u.alternative.equals(a))return Yn(D,e,{condition:Yn(p,e,{left:i,operator:"&&",right:T(s,u,"condition")}),consequent:u.consequent,alternative:tt(u.alternative,a)});if(u instanceof D&&u.consequent.equals(a))return Yn(D,e,{condition:Yn(p,e,{left:o,operator:"||",right:T(s,u,"condition")}),consequent:tt(u.consequent,a),alternative:u.alternative});if(d instanceof D&&s.equals(d.consequent))return Yn(D,e,{condition:Yn(p,e,{left:i,operator:"||",right:T(a,d,"condition")}),consequent:tt(s,d.consequent),alternative:d.alternative});if(d instanceof D&&s.equals(d.alternative))return Yn(D,e,{condition:Yn(p,e,{left:o,operator:"&&",right:T(a,d,"condition")}),consequent:d.consequent,alternative:tt(s,d.alternative)});if(u instanceof p&&"&&"==u.operator&&u.right.equals(a))return Yn(p,e,{operator:"&&",left:Yn(p,e,{operator:"||",left:o,right:T(s,u,"left")}),right:tt(u.right,a)}).optimize(n);if(u instanceof p&&"||"==u.operator&&u.right.equals(a))return Yn(p,e,{operator:"||",left:Yn(p,e,{operator:"&&",left:i,right:T(s,u,"left")}),right:tt(u.right,a)}).optimize(n);if(d instanceof p&&"&&"==d.operator&&d.right.equals(s))return Yn(p,e,{operator:"&&",left:Yn(p,e,{operator:"||",left:i,right:T(a,d,"left")}),right:tt(s,d.right)}).optimize(n);if(d instanceof p&&"||"==d.operator&&d.right.equals(s))return Yn(p,e,{operator:"||",left:Yn(p,e,{operator:"&&",left:o,right:T(a,d,"left")}),right:tt(s,d.right)}).optimize(n);var b=n.option("booleans")&&n.in_boolean_context();return x(s)?w(a)?y(i):Yn(p,e,{operator:"||",left:y(i),right:a}).optimize(n):w(s)?x(a)?y(i.negate(n)):Yn(p,e,{operator:"&&",left:y(i.negate(n)),right:a}).optimize(n):x(a)?Yn(p,e,{operator:"||",left:y(i.negate(n)),right:s}).optimize(n):w(a)?Yn(p,e,{operator:"&&",left:y(i),right:s}).optimize(n):(n.option("typeofs")&&Zt(i,s,a),e);function y(e){return e.is_boolean(n)?e:Yn(un,e,{operator:"!",expression:e.negate(n)})}function x(e){return e instanceof sn||b&&e instanceof O&&e.value||e instanceof un&&"!"==e.operator&&e.expression instanceof O&&!e.expression.value}function w(e){return e instanceof ne||b&&(e instanceof O&&!e.value||e instanceof un&&"void"==e.operator&&!e.expression.has_side_effects(n))||e instanceof un&&"!"==e.operator&&e.expression instanceof O&&e.expression.value}function k(e,n){var t=e.args,i=n.args,r=t.length;if(r!=i.length)return-2;for(var o=0;o<r;o++)if(!t[o].equals(i[o])){if(t[o]instanceof Pe!=i[o]instanceof Pe)return-3;for(var s=o+1;s<r;s++)if(!t[s].equals(i[s]))return-2;return o}return-1}function T(e,n,t){if(e===n)return n[t];var i=e.expressions.slice(0,-1);return i.push(n[t]),Bn(e,i)}function E(e){return e===e.tail_node()||An(e.expressions.slice(0,-1),function(e){return!e.has_side_effects(n)})}function S(e){if(!(e instanceof Ce))return e.right;var n=e.expressions.slice();return n.push(n.pop().right),Bn(e,n)}function A(e){return e instanceof Ce?Bn(e,e.expressions.slice(0,-1)):Yn(ke,e,{value:0})}}),e(_,function(e,n){if(!n.option("booleans"))return e;if(n.in_boolean_context())return Yn(ke,e,{value:+e.value});var t=n.parent();return t instanceof p&&("=="==t.operator||"!="==t.operator)?(xe.warn("Non-strict equality against boolean: {operator} {value} [{start}]",{operator:t.operator,value:e.value,start:t.start}),Yn(ke,e,{value:+e.value})):Yn(un,e,{operator:"!",expression:Yn(ke,e,{value:1-e.value})})}),e(Pe,function(e,n){var t=e.expression;return n.option("spreads")&&t instanceof s&&!(n.parent()instanceof Te)?List.splice(t.elements.map(function(e){return e instanceof ae?Yn(ln,e).optimize(n):e})):e}),e(Ye,function(e,n){var t=e.expression,i=e.property,r=fi(e,n);if(r)return r;if(n.option("properties")){var a=i.evaluate(n);if(a!==i){if("string"==typeof a)if("undefined"==a)a=void 0;else(D=parseFloat(a)).toString()==a&&(a=D);i=e.property=Tt(i,Kn(a,i).transform(n));var f=""+a;if(Xn(f)&&f.length<=i.print_to_string().length+1)return Yn(G,e,{optional:e.optional,expression:t,property:f,quoted:!0}).optimize(n)}}var c,u,l,p,d=n.parent(),h=Qn(n.self(),d);if(n.option("arguments")&&t instanceof en&&x(c=t.definition())&&!t.in_arg&&i instanceof ke&&Math.floor(w=i.value)==w&&(u=c.scope)===function(){var e,t=0;for(;e=n.parent(t++);)if(e instanceof he){if(e instanceof o)return;if(kn(e))continue;return l=n.parent(t),e}}()&&u.uses_arguments<(h?2:3)){d instanceof un&&"delete"==d.operator&&(c.deleted||(c.deleted=[]),c.deleted[w]=!0);var v=u.argnames[w];if(c.deleted&&c.deleted[w])v=null;else if(v){var _;v instanceof Xe&&"await"!=v.name&&t.scope.find_variable(v.name)===(_=v.definition())?(n.has_directive("use strict")||u.name||u.rest||!(l instanceof m&&w<l.args.length&&An(l.args.slice(0,w+1),function(e){return!(e instanceof Pe)}))||!An(u.argnames,function(e){return e instanceof Xe}))&&(z()||_.assignments||_.orig.length>1)&&(v=null):v=null}else if((h||!z())&&w<u.argnames.length+5&&n.drop_fargs(u,l)&&!u.rest)for(;w>=u.argnames.length;)v=u.make_var(Xe,u,"argument_"+u.argnames.length),u.argnames.push(v);if(v&&find_if(function(e){return e.name===v.name},u.argnames)===v){h&&c.reassigned--;var g=Yn(en,v);return g.reference(),v.unused=void 0,g}}if(h)return e;if(n.option("sequences")&&"Call"!=d.TYPE&&!(d instanceof re&&d.init===e)){var b=ci(e);if(b!==e)return b.optimize(n)}if(a!==i){var y=e.flatten_object(f,n);y&&(t=e.expression=y.expression,i=e.property=y.property)}if(n.option("properties")&&n.option("side_effects")&&i instanceof ke&&t instanceof s&&An(p=t.elements,function(e){return!(e instanceof Pe)})){var w,k=p[w=i.value];if(Mi(k,n)){for(var T=k instanceof ae,E=!T,S=[],A=p.length;--A>w;){(D=p[A].drop_side_effect_free(n))&&(S.unshift(D),E&&D.has_side_effects(n)&&(E=!1))}for(E||S.unshift(k);--A>=0;){var D;(D=p[A].drop_side_effect_free(n))?S.unshift(D):T?S.unshift(Yn(ae,p[A])):w--}return E?(S.push(k),Bn(e,S).optimize(n)):Yn(Ye,e,{expression:Yn(s,t,{elements:S}),property:Yn(ke,i,{value:w})})}}return Ot(n,e);function z(){return!n.option("reduce_vars")||c.reassigned}}),_e.DEFMETHOD("contains_super",function(){var e=!1,n=this;return n.walk(new mn(function(t){return!!e||(t instanceof AST_Super?e=!0:t!==n&&t instanceof Me&&!kn(t)||void 0)})),e}),function(e){e(a,Rn),e(c,Rn),e(xe,function(){var e=!1,n=this;return n.walk(new mn(function(t){return!!e||(t instanceof rn?e=!0:t!==n&&t instanceof Me&&!kn(t)||void 0)})),e})}(function(e,n){e.DEFMETHOD("contains_this",n)}),Oe.DEFMETHOD("flatten_object",function(e,n){if(n.option("properties")&&"__proto__"!==e){var t=this.expression;if(t instanceof Te)for(var i=t.properties,r=i.length;--r>=0;){var o=i[r];if(o.key===e){if(!An(i,Ci))return;if(!Mi(o.value,n))return;for(var f,u,l=[],p=0;p<i.length;p++){var d=i[p].value;if(i[p]instanceof De){var h,v=!(d.uses_arguments||Tn(d)||d.contains_this());if(v){u||(u=n.find_parent(Me));var _=li(n,u);d.each_argname(function(e){_[e.name]&&(v=!1)})}if(v)h=is_async(d)?c:a;else{if(!(r!=p||(f=n.parent())instanceof m&&f.expression===this))return;h=d.CTOR}d=Yn(h,d)}l.push(d)}return Yn(Ye,this,{expression:Yn(s,t,{elements:l}),property:Yn(ke,this,{value:r})})}}}}),e(G,function(e,n){"arguments"!=e.property&&"caller"!=e.property||xe.warn("Function.prototype.{property} not supported [{start}]",e);var t=n.parent();if(Qn(n.self(),t))return e;var i=fi(e,n);if(i)return i;if(n.option("sequences")&&"Call"!=t.TYPE&&!(t instanceof re&&t.init===e)){var r=ci(e);if(r!==e)return r.optimize(n)}if(n.option("unsafe_proto")&&e.expression instanceof G&&"prototype"==e.expression.property){var o=e.expression.expression;if(pt(o))switch(o.name){case"Array":e.expression=Yn(s,e.expression,{elements:[]});break;case"Function":e.expression=Yn(se,e.expression,{argnames:[],body:[]}).init_vars(o.scope);break;case"Number":e.expression=Yn(ke,e.expression,{value:0});break;case"Object":e.expression=Yn(Te,e.expression,{properties:[]});break;case"RegExp":e.expression=Yn(qe,e.expression,{value:/t/});break;case"String":e.expression=Yn(Ne,e.expression,{value:""})}}var a=e.flatten_object(e.property,n);return a?a.optimize(n):Ot(n,e)}),e(R,function(e,n){return n.option("rests")&&e.rest instanceof R?Yn(R,e,{elements:e.elements.concat(e.rest.elements),rest:e.rest.rest}):e}),e(L,function(e,n){if(n.option("objects")){var t=e.key;t instanceof xe&&(t=t.evaluate(n))!==e.key&&(e.key=""+t)}return e}),e(Te,function(e,n){if(!n.option("objects"))return e;var t=!1,i=!1,r=!1,o=n.has_directive("use strict"),s=[],a=new zn,f=[];if(e.properties.forEach(function(e){if(!(e instanceof Pe))return l(e);i=!0;var o=e.expression;n.option("spreads")&&o instanceof Te&&An(o.properties,function(e){return!(e instanceof AST_ObjectGetter)&&(!(e instanceof Pe)&&("__proto__"!==e.key||(e instanceof AST_ObjectSetter||!e.value.has_side_effects(n))))})?(t=!0,o.properties.forEach(function(e){var t=e.key,i=e instanceof AST_ObjectSetter;if("__proto__"===t){if(!i)return;t=Kn(t,e)}l(i?Yn(Ee,e,{key:t,value:Yn(ln,e).optimize(n)}):e)})):(r=!0,u(),f.push(e))}),u(),!t)return e;if(i&&r&&1==f.length){var c=f[0];c instanceof Se&&c.key instanceof ke&&(c.key=""+c.key.value)}return Yn(Te,e,{properties:f});function u(){s.forEach(function(n){var i=a.get(n);switch(i.length){case 0:return;case 1:return f.push(i[0])}t=!0;var s=o&&!r&&i.pop();f.push(1==i.length?i[0]:Yn(Ee,e,{key:i[0].key,value:Bn(e,i.map(function(e){return e.value}))})),s&&f.push(s),i.length=0}),s=[],a=new zn}function l(e){var t=e.key;t instanceof xe&&(i=!0,(t=t.evaluate(n))===e.key||"__proto__"===t?r=!0:t=e.key=""+t),Ci(e)?(e.value.has_side_effects(n)&&u(),s.push(t),a.add(t,e)):(u(),f.push(e)),i&&!r&&"string"==typeof t&&K.test(t)&&(r=!0,a.has(t)&&(e=a.get(t)[0]),e.key=Yn(ke,e,{value:+t}))}}),function(e){function n(e,n,t,i,r,o,s){for(var a=[],f=o.expressions,c=t,u=f.length-(s||0),l=u;--u>=0;c=!0,r=!1){var p=f[u].try_inline(e,n,c,i,r);p&&(d(),a.push(p))}if(0!=a.length)return d(),!t&&a[0]instanceof je&&(a[0]=Yn(Fe,o,{value:a[0].body})),Yn(v,o,{body:a.reverse()});function d(){l>u+1&&a.push(Yn(je,o,{body:Bn(o,f.slice(u+1,l))})),l=u}}e(xe,Pn),e(f,Pn),e(u,function(e,n,t,i){if(e.option("awaits")){var r=this,o=r.expression.try_inline(e,n,t,i,!0);if(o)return t||Gt(o,function(n){n.in_bool=!1;var t=n.value;t instanceof u||(n.value=Yn(u,r,{expression:t||Yn(ln,n).transform(e)}))}),Ht(o)?o:Yn(v,r,{body:[o,Yn(je,r,{body:Yn(u,r,{expression:Yn(ke,r,{value:0})})})]})}}),e(p,function(e,n,t,i,r){if(void 0!==t){var o=this,s=o.operator;if(kt[s]){var a=o.right.try_inline(e,n,t,i,r);if(a)return Yn(fe,o,{condition:function(n){switch(s){case"&&":return n;case"||":return n.negate(e);case"??":return Yn(p,o,{operator:"==",left:Yn(we,o),right:n})}}(o.left),body:a,alternative:t?null:Yn(Fe,o,{value:Yn(ln,o).transform(e)})})}}}),e(v,function(e,n,t,i){if(!t&&this.variables){var r=this.body,o=r.length-1;if(!(o<0)){var s=r[o].try_inline(e,this,t,i);if(s)return r[o]=s,this}}}),e(m,function(e,n,t,i,r){if(!(e.option("inline")<4)){var o=this;if(!o.is_expr_pure(e)){var a=o.expression;if(a instanceof _e&&!(a.name||a.uses_arguments||a.pinned()||Tn(a))){var f=kn(a);if(!(f&&a.value||a.body[0]instanceof V||a.contains_this())){n||(n=On(e));var c=new zn;for(c.set("NaN",!0);!(n instanceof Me);)n.variables.each(function(e){c.set(e.name,!0)}),n=n.parent_scope;if(jn(n,e.stack)&&!(n.pinned()&&a.variables.size()>(f?0:1))){if(n instanceof on){if(a.variables.size()>(f?0:1)){if(!e.toplevel.vars)return;if(a.functions.size()>0&&!e.toplevel.funcs)return}c.set("arguments",!0)}var l=!r&&is_async(a);if(l){if(!e.option("awaits"))return;if(!is_async(n))return;if(o.may_throw(e))return}var p=n.var_names();if(i&&(i=[]),a.variables.all(function(e,n){return i&&i.push(e),!c.has(n)&&!p.has(n)||!f&&"arguments"==n&&1==e.orig.length})&&!(i&&i.length>0&&Oi(a,i))){var d=!0;if(An(a.argnames,function(e){var n=!1,t=new mn(function(e){return!!n||(e instanceof j?Pi(a,e.value)?n=!0:(e.name.walk(t),!0):e instanceof L?e.key instanceof xe&&Pi(a,e.key)?n=!0:(e.value.walk(t),!0):e instanceof Xe&&!An(e.definition().orig,function(e){return!(e instanceof We)})?n=!0:void 0)});return e.walk(t),!n&&(e instanceof Xe||(d=!1),!0)})){if(a.rest){if(Pi(a,a.rest))return;d=!1}var h;if(t?h=function(e){var n=!1;return e.walk(new mn(function(e){return!!n||(l&&(e instanceof u||e instanceof AST_ForAwaitOf)||e instanceof Fe?n=!0:e instanceof Me||void 0)})),!n}:(r||is_async(a)||Dn(n))&&(h=function(e){var n=!1,t=new mn(function(e){return!!n||(e instanceof Fe?n=!0:e instanceof Me||void 0)});return e.walk(new mn(function(e){return!!n||(e instanceof an?(e.bfinally&&An(e.body,function(e){return e.walk(t),!n})&&e.bcatch&&e.bcatch.walk(t),!0):e instanceof Me||void 0)})),!n}),(!h||An(a.body,h))&&pi(a,li(e,n))){a.functions.each(function(e,t){n.functions.set(t,e)});var _=[];a.variables.each(function(t,r){if((f||"arguments"!=r||1!=t.orig.length)&&(p.set(r,!0),n.enclosed.push(t),n.variables.set(r,t),t.single_use=!1,i&&t.references.length!=t.replaced&&t.orig.length!=t.eliminated&&(1!=t.orig.length||!a.functions.has(r))&&An(t.orig,function(e){return!(e instanceof Be)&&(e instanceof Xe?!e.unused&&t.scope.resolve()!==a:!(e instanceof Qe))}))){var o=t.orig[0];o instanceof Ue||_.push(Yn(je,o,{body:Ni(e,ji(o))}))}});var g=Object.create(null),m=new zn;if(d&&An(o.args,function(e){return!(e instanceof Pe)})){var b=o.args.slice();a.argnames.forEach(function(n){var t=b.shift();if(n.unused)t&&_.push(Yn(je,o,{body:t}));else{var i=Yn(dn,o,{name:n.convert_symbol(AST_SymbolVar,x),value:t||Yn(ln,o).transform(e)});n instanceof Xe&&Hi(n.definition(),i),_.push(Yn(pn,o,{definitions:[i]}))}}),b.length&&_.push(Yn(je,o,{body:Bn(o,b)}))}else _.push(Yn(pn,o,{definitions:[Yn(dn,o,{name:Yn(R,o,{elements:a.argnames.map(function(e){return e.unused?Yn(ae,e):e.convert_symbol(AST_SymbolVar,x)}),rest:a.rest&&a.rest.convert_symbol(AST_SymbolVar,x)}),value:Yn(s,o,{elements:o.args.slice()})})]}));m.each(function(e,n){var t=g[n];[].unshift.apply(t.orig,e),t.eliminated+=e.length}),[].push.apply(_,i?a.body.filter(function(e){if(!(e instanceof ve))return!0;var n=Yn(AST_SymbolVar,ji(e.name)),t=n.definition();return t.fixed=!1,t.orig.push(n),t.eliminated++,_.push(Yn(pn,e,{definitions:[Yn(dn,e,{name:n,value:Bt(e,!0)})]})),!1}):a.body);var y=Yn(v,o,{body:_});return t||(l&&Gt(y,function(e){var n=e.value;wt(n)||(e.value=Yn(u,o,{expression:n}))}),_.push(Yn(Fe,o,{value:Dn(n)?Yn(ln,o).transform(e):null}))),y}}}}}}}}function x(e,n){var t=n.definition();g[t.id]=t,m.add(t.id,e)}}),e(D,function(e,n,t,i,r){var o=this.consequent.try_inline(e,n,t,i,r),s=this.alternative.try_inline(e,n,t,i,r);if(o||s)return Yn(fe,this,{condition:this.condition,body:o||a(this.consequent),alternative:s||a(this.alternative)});function a(e){return t?Yn(je,e,{body:e}):Yn(Fe,e,{value:e})}}),e(ie,function(e,n,t,i){var r=this.body.try_inline(e,n,!0,!0);r&&(this.body=r);var o=this.init;return o&&(o=o.try_inline(e,n,!0,i))?(this.init=null,o instanceof v?(o.body.push(this),o):Yn(v,o,{body:[o,this]})):r&&this}),e(re,function(e,t,i,r){var o=this.body.try_inline(e,t,!0,!0);o&&(this.body=o);var s=this.object;if(s instanceof Ce){var a=n(e,t,!0,r,!1,s,1);if(a)return this.object=s.tail_node(),a.body.push(this),a}return o&&this}),e(fe,function(e,t,i,r){var o=this.body.try_inline(e,t,i,r);o&&(this.body=o);var s=this.alternative;s&&(s=s.try_inline(e,t,i,r))&&(this.alternative=s);var a=this.condition;if(a instanceof Ce){var f=n(e,t,!0,r,!1,a,1);if(f)return this.condition=a.tail_node(),f.body.push(this),f}return(o||s)&&this}),e(le,function(e,n,t,i){var r=this.body.try_inline(e,n,!0,!0);if(r)return this.body=r,this}),e(de,function(e,n,t,i){var r=this.body.try_inline(e,n,t,i);if(r){if(this.body instanceof le&&r instanceof v){var o=r.body.pop();return this.body=o,r.body.push(this),r}return this.body=r,this}}),e(ye,Pn),e(Fe,function(e,n,t,i){var r=this.value;return r&&r.try_inline(e,n,void 0,"try"===i)}),e(Ce,function(e,t,i,r,o){return n(e,t,i,r,o,this)}),e(je,function(e,n,t,i){for(var r=this.body;r instanceof un;){var o=r.operator;if(unary_side_effects[o])break;if("void"==o)break;r=r.expression}return t||wt(r)||(r=Yn(un,this,{operator:"void",expression:r})),r.try_inline(e,n,t||!1,i)}),e(un,function(e,n,t,i,r){var o=this,s=o.operator;if(!unary_side_effects[s]){t||"void"!=s||(t=!1);var a=o.expression.try_inline(e,n,t,i,r);if(a)return t||Gt(a,function(n){n.in_bool=!1;var t=n.value;"void"==s&&wt(t)||(n.value=Yn(un,o,{operator:s,expression:t||Yn(ln,n).transform(e)}))}),a}}),e(vn,function(e,t,i,r){var o=this.body.try_inline(e,t,i,r);o&&(this.body=o);var s=this.expression;if(s instanceof Ce){var a=n(e,t,!0,r,!1,s,1);if(a)return this.expression=s.tail_node(),a.body.push(this),a}return o&&this}),e(_n,function(e,n,t,i){if(e.option("yields")&&this.nested){var r=this.expression;if("Call"==r.TYPE){var o=r.expression;switch(o.CTOR){case AST_AsyncGeneratorFunction:o=Yn(AST_AsyncFunction,o);break;case AST_GeneratorFunction:o=Yn(se,o);break;default:return}return(r=r.clone()).expression=o,r.try_inline(e,n,t,i)}}})}(function(e,n){e.DEFMETHOD("try_inline",n)}),e(Fe,function(e,n){var t=e.value;return t&&n.option("side_effects")&&wt(t,n)&&!Dn(n.find_parent(Me))&&(e.value=null),e})}(function(e,n){e.DEFMETHOD("optimize",function(e){if(this._optimized)return this;if(e.has_directive("use asm"))return this;var t=n(this,e);return t._optimized=!0,t})}),{Compressor:Zn}});
//# sourceMappingURL=sourcemaps/compress.js.map
