/**
 * skylark-uglifyjs - A version of uglifyjs that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./utils","./ast","./scope"],function(e,t,n){"use strict";const{defaults:r,push_uniq:a,Dictionary:o}=e,{base54:i}=n,{AST_Binary:s,AST_Call:c,AST_ClassPrivateProperty:f,AST_Conditional:p,AST_Dot:u,AST_DotHash:l,AST_ObjectKeyVal:y,AST_ObjectProperty:d,AST_PrivateMethod:_,AST_PrivateGetter:S,AST_PrivateSetter:A,AST_PrivateIn:b,AST_Sequence:g,AST_String:h,AST_Sub:T,TreeWalker:k,_KEY:m,_MANGLEPROP:v,walk:P}=t;function w(){var e=new o;["NaN","null","true","false","Infinity","-Infinity","undefined"].forEach(n),["encodeURI","encodeURIComponent","escape","eval","decodeURI","decodeURIComponent","isFinite","isNaN","parseFloat","parseInt","unescape"].forEach(n);var t=Function("return this")();return["Array","ArrayBuffer","Atomics","BigInt","Boolean","console","DataView","Date","Error","Function","Int8Array","Intl","JSON","Map","Math","Number","Object","Promise","Proxy","Reflect","RegExp","Set","String","Symbol","WebAssembly"].forEach(function(e){n(e);var r=t[e];if(r&&(Object.getOwnPropertyNames(r).map(n),"function"==typeof r)){r.__proto__&&Object.getOwnPropertyNames(r.__proto__).map(n),r.prototype&&Object.getOwnPropertyNames(r.prototype).map(n);try{Object.getOwnPropertyNames(new r).map(n)}catch(e){try{Object.getOwnPropertyNames(r()).map(n)}catch(e){}}}}),(w=function(){return e.clone()})();function n(t){e.set(t,!0)}}function O(e,t){e instanceof p?(O(e.consequent,t),O(e.alternative,t)):e instanceof g?O(e.tail_node(),t):e instanceof h&&t(e.value)}return{mangle_properties:function(e,t){var n=(t=r(t,{builtins:!1,cache:null,debug:!1,domprops:!1,keep_quoted:!1,regex:null,reserved:null},!0)).builtins?new o:w();t.domprops||"undefined"==typeof domprops||domprops.forEach(function(e){n.set(e,!0)}),Array.isArray(t.reserved)&&t.reserved.forEach(function(e){n.set(e,!0)});var a,c=-1;t.cache?(a=t.cache.props).each(function(e){n.set(e,!0)}):a=new o;var f,l=t.regex,y=!1!==t.debug;y&&(f=!0===t.debug?"":t.debug);var _=new o,S=n.clone();function A(e){return!S.has(e)&&!/^-?[0-9]+(\.[0-9]+)?(e[+-][0-9]+)?$/.test(e)}function b(e){return n.has(e)?(AST_Node.info("Preserving reserved property {this}",e),!1):l&&!l.test(e)?(AST_Node.info("Preserving excluded property {this}",e),!1):a.has(e)||_.has(e)}function m(e){A(e)&&_.set(e,!0),b(e)||S.set(e,!0)}function v(e){if(!b(e))return e;var t=a.get(e);if(!t){if(y){var n="_$"+e+"$"+f+"_";A(n)&&(t=n)}if(!t)do{t=i(++c)}while(!A(t));/^#/.test(e)&&(t="#"+t),a.set(e,t)}return AST_Node.info("Mapping property {name} to {mangled}",{mangled:t,name:e}),t}function P(e){e instanceof g?P(e.tail_node()):e instanceof h?e.value=v(e.value):e instanceof p&&(P(e.consequent),P(e.alternative))}e.walk(new k(function(e){if("Call"==e.TYPE){var t=e.expression;if(t instanceof u)switch(t.property){case"defineProperty":case"getOwnPropertyDescriptor":if(e.args.length<2)break;if(!((t=t.expression)instanceof AST_SymbolRef))break;if("Object"!=t.name)break;if(!t.definition().undeclared)break;O(e.args[1],m);break;case"hasOwnProperty":if(e.args.length<1)break;O(e.args[0],m)}}else e instanceof AST_ClassProperty||e instanceof AST_DestructuredKeyVal||e instanceof d?e.key instanceof AST_Node?O(e.key,m):m(e.key):e instanceof u?is_lhs(e,this.parent())&&m(e.property):e instanceof T&&is_lhs(e,this.parent())&&O(e.property,m)})),e.walk(new k(function(e){if(e instanceof s)"in"==e.operator&&P(e.left);else if("Call"==e.TYPE){var n=e.expression;if(n instanceof u)switch(n.property){case"defineProperty":case"getOwnPropertyDescriptor":if(e.args.length<2)break;if(!((n=n.expression)instanceof AST_SymbolRef))break;if("Object"!=n.name)break;if(!n.definition().undeclared)break;P(e.args[1]);break;case"hasOwnProperty":if(e.args.length<1)break;P(e.args[0])}}else e instanceof AST_ClassProperty||e instanceof AST_DestructuredKeyVal||e instanceof d?e.key instanceof AST_Node?P(e.key):e.key=v(e.key):e instanceof u?e.property=v(e.property):e instanceof T&&(t.keep_quoted||P(e.property))}))},reserve_quoted_keys:function(e,t){function n(e){a(t,e)}e.walk(new k(function(e){e instanceof AST_ClassProperty||e instanceof AST_DestructuredKeyVal||e instanceof d?e.key instanceof AST_Node?O(e.key,n):e.start&&e.start.quote&&n(e.key):e instanceof u?e.quoted&&n(e.property):e instanceof T&&O(e.property,n)}))}}});
//# sourceMappingURL=sourcemaps/propmangle.js.map
