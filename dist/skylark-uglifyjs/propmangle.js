/**
 * skylark-uglifyjs - A version of uglifyjs that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./utils","./ast","./scope"],function(e,n,t){"use strict";const{defaults:_,push_uniq:r,Dictionary:g}=e,h=t["base54"],{AST_Binary:m,AST_Conditional:S,AST_Dot:A,AST_ObjectProperty:b,AST_Sequence:T,AST_String:w,AST_Sub:P,TreeWalker:k}=n;function O(){var n=new g,e=(["NaN","null","true","false","Infinity","-Infinity","undefined"].forEach(t),["encodeURI","encodeURIComponent","escape","eval","decodeURI","decodeURIComponent","isFinite","isNaN","parseFloat","parseInt","unescape"].forEach(t),Function("return this")());return["Array","ArrayBuffer","Atomics","BigInt","Boolean","console","DataView","Date","Error","Function","Int8Array","Intl","JSON","Map","Math","Number","Object","Promise","Proxy","Reflect","RegExp","Set","String","Symbol","WebAssembly"].forEach(function(n){t(n);n=e[n];if(n&&(Object.getOwnPropertyNames(n).map(t),"function"==typeof n)){n.__proto__&&Object.getOwnPropertyNames(n.__proto__).map(t),n.prototype&&Object.getOwnPropertyNames(n.prototype).map(t);try{Object.getOwnPropertyNames(new n).map(t)}catch(e){try{Object.getOwnPropertyNames(n()).map(t)}catch(e){}}}}),(O=function(){return n.clone()})();function t(e){n.set(e,!0)}}function v(e,n){e instanceof S?(v(e.consequent,n),v(e.alternative,n)):e instanceof T?v(e.tail_node(),n):e instanceof w&&n(e.value)}return{mangle_properties:function(e,t){var r,o,n=(t=_(t,{builtins:!1,cache:null,debug:!1,domprops:!1,keep_quoted:!1,regex:null,reserved:null},!0)).builtins?new g:O(),s=(t.domprops||"undefined"==typeof domprops||domprops.forEach(function(e){n.set(e,!0)}),Array.isArray(t.reserved)&&t.reserved.forEach(function(e){n.set(e,!0)}),-1),a=(t.cache?(r=t.cache.props).each(function(e){n.set(e,!0)}):r=new g,t.regex),i=!1!==t.debug,c=(i&&(o=!0===t.debug?"":t.debug),new g),f=n.clone();function p(e){return!f.has(e)&&!/^-?[0-9]+(\.[0-9]+)?(e[+-][0-9]+)?$/.test(e)}function u(e){if(n.has(e))AST_Node.info("Preserving reserved property {this}",e);else{if(!a||a.test(e))return r.has(e)||c.has(e);AST_Node.info("Preserving excluded property {this}",e)}}function l(e){p(e)&&c.set(e,!0),u(e)||f.set(e,!0)}function y(e){if(!u(e))return e;var n,t=r.get(e);if(!t){if(!(t=i&&p(n="_$"+e+"$"+o+"_")?n:t))for(;!p(t=h(++s)););/^#/.test(e)&&(t="#"+t),r.set(e,t)}return AST_Node.info("Mapping property {name} to {mangled}",{mangled:t,name:e}),t}function d(e){e instanceof T?d(e.tail_node()):e instanceof w?e.value=y(e.value):e instanceof S&&(d(e.consequent),d(e.alternative))}e.walk(new k(function(e){if("Call"==e.TYPE){var n=e.expression;if(n instanceof A)switch(n.property){case"defineProperty":case"getOwnPropertyDescriptor":e.args.length<2||(n=n.expression)instanceof AST_SymbolRef&&"Object"==n.name&&n.definition().undeclared&&v(e.args[1],l);break;case"hasOwnProperty":e.args.length<1||v(e.args[0],l)}}else e instanceof AST_ClassProperty||e instanceof AST_DestructuredKeyVal||e instanceof b?e.key instanceof AST_Node?v(e.key,l):l(e.key):e instanceof A?is_lhs(e,this.parent())&&l(e.property):e instanceof P&&is_lhs(e,this.parent())&&v(e.property,l)})),e.walk(new k(function(e){if(e instanceof m)"in"==e.operator&&d(e.left);else if("Call"==e.TYPE){var n=e.expression;if(n instanceof A)switch(n.property){case"defineProperty":case"getOwnPropertyDescriptor":e.args.length<2||(n=n.expression)instanceof AST_SymbolRef&&"Object"==n.name&&n.definition().undeclared&&d(e.args[1]);break;case"hasOwnProperty":e.args.length<1||d(e.args[0])}}else e instanceof AST_ClassProperty||e instanceof AST_DestructuredKeyVal||e instanceof b?e.key instanceof AST_Node?d(e.key):e.key=y(e.key):e instanceof A?e.property=y(e.property):e instanceof P&&(t.keep_quoted||d(e.property))}))},reserve_quoted_keys:function(e,n){function t(e){r(n,e)}e.walk(new k(function(e){e instanceof AST_ClassProperty||e instanceof AST_DestructuredKeyVal||e instanceof b?e.key instanceof AST_Node?v(e.key,t):e.start&&e.start.quote&&t(e.key):e instanceof A?e.quoted&&t(e.property):e instanceof P&&v(e.property,t)}))}}});
//# sourceMappingURL=sourcemaps/propmangle.js.map
